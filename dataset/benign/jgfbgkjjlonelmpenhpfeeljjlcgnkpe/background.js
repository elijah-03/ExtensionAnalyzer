/*! For license information please see background.js.LICENSE.txt */
(()=>{var e={430:e=>{var t={clOpenTabs:{},LaunchpadUri:"",sendRequest:function(e,n,r,a){n=new RegExp("https://"+t.LaunchpadUri).test("https://betalaunchpad.classlink.com")||new RegExp("https://"+t.LaunchpadUri).test("https://betamyapps.classlink.com")?"https://analytics-log-beta.classlink.io"+n:"https://analytics-log.classlink.io"+n;var o=new Headers;o.append("Content-Type","application/json;charset=UTF-8"),r&&o.append("Authorization","gws "+r),fetch(n,{method:e,headers:o,redirect:"follow"}).then((function(e){return e.text().then((function(t){200===e.status?a(null,t):a({status:e.status,statusText:e.statusText,responseText:t})}))})).catch((function(e){return console.error(e)}))},appAnalyticsLaunch:function(e,n,r){try{var a={appid:e.app_id,gwstoken:e.gwstoken};t.LaunchpadUri=e.LaunchpadUri,t.sendRequest("POST","/launch/v1p0/launch?applicationId="+encodeURIComponent(a.appid),a.gwstoken,(function(e,a){if(e)console.log(e);else try{a=JSON.parse(a),t.clOpenTabs[r]={lapse:0,interval:null,windowId:n,launchToken:a.tk},chrome.tabs.query({active:!0,windowId:n},(function(e){e&&e.length>0&&e[0].id==r&&t.appAnalyticsActivity(n,r)}))}catch(e){return void console.log(e)}}))}catch(e){}},appAnalyticsActivity:function(e,n){Object.keys(t.clOpenTabs).forEach((function(e){t.clOpenTabs[e]&&t.clOpenTabs[e].interval&&chrome.windows.get(t.clOpenTabs[e].windowId,(function(n){"minimized"==n.state?(clearInterval(t.clOpenTabs[e].interval),t.clOpenTabs[e].interval=null):chrome.tabs.query({active:!0,windowId:t.clOpenTabs[e].windowId},(function(n){n&&n.length>0&&n[0].id!=e&&(clearInterval(t.clOpenTabs[e].interval),t.clOpenTabs[e].interval=null)}))}))})),t.clOpenTabs&&t.clOpenTabs[n]&&!t.clOpenTabs[n].interval&&(t.clOpenTabs[n].interval=setInterval((function(){chrome.windows.get(t.clOpenTabs[n].windowId,(function(e){"minimized"!=e.state?(t.clOpenTabs[n].lapse+=10,3e5==t.clOpenTabs[n].lapse&&(t.clOpenTabs[n].lapse=0,t.sendRequest("POST","/activity/v1p0/activity?launchToken="+encodeURIComponent(t.clOpenTabs[n].launchToken)+"&activeS=300",null,(function(e,r){if(e){if(e.status&&400==e.status&&e.responseText)try{var a=JSON.parse(e.responseText);if(a.statusCode&&400==a.statusCode&&a.message&&"Invalid launchToken"==a.message)return clearInterval(t.clOpenTabs[n].interval),t.clOpenTabs[n].interval=null,void delete t.clOpenTabs[n]}catch(e){}console.log(e)}})))):t.fnFocusChanged(e.id)}))}),10))},fnFocusChanged:function(e){e==chrome.windows.WINDOW_ID_NONE?Object.keys(t.clOpenTabs).forEach((function(e){t.clOpenTabs[e]&&t.clOpenTabs[e].interval?chrome.windows.get(t.clOpenTabs[e].windowId,(function(n){"minimized"==n.state&&(clearInterval(t.clOpenTabs[e].interval),t.clOpenTabs[e].interval=null)})):chrome.windows.getAll((function(e){var n=(e=e.filter((function(e){return"minimized"!=e.state}))).reduce((function(e,t){return e.top>t.top?e:t}));chrome.tabs.query({active:!0,windowId:n.id},(function(e){e&&e.length>0&&e[0].id&&t.appAnalyticsActivity(n.id,e[0].id)}))}))})):chrome.windows.get(e,(function(n){"minimized"==n.state?Object.keys(t.clOpenTabs).forEach((function(n){t.clOpenTabs[n]&&t.clOpenTabs[n].interval&&t.clOpenTabs[n].windowId==e&&(clearInterval(t.clOpenTabs[n].interval),t.clOpenTabs[n].interval=null)})):(Object.keys(t.clOpenTabs).forEach((function(n){t.clOpenTabs[n]&&t.clOpenTabs[n].interval&&t.clOpenTabs[n].windowId!=e&&(clearInterval(t.clOpenTabs[n].interval),t.clOpenTabs[n].interval=null)})),chrome.tabs.query({active:!0,windowId:e},(function(n){n&&n.length>0&&n[0].id&&t.appAnalyticsActivity(e,n[0].id)})))}))},fnRemoved:function(e,n){t.clOpenTabs&&t.clOpenTabs[e]&&(t.clOpenTabs[e]&&t.clOpenTabs[e].interval&&(clearInterval(t.clOpenTabs[e].interval),t.clOpenTabs[e].interval=null),t.sendRequest("POST","/activity/v1p0/close?launchToken="+encodeURIComponent(t.clOpenTabs[e].launchToken)+"&activeS="+encodeURIComponent(Math.ceil(t.clOpenTabs[e].lapse/1e3)),null,(function(n,r){if(n){if(n.status&&400==n.status&&n.responseText)try{var a=JSON.parse(n.responseText);if(a.statusCode&&400==a.statusCode&&a.message&&"Invalid launchToken"==a.message)return clearInterval(t.clOpenTabs[e].interval),t.clOpenTabs[e].interval=null,void delete t.clOpenTabs[e]}catch(e){}console.log(n)}else delete t.clOpenTabs[e]})))}};chrome.tabs.onActivated.addListener((function(e){t.appAnalyticsActivity(e.windowId,e.tabId)})),chrome.windows.onFocusChanged.addListener((function(e){t.fnFocusChanged(e)})),chrome.windows.onCreated.addListener((function(e){Object.keys(t.clOpenTabs).forEach((function(n){t.clOpenTabs[n]&&t.clOpenTabs[n].interval&&e.id!=t.clOpenTabs[n].windowId&&(clearInterval(t.clOpenTabs[n].interval),t.clOpenTabs[n].interval=null)}))})),chrome.windows.onRemoved.addListener((function(e){Object.keys(t.clOpenTabs).forEach((function(e){chrome.windows.get(t.clOpenTabs[e].windowId,(function(n){"minimized"==n.state&&t.clOpenTabs[e].interval?(clearInterval(t.clOpenTabs[e].interval),t.clOpenTabs[e].interval=null):t.appAnalyticsActivity(t.clOpenTabs[e].windowId,e)}))}))})),chrome.tabs.onAttached.addListener((function(e){chrome.tabs.get(e,(function(n){t.clOpenTabs[e]?(t.clOpenTabs[e].windowId=n.windowId,t.appAnalyticsActivity(n.windowId,e)):t.fnFocusChanged(n.windowId)}))})),chrome.tabs.onDetached.addListener((function(e){chrome.tabs.get(e,(function(n){t.clOpenTabs[e]?(t.clOpenTabs[e].windowId=n.windowId,t.appAnalyticsActivity(n.windowId,e)):t.fnFocusChanged(n.windowId)}))})),chrome.tabs.onRemoved.addListener((function(e,n){t.fnRemoved(e,n)})),chrome.webNavigation.onCommitted.addListener((function(e){e&&0==e.frameId&&("typed"==e.transitionType||"generated"==e.transitionType&&"from_address_bar"==e.transitionQualifiers)&&t.fnRemoved(e.tabId,e)})),chrome.idle.onStateChanged.addListener((function(e){"locked"==e?Object.keys(t.clOpenTabs).forEach((function(e){t.clOpenTabs[e]&&t.clOpenTabs[e].interval&&(clearInterval(t.clOpenTabs[e].interval),t.clOpenTabs[e].interval=null)})):Object.keys(t.clOpenTabs).forEach((function(e){chrome.windows.get(t.clOpenTabs[e].windowId,(function(n){"minimized"!=n.state&&chrome.tabs.query({active:!0,windowId:t.clOpenTabs[e].windowId},(function(n){n&&n.length>0&&n[0].id&&t.appAnalyticsActivity(t.clOpenTabs[e].windowId,n[0].id)}))}))}))})),e.exports.c=t}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}(()=>{"use strict";var e,t=n(430);function r(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){s=!0,i=e},f:function(){try{c||null==n.return||n.return()}finally{if(s)throw i}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(){i=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},c="function"==typeof Symbol?Symbol:{},s=c.iterator||"@@iterator",l=c.asyncIterator||"@@asyncIterator",u=c.toStringTag||"@@toStringTag";function p(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{p({},"")}catch(e){p=function(e,t,n){return e[t]=n}}function d(e,t,n,r){var o=t&&t.prototype instanceof y?t:y,i=Object.create(o.prototype),c=new j(r||[]);return a(i,"_invoke",{value:E(e,n,c)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var h="suspendedStart",b="suspendedYield",v="executing",m="completed",g={};function y(){}function w(){}function T(){}var O={};p(O,s,(function(){return this}));var k=Object.getPrototypeOf,I=k&&k(k(_([])));I&&I!==n&&r.call(I,s)&&(O=I);var x=T.prototype=y.prototype=Object.create(O);function A(e){["next","throw","return"].forEach((function(t){p(e,t,(function(e){return this._invoke(t,e)}))}))}function L(e,t){function n(a,i,c,s){var l=f(e[a],e,i);if("throw"!==l.type){var u=l.arg,p=u.value;return p&&"object"==o(p)&&r.call(p,"__await")?t.resolve(p.__await).then((function(e){n("next",e,c,s)}),(function(e){n("throw",e,c,s)})):t.resolve(p).then((function(e){u.value=e,c(u)}),(function(e){return n("throw",e,c,s)}))}s(l.arg)}var i;a(this,"_invoke",{value:function(e,r){function a(){return new t((function(t,a){n(e,r,t,a)}))}return i=i?i.then(a,a):a()}})}function E(t,n,r){var a=h;return function(o,i){if(a===v)throw new Error("Generator is already running");if(a===m){if("throw"===o)throw i;return{value:e,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var s=S(c,r);if(s){if(s===g)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===h)throw a=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=v;var l=f(t,n,r);if("normal"===l.type){if(a=r.done?m:b,l.arg===g)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(a=m,r.method="throw",r.arg=l.arg)}}}function S(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=f(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function _(t){if(t||""===t){var n=t[s];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,i=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(o(t)+" is not iterable")}return w.prototype=T,a(x,"constructor",{value:T,configurable:!0}),a(T,"constructor",{value:w,configurable:!0}),w.displayName=p(T,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,T):(e.__proto__=T,p(e,u,"GeneratorFunction")),e.prototype=Object.create(x),e},t.awrap=function(e){return{__await:e}},A(L.prototype),p(L.prototype,l,(function(){return this})),t.AsyncIterator=L,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new L(d(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},A(x),p(x,u,"Generator"),p(x,s,(function(){return this})),p(x,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=_,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return c.type="throw",c.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),l=r.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),R(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;R(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:_(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function c(e,t,n,r,a,o,i){try{var c=e[o](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,a)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){c(o,r,a,i,s,"next",e)}function s(e){c(o,r,a,i,s,"throw",e)}i(void 0)}))}}var l=!0,u=0,p=0;function d(e,t){return n=function(n){chrome.webNavigation.getAllFrames({tabId:e},(function(e){return e.forEach((function(e){if("string"==typeof e.url&&0===e.url.indexOf(t))return n(null,e.frameId)})),n(null,0)}))},new Promise((function(e,t){n((function(n,r){if(n)return t(n);e(r)}))}));var n}function f(){return(f=s(i().mark((function e(t,n,a){var o,c,s,l,u,p;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=r(n.tasks),e.prev=1,c.s();case 3:if((s=c.n()).done){e.next=48;break}if(l=s.value,1==parseInt(n.debug)&&console.log("TASK => TabId:"+t+", Type:"+l.type+", Args:",JSON.stringify(l.args)),!o){e.next=10;break}if(l.id===o){e.next=9;break}return e.abrupt("continue",46);case 9:o=!1;case 10:e.t0=l.type,e.next="waitForUrl"===e.t0?13:"waitForUrlTimeout"===e.t0?18:"redirect"===e.t0?23:"ifSelector"===e.t0?28:"recaptchaClick"===e.t0?34:42;break;case 13:return e.next=15,v(l);case 15:return u=e.sent,1==parseInt(n.debug)&&console.log("TASK:Result => TabId:"+t+", Type:"+l.type+", result: finished"),e.abrupt("break",46);case 18:return e.next=20,b(l);case 20:return u=e.sent,1==parseInt(n.debug)&&console.log("TASK:Result => TabId:"+t+", Type:"+l.type+", result: finished"),e.abrupt("break",46);case 23:return e.next=25,m(t,l);case 25:return u=e.sent,1==parseInt(n.debug)&&console.log("TASK:Result => TabId:"+t+", Type:"+l.type+",  result: finished"),e.abrupt("break",46);case 28:return e.next=30,h(t,{type:"handle-sso-task",task:l,auth:n.auth},a);case 30:return(u=e.sent)&&u.error?l.args.elseThenSkipTo&&(o=l.args.elseThenSkipTo):l.args.ifThenSkipTo&&(o=l.args.ifThenSkipTo),1==parseInt(n.debug)&&console.log("TASK:Result => TabId:"+t+", Type:"+l.type+",  result: finished"),e.abrupt("break",46);case 34:return e.next=36,d(t,"https://www.google.com/recaptcha/api2/anchor");case 36:if(!(p=e.sent)){e.next=40;break}return e.next=40,h(t,{type:"handle-sso-task",task:l,auth:n.auth},p);case 40:return 1==parseInt(n.debug)&&console.log("TASK:Result => TabId:"+t+", Type:"+l.type+",  result: finished"),e.abrupt("return");case 42:return e.next=44,h(t,{type:"handle-sso-task",task:l,auth:n.auth},a);case 44:u=e.sent,1==parseInt(n.debug)&&console.log("TASK:Result => TabId:"+t+", Type:"+l.type+",  result: finished");case 46:e.next=3;break;case 48:e.next=53;break;case 50:e.prev=50,e.t1=e.catch(1),c.e(e.t1);case 53:return e.prev=53,c.f(),e.finish(53);case 56:return e.next=58,h(t,{type:"handle-sso-task",task:{type:"finishTask"},auth:{}},a);case 58:case"end":return e.stop()}}),e,null,[[1,50,53,56]])})))).apply(this,arguments)}function h(e,t,n){return new Promise((function(r,a){var o=function(e){chrome.runtime.lastError||(e&&e.error,r(e))};if(n)return chrome.tabs.sendMessage(e,t,{frameId:n},o);chrome.tabs.sendMessage(e,t,o)}))}function b(e){var t=Date.now();return new Promise((function(n,r){0===e.args.url.indexOf("re:")&&new RegExp(e.args.url.substring(3),"i");var a=function(){clearInterval(i),chrome.webNavigation.onCompleted.removeListener(c),n()},i=setInterval((function(){var n=Date.now()-t;e.args.timeout&&n>e.args.timeout&&a()}),100),c=function(t){if(t.url)if("string"==typeof e.args.url){var n=0===e.args.url.indexOf("re:")&&new RegExp(e.args.url.substring(3),"i");(n&&n.test(t.url)||t.url===e.args.url||-1!=t.url.indexOf(e.args.url))&&a()}else if("object"==o(e.args.url)){var r=!1;e.args.url.forEach((function(e){var n=0===e.indexOf("re:")&&new RegExp(e.substring(3),"i");(n&&n.test(t.url)||t.url===e||-1!=t.url.indexOf(e))&&(r=!0)})),1==r&&a()}};chrome.webNavigation.onCompleted.addListener(c)}))}function v(e){return new Promise((function(t,n){var r=function(){chrome.webNavigation.onCompleted.removeListener(a),t()},a=function(t){if(t.url)if("string"==typeof e.args){var n=0===e.args.indexOf("re:")&&new RegExp(e.args.substring(3),"i");(n&&n.test(t.url)||t.url===e.args||-1!=t.url.indexOf(e.args))&&r()}else if("object"==o(e.args)){var a=!1;e.args.forEach((function(e){var n=0===e.indexOf("re:")&&new RegExp(e.substring(3),"i");(n&&n.test(t.url)||t.url===e||-1!=t.url.indexOf(e))&&(a=!0)})),1==a&&r()}};chrome.webNavigation.onCompleted.addListener(a)}))}function m(e,t){return new Promise((function(n,r){chrome.tabs.update(e,{url:t.args},(function(e){chrome.runtime.lastError||n()}))}))}function g(e,n){var r=new RegExp(/[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/gi);n&&e.match(r)?chrome.tabs.create({url:e,active:!1},(function(e){chrome.runtime.lastError||(n.tabId=e.id,t.c.appAnalyticsLaunch(n,n.windowId,n.tabId))})):console.log("Invalid url!")}chrome.tabs.onCreated.addListener((function(n){setTimeout((function(){l&&e&&e.app_id&&e.windowId==n.windowId&&e.tabId==n.openerTabId&&(t.c.appAnalyticsLaunch(e,e.windowId,n.id),e=null)}),300)})),chrome.runtime.onMessage.addListener((function(n,r,a){var o=r.tab.windowId,c=r.tab.id;if("initiate-sso-tasks"==n.type)!function(e,t,n){f.apply(this,arguments)}(c,n.data,r.frameId);else if("initiate-sso"==n.type)!function(e,t){var n=!1;function r(e,t,n){return a.apply(this,arguments)}function a(){return a=s(i().mark((function a(o,c,s){var l;return i().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(o===t){a.next=2;break}return a.abrupt("return");case 2:if(c.url&&(n=!0),"complete"!==c.status||!n){a.next=9;break}return chrome.tabs.onUpdated.removeListener(r),a.next=7,h(o,{type:"verify-toplevel-domain",data:e});case 7:a.sent&&(l=setInterval((function(){chrome.tabs.sendMessage(o,{type:"handle-sso",data:e},(function(){chrome.runtime.lastError||clearInterval(l)}))}),1e3));case 9:case"end":return a.stop()}}),a)}))),a.apply(this,arguments)}chrome.tabs.onUpdated.addListener(r)}(n.data,c);else if("initiate-autolaunch"==n.type){if(1==p)return!1;p=1,function(e,t,n){l&&e.data.data&&e.data.data.length>0&&e.data.data.forEach((function(r){!function(e,t,n,r){var a=n.data.IdConfigBaseUrl,o=r.id,i=r.type,c=r.url?r.url:[];c&&0==c.length&&(c[0]="");var s={app_id:o,windowId:e,tabId:t,gwstoken:n.data.gwstoken,LaunchpadUri:a.replace(/^https?:\/\//,"")};switch(i){case 1:case 25:case 26:case 30:case 31:case 32:case 37:g(new RegExp(/^(http|https):\/\//).test(c[0])?c[0]:"http://"+c[0],s);break;case 7:case 8:!function(e,t){chrome.scripting.executeScript({target:{tabId:e},func:function(){var e=setInterval((function(){window.CloudApp&&window.CloudApp.MyApps&&(window.CloudApp.MyApps.Controller.openRDPClient("'"+t+"'"),clearInterval(e))}),700)}}).then((function(){return console.log("injected script file")}))}(t,o);break;case 9:g(a+"/clsso/"+encodeURIComponent(o),s);break;case 14:g(c[0],s);break;case 15:g(a+"/browsersso/"+encodeURIComponent(o),s);break;case 16:case 36:g(a+"/ltisso/"+o,s);break;case 17:g(a+"/focussso/"+o,s);break;case 18:g(a+"/pearson/mathxl/"+o,s);break;case 19:g(a+"/pearson/mymathlab/"+o,s);break;case 20:g(a+"/custom/certification/"+o,s);break;case 21:g(a+"/oneroster/"+o,s);break;case 22:g(a+"/phonebook/"+o,s);break;case 23:g(a+"/onerosterlti/"+o,s);break;case 24:g(a+"/assignapplication/"+o,s);break;case 3:case 27:var l=c[0];chrome.scripting.executeScript({target:{tabId:t},func:function(){var e=setInterval((function(){window.CloudApp&&window.CloudApp.MyApps&&(window.CloudApp.MyApps.Controller.launchLocalApp("'"+l+"'"),clearInterval(e))}),700)}}).then((function(){return console.log("injected script file")}));break;case 28:g(a+"/custom/genericoneroster/ltilaunch/"+o,s);break;case 29:case 33:g(a+"/custom/pearsonapapp/"+o,s);break;case 34:g(a+"/custom/naviancestudentsso/"+o,s);break;case 35:g(a+"/oneroster/manage/class/"+o,s)}}(t,n,e,r)}))}(n,o,c),setTimeout((function(){p=0}),1e4)}else if("initiate-apptimer"==n.type)e={app_id:n.data.app_id,windowId:o,tabId:c,gwstoken:n.data.gwstoken,LaunchpadUri:n.data.LaunchpadUri};else if("initiate-ssosignout"==n.type){if(1==u)return!1;u=1,n.data&&n.data.length>0&&n.data.forEach((function(e){chrome.tabs.create({url:e,active:!1},(function(e){chrome.runtime.lastError}))})),setTimeout((function(){u=0}),1e4)}else"stopapptimers"==n.type?(Object.keys(t.c.clOpenTabs).forEach((function(e){clearInterval(t.c.clOpenTabs[e].interval),t.c.clOpenTabs[e].interval=null,delete t.c.clOpenTabs[e]})),l=!1):"execute-script"==n.type&&chrome.scripting.executeScript({target:{tabId:c},func:function(e){var t=document.createElement("script");t.textContent=e,document.documentElement.appendChild(t),t.remove()},args:[n.data],world:"MAIN"})})),chrome.windows.onCreated.addListener((function(e){e&&"maximized"==e.state&&"normal"==e.type&&chrome.windows.getAll((function(e){if(1==e.length){var t=[btoa("islogin_betalaunchpad.classlink.com"),btoa("islogin_stagingclouddesktop.classlink.com"),btoa("islogin_launchpad.classlink.com")];chrome.storage.sync.remove(t,(function(){}))}}))})),chrome.manifest=chrome.runtime.getManifest(),chrome.windows.getAll({populate:!0},(function(e){for(var t,n,r,a=0,o=e.length;a<o;a++)for(var i,c=0,s=(t=e[a]).tabs.length;c<s;c++)i=t.tabs[c],new RegExp("^https:\\/\\/(betalaunchpad\\.classlink\\.com|stagingclouddesktop\\.classlink\\.com|launchpad\\.classlink\\.com|my\\.classlink\\.eu|betamyapps\\.classlink\\.com|stagingmyapps\\.classlink\\.com|myapps\\.classlink\\.com|betateacherconsole\\.classlink\\.com|stagingteacherconsole\\.classlink\\.com|teacherconsole\\.classlink\\.com|betamybackpack\\.classlink\\.com|stagingmybackpack\\.classlink\\.com|mybackpack\\.classlink\\.com|staging-login\\.classlink\\.com|beta-login\\.classlink\\.com|login\\.classlink\\.com)(?![w\\.-])").test(i.url)&&(n=i,void 0,r=chrome.manifest.content_scripts[0].js,chrome.scripting.executeScript({target:{tabId:n.id},files:r}))}))})()})();