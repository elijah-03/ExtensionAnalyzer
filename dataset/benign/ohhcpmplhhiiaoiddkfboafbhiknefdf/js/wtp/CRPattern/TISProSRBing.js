const carbonwtpTagName="[WTP][Bing]";function CheckATagSpanChildElement(e){var t=e.FindInsertNode(),r=!1;if(t&&t.childNodes)for(var l=0;l<t.childNodes.length;++l){var o=t.childNodes[l];if(o&&o.tagName&&"CITE"==o.tagName.toUpperCase()){r=!0;break}}t.NotHighLight=r}function getCiteText(e){const t=e=>{let t="";do{let r=e.querySelector(".b_caption");if(!r)break;let l=r.querySelector("cite");if(!l)break;t=l.textContent}while(0);return t},r=e=>{let t="";do{let r=e.querySelector(".b_imgcap_altitle");if(!r)break;let l=r.querySelector("cite");if(!l)break;t=l.textContent}while(0);return t};let l="";try{do{let o=e;for(;o&&"LI"!==o.tagName.toUpperCase();)o=o.parentNode;if(!o)break;l=t(o),l||(l=r(o))}while(0)}catch(e){logError("getCiteText: e = "+e)}return l}function getRealURL(e){let t="",r="";try{do{if(r=new URL(e).searchParams.get("u"),!r)break;0===r.indexOf("a1")&&(r=r.substring(2)),r=r.replace(/-/g,"+").replace(/_/g,"/"),t=decodeURIComponent(atob(r))}while(0)}catch(e){r&&logError("getRealURL: base64EncodeURL = "+r),logError("getRealURL: exception = "+e)}return t}function TSSRMSBingResult(){let e=document.querySelector("#b_results");if(!e)return;let t=e.querySelectorAll("h2");for(let e=0;e<t.length;++e){let r=t[e].querySelector("A");if(r){let l=r.href;logInfo("[WTP][Bing]","TSSRMSBingResult: url =  "+l);let o=getRealURL(l);logInfo("[WTP][Bing]","TSSRMSBingResult: realURL =  "+o),o&&(l=o),CreateTSRResultObject(r,l,null,null,null,!0);let n=t[e].parentNode.querySelector(".b_deep");if(n){let e=n.querySelectorAll("h3");for(let t=0;t<e.length;++t){let r=e[t].querySelector("a");r&&CreateTSRResultObject(r,l,null,null,null,!0)}}}}}function TSRParse(){var e=g_oEnv.Parser.iResultNumber;TSSRMSBingResult(),TrendMicro.TB.ReduceNewNode(e+1);for(var t=1;t<g_oEnv.Parser.rgobjSearchResult.length;t++)g_oEnv.Parser.rgobjSearchResult[t]&&CheckATagSpanChildElement(g_oEnv.Parser.rgobjSearchResult[t]);return g_oEnv.Parser.rgobjSearchResult}g_bIsNeedCheckSPan=!0,TSRTagFlowID();