
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="bcf33095-83b3-551f-8102-181958d65a86")}catch(e){}}();
(()=>{"use strict";var Y={};class y{constructor(t,i,e,s){this.Left=0,this.Top=0,this.Right=0,this.Bottom=0,this.Left=t,this.Top=i,this.Right=e,this.Bottom=s}clone(){return new y(this.Left,this.Top,this.Right,this.Bottom)}equalsTo(t){return t.Left==this.Left&&t.Top==this.Top&&t.Right==this.Right&&t.Bottom==this.Bottom}Width(){return this.Right-this.Left}Height(){return this.Bottom-this.Top}midX(){return this.Left+(this.Right-this.Left)/2}midY(){return this.Top+(this.Bottom-this.Top)/2}containsPoint(t,i){return t>=this.Left&&t<=this.Right&&i>=this.Top&&i<=this.Bottom}floorCoords(){this.Left=Math.floor(this.Left),this.Top=Math.floor(this.Top),this.Right=Math.floor(this.Right),this.Bottom=Math.floor(this.Bottom)}offsetRect(t,i){this.Left+=t,this.Right+=t,this.Top+=i,this.Bottom+=i}}class I{constructor(){this.rectangles=[],this.boundsRect=new y(0,0,0,0)}addRect(t){var i=t.clone();R.normalizeRect(i),this.rectangles.length==0?this.boundsRect=i.clone():(this.boundsRect.Left=Math.min(this.boundsRect.Left,i.Left),this.boundsRect.Top=Math.min(this.boundsRect.Top,i.Top),this.boundsRect.Right=Math.max(this.boundsRect.Right,i.Right),this.boundsRect.Bottom=Math.max(this.boundsRect.Bottom,i.Bottom)),this.rectangles.push(i)}containsPoint(t,i){for(var e=this.rectangles.length-1;e>=0;e--)if(this.rectangles[e].containsPoint(t,i))return!0;return!1}getBoundsRect(){return this.boundsRect.clone()}}class B{constructor(t=0,i=0){this.x=t,this.y=i}clone(){return new B(this.x,this.y)}equalsTo(t){return t.x==this.x&&t.y==this.y}}class p{constructor(t=0,i=0){this.cx=t,this.cy=i}clone(){return new p(this.cx,this.cy)}equalsTo(t){return t.cx==this.cx&&t.cy==this.cy}}class R{static normalizeRect(t){}static createCanvas(t,i){let e;return typeof OffscreenCanvas>"u"?(e=document.createElement("canvas"),e.width=t,e.height=i):e=new OffscreenCanvas(t,i),e}static setupCtx(t,i=!0){const e=t.getContext("2d",{alpha:i});return e&&(e.fillStyle="#fff",e.fillRect(0,0,t.width,t.height),e.translate(.5,.5)),e}static blendRect(t,i,e,s,n,l){t.fillStyle=s,t.globalAlpha=1-i,t.fillRect(e.Left,e.Top,e.Width(),e.Height()),t.globalAlpha=1,n>0&&(t.strokeStyle=l,t.lineWidth=n,t.strokeRect(e.Left,e.Top,e.Width(),e.Height()))}static dashRect(t,i,e,s,n,l){let u=Math.max(s,n)+Math.min(s,n);t.beginPath(),t.strokeStyle="#eee",t.lineWidth=1;for(let r=0;r<u;r+=l)t.moveTo(i+0,e+r),t.lineTo(i+r,e),t.moveTo(i+s-r,e),t.lineTo(i+s,e+r);t.stroke()}static drawTextSingle(t,i,e,s,n,l=!0){const u=e.fontStyle.indexOf("B")!==-1?"bold":"",r=e.fontStyle.indexOf("I")!==-1?"italic":"",a=e.fontStyle.indexOf("U")!==-1,o=e.fontStyle.indexOf("S")!==-1,f=function(m){m.realWidth=Math.max(m.width,m.actualBoundingBoxLeft+m.actualBoundingBoxRight)};t.font=`${u} ${r} ${e.fontSize}px ${e.fontName}`,t.fillStyle=e.fontColor;let b=i.trimEnd().split(" ");if(!b.length)return{width:0,height:0,nextLineY:0,gap:0};let c=[],d=b[0],h=t.measureText(d),g=0,k=0;f(h);for(let m=1;m<=b.length;++m){let T=m==b.length,W=d+(T?"":" "+b[m]),x=t.measureText(W.trimEnd());f(x),n>0&&x.realWidth>n||T?(c.push({string:d,metrics:h}),k=Math.max(k,h.realWidth),T||(d=b[m],h=t.measureText(b[m]),f(h))):(h=x,d=W)}t.textBaseline="top";let w=t.measureText("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"),M=typeof w.fontBoundingBoxDescent>"u"?w.actualBoundingBoxDescent:w.fontBoundingBoxDescent;g=typeof w.fontBoundingBoxDescent>"u"?(w.actualBoundingBoxDescent-w.actualBoundingBoxAscent)*1.2:w.fontBoundingBoxDescent+w.fontBoundingBoxAscent;let P=0;const L=g*.2;l&&(n>0&&(t.save(),t.rect(s.x-.5,s.y-.5,n,9999999),t.clip()),c.forEach(m=>{let T=m.string,W="";for(;n>0&&m.metrics.realWidth>n&&T.length>0;)W=W||"...",T=T.substring(0,T.length-1),m.metrics=t.measureText(T+W),f(m.metrics);let x=0;switch(n<=0&&(n=k),e.alignment){case"right":x=n-m.metrics.realWidth;break;case"center":x=Math.floor((n-m.metrics.realWidth)/2);break}if(t.fillText(T+W,x+s.x,s.y+P),o||a){t.strokeStyle=e.fontColor,t.lineWidth=Math.ceil(e.fontSize/15),t.beginPath();const U=Math.floor(g*.85)-t.lineWidth;o&&(t.moveTo(Math.floor(x+s.x),Math.floor(s.y+P+U/2)),t.lineTo(Math.floor(x+s.x+m.metrics.realWidth),Math.floor(s.y+P+U/2))),a&&(t.moveTo(Math.floor(x+s.x),Math.floor(s.y+P+M)),t.lineTo(Math.floor(x+s.x+m.metrics.realWidth),Math.floor(s.y+P+M))),t.stroke()}P+=g+L}),t.restore());let C=(g+L)*c.length;w=t.measureText(c[c.length-1].string);let V=w.fontBoundingBoxDescent?w.fontBoundingBoxDescent:w.actualBoundingBoxDescent-w.actualBoundingBoxAscent,_=(c.length>1?C-(g+L):0)+V;return{width:n>0?Math.min(n,k):k,height:_,nextLineY:C+s.y,gap:L}}static drawText(t,i,e,s,n,l=!0){if(i==="")return{width:0,height:0,gap:0,nextLineY:0};let u=i.split(`
`),r=0,a=0,o=s.y,f=0;return u.forEach(b=>{let c=b==""?" ":b,d=this.drawTextSingle(t,c,e,new B(s.x,o),n,l);f=o+d.height,o=d.nextLineY,r=Math.max(r,d.width),a=d.gap}),{width:Math.ceil(r),height:Math.ceil(f),gap:a,nextLineY:o}}static measureTextSingle(t,i,e,s){return this.drawTextSingle(t,i,e,new B(0,0),s,!1)}static measureText(t,i,e,s){let n=this.drawText(t,i,e,new B(0,0),s,!1);return new p(n.width,n.height)}static textInBox(t,i,e,s,n,l=!0,u=!0){const r=12+Math.ceil(e.frameWidth/2);let a=this.drawText(t,i,e,s,n>0?n-r*2:n,!1),o=a.width+r*2,f=a.height+r*2;if(u&&n>0&&(a.width=n-r*2,o=n-1),l){let b=s.x+r,c=s.y+r;this.blendRect(t,e.backgroundOpacity,new y(s.x,s.y,s.x+o,s.y+f),e.backgroundColor,e.frameWidth,e.frameColor),this.drawText(t,i,e,new B(b,c),a.width,!0)}return new p(o,f)}}class E{constructor(t="Page title",i="Page URL",e=new Date,s=new p(1e3,1e3)){this.title=t,this.URL=i,this.created=e,this.extents=s}}class v{constructor(t,i){var e;switch(this.type="text",this.fontName="Verdana",this.fontSize=Math.ceil(15*self.devicePixelRatio),this.fontColor="#666",this.fontStyle=[],this.backgroundColor="#f0f0f0",this.frameColor="#ddd",this.frameWidth=1,this.textAlignment="left",this.margin=50,this.template=`Page %p
%t
%u`,this.opacity=0,this.bitmap="",this.bitmapLink="",this.position=8,t){case"header":this.template=`Page %p
%t
%u`;break;case"footer":this.template="Captured by FireShot Pro: %d %B %y, "+(((e=navigator.language)===null||e===void 0?void 0:e.toLowerCase())==="en-us"?"%U":"%H:%M:%S")+`
https://getfireshot.com`,this.textAlignment="center";break;case"watermark":this.template="Page %p",this.opacity=85,this.frameWidth=0,this.fontSize=Math.ceil(150*self.devicePixelRatio),this.backgroundColor="#fff";break}if(i){let s=JSON.parse(i);for(const n in s)this[n]=s[n]}}serialize(){return JSON.stringify(this)}}class H{constructor(t,i){this.options=t,this.vars=i,this.pageNumber=1,this.options=Object.assign({},t)}setPageNumber(t){this.pageNumber=t}padString(t,i,e){for(t=t.toString();t.length<e;)t=i+t;return t}processTemplate(){let t=this.options.template;t=t.replace(/%y/g,this.vars.created.getFullYear().toString()),t=t.replace(/%m/g,this.padString((this.vars.created.getMonth()+1).toString(),"0",2)),t=t.replace(/%d/g,this.padString(this.vars.created.getDate().toString(),"0",2)),t=t.replace(/%H/g,this.padString(this.vars.created.getHours().toString(),"0",2)),t=t.replace(/%M/g,this.padString(this.vars.created.getMinutes().toString(),"0",2)),t=t.replace(/%S/g,this.padString(this.vars.created.getSeconds().toString(),"0",2)),t=t.replace(/%U/g,new Intl.DateTimeFormat("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}).format(this.vars.created)),t=t.replace(/%A/g,this.vars.created.toLocaleDateString(navigator.language,{weekday:"long"})),t=t.replace(/%B/g,this.vars.created.toLocaleDateString(navigator.language,{month:"long"}));let i="";try{i=new URL(this.vars.URL).hostname}catch{i="<Error acquiring domain>"}return t=t.replace(/%e/g,i),t=t.replace(/%t/g,this.vars.title),t=t.replace(/%u/g,this.vars.URL),t=t.replace(/%w/g,this.vars.extents.cx.toString()),t=t.replace(/%h/g,this.vars.extents.cy.toString()),t=t.replace(/%p/g,this.pageNumber.toString()),t}getText(){return this.processTemplate()}getMargin(){return this.options.margin}getOpacity(){return this.options.opacity}getRect(t){let i=R.createCanvas(1,1),e=R.setupCtx(i,!1),s=this.draw(e,new p(t.cx,-1),!0);return s.cx++,s.cy++,new y(0,0,s.cx,s.cy)}getURLFromImage(){if(this.options.type==="bitmap"&&this.options.bitmapLink.length){let t=this.options.bitmapLink.trim();return t.length&&/(^[a-zA-Z]+:\/\/)/.test(t)?t:"https://"+t}else return""}getURLFromText(){let t=/([a-zA-Z]+:\/\/.+?)(\s|$)/.exec(this.getText());return t&&t.length>1?t[1]:""}getURL(){return this.options.type==="bitmap"?this.getURLFromImage():this.getURLFromText()}getBitmap(t){let i=this.getRect(t);if(!i.Width()&&!i.Height())return new ImageData(0,0);let e=this.getCanvas(t).getContext("2d",{alpha:!1});return e?e.getImageData(0,0,i.Width(),i.Height()):new ImageData(0,0)}getCanvas(t){let i=this.getRect(t),e=R.createCanvas(i.Width(),i.Height()),s=R.setupCtx(e,!1);return s&&this.draw(s,t),e}draw(t,i,e=!1){let s={fontStyle:this.options.fontStyle,fontSize:this.options.fontSize,fontName:this.options.fontName,fontColor:this.options.fontColor,alignment:this.options.textAlignment,backgroundColor:this.options.backgroundColor,backgroundOpacity:0,frameColor:this.options.frameColor,frameWidth:this.options.frameWidth};return R.textInBox(t,this.getText(),s,new B(0,0),i.cx,!e,!0)}}class F extends H{getSize(t){let i=R.createCanvas(1,1),e=R.setupCtx(i,!1);return this.draw(e,t,!0)}draw(t,i,e=!1){const s=new p(i.cx-this.options.margin*2,0);let n={fontStyle:this.options.fontStyle,fontSize:this.options.fontSize,fontName:this.options.fontName,fontColor:this.options.fontColor,alignment:this.options.textAlignment,backgroundColor:this.options.backgroundColor,backgroundOpacity:0,frameColor:this.options.frameColor,frameWidth:this.options.frameWidth};return R.textInBox(t,this.getText(),n,new B(0,0),s.cx,!e,!1)}getRect(t){const i=this.getSize(t);i.cx++,i.cy++;const e=i.cx,s=i.cy;let n=0,l=0,u=this.options.margin,r=new y(0,0,t.cx,t.cy);switch(this.options.position){case 0:n=u,l=u;break;case 1:n=(r.Width()-e)/2,l=u;break;case 2:n=r.Width()-(e+u),l=u;break;case 3:n=u,l=(r.Height()-s)/2;break;case 4:n=r.Width()-(e+u),l=(r.Height()-s)/2;break;case 5:n=u,l=r.Height()-(u+s);break;case 6:n=(r.Width()-e)/2,l=r.Height()-(u+s);break;case 7:n=r.Width()-(e+u),l=r.Height()-(u+s);break;case 8:n=(r.Width()-e)/2,l=(r.Height()-s)/2;break}return new y(n,l,n+i.cx,l+i.cy)}}const z=8.3,A=11.7;class N{constructor(t){if(this.chkMultipagePDF=!0,this.chkSmartPageBreaks=!0,this.cmbPageSize=0,this.cmbPageSizeSingle=0,this.edtCustomWidth=8.3,this.cmbCustomWidthUnits=0,this.edtWidthSingle=8.3,this.cmbWidthMeasurementSingle=0,this.edtCustomHeight=11.7,this.cmbCustomHeightUnits=0,this.edtWidth=8.3,this.cmbWidthMeasurement=0,this.edtHeight=11.7,this.cmbHeightMeasurement=0,this.cmbOrientation=0,this.chkSearchablePDF=!0,this.chkEnableWebLinks=!0,this.chkAddHeader=!0,this.chkAddFooter=!0,this.chkAddWatermark=!1,this.cmbMarginsMeasurement=0,this.edtLeftMargin=.5,this.edtTopMargin=.5,this.edtRightMargin=.5,this.edtBottomMargin=.5,t){let i=JSON.parse(t);for(const e in i)this[e]=i[e]}}serialize(){return JSON.stringify(this)}}class O{constructor(t){this.options=t}getUnitsRatio(t){switch(t){case 0:return 1;case 1:return 2.54;case 2:return 25.4;case 3:return 72;case 4:return 6;default:return 1}}getSelectedStockSize(){let t=new p(0,0);switch(this.options.cmbPageSize){case 1:t=new p(11.7,16.5);break;case 2:t=new p(8.3,11.7);break;case 3:t=new p(5.8,8.3);break;case 4:t=new p(8.5,11);break;case 5:t=new p(8.5,14);break}if(this.options.cmbOrientation==1){let i=t.cx;t.cx=t.cy,t.cy=i}return t}areMarginsValid(){let t=this.getPageMargins(),i=this.getPageSize();return this.options.chkMultipagePDF?this.options.cmbPageSize===0?!0:t.Left+t.Right<i.cx&&t.Top+t.Bottom<i.cy:this.isCustomSize()?t.Left+t.Right<i.cx:!0}toDoubleDef(t,i){const e=parseFloat(t);return isNaN(e)?i:e}loadConfig(){}saveConfig(){}getPageSize(){let t=0,i=0;if(this.options.chkMultipagePDF)if(this.isCustomSize())t=this.options.edtCustomWidth/this.getUnitsRatio(this.options.cmbCustomWidthUnits),t<=0&&(t=z),i=this.options.edtCustomHeight/this.getUnitsRatio(this.options.cmbCustomHeightUnits),i<=0&&(i=A);else{let e=this.getSelectedStockSize();t=e.cx,i=e.cy}else this.isCustomSize()&&(t=this.options.edtWidthSingle/this.getUnitsRatio(this.options.cmbWidthMeasurementSingle),t<=0&&(t=z));return new p(t,i)}getPageMargins(){const t=this.getUnitsRatio(this.options.cmbMarginsMeasurement),i=e=>Math.max(0,e/t);return new y(i(this.options.edtLeftMargin),i(this.options.edtTopMargin),i(this.options.edtRightMargin),i(this.options.edtBottomMargin))}isCustomSize(){return this.options.chkMultipagePDF?this.options.cmbPageSize===6:this.options.cmbPageSizeSingle===1}isAutocalcHeight(){return!this.options.chkMultipagePDF&&this.options.cmbPageSizeSingle==1}isSinglePage(){return!this.options.chkMultipagePDF}isSpecificSize(){return this.options.chkMultipagePDF&&this.options.cmbPageSize>0||!this.options.chkMultipagePDF&&this.options.cmbPageSizeSingle==1}linksEnabled(){return this.options.chkEnableWebLinks}textEnabled(){return this.options.chkSearchablePDF}headersEnabled(){return this.options.chkAddHeader}footersEnabled(){return this.options.chkAddFooter}watermarksEnabled(){return this.options.chkAddWatermark}optimizationEnabled(){return!1}smartPageBreaksEnabled(){return this.options.chkSmartPageBreaks}}function D(S){if(typeof window!="object"||!window.fsWorkerConnection)return onmessage=S,{postMessage:function(i,e){try{postMessage(i,e)}catch{postMessage(JSON.parse(JSON.stringify(i)),e)}},isWorker:!0};{var t=window.fsWorkerConnection;delete window.fsWorkerConnection,t.worker=S,setTimeout(function(){t.msgs.forEach(function(e){t.worker({data:e})})},1);const i=document.location.href.indexOf("background_page")>0;return{postMessage:function(e){i?setTimeout(()=>t.host({data:e},10)):requestAnimationFrame(()=>t.host({data:e}))},isWorker:!1}}}(function(){let S;function t(){S&&document.head.removeChild(S)}function i(e){return new Promise(s=>{typeof window!="object"||!window.fsWorkerConnection?(self.devicePixelRatio=parseFloat(new URLSearchParams(location.href.split("?")[1]).get("ratio")||""),importScripts("fsEncoder.js"),s(0)):(S=document.createElement("script"),S.src=e,S.async=!1,S.onload=s,document.head.appendChild(S))})}i("scripts/enc/fsEncoder.js").then(()=>Module().then(e=>{function s(a,o){const f=o.length*o.BYTES_PER_ELEMENT,b=a._malloc(f);return a.HEAPU8.set(o,b),[b,f]}function n(a){let o=new H(new v("header",a.headerSettings),new E(a.title,a.URL,a.created,new p(a.width,a.height))),f=new H(new v("footer",a.footerSettings),new E(a.title,a.URL,a.created,new p(a.width,a.height))),b=new F(new v("watermark",a.wmSettings),new E(a.title,a.URL,a.created,new p(a.width,a.height))),c=new O(new N(a.pdfSettings)),d=h=>h===0?o:h===1?f:b;self.fsWasmSupport={getText:function(h){let g=d(h).getText();return e.stringToNewUTF8(g)},getURL:function(h){let g=d(h).getURL();return e.stringToNewUTF8(g)},getMargin:function(h){return d(h).getMargin()},getOpacity:function(h){return d(h).getOpacity()},setPageNumber:function(h,g){d(h).setPageNumber(g)},getBitmap:function(h,g){let k=new p(e.getValue(g,"i32"),e.getValue(g+4,"i32")),w=d(h).getBitmap(k);const M=w.data,P=M.length*M.BYTES_PER_ELEMENT,L=e._malloc(P);e.HEAPU8.set(M,L);const C=e._malloc(12);return e.setValue(C,w.width,"i32"),e.setValue(C+4,w.height,"i32"),e.setValue(C+8,L,"i32"),C},getRect:function(h,g,k){let w=new p(e.getValue(g,"i32"),e.getValue(g+4,"i32")),M=d(h).getRect(w);e.setValue(k,M.Left,"i32"),e.setValue(k+4,M.Top,"i32"),e.setValue(k+8,M.Right,"i32"),e.setValue(k+12,M.Bottom,"i32")},isCustomSize:function(){return c.isCustomSize()},isAutocalcHeight:function(){return c.isAutocalcHeight()},isSinglePage:function(){return c.isSinglePage()},isSpecificSize:function(){return c.isSpecificSize()},linksEnabled:function(){return c.linksEnabled()},textEnabled:function(){return c.textEnabled()},headersEnabled:function(){return c.headersEnabled()},footersEnabled:function(){return c.footersEnabled()},watermarksEnabled:function(){return c.watermarksEnabled()},optimizationEnabled:function(){return c.optimizationEnabled()},smartPageBreaksEnabled:function(){return c.smartPageBreaksEnabled()},getPageSize:function(h,g){const k=c.getPageSize();e.setValue(h,k.cx,"float"),e.setValue(g,k.cy,"float")},getPageMargins:function(h){let g=c.getPageMargins();e.setValue(h,g.Left,"float"),e.setValue(h+4,g.Top,"float"),e.setValue(h+8,g.Right,"float"),e.setValue(h+12,g.Bottom,"float")}}}let l,u=!1;const r=D(a=>{if(u)return;const o=a.data;try{switch(o.message){case"init":l=new e.TWASMModule,n(o),l.initGrabber(o.width,o.height,o.URL,o.title);break;case"addExtras":let f=e.stringToNewUTF8(o.metadata);l.addExtras(f),e._free(f);break;case"blit":let[b,c]=s(e,o.imageData);l.blitFragment(o.dstX,o.dstY,o.dstW,o.dstH,b,o.bufWidth,o.bufHeight,o.srcX,o.srcY),r.postMessage({message:"blitDone",totalHeight:o.dstY+o.dstH});break;case"finalize":let d=l.finalizeGrabber();l.delete();let h=new Blob([d],{type:"application/pdf"});r.postMessage({message:"completed",result:h});break}}catch(f){u=!0,t(),console.error(f),r.postMessage({message:"abort",data:f})}});r.postMessage({message:"loaded"})})).catch(e=>{console.error(e),t(),D(s=>{}).postMessage({message:"abort",data:e})})})()})();
//# sourceMappingURL=fsWorker.js.map

//# debugId=bcf33095-83b3-551f-8102-181958d65a86
