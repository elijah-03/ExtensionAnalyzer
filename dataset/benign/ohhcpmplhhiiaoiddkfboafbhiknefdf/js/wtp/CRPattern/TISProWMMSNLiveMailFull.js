function filterbyHref(e){for(var t=["http://mail.live.com/","https://mail.live.com/","http://profile.live.com/","https://profile.live.com/"],n=0;n<t.length;n++)if(ptn=new RegExp(t[n],"i"),ptn.test(e))return!0;return!1}function TSWMMSNLiveSimpleShowRatingResultUI(){var e=this.level;return g_oRatingLevel[e]!=g_oImgDefine.Safe&&g_oRatingLevel[e]!=g_oImgDefine.Neutral&&g_oRatingLevel[e]!=g_oImgDefine.Trusted}function TSWMMSNLiveSimpleFetchTargetURL(e,t){var n=new RegExp("^(http|https|ftp|ftps)://","i"),l=new RegExp("^(http|https|ftp|ftps)://"+e,"i");return n.test(t)&&!l.test(t)?t:""}function TSWMMSNLiveSimpleParseResult1(e){var t,n=new CreateTSRLocatedObject(null,null,"A",null);if(t=new CreateTSRLocatedObject(e,n,"DIV","mainContentContainer").findElement())for(var l=GetAllTSRLocatedNodes(t),i=e.location.host,r=0;r<l.length;r++){var o=TSWMMSNLiveSimpleFetchTargetURL(i,l[r].href);0==o.length||filterbyHref(o)||CreateTSRResultObject(l[r],o,null,TSWMMSNLiveSimpleShowRatingResultUI)}}function TSWMMSNLiveSimpleParseResult2(e){var t,n=new CreateTSRLocatedObject(null,null,"A",null),l=new CreateTSRLocatedObject(e,n,"DIV",null);if(l.appendAttribute("class","ContentRightInner"),t=l.findElement())for(var i=GetAllTSRLocatedNodes(t),r=e.location.host,o=0;o<i.length;o++){var a=TSWMMSNLiveSimpleFetchTargetURL(r,i[o].href);0==a.length||filterbyHref(a)||CreateTSRResultObject(i[o],a,null,TSWMMSNLiveSimpleShowRatingResultUI)}}function TSRPrintRatingQueue(e){for(var t=0;t<e.length;++t){var n=e[t];n&&TrendMicro.TB.console.info("queue["+t+"]="+n.link)}}function TSRParse(){var e=g_oEnv.Parser.iResultNumber;return TSWMMSNLiveSimpleParseResult1(document),TSWMMSNLiveSimpleParseResult2(document),TrendMicro.TB.ReduceNewNode(e+1),g_oEnv.Parser.rgobjSearchResult}g_bIsNeedCheckSPan=!0,TSRTagFlowID();