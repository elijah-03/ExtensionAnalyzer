import{l as I,m as V,n as We}from"../chunks/chunk-PU2BTBHE.js";import{A as Le,B as Be,C as He,D as x,E as Ke,F as Fe,G as Ae,H as je,I as Ye,J as Q,K as Ve,L as u,M as b,N as qe,O as $e,P as Ge,Q as Xe,R as W,S as ze,T as Qe,U as M,a as Ce,b as Pe,c as ge,d as he,e as Te,f as ye,g as q,i as Oe,j as xe,k as be,l as ke,m as ve,o as $,p as G,q as X,r as z,s as we,t as Se,u as Ne,v as Re,w as Ie,x as Me,y as De,z as Ue}from"../chunks/chunk-2PV5HFH3.js";import{a as O}from"../chunks/chunk-BNHGR4RR.js";import{a as Ee}from"../chunks/chunk-BDOU7XT6.js";import{a as Y}from"../chunks/chunk-AGWLSUX4.js";import"../chunks/chunk-JDXM4SX2.js";import"../chunks/chunk-F2BE3OL5.js";import{c as K,d as F,f as A,t as w,u as S,v as N,w as R}from"../chunks/chunk-D3B67B3M.js";import{a as H}from"../chunks/chunk-2GAAOKGQ.js";import{n as j,q as _e}from"../chunks/chunk-KJBXKQ52.js";import{o as fe,t as ue,v as pe}from"../chunks/chunk-4XUWKJYA.js";import{d as L,e as me}from"../chunks/chunk-QWQLNDJC.js";import{E as y,F as g,H as B,z as v}from"../chunks/chunk-K2PA57PF.js";import"../chunks/chunk-ECXCPAF6.js";import"../chunks/chunk-CBPLEXH3.js";import{d as ct}from"../chunks/chunk-AYDLOBCW.js";import{a as k,c as te}from"../chunks/chunk-JENJKWHP.js";import"../chunks/chunk-53OM6ECF.js";import"../chunks/chunk-KUOYBGP4.js";import"../chunks/chunk-PDIOZR2P.js";import"../chunks/chunk-WO6N5TBT.js";import{d as dt,e as mt}from"../chunks/chunk-BTBTC4NL.js";import{c as nt,e as p,f as lt}from"../chunks/chunk-3GYLW4KZ.js";var Ze=nt(re=>{"use strict";Object.defineProperty(re,"__esModule",{value:!0});var Je=(mt(),lt(dt)),J=Je.__importStar(v()),ft=function(e){return J.createElement("svg",Je.__assign({xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24"},e),J.createElement("path",{d:"M13.25 8.25a1.25 1.25 0 1 1-2.5 0 1.25 1.25 0 0 1 2.5 0"}),J.createElement("path",{fillRule:"evenodd",d:"M2 12C2 6.48 6.48 2 12 2s10 4.48 10 10-4.48 10-10 10S2 17.52 2 12m2 0c0 4.41 3.59 8 8 8s8-3.59 8-8-3.59-8-8-8-8 3.59-8 8",clipRule:"evenodd"}),J.createElement("path",{d:"M11 12a1 1 0 1 1 2 0v4a1 1 0 1 1-2 0z"}))};re.default=ft});var at=p(ct());var Z=p(v());me();B();var et=p(v()),tt=p(Ze());B();te();var U=p(v());var D=p(g());function oe({url:e,forceBgColor:t}){let s=(0,U.useCallback)((l,n)=>{if(!(!l||!n))try{let d=Qe(l);if(d){let{color:a,alpha:f,useTrueColor:r}=d;if(r){let C=t?"rgba(250, 250, 250, 1)":`rgba(${a}, ${a}, ${a}, ${f})`;n.style.backgroundColor=C}}}catch{}},[]),i=(0,U.useRef)(null),o=(0,U.useRef)(null);return Q()?(0,D.jsx)("div",{className:"flex items-center justify-center min-w-[193px] h-[135px] bg-[#F0F0F0] border-solid border-b border-border",ref:o,children:(0,D.jsx)("img",{className:"max-w-full max-h-full object-contain",crossOrigin:"anonymous",ref:i,src:e,onLoad:()=>{s(i.current,o.current)}})}):(0,D.jsx)("div",{className:"flex items-center justify-center min-w-[193px] h-[135px] bg-[#F0F0F0] border-solid border-b border-border",ref:o,children:(0,D.jsx)("img",{className:"max-w-full max-h-full object-contain",ref:i,src:e})})}var c=p(g()),ut=(e,t)=>e==="EMBEDDED_MULTI_OFFER_PD"?t?Ue:De:e==="EMBEDDED_MULTI_OFFER_PD_BUTTON"?t?Be:Le:"";function ie({offer:e,product:t,variant:s,dark:i=!1,onOfferClick:o}){let{formatCurrency:l}=(0,et.useContext)(j),{getValue:n}=y(x.MULTI_OFFER_PRICE_DISPLAY,{defaultValues:{displayReward:e.displayReward}}),d=e.rewardHasPrefix?n("prefixed_rewards_text"):n("rewards_text");if(b(t.image))return k(`Image not found for product: ${t.title}`),null;let a=t.list_price??t.price_after_discount,f=e.rewardsType==="percentage"?a*(e.rewardsRate/1e4):e.rewardsRate,r=a-f;if(a<0||f<0||r<0||r>a||f>a||r===0)return k(`Invalid pricing for product: ${t.title}`),null;let C=()=>{o&&o({redirectUrl:e.href,type:G,subType:ut(s,i),redirect:!0,label:e?.tld??t?.seller,clickId:O(),itemName:t?.title||"",hasOffer:!0,offer:e})},m=()=>{I([e.tld])};return(0,c.jsxs)("div",{onClick:C,className:"flex flex-col justify-start items-center border-solid border border-border w-[195px] bg-white hover:outline hover:outline-[3px] hover:outline-blue-500 hover:shadow-md cursor-pointer dark:bg-gray-950",style:{minHeight:"250px"},children:[(0,c.jsx)(oe,{url:e.imageUrl??t.image,forceBgColor:M(e.key)}),(0,c.jsxs)("div",{className:"pt-1 pb-2 pr-2 pl-2",children:[(0,c.jsxs)("div",{className:"text-base self-start mb-4",children:[(0,c.jsx)("div",{className:"text-green-550 font-bold text-lg dark:text-green-350",children:d}),(0,c.jsx)("div",{className:"text-sm text-gray-400 line-clamp-1 dark:text-gray-50",children:t.brand}),(0,c.jsx)("div",{className:"text-base text-blue-700 max-w-[195px] line-clamp-2 h-12 dark:text-blue-300",children:t.title})]}),(0,c.jsxs)("div",{className:"text-base self-start space-y-2",children:[(0,c.jsxs)("div",{className:"flex flex-row justify-between items-center",children:[(0,c.jsx)("div",{className:"text-gray-600 text-xs dark:text-gray-50",children:n("list_price")}),(0,c.jsx)("div",{className:"text-gray-600 text-xs dark:text-gray-50",children:l(a)})]}),(0,c.jsxs)("div",{className:"flex flex-row justify-between items-center",children:[(0,c.jsx)("div",{className:"text-green-550 text-xs dark:text-green-350",children:n("rewards")}),(0,c.jsx)("div",{className:"text-green-550 text-xs dark:text-green-350",children:l(f)})]}),(0,c.jsxs)("div",{className:"flex flex-row justify-between items-center",children:[(0,c.jsxs)("div",{className:"flex items-center text-gray-600 text-xs gap-1 dark:text-gray-50",children:[n("price_after_rewards"),(0,c.jsx)(w,{children:(0,c.jsxs)(S,{delayDuration:150,children:[(0,c.jsx)(N,{className:"border-none outline-none shadow-none m-0 font-light min-w-0",children:(0,c.jsx)(tt.default,{className:"info-icon h-3 w-3"})}),(0,c.jsxs)(R,{side:"right",sideOffset:20,className:"font-light italic text-neutralsecondary",children:[n("rewards_tooltip_content")," ",(0,c.jsx)("span",{className:"italic underline cursor-pointer",onClick:T=>{T.stopPropagation(),m()},children:n("rewards_tooltip_content_link_text")})]})]})})]}),(0,c.jsx)("div",{className:"text-gray-600 text-xs dark:text-gray-50",children:l(r)})]})]}),s==="EMBEDDED_MULTI_OFFER_PD_BUTTON"&&(0,c.jsx)("div",{className:"flex flex-col",children:(0,c.jsx)(A,{size:"sm",className:"w-full border-none my-1 mr-0 p-0 dark:shadow-none",children:n("cta_button_text")})})]})]})}var _=p(g());function ae({offers:e,products:t,variant:s,dark:i=!1,onOfferClick:o}){let[l,n]=(0,Z.useState)(!0),d=Array.from(e).sort((m,T)=>T.rewardsRate-m.rewardsRate).slice(0,5),{getValue:a}=y(x.MULTI_OFFER_PRICE_DISPLAY),f=t.reduce((m,T)=>(m[T.key]=T,m),{});e.forEach(m=>{M(m.key)&&(f[m.key]={brand:m.displayName,image:m.imageUrl,key:m.key,list_price:m.listPrice,price_after_discount:m.listPrice,title:m.title,url:m.href})}),(0,Z.useEffect)(()=>{u({type:He,subtype:"mo"}),d.some(T=>b(f[T.key].image))&&u({type:q,subtype:"mo"})},[]);let r=()=>{n(!1);let m=L(new Date,{minutes:W()}).getTime();V({componentName:"mo",throttleValue:m}),u({type:X,redirect:!1,label:z})},C=()=>{let m=d.map(T=>T.tld);I(m)};return l?(0,_.jsxs)("div",{className:"flex flex-col w-fit justify-center items-start px-4 pt-2 pb-4 border-solid border border-border bg-blue-50 dark:bg-gray-700",children:[(0,_.jsxs)("div",{className:"flex flex-row h-[50px] items-center justify-start w-full",children:[(0,_.jsx)("div",{className:"flex w-[174px]",children:(0,_.jsx)(H,{showFullLogo:!0,className:"m-0",dark:i})}),(0,_.jsxs)("div",{className:"flex flex-row justify-between grow pl-6",children:[(0,_.jsxs)("div",{className:"font-semibold text-base dark:text-gray-50",children:[Y()?a("title"):a("not_logged_in_title"),(0,_.jsx)(w,{children:(0,_.jsxs)(S,{delayDuration:150,children:[(0,_.jsx)(N,{className:"border-none outline-none shadow-none m-0 pt-1 pr-3 pb-1 pl-2 font-light italic min-w-0",children:(0,_.jsx)(F,{className:"info-icon h-4 w-4 dark:text-gray-50"})}),(0,_.jsxs)(R,{side:"right",sideOffset:20,className:"font-light italic text-neutralsecondary",children:[a("info_tooltip_content")," ",(0,_.jsx)("span",{className:"italic underline cursor-pointer",onClick:C,children:a("info_tooltip_content_link_text")})]})]})})]}),(0,_.jsx)(K,{className:"close-icon w-4 h-4 pl-[4px] mr-[7px] cursor-pointer text-neutralsecondary dark:text-gray-50",onClick:r})]})]}),(0,_.jsx)("div",{className:"flex flex-row justify-between align-start space-x-4",children:d.map(m=>(0,_.jsx)(ie,{offer:m,product:f[m.key],variant:s,dark:i,onOfferClick:o},m.key))}),(0,_.jsx)("link",{rel:"prefetch",href:Ee("/lp/signup/embed/search-alerts")})]}):null}te();var ee=p(v());me();B();var rt=p(v());B();te();var P=p(g());function se({offer:e,product:t,dark:s=!1}){let{formatCurrency:i}=(0,rt.useContext)(j),{getValue:o}=y(x.MULTI_OFFER,{defaultValues:{displayReward:e.displayReward}}),l=e.rewardHasPrefix?o("prefixed_rewards_text"):o("rewards_text"),n=t?.price_after_discount?i(t?.price_after_discount):"";return b(t.image)?(k(`Image not found for product: ${t.title}`),null):(0,P.jsxs)("div",{className:"flex flex-col justify-start items-center pt-1 pb-2 pr-2 pl-2 border-solid border border-border w-[166px] bg-white dark:bg-gray-950",children:[(0,P.jsx)("div",{className:"flex items-center justify-center w-[142px] h-[142px] bg-[#F9F9F9]",children:(0,P.jsx)("img",{className:"max-w-full max-h-full object-contain",src:t.image})}),(0,P.jsxs)("div",{className:"text-base self-start space-y-2",children:[(0,P.jsx)("div",{className:"text-green-550 font-bold text-lg dark:text-green-350",children:l}),(0,P.jsx)("div",{className:"text-base text-blue-700 max-w-[142px] line-clamp-2 h-12 dark:text-blue-300",children:t.title}),(0,P.jsx)("div",{className:"text-lg dark:text-gray-50",children:n}),(0,P.jsx)("div",{className:"text-sm line-clamp-2 h-[40px] dark:text-gray-50",children:t.brand})]}),(0,P.jsx)("div",{className:"flex flex-col m-2",children:(0,P.jsx)("a",{href:e.href,target:"_blank",rel:"noopener noreferrer",children:(0,P.jsx)(A,{size:"sm",className:"font-extrabold min-w-[142px] border-none my-1 mr-0 dark:shadow-none",onClick:()=>{u({type:G,subType:s?Se:we,redirect:!0,label:e?.tld??t?.seller,clickId:O(),itemName:t?.title||"",hasOffer:!0})},children:o("cta_button_text")})})})]})}var E=p(g());function ne({offers:e,products:t,dark:s=!1}){let[i,o]=(0,ee.useState)(!0),l=Array.from(e).sort((r,C)=>C.rewardsRate-r.rewardsRate).slice(0,5),{getValue:n}=y(x.MULTI_OFFER),d=t.reduce((r,C)=>(r[C.key]=C,r),{});e.forEach(r=>{M(r.key)&&(d[r.key]={brand:r.displayName,image:r.imageUrl,key:r.key,list_price:r.listPrice,price_after_discount:r.listPrice,title:r.title,url:r.href})}),(0,ee.useEffect)(()=>{u({type:Me,subtype:"mo"}),l.some(C=>b(d[C.key].image))&&u({type:q,subtype:"mo"})},[]);let a=()=>{o(!1);let r=L(new Date,{minutes:W()}).getTime();V({componentName:"mo",throttleValue:r}),u({type:X,redirect:!1,label:z})},f=()=>{let r=l.map(C=>C.tld);I(r)};return i?(0,E.jsxs)("div",{className:"flex flex-col w-fit justify-center items-start px-4 pt-2 pb-4 border-solid border border-border bg-blue-50 dark:bg-gray-700",children:[(0,E.jsxs)("div",{className:"flex flex-row h-[50px] items-center justify-start w-full",children:[(0,E.jsx)("div",{className:"flex w-[174px]",children:(0,E.jsx)(H,{showFullLogo:!0,className:"m-0",dark:s})}),(0,E.jsxs)("div",{className:"flex flex-row justify-between grow pl-6 border-border border-solid border-l",children:[(0,E.jsxs)("div",{className:"font-semibold text-base dark:text-gray-50",children:[n("title"),(0,E.jsx)(w,{children:(0,E.jsxs)(S,{delayDuration:150,children:[(0,E.jsx)(N,{className:"border-none outline-none shadow-none m-0 pt-1 pr-3 pb-1 pl-2 font-light italic min-w-0",children:(0,E.jsx)(F,{className:"info-icon h-4 w-4 dark:text-gray-50"})}),(0,E.jsxs)(R,{side:"right",sideOffset:20,className:"font-light italic text-neutralsecondary",children:[n("info_tooltip_content")," ",(0,E.jsx)("span",{className:"italic underline cursor-pointer",onClick:f,children:n("info_tooltip_content_link_text")})]})]})})]}),(0,E.jsx)(K,{className:"close-icon w-4 h-4 pl-[4px] mr-[7px] cursor-pointer text-neutralsecondary dark:text-gray-50",onClick:a})]})]}),(0,E.jsx)("div",{className:"flex flex-row justify-between align-start space-x-4",children:l.map(r=>(0,E.jsx)(se,{offer:r,product:d[r.key],dark:s},r.key))})]}):null}var ot=e=>pe("openSearchAlertsMerchantTab",e);var de=p(g()),h=[];async function _t(){let e=await ue(),{pageType:t}=e;if(t==="sponsoredProductsPage"){if(h=e.pageData.products??[],!h||h.length===0)return!1;let s=h.slice(0,20).map((a,f)=>{let r={key:a.key,url:a.url,domain:a.seller,title:a.title};return Q()&&(r.imageUrl=a.image),r});if(!Ke())return!1;let{offers:i}=await We(s);if(!i||i.length===0)return!1;if(!Ye()){let a=at.default.v4();i.forEach(f=>{f.href=f.href.replace(ge,a)})}let o=window.matchMedia("(prefers-color-scheme: dark)").matches,l=qe(),n,d=Oe;if(Fe())n="EMBEDDED_MULTI_OFFER_BLUE_BOX",await ce(i,h,n,o);else if(Ae())n="EMBEDDED_MULTI_OFFER_PD",await ce(i,h,n,o);else if(je())n="EMBEDDED_MULTI_OFFER_PD_BUTTON",await ce(i,h,n,o);else{u({name:Te.HOLDOUT}),n="HOLDOUT";let{shouldShow:a}=await st(i);a&&u({name:ye,type:o?"dm":null})}Et(i,l,d),le("Popular products",xe),le("More products",ke),le("Deals on \\w+",ve),Ct(be)}else return!1;return!0}function Et(e,t,s){t.forEach((i,o)=>{let l=e.find(d=>d.key===o.toString());$e(o.toString()).forEach(async d=>{d.addEventListener("click",()=>{u({type:$,subType:s,redirect:!0,label:l?.tld??h[o]?.seller,clickId:O(),carouselPosition:o,itemName:h[o]?.title||"",hasOffer:!!l})})})})}function le(e,t){Ge(e).forEach((i,o)=>{let l=i.querySelector(".gkQHve.SsM98d.RmEs5b")?.textContent;i.addEventListener("click",()=>{u({type:$,subType:t,redirect:!1,label:l,clickId:O(),carouselPosition:o,itemName:h[o]?.title||"",hasOffer:!1})})})}function Ct(e){document.querySelectorAll("#taw a").forEach((s,i)=>{let o;o=s.querySelector("div.aFn4tc.DZm15c.MBeuO")?.textContent,o||(o=s.querySelector("div.CCgQ5.vCa9Yd.QfkTvb.N8QANc.MBeuO.Va3FIb.EE3Upf span")?.textContent),s.addEventListener("click",()=>{u({type:$,subType:e,redirect:!1,label:o,clickId:O(),carouselPosition:i,itemName:h[i]?.title||"",hasOffer:!1})})})}async function st(e){let t=document.querySelectorAll(Ce),s=null;for(let i of t)if(s=i.querySelector(Pe),s)break;return s?await ze("mo")?(u({type:Ie}),{shouldShow:!1,injectionElement:null}):e.length<3?(u({type:Ne}),{shouldShow:!1,injectionElement:null}):{shouldShow:!0,injectionElement:s}:(k("Injection element not found, cannot inject multi-offer"),u({type:Re}),{shouldShow:!1,injectionElement:null})}async function Pt(e){let{redirectUrl:t,type:s,subType:i,redirect:o,label:l,clickId:n,itemName:d,hasOffer:a,offer:f}=e;function r(){window.open(t,"_blank","noopener,noreferrer"),u({type:s,subType:i,redirect:o,label:l,clickId:n,itemName:d,hasOffer:a})}Y()||!Ve()?await r():(u({type:s,subType:i,redirect:o,label:l,clickId:n,itemName:d,hasOffer:a}),ot(f))}async function ce(e,t,s,i){let{shouldShow:o,injectionElement:l}=await st(e);if(!o||!l)return;await _e({appName:"preCheckout",app:s==="EMBEDDED_MULTI_OFFER_BLUE_BOX"?(0,de.jsx)(ne,{offers:e,products:t,dark:i}):(0,de.jsx)(ae,{offers:e,products:t,variant:s,dark:i,onOfferClick:Pt}),mountClass:"_25pcmo",insertAfterElement:l,positionOnTop:!1});let d=document.querySelector("._25pcmo"),a="unknown";if(d){let f=window.innerHeight,{bottom:r,top:C}=d.getBoundingClientRect();C>f?a="fully-beneath":r<f?a="fully-above":a="partial"}fe("track",he,{name:Xe(s,i),verticalLocation:a})}async function it(){await _t()}document.readyState!=="loading"?it():document.addEventListener("DOMContentLoaded",it);
