var debugInfo,textDebugInfo="",extInfo="",backgroundPage=ext.backgroundPage.getWindow();$(document).ready((function(){"use strict";backgroundPage.getDebugInfo((function(e){(debugInfo={}).filter_lists=JSON.stringify(e.subscriptions,null,"\t"),debugInfo.other_info=JSON.stringify(e.other_info,null,"\t"),debugInfo.custom_filters=e.custom_filters,debugInfo.settings=JSON.stringify(e.settings,null,"\t"),debugInfo.language=determineUserLanguage();var s=[];if(e.subscriptions)for(var t in s.push("=== Filter Lists ==="),e.subscriptions)s.push("Id: "+t),s.push("  Download Count: "+e.subscriptions[t].downloadCount),s.push("  Download Status: "+e.subscriptions[t].downloadStatus),s.push("  Last Download: "+e.subscriptions[t].lastDownload),s.push("  Last Success: "+e.subscriptions[t].lastSuccess);if(s.push(""),e.custom_filters){for(var r in s.push("=== Custom Filters ==="),e.custom_filters)s.push(e.custom_filters[r]);s.push("")}for(var n in e.exclude_filters&&(s.push("=== Exclude Filters ==="),s.push(JSON.stringify(e.exclude_filters))),s.push("=== Settings ==="),e.settings)s.push(n+" : "+e.settings[n]);s.push(""),s.push("=== Other Info ==="),s.push(JSON.stringify(e.other_info,null,"\t")),textDebugInfo=s.join("\n")}));var e=$("#name"),s=$("#email"),t=$("#summary"),r=$("#repro-steps"),n=$("#expected-result"),o=$("#actual-result"),a=$("#other-comments");chrome.storage.local.get("user_name",(function(s){e.val(s.user_name)})),chrome.storage.local.get("user_email",(function(e){s.val(e.user_email)}));var i=function(){$("#debug-info").val(textDebugInfo),$("#step2-back").prop("disabled",!1),$("#step_final_questions").fadeIn(),$("html, body").animate({scrollTop:15e3},50),$("#rememberDetails").is(":checked")&&(chrome.storage.local.set({user_name:e.val()}),chrome.storage.local.set({user_email:s.val()}))};$("#step1-next").click((function(){var a=0;""===e.val()?(a++,e.addClass("inputError")):e.removeClass("inputError"),""===s.val()||-1===s.val().search(/^.+@.+\..+$/)?(a++,s.addClass("inputError")):s.removeClass("inputError"),""===t.val()?(a++,t.addClass("inputError")):t.removeClass("inputError"),"1. \n2. \n3. "===r.val()?(a++,r.addClass("inputError")):r.removeClass("inputError"),""===n.val()?(a++,n.addClass("inputError")):n.removeClass("inputError"),""===o.val()?(a++,o.addClass("inputError")):o.removeClass("inputError"),0===a?($(this).prop("disabled",!0),$("#email, #name, #rememberDetails").prop("disabled",!0),$("#summary, #repro-steps, #expected-result, #actual-result").prop("disabled",!0),$(".missingInfoMessage").hide(),chrome&&chrome.permissions&&chrome.permissions.request?chrome.permissions.request({permissions:["management"]},(function(e){e?chrome.management.getAll((function(e){for(var s=[],t=0;t<e.length;t++)s.push("Number "+(t+1)),s.push("  name: "+e[t].name),s.push("  id: "+e[t].id),s.push("  version: "+e[t].version),s.push("  enabled: "+e[t].enabled),s.push("  type: "+e[t].type),s.push("");extInfo="\nExtensions:\n"+s.join("\n"),chrome.permissions.remove({permissions:["management"]},(function(e){})),i()})):(extInfo="Permission not granted",i())})):(extInfo="no extension information",i())):$("#step_name_email > .missingInfoMessage").show()})),$("#step2-back").click((function(){$("#email, #name, #rememberDetails").prop("disabled",!1),$("#summary, #repro-steps, #expected-result, #actual-result").prop("disabled",!1),$("#step_repro_info").fadeOut(),$("#step_final_questions").fadeOut(),$("html, body").animate({scrollTop:$("#step_name_email").parent().parent().offset().top},2e3),$("#step2-back").prop("disabled",!0),$("#step1-next").prop("disabled",!1)})),$("#submit").click((function(){var i;i={title:t.val(),repro:r.val(),expect:n.val(),actual:o.val(),debug:debugInfo,name:e.val(),email:s.val(),comments:a.val()},extInfo&&(i.debug.extensions=extInfo),$("#submit").prop("disabled",!0),$("#step2-back").prop("disabled",!0)}))}));