function TSNSInsertAlertICON(e){try{if(IsInSNSWallAndMalicious(e)){var t=FindInsertPositionNode(e);if(t&&t.previousSibling&&"TSRSpan"==t.previousSibling.className)return;var n=document.createElement("DIV");n.id="TAlertWindowID",TMExt_$(n).css({cursor:"pointer",margin:"5px 0px 7px 0px",height:"42px",width:"314px",border:"solid 1px","border-color":"#bfbfbf","background-color":"#f2f2f2"}),n.className="TSRSpan";var r=["<table>","<tbody>","<tr>","<td id='TUMSAlertMsgID'>","<div>",g_oToolTipString.ShareToFriend.ShareMsg,"</div>","</td>","<td id='TUMSAlertMsgIconID'>","<img src='"+TSREscapeURL(g_oImgDefine.ShareIcon)+"'>","</td>","</tr>","</tbody>","</table>"];n.innerHTML=r.join("");var a=TMExt_$(n).find("#TUMSAlertMsgID");a.css({color:"#3F44D4",width:"230px",height:"35px","font-size":"12px","text-align":"left","text-decoration":"underline"}),a.find("DIV").css({"margin-left":"5px"}),TMExt_$(n).find("#TUMSAlertMsgIconID").css({width:"64px",height:"22px",margin:"0",padding:"0","background-color":"transparent"}),n.onclick=function(){TShareToFriendHandler(e)},t.parentNode.insertBefore(n,t)}}catch(e){if(e.number&&e.description){var i="catch err:[\n";i+="Facility Code: "+(e.number>>16&8191)+"\n",i+="Number: "+(65535&e.number)+"\n",i+="Description: "+e.description+"\n",TMExt_debug(i)}else TMExt_debug(e)}}function FindInsertPositionNode(e){for(var t=TMExt_$(e.FindInsertNode()),n=t,r=0;!n.hasClass("_5pcr")&&!(n=n.parent()).hasClass("UFIList")&&50!=++r;);if(0==n.length)for(n=t,r=0;"LI"!=n[0].tagName.toUpperCase()&&(n=n.parent(),50!=++r););var a=n.find("form");return 0==e.HomePage&&(a=a.parent()),e.formTag=a,a[0]}function IsInSNSWallAndMalicious(e){if(3!=e.level&&4!=e.level)return!1;var t=!1;try{if(/facebook\.com/.test(document.location)){var n=TMExt_$(e.FindInsertNode()),r=n,a=0;for(e.HomePage=1;!r.hasClass("_5pcr")&&!(r=r.parent()).hasClass("UFIList")&&50!=++a;);if(0==r.length){for(r=n,a=0;"LI"!=r[0].tagName.toUpperCase()&&(r=r.parent(),50!=++a););e.HomePage=0}var i=r.find("input[data-ft][type='button']");1==i.length&&(TMExt_debug("Found comment of link:"+e.link),t=!0,e.ShareComment=i,e.ShareText=r)}}catch(e){TMExt_debug(e)}return t}function TShareToFriendHandler(e){if(e.ShareComment&&e.ShareText){e.ShareComment.click();var t=function(e){try{document.createEvent&&((t=document.createEvent("KeyboardEvent")).initKeyboardEvent("keydown",!0,!0,document.defaultView,!0,!0,!0,!1,0,90),e[0].dispatchEvent(t))}catch(e){}try{e[0].fireEvent&&e[0].fireEvent("onkeydown")}catch(e){}try{var t;document.createEvent&&((t=document.createEvent("KeyboardEvent")).initKeyEvent("keydown",!0,!0,null,!0,!0,!0,!1,90,0),e[0].dispatchEvent(t))}catch(e){}},n=e.ShareText.find("TEXTAREA");if(1==n.length){var r=g_oToolTipString.ShareToFriend.ShareString;t(n),setTimeout(function(){n.focus(),n.val(""),n.val(r),e.formTag.find("input[name='add_comment_text']").attr("value",r),t(n),n.select()},500)}}}