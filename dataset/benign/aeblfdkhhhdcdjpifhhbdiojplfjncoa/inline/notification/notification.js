
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="255e5c2a-d918-5008-9d92-c44012471827")}catch(e){}}();
import{a as zo,b as Lo,c as Po}from"/chunks/chunk-MA3SVS3A.js";import{b as oi}from"/chunks/chunk-K647UWNN.js";import{a as ai,b as J}from"/chunks/chunk-PQBPSXZQ.js";import{b as Co,c as Eo,d as _o,e as co}from"/chunks/chunk-7OGXR7VM.js";import{a as ti,b as q,c as si}from"/chunks/chunk-FHIKE3ZT.js";import{a as ii}from"/chunks/chunk-BM7RV4DC.js";import{a as ni}from"/chunks/chunk-H2RNA6US.js";import{c as Xo,e as hn,f as pn,g as xe,h as Jo,i as Qo,j as b,k as Zo}from"/chunks/chunk-YCUTMSD4.js";import{$a as ur,A as Do,Bb as Re,C as yn,Dc as $o,Ea as kn,Fa as Yn,Fb as fr,Ga as g,Gc as me,Ha as Wn,Hb as Mn,Hc as Yo,Ia as E,Ib as Qe,J as kr,Ja as C,Jb as Go,K as jo,Kb as Ko,La as v,Ma as gn,N as Ho,P as Uo,T as Wo,Va as Mo,Wa as on,_a as Oo,b as ja,c as mo,d as xo,f as $n,g as Pe,j as Ao,k as Ae,kb as Fo,lc as po,ma as ce,mb as He,nc as br,oa as je,r as qe,s as pr,w as De,xa as gr,y as qo,zb as Vo}from"/chunks/chunk-CARILTDN.js";import{a as h,b as m}from"/chunks/chunk-EXMDW5FT.js";import{i as cr}from"/chunks/chunk-U3DUDNXO.js";import"/chunks/chunk-YUOMCGI6.js";import{a as F,b as K}from"/chunks/chunk-3ZEXWRW2.js";import"/chunks/chunk-YUOMCGI6.js";import{a as ei,c as ri}from"/chunks/chunk-OYVYWA4C.js";import"/chunks/chunk-ELSMRAMV.js";import"/chunks/chunk-OK4UQCTS.js";import"/chunks/chunk-NC7PITUF.js";import{a as Le}from"/chunks/chunk-YVQAWSEC.js";import{$ as p,N as Ln,Z as No,a as _e,aa as bn,b as mr,l as lo,m as Ro,n as xr,o as ze,q as To}from"/chunks/chunk-PTEF4S3V.js";import{c as i}from"/chunks/chunk-54UHBIHR.js";var Ne=i(h()),qa=i(ja());var hr=n=>{let e=Object.values(F).find(r=>r===n.slice(1));if(!e)throw new Error("Invalid notification type provided to notification component.");return e};var Rr=i(h());var Bi=i(h());var mn=i(h());var vr=i(h());function _n(n){let e=(0,vr.useContext)(J);return(0,vr.useCallback)(()=>e?e.unleashFeatures[n]:!1,[n,e])}var _i=i(Le()),ke=i(h());var wr=i(h());var yr=(n=0)=>{let[e,r]=De(),o=(0,wr.useContext)(q);return(0,wr.useEffect)(()=>{e?.height&&o.resizeNotification(e.height+n)},[o,e?.height,n]),{measured:e!==void 0,resizeRef:r}};var li=i(h()),cn=i(m()),Ue=({close:n,title:e,titleId:r,hideCloseButton:o,actions:a})=>{let t=(0,li.useContext)(b);return(0,cn.jsxs)(g,{display:"flex",flexDirection:"row",alignItems:"center",gap:"xs",padding:"medium",id:"notification-title-bar",children:[(0,cn.jsx)(g,{flexShrink:"0",children:(0,cn.jsx)(ni,{size:"small"})}),(0,cn.jsx)(v,{grow:"1",wrap:"wrap",children:(0,cn.jsx)(Fo,{as:"h1",id:r,variant:"small",children:e})}),(0,cn.jsxs)(v,{gap:"xs",wrap:"nowrap",children:[a&&a.length>0&&a.map((l,_)=>l.useTooltip?(0,cn.jsxs)(Re,{children:[(0,cn.jsx)(Re.Trigger,{children:(0,cn.jsx)(C.Tertiary,{color:"neutral",onClick:l.onClick,ariaLabel:l.label,disabled:l.disabled,startAccessory:l.icon})}),(0,cn.jsx)(Re.Content,{portal:!1,children:l.label})]},`${l.label}-${_}`):(0,cn.jsx)(C.Tertiary,{color:"neutral",onClick:l.onClick,ariaLabel:l.label,disabled:l.disabled,startAccessory:l.icon},`${l.label}-${_}`)),!o&&(0,cn.jsxs)(Re,{children:[(0,cn.jsx)(Re.Trigger,{children:(0,cn.jsx)(C.Tertiary,{color:"neutral",onClick:n,ariaLabel:t("Close"),startAccessory:(0,cn.jsx)(Uo,{})})}),(0,cn.jsx)(Re.Content,{portal:!1,children:t("Close")})]})]})]})};var di={container:"Rx"};var Sr=i(m()),ci=(0,ke.forwardRef)(function({animateOnMount:e,children:r,close:o,hideCloseButton:a,title:t,actions:l,autoFocus:_,focusOptions:c,className:s},d){let{measured:u,resizeRef:x}=yr(),y=me(_,e?c:void 0),N=$n(y,x,d),B=(0,ke.useContext)(q),S=(0,ke.useId)();return(0,ke.useEffect)(()=>{e&&u&&B.performEnterAnimation()},[e,B,u]),(0,Sr.jsxs)("div",{"aria-labelledby":S,ref:N,tabIndex:_?0:void 0,role:"dialog",className:(0,_i.default)(di.container,s),children:[(0,Sr.jsx)(Ue,{close:o,hideCloseButton:a,title:t,titleId:S,actions:l}),r]})});var On=i(h());var xi=i(m()),mi=({notificationId:n,children:e})=>{let[r,o]=(0,On.useState)(window.location.hash),[a,t]=(0,On.useState)(!1),l=(0,On.useContext)(q);(0,On.useEffect)(()=>{let c=()=>o(window.location.hash);return window.addEventListener("hashchange",c),()=>window.removeEventListener("hashchange",c)},[]),pn("notification-exiting",c=>{c.notificationId===n&&t(!0)},[]);let _=(0,On.useCallback)(c=>void l.notificationExitComplete(c),[l]);return(0,xi.jsx)(Ze.Provider,{value:{exit:a,notifyExitComplete:_},children:e?.(hr(r))})},Ze=(0,On.createContext)({});var pi=i(Le());var We=i(h());var ko={dialog:"na",blur:"_v"};var Xn=i(m()),ki=(0,We.forwardRef)(function({close:e,title:r,actions:o,autoFocus:a,focusOptions:t,children:l,hideCloseButton:_=!1,blurBackground:c=!1},s){let{exit:d,notifyExitComplete:u}=(0,We.useContext)(Ze),x=(0,We.useId)(),y=me(a,t),N=$n(y,s);return(0,Xn.jsx)(qe,{propagate:!1,onExitComplete:()=>u({performExitAnimation:!1}),children:d?null:(0,Xn.jsxs)(Xn.Fragment,{children:[(0,Xn.jsx)(fr,{className:(0,pi.default)({[ko.blur]:c})}),(0,Xn.jsxs)(pr.div,{ref:N,tabIndex:a?0:void 0,"aria-labelledby":x,role:"dialog",className:ko.dialog,initial:{opacity:0,translateX:"calc(100% + 32px)"},animate:{opacity:1,translateX:0,transition:{type:"tween",ease:xo.Quick,duration:mo.Slow}},exit:{opacity:0,translateX:"calc(100% + 32px)",transition:{type:"tween",ease:xo.Quick,duration:mo.Slow}},children:[(0,Xn.jsx)(Ue,{close:e,title:r,titleId:x,actions:o,hideCloseButton:_}),(0,Xn.jsx)(yn,{elevateOnScroll:"top",children:l})]})]})})});var ge=i(h());var gi={container:"sv"};var fi=i(m()),ui=(0,ge.forwardRef)(function({animateOnMount:e,children:r,autoFocus:o,focusOptions:a},t){let{measured:l,resizeRef:_}=yr(),c=me(o,e?a:void 0),s=$n(c,_,t),d=(0,ge.useContext)(q),u=(0,ge.useId)();return(0,ge.useEffect)(()=>{e&&l&&d.performEnterAnimation()},[e,d,l]),(0,fi.jsx)("div",{"aria-labelledby":u,ref:s,tabIndex:o?0:void 0,role:"dialog",className:gi.container,children:r})});var Ir=i(m()),Br=(0,mn.forwardRef)(function(e,r){let{accountUuid:o,children:a,onClose:t,hideCloseButton:l,title:_,actions:c,autoFocus:s,type:d,className:u,closeOnBackForwardCacheLoad:x}=e,N=new URLSearchParams(window.location.search).get("notificationId"),{exit:B,notifyExitComplete:S}=(0,mn.useContext)(Ze),M=(0,mn.useContext)(q),A=_n("b5x-filling-saving-telemetry"),k=(0,mn.useCallback)(()=>{o?p("record-click-event",{accountUuid:o,event:{componentType:"button",category:"app",source:"notification",componentName:`NOTIFICATION_DISMISS_${d}`}}):p("record-click-event-all-accounts",{event:{componentType:"button",category:"app",source:"notification",componentName:`NOTIFICATION_DISMISS_${d}`}})},[o,d]),w=(0,mn.useCallback)(()=>{A()&&d!=="notificationManager"&&k(),t&&t(),M.hideNotification(N??void 0)},[M,A,d,t,N]),P=(0,mn.useMemo)(()=>{if(s)return{preventScroll:!0}},[s]);(0,mn.useEffect)(()=>{s&&cr()&&M.requestFocus(d,P)},[s,M,d,P]),(0,mn.useEffect)(()=>{!B||K[d].fullscreen||S({performExitAnimation:!0})},[B,d,S]);let j=(0,mn.useRef)(null),O=$n(j,r),V=[{},{},j],fn=[{close:{key:"Escape"}},{close:w},j],dn=K[d].fullscreen&&K[d].disableKeyboardClose||d==="notificationManager"?V:fn;Pe(...dn);let U=(0,mn.useCallback)(R=>{R.persisted&&w()},[w]);return(0,mn.useEffect)(()=>{x&&window.addEventListener("pageshow",U)},[x,U]),(0,mn.useEffect)(()=>{!A()||d==="notificationManager"||(o?p("record-view-event",{accountUuid:o,event:{componentType:"notification",category:"app",source:"notification",componentName:`NOTIFICATION_VIEW_${d}`}}):p("record-view-event-all-accounts",{event:{componentType:"notification",category:"app",source:"notification",componentName:`NOTIFICATION_VIEW_${d}`}}))}),d==="notificationManager"?(0,Ir.jsx)(ui,{animateOnMount:!0,autoFocus:s||!1,focusOptions:P,ref:O,children:a}):K[d].fullscreen?(0,Ir.jsx)(ki,{close:w,title:_,autoFocus:s||!1,focusOptions:P,actions:c,ref:O,hideCloseButton:l,blurBackground:K[d].blurBackground,children:a}):(0,Ir.jsx)(ci,{animateOnMount:!0,autoFocus:s||!1,focusOptions:P,close:w,hideCloseButton:l,title:_,actions:c,ref:O,className:u,children:a})});var bi=i(m()),Cr=({children:n,paddingBottom:e="medium"})=>(0,bi.jsx)(g,{paddingLeft:"medium",paddingRight:"medium",paddingBottom:e,children:n});var Si=i(Le()),un=i(h());var re={notificationScroller:"tv",notificationStack:"dv",expandButton:"jx",collapseButton:"ra",expandedNotification:"Lx"};var hi=(n,e,r)=>{switch(n){case"view":r?p("record-click-event",{accountUuid:r,event:e}):p("record-view-event-all-accounts",{event:e});break;case"click":p("record-click-event-all-accounts",{event:e});break}},vi=(n,e)=>hi("view",n,e),wi=(n,e)=>hi("click",n,e);var Me=i(h()),yi=i(m()),nr=({state:n,children:e})=>{let[r,o]=(0,Me.useState)(n.autoFocus??!1);return(0,Me.useEffect)(()=>{o(n.autoFocus??!1)},[n.autoFocus]),n?(0,yi.jsx)(I.Provider,{value:{...n,autoFocus:r,setAutoFocus:n.setAutoFocus},children:e}):null},I=(0,Me.createContext)({});var Oe={fullscreenNotification:"a_",collapsedNotification:"qx",animateUnstackedNotification:"xv",floatRightToLeft:"Tx",dismissNotification:"mv",slideOutRight:"Hx",hideNotification:"kv"};var ue=i(m()),Ii=({title:n,onClose:e,hideCloseButton:r,closeOnBackForwardCacheLoad:o,accountUuid:a,children:t,actions:l,ref:_,paddingStyle:c})=>{let s=(0,un.useContext)(I),d=_n("b5x-filling-saving-telemetry"),[u,x]=De(),y=(0,un.useContext)(q),[N,B]=(0,un.useState)(!1),S=(0,un.useRef)(null),M=(0,un.useRef)(null),A=()=>{B(!0),e()},k=(0,un.useCallback)(H=>{H.persisted&&A()},[A]);(0,un.useEffect)(()=>{o&&window.addEventListener("pageshow",k)},[o,k]);let w=(0,un.useMemo)(()=>s.autoFocus?{preventScroll:!0}:void 0,[s]),P=me(s.autoFocus,w),j=$n(M,s.autoFocus?P:null,_??null);(0,un.useEffect)(()=>{s.autoFocus&&cr()&&s?.notification?.type&&y.requestFocus(s.notification.type,w)},[y,s,w]),(0,un.useEffect)(()=>{let H=s?.notification;d()&&H&&S.current!==H.id&&(vi({componentType:"notification",category:"app",source:"notification",componentName:`NOTIFICATION_VIEW_${H.type}`},a),S.current=H.id)},[d,s]);let O=[{},{},M],V=[{escape:{key:"Escape"}},{escape:A},M],fn=s.notification&&K[s.notification.type].fullscreen&&K[s.notification.type].disableKeyboardClose?O:V;if(Pe(...fn),!s.notification||!s.orderInStack)return null;let dn=s.fullscreenNotification&&s.fullscreenNotification.id!==s.notification?.id,U=()=>(0,ue.jsx)(g,{style:{height:u?.height!==void 0?`${u.height}px`:"auto",transition:"height 50ms ease-in",overflow:"hidden"},children:(0,ue.jsx)(g,{ref:x,children:(0,ue.jsx)(Cr,{paddingBottom:c,children:t})})}),R=N||!!s.markedForDismissal;return(0,ue.jsxs)(g,{className:(0,Si.default)(s.stackCollapsed?Oe.collapsedNotification:re.expandedNotification,Oe.animateUnstackedNotification,{[Oe.dismissNotification]:R},{[Oe.fullscreenNotification]:K[s.notification.type].fullscreen},{[Oe.hideNotification]:dn}),"data-testid":"stacked-notification","data-notificationid":s.notification.id,"data-orderinstack":s.orderInStack,boxShadow:"low",borderRadius:"large",role:"alert",tabIndex:0,ref:j,overflow:"visible",children:[!dn&&(0,ue.jsx)(Ue,{close:A,title:n,titleId:s.notification.id,hideCloseButton:r,actions:l}),K[s.notification.type].fullscreen?(0,ue.jsx)(yn,{elevateOnScroll:"top",children:U()}):U()]})};var Er=i(m()),L=({type:n,title:e,onClose:r,hideCloseButton:o,className:a,closeOnBackForwardCacheLoad:t,accountUuid:l,autoFocus:_,children:c,actions:s,ref:d,paddingStyle:u})=>{let x=(0,Bi.useContext)(I);return x.notification?(0,Er.jsx)(Ii,{onClose:r??x.deleteNotification,hideCloseButton:o,title:e,closeOnBackForwardCacheLoad:t,accountUuid:l,actions:s,ref:d,paddingStyle:u,children:c}):(0,Er.jsx)(Br,{onClose:r??x.deleteNotification,hideCloseButton:o,type:n,className:a,title:e,closeOnBackForwardCacheLoad:t,accountUuid:l,actions:s,autoFocus:_,ref:d,children:(0,Er.jsx)(Cr,{paddingBottom:u,children:c})})};var Jn=i(m()),Fa=()=>{let n=new URLSearchParams(window.location.search),e=(0,Rr.useContext)(I),r=e.notification?e.notification.params.uuid:n.get("uuid")||"",o=(0,Rr.useContext)(q),a=(0,Rr.useContext)(b),t=async()=>{await o.sendAddAccountResponse(r,"YES"),e.deleteNotification()},l=async()=>{await o.sendAddAccountResponse(r,"IGNORE"),e.deleteNotification()};return(0,Jn.jsxs)(L,{title:a("Add account to 1Password browser extension"),type:"addAccount",children:[(0,Jn.jsx)(v,{direction:"row",alignItems:"center",wrap:"nowrap",children:(0,Jn.jsxs)(v,{direction:"column",gap:"medium",children:[(0,Jn.jsx)(E,{as:"p",variant:"medium",children:a("Sign in to websites with one click, easily save your information, and generate new passwords with the browser extension.")}),(0,Jn.jsx)(E,{as:"p",variant:"medium",children:a("You can manage your accounts in Settings.")})]})}),(0,Jn.jsxs)(v,{justifyContent:"flex-end",marginTop:"medium",gap:"medium",children:[(0,Jn.jsx)(C.Secondary,{onClick:l,children:a("Don\u2019t ask again")}),(0,Jn.jsx)(C.Primary,{onClick:t,children:a("Add account")})]})]})},Tr=Fa;var pl={login:{priority:0,setting:"autoSaveEnabled",templateUuid:zo,triggers:[ze.CurrentPassword,ze.NewPassword]},creditCard:{priority:1,setting:"autoSaveCreditCardsEnabled",templateUuid:Lo,triggers:[ze.CcNumber]},identity:{featureFlag:"b5x-autosave-identities",priority:2,setting:"autoSaveIdentitiesEnabled",templateUuid:Po,triggers:[ze.AddressLine1,ze.StreetAddress]}},er=(t=>(t.ExpiredSession="expiredSession",t.MissingItem="missingItem",t.MissingSecret="missingSecret",t.Save="save",t.Unknown="unknown",t))(er||{});var ln=i(h());var uo=i(h());var Nr={successGradient:"pv",attentionGradient:"Wx",brandGradient:"gv"};var oe=i(m());function fe({vaultIcon:n,title:e,subtitle:r,rowEndElement:o,disabled:a=!1,getCustomIcon:t,color:l}){return(0,oe.jsxs)(g,{className:(c=>{switch(c){case"success":return Nr.successGradient;case"attention":return Nr.attentionGradient;case"brand":return Nr.brandGradient;default:return}})(l),borderColor:"neutral",borderStyle:"solid",borderWidth:"1px",borderRadius:"medium",justifyContent:"space-between",alignItems:"center",padding:"small",width:"full",display:"flex",children:[(0,oe.jsxs)(v,{alignItems:"center",direction:"row",gap:"small",wrap:"nowrap",children:[(0,oe.jsx)(Mo.VaultItem,{size:"medium",name:e,shape:"square",children:n?.sources&&(0,oe.jsx)(kn,{sources:n?.sources,size:"medium",disabled:a,getCustomIcon:t})}),(0,oe.jsxs)(gn,{wrap:"nowrap",marginInlineEnd:"medium",children:[(0,oe.jsx)(E.Medium,{as:"label",color:"neutral",truncate:!0,disabled:a,children:e}),r&&(0,oe.jsx)(E.Small,{as:"label",color:"neutralWeak",truncate:!0,disabled:a,children:r})]})]}),o]})}var Ci=i(Le()),be=i(h());var go={textLabel:"cv",focused:"fv"};var Sn=i(m()),Ei=({items:n,itemAccent:e,selectedItemId:r="",onItemSubmitted:o,onItemSelected:a})=>{let t=(0,be.useRef)(null),l=(0,be.useRef)(null),_=(0,be.useMemo)(()=>n.reduce((B,S)=>(S.type==="option"&&B.push(S.data),B),[]),[n]),c=(0,be.useMemo)(()=>_.map(B=>B.id),[_]),[s,d]=Do(c),u=(0,be.useContext)(b),x=()=>{l.current?.querySelector("div[aria-selected=true]")?.scrollIntoView({block:"center"})};Pe({next:[{key:"ArrowDown"},{key:"n",modifiers:{ctrl:!0},os:"macos"}],previous:[{key:"ArrowUp"},{key:"p",modifiers:{ctrl:!0},os:"macos"}],submitWithEnter:{key:"Enter"},selectWithSpace:{key:" "}},{next:()=>{d.next(),x()},previous:()=>{d.previous(),x()},submitWithEnter:o,selectWithSpace:()=>{let B=_.find(S=>S.id===s);B&&a(B.id)}},t);let y=()=>{s||d.entry(c[0])},N=B=>{d.entry(B),a(B)};return(0,Sn.jsx)(g,{display:"flex",maxHeight:"300px",children:(0,Sn.jsx)(yn,{elevateOnScroll:"top",ref:l,thin:!0,children:(0,Sn.jsx)(g,{role:"listbox",ariaActiveDescendant:s,ariaLabel:u("Existing items"),onBlur:()=>d.none(),onFocus:y,ref:t,tabIndex:0,paddingX:"xs",outline:"none",children:n.map(B=>{switch(B.type){case"header":return(0,Sn.jsx)(Ka,{...B.data},B.data.id);case"option":return(0,Sn.jsx)($a,{data:B.data,selected:r===B.data.id,focused:s===B.data.id,onSelect:N,itemAccent:e},B.data.id);case"separator":return(0,Sn.jsx)(Ya,{},B.data.id)}})})})})},Ka=({accountIcon:n,vaultIcon:e,accountLabel:r,vaultLabel:o})=>(0,Sn.jsx)(He,{paddingBottom:"small",children:(0,Sn.jsx)(br,{items:[{icon:n,text:r},{icon:e,text:o}]})}),$a=({data:n,focused:e,selected:r,onSelect:o,itemAccent:a})=>(0,Sn.jsxs)(g,{role:"option",ariaSelected:e,id:n.id,display:"flex",alignItems:"center",overflow:"hidden",padding:"xs",marginBottom:"2xs",backgroundColor:r?"brandWeak":void 0,borderRadius:"medium",className:(0,Ci.default)({[go.focused]:e}),onClick:()=>o(n.id),children:[(0,Sn.jsx)(Yn,{className:go.textLabel,icon:(0,Sn.jsx)(kn,{...n.icon,size:"medium",getCustomIcon:Xa}),label:n.label,secondaryLabel:n.subtitle}),a(n.id)]}),Ya=()=>(0,Sn.jsx)(g,{borderTopWidth:"1px",borderStyle:"solid",borderColor:"neutral",margin:"small"}),Xa=async n=>{let e=await p("get-custom-icon-url",{itemId:n});if(e.ok)return e.data;if(e.type==="nolistener"){let r="No listener registered for GetCustomIconUrl";throw new Error(r)}throw e.error};var Qn=i(h()),Ri=i(m()),Ja=n=>n.filter(e=>e.type==="option").map(e=>e.data),Qa=n=>{for(let e of n)if(e.type==="header")return e.data},rr=(0,Qn.createContext)({}),zr=({updateableItems:n,children:e})=>{let r=(0,Qn.useMemo)(()=>Ja(n),[n]),o=(0,Qn.useMemo)(()=>Qa(n),[n]),a=(0,Qn.useMemo)(()=>r.find(_=>!!_.isDefault),[r]),[t,l]=(0,Qn.useState)(a?.id??r[0]?.id);return(0,Qn.useEffect)(()=>{(!t||!r.some(_=>_.id===t))&&l(a?.id??r[0]?.id)},[a,r,t]),(0,Ri.jsx)(rr.Provider,{value:{updateableItems:n,itemListOptions:r,defaultAccount:o,updateItemId:t,setUpdateItemId:l},children:e})};var In=i(m()),Lr=({calloutBanner:n,isDisabled:e,buttonLabel:r="save",onUpdate:o,vaultItemRowProps:a,itemListAttachment:t})=>{let l=(0,uo.useContext)(b),_=(0,uo.useContext)(rr),c=async d=>{let u=await p("get-custom-icon-url",{itemId:d});if(u.ok)return u.data;if(u.type==="nolistener"){let x="No listener registered for GetCustomIconUrl";throw new Error(x)}else throw u.error},s=_.itemListOptions.length===1;return(0,In.jsx)(In.Fragment,{children:!e&&(0,In.jsxs)(In.Fragment,{children:[s?(0,In.jsx)(fe,{rowEndElement:a?.rowEndElement,vaultIcon:_.itemListOptions[0].icon,title:_.itemListOptions[0].label,subtitle:_.itemListOptions[0].subtitle,disabled:e,getCustomIcon:c,color:a?.color}):(0,In.jsx)(Ei,{items:_.updateableItems,itemAccent:d=>(0,In.jsx)($o,{checked:_.updateItemId===d,tabIndex:-1,readOnly:!0}),selectedItemId:_.updateItemId,onItemSelected:_.setUpdateItemId,onItemSubmitted:()=>{_.updateItemId&&o(_.updateItemId)}}),n||null,(0,In.jsxs)(g,{display:"flex",width:"full",paddingLeft:"small",gap:"small",justifyContent:s&&_.defaultAccount?"space-between":"flex-end",children:[s&&_.defaultAccount&&(0,In.jsx)(br,{items:[{icon:_.defaultAccount.accountIcon,text:_.defaultAccount.accountLabel},{icon:_.defaultAccount.vaultIcon,text:_.defaultAccount.vaultLabel}]}),(0,In.jsxs)(He,{gap:"small",children:[!s&&t,(0,In.jsx)(C.Primary,{disabled:!_.updateItemId||e,onClick:()=>{_.updateItemId&&o(_.updateItemId)},children:l(r==="save"?"Save":"Update")})]})]})]})})};var Fn=i(h());var Pn=n=>{let[e,r]=(0,Fn.useState)(!1),[o,a]=(0,Fn.useState)(void 0),t=(0,Fn.useContext)(q),l=(0,Fn.useRef)(n),_=qo(n),c=_===!0&&!n,s=_===!1&&n;return(0,Fn.useEffect)(()=>{l.current=n},[n]),(0,Fn.useEffect)(()=>{c&&a(e?"connected":"disconnected")},[e,c]),(0,Fn.useEffect)(()=>{let d=({name:x})=>(r(x==="yes"),a(x==="yes"?"connected":"disconnected"),x);t.canRequestUnlock().then(d);let u=t.on("can-request-unlock-changed",d);return()=>u()},[t]),{locked:n,requestUnlockStatus:o,wasLockedNowUnlocked:c,wasUnlockedNowLocked:s}};var Ti=i(h()),Pr=i(m()),Ar=({error:n})=>{let e=(0,Ti.useContext)(b),r=o=>{switch(o){case"expiredSession":return e("Session expired for tab.");case"missingItem":return e("Failed to load item.");case"missingSecret":return e("Invalid one-time password secret.");case"unknown":return e("1Password encountered a problem.");case"save":return e("Failed to save item.");default:_e(o)}};return(0,Pr.jsx)(Mn,{icon:{id:"error-callout-banner-icon",sources:[{type:"ThemedIcon",content:{file:Ln.Warning}}]},role:"alert",variant:"warning",children:(0,Pr.jsx)(v,{alignItems:"flex-start",direction:"column",gap:"small",children:(0,Pr.jsx)(E,{as:"p",variant:"medium",color:"critical",children:r(n)})})})};var Fe=i(h());var Ni=i(m()),qr=({title:n,username:e,icon:r,rowEndElement:o})=>(0,Ni.jsx)(fe,{color:"success",rowEndElement:o,vaultIcon:r,title:n,subtitle:e});var Dr=i(m()),jr=({preview:n})=>{let e=(0,Fe.useRef)(null),r=(0,Fe.useContext)(I);return(0,Fe.useEffect)(()=>{e.current=setTimeout(r.deleteNotification,3500)},[r]),(0,Dr.jsx)(qr,{title:n.title,username:n.subtitle,icon:n.icon,rowEndElement:(0,Dr.jsx)(g,{children:(0,Dr.jsx)(jo,{color:"success"})})})};var zi=i(h()),ie=i(m()),Hr=({canRequestUnlock:n,itemCopy:e})=>{let r=(0,zi.useContext)(b);return(0,ie.jsx)(ie.Fragment,{children:(0,ie.jsx)(Mn,{icon:{id:"unlock-callout-banner-icon",sources:[{type:"ThemedIcon",content:{file:Ln.Lock}}]},role:"status",variant:"info",children:n?(0,ie.jsxs)(v,{alignItems:"flex-start",direction:"column",gap:"small",children:[(0,ie.jsx)(E,{as:"p",variant:"medium",color:"brand",children:r("To save {item}, unlock 1Password first.",{item:e})}),(0,ie.jsx)(C.Primary,{onClick:async()=>p("request-managed-unlock",void 0),children:r("Unlock 1Password")})]}):r("Select the 1Password icon in your browser's toolbar to unlock.")})})};function he(n,e="unknown"){return n.ok?"unknown":n.type==="nolistener"?(console.error("No listener registered for message kind."),"unknown"):Object.values(er).find(r=>n.error.message===r)??e}var nn=i(m()),Ur=()=>{let n=(0,ln.useContext)(b),e=(0,ln.useContext)(J),r=(0,ln.useContext)(I),o=new URLSearchParams(window.location.search),a=r.notification?r.notification.params.secret:o.get("secret"),{locked:t,requestUnlockStatus:l,wasLockedNowUnlocked:_,wasUnlockedNowLocked:c}=Pn(e.locked),[s,d]=(0,ln.useState)(),[u,x]=(0,ln.useState)(),[y,N]=(0,ln.useState)(),[B,S]=(0,ln.useState)(),[M,A]=(0,ln.useState)(!1),k=(0,ln.useCallback)(()=>{p("autosave-2fa-configuration",void 0).then(V=>{V.ok?(d(V.data),A(!1)):x(he(V))})},[]);pn("accounts-and-vaults-changed",k,[k]),(0,ln.useEffect)(k,[k]),(0,ln.useEffect)(()=>{if(_){A(!0),k();return}c&&d(void 0)},[k,_,c]);let w=_n("b5x-filling-saving-telemetry"),P=(V,fn)=>{if(!a)return x("missingSecret");x(void 0),w()&&p("record-click-event-first-account",{event:{componentType:"button",componentName:fn?"overwrite":"save",source:"autosave_2fa_notification",category:"autosave_2fa"}}),p("autosave-2fa-save",{id:V,overwrite:fn,secret:a}).then(dn=>{if(!dn.ok)return x(he(dn));switch(dn.data.type){case"success":N(dn.data.data);return;case"overwrite":S(V);return;default:_e(dn.data)}})},j=()=>t||M?(0,nn.jsx)(Hr,{canRequestUnlock:l?l==="connected":void 0,itemCopy:n("one-time password")}):y?(0,nn.jsx)(jr,{preview:y}):B?(0,nn.jsx)(et,{onCancel:()=>S(void 0),onOverwrite:()=>P(B,!0)}):s?s.updatableItemListElements.length===0?(0,nn.jsx)(Za,{}):(0,nn.jsx)(Lr,{isDisabled:!1,calloutBanner:s.firstRun?(0,nn.jsx)(nt,{}):void 0,onUpdate:V=>P(V,!1)}):(0,nn.jsx)(v,{alignItems:"center",justifyContent:"center",paddingTop:"medium",paddingBottom:"medium",children:(0,nn.jsx)(Wn.Indeterminate,{})}),O=(0,ln.useMemo)(()=>n(y?"Saved one-time password":"Save one-time password"),[n,y]);return(0,nn.jsx)(L,{title:O,type:"autosaveTotp",closeOnBackForwardCacheLoad:!0,children:(0,nn.jsxs)(v,{direction:"column",gap:"medium",children:[(0,nn.jsx)(zr,{updateableItems:s?s.updatableItemListElements:[],children:j()}),!!u&&(0,nn.jsx)(Ar,{error:u})]})})},Za=()=>{let n=(0,ln.useContext)(b);return(0,nn.jsx)(on.Informational,{title:n("No logins found"),children:(0,nn.jsx)(on.Content,{children:n("Make sure 1Password accounts containing logins for this site are unlocked.")})})},nt=()=>{let n=(0,ln.useContext)(b);return(0,nn.jsx)(on.Informational,{title:n("Use 1Password for two-factor authentication"),children:(0,nn.jsx)(on.Content,{children:n("Save one-time passwords that will be automatically filled during sign-in.")})})},et=({onCancel:n,onOverwrite:e})=>{let r=(0,ln.useContext)(b);return(0,nn.jsxs)(on.Warning,{title:r("Overwrite one-time password?"),children:[(0,nn.jsx)(on.Content,{children:r("The one-time password in this item will be replaced.")}),(0,nn.jsxs)(on.Actions,{children:[(0,nn.jsx)(on.Button,{onClick:n,children:r("Cancel")}),(0,nn.jsx)(on.Button,{onClick:e,children:r("Overwrite")})]})]})};var an=i(h());var Ge=i(h());var or=i(h());var Li={vaultItem:"uv",vaultForItem:"bv"};var Ve=i(h()),Ai=i(m()),fo=(0,Ve.createContext)({}),Pi=({vaults:n,selectedVaultUuid:e,children:r})=>{let[o,a]=(0,Ve.useState)(e);return(0,Ve.useEffect)(()=>{n.some(l=>l.type==="Vault"&&l.content.id===e)||a(e)},[e,n]),(0,Ai.jsx)(fo.Provider,{value:{vaults:n,accountVaultUuid:o,setAccountVaultUuid:a},children:r})};var Rn=i(m()),qi=n=>{let e=(0,or.useContext)(b),r=(0,or.useContext)(fo),o=(0,or.useRef)(null);return(0,Rn.jsxs)(Rn.Fragment,{children:[(0,Rn.jsx)(fe,{rowEndElement:n.vaultItemRowProps?.rowEndElement,vaultIcon:n.newVaultItemData.icon,title:n.newVaultItemData.title,subtitle:n.newVaultItemData.username,disabled:n.isDisabled,color:n.vaultItemRowProps?.color}),!n.isDisabled&&(0,Rn.jsxs)(He,{gap:"medium",children:[(0,Rn.jsx)(g,{flexGrow:"1",children:(0,Rn.jsx)(oi,{buttonClassName:Li.vaultForItem,vaultListElements:r.vaults,selectedVaultId:r.accountVaultUuid,onSelect:a=>r.setAccountVaultUuid(a.content.id)})}),(0,Rn.jsx)(g,{flexShrink:"0",children:(0,Rn.jsx)(C.Primary,{disabled:!r.accountVaultUuid,onClick:()=>r.accountVaultUuid&&n.onSave(r.accountVaultUuid),children:e("Save")})})]}),!n.isDisabled&&n.isTutorial&&(0,Rn.jsx)(g,{children:(0,Rn.jsx)(ii,{initialPlacement:"bottom",fullDisplay:!0,primaryText:e("Step 3: Review or edit your new login item, then save it."),secondaryText:e("Once saved, we'll remember it for you."),targetRef:o,telemetryEvent:{componentType:"tooltip",category:"extension_save_fill_tutorial",componentName:"REVIEW_LOGIN_ITEM"}})})]})};var ve=i(m()),Wr=n=>{let e=(0,Ge.useContext)(b),r=n.updateableItems.some(l=>l.type==="option"&&!!l.data.isDefault),[o,a]=(0,Ge.useState)(r?"updatable-item-list":"new-item");(0,Ge.useEffect)(()=>{n.updateableItems.some(_=>_.type==="option")||a("new-item")},[n.updateableItems]);let t=[{id:"new-item",label:e("New Item")},{id:"updatable-item-list",label:e("Update Existing")}];return(0,ve.jsx)(Pi,{selectedVaultUuid:n.newItem.selectedVault,vaults:n.newItem.vaults,children:(0,ve.jsxs)(zr,{updateableItems:n.updateableItems,children:[n.updateableItems.length>0&&(0,ve.jsx)(qe,{children:(0,ve.jsx)(Yo,{activeTabId:o,onTabClick:l=>{a(l)},tabs:t})}),o==="new-item"&&(0,ve.jsx)(qi,{vaultItemRowProps:n.vaultItemRowProps,newVaultItemData:n.newItem,onSave:n.onSave,isTutorial:n.isTutorial,isDisabled:n.isDisabled}),o==="updatable-item-list"&&!n.isDisabled&&(0,ve.jsx)(Lr,{...n.updateItemOpts,isDisabled:n.isDisabled,onUpdate:n.onUpdate})]})})};var Di=i(h());var we=i(m()),ji=({preview:n,onDismiss:e})=>{let r=(0,Di.useContext)(b);setTimeout(()=>{e()},5e3);let o=async a=>{let t=await p("get-custom-icon-url",{itemId:a});if(t.ok)return t.data;if(t.type==="nolistener"){let l="No listener registered for GetCustomIconUrl";throw new Error(l)}else throw t.error};return(0,we.jsxs)(we.Fragment,{children:[(0,we.jsx)(fe,{vaultIcon:n.icon,title:n.title,subtitle:n.subtitle,getCustomIcon:o}),(0,we.jsx)(on.Success,{role:"status",children:(0,we.jsx)(on.Content,{children:r("Fill this item with 1Password next time you log in to save time")})})]})};var Hi={loginDetails:"l_",lockBanner:"hv"};var vn=i(m()),bo={login:"autosave-save-type-login",creditCard:"autosave-save-type-credit-card",identity:"autosave-save-type-identity"},Mr=()=>{let n=(0,an.useContext)(J),e=(0,an.useContext)(I),r=new URLSearchParams(window.location.search),o=e.notification?e.notification.params.tutorialMode:r.get("tutorialMode")==="true",a=(0,an.useContext)(b),{locked:t,requestUnlockStatus:l,wasLockedNowUnlocked:_,wasUnlockedNowLocked:c}=Pn(n.locked),[s,d]=(0,an.useState)(),[u,x]=(0,an.useState)(),[y,N]=(0,an.useState)(),[B,S]=(0,an.useState)(!1),[M,A]=(0,an.useState)(),k=(0,an.useCallback)(()=>{p("autosave-configuration",void 0).then(R=>{R.ok?(d(R.data),A(R.data.saveType),S(!1)):x(he(R))})},[]);pn("accounts-and-vaults-changed",k,[k]),pn("refresh-notification",k,[k]),(0,an.useEffect)(k,[k]),(0,an.useEffect)(()=>{if(_){S(!0),k();return}c&&d(void 0)},[k,_,c]);let w=_n("b5x-filling-saving-telemetry"),P=(0,an.useCallback)(R=>{R&&(w()&&p("record-click-event-first-account",{event:{componentType:"button",category:"item",source:"notification",componentName:"AUTOSAVE_SAVE"}}),p("autosave-save",{type:"new",data:{vaultSelector:R}}).then(H=>{H.ok?N(H.data):x(he(H))}))},[w]),j=(0,an.useCallback)(()=>{p("autosave-dismiss",void 0),e.deleteNotification()},[e]),O=(0,an.useCallback)(R=>{p("autosave-edit",R).then(H=>{H.ok?e.deleteNotification():x(he(H))})},[e]),V=(0,an.useCallback)(async R=>p("autosave-save",{type:"update",data:{id:R}}).then(H=>{H.ok?N(H.data):x(he(H))}),[]),fn=R=>R===void 0?a("an Item"):R==="identity"?a("an {item}",{item:a.lookup(bo[R]).toLowerCase()}):a("a {item}",{item:a.lookup(bo[R]).toLowerCase()}),dn=R=>{let H=R?a.lookup(bo[R]):a("Item");return y?a("{item} saved",{item:H}):s?.duplicateItemPreview?a("{item} already saved",{item:H}):a("Save {item}",{item:H.toLowerCase()})},U=()=>{if(t||B)return(0,vn.jsx)(Hr,{canRequestUnlock:l?l==="connected":void 0,itemCopy:fn(M)});if(s?.duplicateItemPreview)return(0,vn.jsx)(ji,{preview:s.duplicateItemPreview,onDismiss:j});if(y)return(0,vn.jsx)(jr,{preview:y});if(!s)return(0,vn.jsx)(v,{alignItems:"center",justifyContent:"center",paddingTop:"medium",paddingBottom:"medium",children:(0,vn.jsx)(Wn.Indeterminate,{})});let R=H=>({rowEndElement:(0,vn.jsx)(C.Tertiary,{color:"neutral",startAccessory:(0,vn.jsx)(Wo,{}),disabled:H,onClick:()=>O(void 0),children:a("Edit")})});return(0,vn.jsx)(Wr,{vaultItemRowProps:R(t),updateItemOpts:{vaultItemRowProps:R(t),itemListAttachment:(0,vn.jsx)(it,{onEdit:O,isDisabled:t}),buttonLabel:"update"},isDisabled:t,isTutorial:o,onSave:P,onUpdate:V,updateableItems:s.updatableItemListElements,newItem:{title:s.preview.title,username:s.preview.subtitle,icon:s.preview.icon,vaults:s.vaultListElements,selectedVault:s.defaultSuggestedVaultId}})};return(0,vn.jsx)(L,{onClose:j,hideCloseButton:o,type:"autosave",className:Hi.notification,title:dn(M),children:(0,vn.jsxs)(v,{direction:"column",gap:"medium",children:[U(),!!u&&(0,vn.jsx)(Ar,{error:u})]})})},it=({onEdit:n,isDisabled:e})=>{let r=(0,an.useContext)(b),o=(0,an.useContext)(rr);return(0,vn.jsx)(C.Secondary,{disabled:!o.updateItemId||e,onClick:()=>n?.(o.updateItemId),children:r("Edit")})};var te=i(h());var ae=i(h());var Ui=i(h());var Or=i(h());function ye(n){let[e,r]=(0,Or.useState)(!1),o=(0,Or.useCallback)(async(...a)=>{if(e){console.info(`Can't execute ${n.name} while prior action is in progress - ignoring request`);return}r(!0);try{await n(...a)}catch(t){throw console.warn(`${n.name} failed`),t}finally{r(!1)}},[n,e]);return{isExecuting:e,execute:o}}var en={recheckingContainer:"vv",openLinkIcon:"wv",multiSelectionContainer_blocking:"yv",multiSelectionContainer_nonBlocking:"Bv",reasonsListContainer:"Pr",reasonsListContainer_individual:"Vr",resolvedIssue:"Ax",successNotification:"Gx"};var z=i(m()),Wi=({accountUuid:n,reasons:e,resolvedIssues:r,recheckDevice:o,errorMessage:a,snooze:t})=>{let l=(0,Ui.useContext)(b),{isExecuting:_,execute:c}=ye(o),{isExecuting:s,execute:d}=ye(t.show?t.onSnooze:async()=>{}),u=x=>{p("record-click-event",{accountUuid:n,event:{componentType:"notification",category:"app",source:"notification",componentName:"DT4A_BLOCKING_FIX_ISSUE"}}),window.open(x,"_blank","noopener")};return(0,z.jsxs)(v,{direction:"column",children:[(0,z.jsx)(v,{gap:"small",direction:"row",wrap:"nowrap",children:e.length===1&&r.length===0?(0,z.jsx)(g,{className:en.reasonsListContainer_individual,width:"full",children:(0,z.jsxs)(g,{as:"a",tabIndex:0,focusable:"on",htmlFor:e?.[0]?.title,alignItems:"center",justifyContent:"space-between",gap:"small",wrap:"nowrap",paddingInline:"small",paddingBlock:"small",display:"flex",onClick:()=>{u(e?.[0].fixUrl)},onKeyUp:x=>{(x.key==="Enter"||x.key===" ")&&u(e?.[0].fixUrl)},children:[(0,z.jsxs)(v,{alignItems:"center",gap:"small",wrap:"nowrap",direction:"row",children:[(0,z.jsx)(kn,{size:"medium",sources:[{type:"RichIcon",content:{url:e?.[0]?.icon??""}}]}),(0,z.jsx)(gn,{shrink:"1",children:(0,z.jsx)(E,{variant:"medium",as:"span",color:"neutral",children:e[0]?.title})})]}),(0,z.jsx)(g,{display:"flex",alignItems:"center",gap:"xs",justifyContent:"flex-end",className:en.openLinkIcon,children:(0,z.jsx)(ce,{ariaLabel:"Navigate",color:"neutralWeak"})})]})}):(0,z.jsx)(g,{display:"flex",className:en.multiSelectionContainer_blocking,children:(0,z.jsx)(yn,{alwaysShowBorder:!1,thin:!0,children:(0,z.jsxs)(g,{as:"ul",className:en.reasonsListContainer,children:[e.map(x=>(0,z.jsx)("li",{"aria-label":l("Fix issue: {issue}",{issue:x.title}),children:(0,z.jsxs)(v,{as:"a",tabIndex:0,focusable:"on",htmlFor:x.title,alignItems:"center",justifyContent:"space-between",gap:"small",wrap:"nowrap",paddingInline:"small",paddingBlock:"small",onClick:()=>{u(x.fixUrl)},onKeyUp:y=>{(y.key==="Enter"||y.key===" ")&&u(x.fixUrl)},children:[(0,z.jsxs)(v,{alignItems:"center",gap:"small",wrap:"nowrap",direction:"row",children:[(0,z.jsx)(kn,{size:"medium",sources:[{type:"RichIcon",content:{url:x?.icon??""}}]}),(0,z.jsx)(gn,{shrink:"1",children:(0,z.jsx)(E,{variant:"medium",as:"span",color:"neutral",children:x.title})})]}),(0,z.jsx)(g,{display:"flex",alignItems:"center",gap:"xs",justifyContent:"flex-end",className:en.openLinkIcon,children:(0,z.jsx)(ce,{ariaLabel:"Navigate",color:"neutralWeak"})})]})},x.id)),r.map(x=>(0,z.jsx)("li",{"aria-label":l("Resolved issue: {issue}",{issue:x.title}),children:(0,z.jsxs)(g,{as:"div",focusable:"off",alignItems:"center",justifyContent:"space-between",gap:"xs",wrap:"nowrap",paddingInline:"small",paddingBlock:"small",display:"flex",className:en.resolvedIssue,children:[(0,z.jsxs)(v,{alignItems:"center",gap:"small",wrap:"nowrap",direction:"row",children:[(0,z.jsx)(kn,{size:"medium",sources:[{type:"RichIcon",content:{url:x?.icon??""}}]}),(0,z.jsx)(gn,{shrink:"1",children:(0,z.jsx)(E,{variant:"medium",as:"span",color:"neutral",children:x.title})})]}),(0,z.jsx)(g,{display:"flex",alignItems:"center",gap:"xs",justifyContent:"flex-end",className:en.openLinkIcon,children:(0,z.jsx)(kr,{ariaLabel:"Navigate",color:"success"})})]})},x.id))]})})})}),a?(0,z.jsx)(g,{marginTop:"xs",children:(0,z.jsx)(E.Medium,{as:"span",color:"critical",children:a})}):null,(0,z.jsxs)(v,{direction:"row-reverse",gap:"xs",justifyContent:"space-between",marginTop:"small",children:[(0,z.jsx)(C.Secondary,{disabled:_,onClick:c,ariaLabel:l("Recheck device"),children:_?(0,z.jsx)(g,{className:en.recheckingContainer,children:(0,z.jsx)(Wn,{variant:"indeterminate"})}):l("Recheck")}),t.show&&(0,z.jsx)(C.Tertiary,{onClick:d,disabled:_||s,children:l("Snooze")})]})]})};var ho=i(m()),Mi=({accountUuid:n,initialDeviceHealth:e,setInitialDeviceHealth:r,blockedPage:o})=>{let a=(0,ae.useContext)(b),t=(0,ae.useContext)(I),_=new URLSearchParams(window.location.search).get("notificationId"),{deviceHealth:c,getDeviceHealth:s}=xe(),[d,u]=(0,ae.useState)(),x=a("Something isn't right. Please try again. If the problem persists, contact your administrator"),y=c?.failingChecks?c?.failingChecks.filter(k=>k.status==="blocked").map(k=>({id:k.id,title:k.title,icon:k.iconUrl,fixUrl:k.endUserUrl,canForceSuccess:k.canForceSuccess})):[],N=e&&c?e?.failingChecks.filter(({id:k})=>!c?.failingChecks.some(({id:w})=>k===w)).filter(k=>k.status==="blocked").map(k=>({id:k.id,title:k.title,icon:k.iconUrl})):[],B=o?a("Fix {count, plural, =1 {# issue} other {# issues}} to use {appName}",{appName:o||"",count:y.length||0}):a("Blocked Device");(0,ae.useEffect)(()=>{s(),d&&d!==x&&u(y.length>0?a("{count, plural, =1{# issue remains} other{# issues remain}}",{count:y.length}):void 0)},[a,d,x,s,y.length]);let S=(0,ae.useCallback)(()=>{t.deleteNotification()},[]),M=async()=>{let k=await p("recheck-device",{deviceStatus:"blocked",activeNotificationId:_});if(p("record-click-event",{accountUuid:n,event:{componentType:"notification",category:"app",source:"notification",componentName:"DT4A_BLOCKING_RECHECK_BUTTON"}}),!k.ok||k.data.type==="failure"){u(x);return}let{health:w}=k.data.data;if(w.device.status!=="blocked")return;let P=w.failingChecks.filter(j=>j.status==="blocked");u(P.length>0?a("{count, plural, =1{# issue remains} other{# issues remain}}",{count:P.length}):void 0),r(void 0)},A=c?.actions.forceSuccess?{show:!0,onSnooze:async()=>{let k=await p("force-device-trust-success",void 0);if(p("record-click-event",{accountUuid:n,event:{componentType:"notification",category:"app",source:"notification",componentName:"DT4A_BLOCKING_IGNORE_BUTTON"}}),!k.ok){u(x);return}if(k.data.type==="failure"){u(k.data.userFacingError||x);return}S()}}:{show:!1};return(0,ho.jsx)(L,{onClose:S,title:B,autoFocus:!0,type:"deviceTrustBlocking",closeOnBackForwardCacheLoad:!1,hideCloseButton:!0,accountUuid:n,children:(0,ho.jsx)(Wi,{accountUuid:n,recheckDevice:M,reasons:y,resolvedIssues:N,errorMessage:d,snooze:A})})};var Bn=i(h());var Oi="/assets/png/1password_kolide_icon-KSUCYEQW.png";var Fi=i(h());var Fr={fixRunningContainer:"Sv",recheckRunningContainer:"zv"};var rn=i(m()),Vi=({accountUuid:n,errorMessage:e,reason:r,aboutUrl:o,onFixClick:a,showAboutButton:t,onRecheckClick:l,iconUrl:_,fixLabel:c})=>{let s=(0,Fi.useContext)(b),{isExecuting:d,execute:u}=ye(a),{isExecuting:x,execute:y}=ye(l);return(0,rn.jsxs)(v,{direction:"column",children:[(0,rn.jsx)(v,{gap:"small",direction:"row",wrap:"nowrap",children:(0,rn.jsx)(g,{className:en.reasonsListContainer_individual,width:"full",children:(0,rn.jsxs)(g,{as:"a",tabIndex:0,focusable:"on",htmlFor:r.title,alignItems:"center",justifyContent:"space-between",gap:"small",wrap:"nowrap",paddingInline:"small",paddingBlock:"small",display:"flex",onClick:u,onKeyUp:N=>{(N.key==="Enter"||N.key===" ")&&u()},disabled:d,children:[(0,rn.jsx)(Yn,{truncate:!1,label:r.title,secondaryLabel:r.subtitle,icon:{size:"small",sources:[{type:"RichIcon",content:{url:_}}]}}),(0,rn.jsx)(g,{display:"flex",alignItems:"center",gap:"xs",justifyContent:"flex-end",className:Fr.openLinkIcon,children:d?(0,rn.jsx)(g,{className:Fr.fixRunningContainer,children:(0,rn.jsx)(Wn,{variant:"indeterminate"})}):(0,rn.jsx)(ce,{ariaLabel:"Navigate",color:"neutralWeak"})})]})})}),e?(0,rn.jsx)(g,{marginTop:"xs",children:(0,rn.jsx)(E.Medium,{as:"span",color:"critical",children:e})}):null,(0,rn.jsxs)(v,{direction:"row",gap:"medium",justifyContent:"flex-end",marginTop:"small",children:[t&&(0,rn.jsx)(C.Tertiary,{ariaLabel:s("About Kolide"),onClick:()=>{p("record-click-event",{accountUuid:n,event:{componentType:"notification",category:"app",source:"notification",componentName:"DT4A_REGISTER_ABOUT_BUTTON"}}),window.open(o)},children:(0,rn.jsx)(g,{display:"flex",gap:"xs",justifyContent:"center",alignItems:"flex-end",children:s("About Kolide")})}),(0,rn.jsx)(C,{ariaLabel:c,onClick:y,disabled:x,children:(0,rn.jsx)(g,{className:Fr.recheckRunningContainer,children:x?(0,rn.jsx)(Wn,{inverted:!0,variant:"indeterminate"}):(0,rn.jsx)(rn.Fragment,{children:c})})})]})]})};var vo=i(m()),Gi=n=>{let e=(0,Bn.useContext)(b),r=(0,Bn.useContext)(I),[o,a]=(0,Bn.useState)(),t=n.blockedPage?e("Fix 1 issue to access {appName}",{appName:n.blockedPage||""}):e("Blocked Device"),l=n.accountName?e("{accountName} requires that you set up Kolide on this device before accessing work apps.",{accountName:n.accountName}):e("Your admin requires that you set up Kolide on this device before accessing work apps."),_=n.accountName?e("{accountName} needs 1Password unlocked to check your device's security.",{accountName:n.accountName}):e("Your admin needs 1Password unlocked to check your device's security."),s={title:n.cause==="deviceTrustNoKolide"?e("Kolide is missing or not registered"):e("1Password is locked"),subtitle:n.cause==="deviceTrustNoKolide"?l:_},d=(0,Bn.useRef)(void 0);pn("lock-state-changed",({locked:k})=>{k||d.current&&d.current.resolve({type:"unlocked"})},[]);let u=(0,Bn.useCallback)(()=>{r.deleteNotification()},[]),x=(0,Bn.useCallback)((k,w)=>{p("record-click-event",{accountUuid:k,event:{componentType:"notification",category:"app",source:"notification",componentName:w}})},[]),y=(0,Bn.useCallback)(async(k,w)=>{if(a(void 0),k){d.current=co(),p("request-managed-unlock",void 0);let P=await Promise.race([d.current.promise,_o(3e4)]);if(d.current=void 0,P.type==="timeout")return a(e("Please try unlocking again before fixing this issue")),!1}return w!=="deviceTrustNeedsUnlock"},[e]),N=(0,Bn.useCallback)(async()=>{if(x(n.accountUuid,"DT4A_REGISTER_FIX_BUTTON"),!await y(n.locked,n.cause))return;let w=await p("enroll-device",{accountUuid:n.accountUuid});if(!w.ok){a(e("Something isn't right. Please try again. If the problem persists, contact your administrator"));return}if(w.data.type==="failure"){console.error(`DeviceTrust: ${w.data.code.toString()} ${w.data.message.toString()}`),a(n.accountName?e("Ensure you are signed in to the account associated with { accountName }. Please try again. If the problem persists, contact your administrator",{accountName:n.accountName}):e("Something isn't right. Please try again. If the problem persists, contact your administrator"));return}return w.data},[x,n.accountUuid,n.locked,n.cause,y,e]),B=(0,Bn.useCallback)(async()=>{if(x(n.accountUuid,"DT4A_REGISTER_RECHECK_BUTTON"),!await y(n.locked,n.cause))return;S.current=co();let w=await p("kolide-device-registered",{accountUuid:n.accountUuid}),P=await Promise.race([S.current.promise,_o(3e3)]);if(S.current=void 0,!w.ok||P.type==="timeout"){a(e("Kolide wasn't found. Try again, or contact your administrator if the problem persists."));return}return w.ok&&u(),w.data},[x,n.accountUuid,n.locked,n.cause,y,e,u]),S=(0,Bn.useRef)(void 0);pn("device-trust-connected",()=>{if(!S.current){u();return}S.current.resolve({type:"agent-found"})},[]);let M=n.cause==="deviceTrustNoKolide"?"https://assets1.kolide.com/assets/kolide-k-logo-a6e31c59.svg":Oi,A=n.cause==="deviceTrustNoKolide"&&!n.locked?e("Recheck"):e("Unlock 1Password");return(0,vo.jsx)(L,{onClose:u,title:t,autoFocus:!0,type:"deviceTrustNoKolide",closeOnBackForwardCacheLoad:!1,hideCloseButton:!0,accountUuid:n.accountUuid,children:(0,vo.jsx)(Vi,{accountUuid:n.accountUuid,errorMessage:o,aboutUrl:"https://www.kolide.com/docs/users",reason:s,onFixClick:N,iconUrl:M,fixLabel:A,showAboutButton:n.cause==="deviceTrustNoKolide",onRecheckClick:B})})};var Zn=i(h());var lt=1e3*3600*24,dt=n=>Math.floor(n/lt),Ki=(n,e)=>{let r=new Date(n),o=new Date(e);r.setHours(0,0,0,0);let a=r.getTime(),l=o.getTime()-a,_=Math.abs(l);return dt(_)},$i=(n,e)=>n.getFullYear()!==e.getFullYear()||n.getMonth()!==e.getMonth()?!1:n.getDay()===e.getDay(),Yi=(n,e)=>!n&&!e||n?.length!==e?.length?!1:n?.some(r=>e?.some(o=>r.id===o.id)),Xi=(n,e)=>{try{chrome.runtime.sendMessage({name:"report-error",data:{name:"DeviceTrust",message:n.str,severity:"error",stack:e}})}catch{console.error("DeviceTrust: sendMessage failed to send reportable error to sentry")}},Vr=(n,e,r)=>n&&typeof n=="object"&&r in n&&typeof n[r]=="string"?n[r]:e.get(r);var Ji=i(h());var T=i(m()),Qi=({accountUuid:n,reasons:e,resolvedIssues:r,recheckDevice:o,ignoreWarningNotification:a,errorMessage:t})=>{let l=(0,Ji.useContext)(b),{isExecuting:_,execute:c}=ye(o),s=d=>{p("record-click-event",{accountUuid:n,event:{componentType:"notification",category:"app",source:"notification",componentName:"DT4A_WARNING_FIX_ISSUE"}}),window.open(d,"_blank","noopener")};return(0,T.jsxs)(v,{direction:"column",children:[(0,T.jsx)(v,{gap:"small",direction:"row",wrap:"nowrap",children:e.length===1&&r.length===0?(0,T.jsx)(g,{className:en.reasonsListContainer_individual,width:"full",children:(0,T.jsxs)(g,{as:"a",tabIndex:0,focusable:"on",htmlFor:e?.[0]?.title,alignItems:"center",justifyContent:"space-between",gap:"small",wrap:"nowrap",paddingInline:"small",paddingBlock:"small",display:"flex",onClick:()=>{s(e?.[0].fixUrl)},onKeyUp:d=>{(d.key==="Enter"||d.key===" ")&&s(e?.[0].fixUrl)},children:[(0,T.jsxs)(v,{alignItems:"center",gap:"small",wrap:"nowrap",direction:"row",children:[(0,T.jsx)(kn,{size:"medium",sources:[{type:"RichIcon",content:{url:e?.[0]?.icon??""}}]}),(0,T.jsxs)(gn,{shrink:"1",children:[(0,T.jsx)(E,{variant:"medium",as:"span",color:"neutral",children:e[0]?.title}),e[0]?.blockDate&&(0,T.jsx)(E,{variant:"small",as:"span",color:"neutralWeak",children:e[0]?.blockDate})]})]}),(0,T.jsx)(g,{display:"flex",alignItems:"center",gap:"xs",justifyContent:"flex-end",className:en.openLinkIcon,children:(0,T.jsx)(ce,{ariaLabel:"Navigate",color:"neutralWeak"})})]})}):(0,T.jsx)(g,{display:"flex",className:en.multiSelectionContainer_nonBlocking,children:(0,T.jsx)(yn,{alwaysShowBorder:!1,thin:!0,children:(0,T.jsxs)(g,{as:"ul",className:en.reasonsListContainer,children:[e.map(d=>(0,T.jsx)("li",{"aria-label":l("Fix issue: {issue}",{issue:d.title}),children:(0,T.jsxs)(v,{as:"a",tabIndex:0,focusable:"on",htmlFor:d.title,alignItems:"center",justifyContent:"space-between",gap:"xs",wrap:"nowrap",paddingInline:"small",paddingBlock:"small",onClick:()=>{s(d.fixUrl)},onKeyUp:u=>{(u.key==="Enter"||u.key===" ")&&s(d.fixUrl)},children:[(0,T.jsxs)(v,{alignItems:"center",gap:"small",wrap:"nowrap",direction:"row",children:[(0,T.jsx)(kn,{size:"medium",sources:[{type:"RichIcon",content:{url:d?.icon??""}}]}),(0,T.jsxs)(gn,{shrink:"1",children:[(0,T.jsx)(E,{variant:"medium",as:"span",color:"neutral",children:d.title}),d.blockDate&&(0,T.jsx)(E,{variant:"small",as:"span",color:"neutralWeak",children:d.blockDate})]})]}),(0,T.jsx)(g,{display:"flex",alignItems:"center",gap:"xs",justifyContent:"flex-end",className:en.openLinkIcon,children:(0,T.jsx)(ce,{ariaLabel:"Navigate",color:"neutralWeak"})})]})},d.id)),r.map(d=>(0,T.jsx)("li",{"aria-label":l("Resolved issue: {issue}",{issue:d.title}),children:(0,T.jsxs)(g,{as:"div",focusable:"off",alignItems:"center",justifyContent:"space-between",gap:"xs",wrap:"nowrap",paddingInline:"small",paddingBlock:"small",display:"flex",className:en.resolvedIssue,children:[(0,T.jsxs)(v,{alignItems:"center",gap:"small",wrap:"nowrap",direction:"row",children:[(0,T.jsx)(kn,{size:"medium",sources:[{type:"RichIcon",content:{url:d?.icon??""}}]}),(0,T.jsx)(gn,{shrink:"1",children:(0,T.jsx)(E,{variant:"medium",as:"span",color:"neutral",children:d.title})})]}),(0,T.jsx)(g,{display:"flex",alignItems:"center",gap:"xs",justifyContent:"flex-end",className:en.openLinkIcon,children:(0,T.jsx)(kr,{ariaLabel:"Navigate",color:"success"})})]})},d.id))]})})})}),t?(0,T.jsx)(g,{marginTop:"xs",children:(0,T.jsx)(E.Medium,{as:"span",color:"critical",children:t})}):null,(0,T.jsxs)(v,{direction:"row-reverse",gap:"xs",justifyContent:"space-between",marginTop:"small",children:[(0,T.jsx)(C.Secondary,{disabled:_,onClick:c,ariaLabel:l("Recheck device"),children:_?(0,T.jsx)(g,{className:en.recheckingContainer,children:(0,T.jsx)(Wn,{variant:"indeterminate"})}):l("Recheck")}),(0,T.jsx)(C.Tertiary,{disabled:_,onClick:a,ariaLabel:l("Fix later"),children:l("Fix later")})]})]})};var wo=i(m()),Zi=({accountUuid:n,initialDeviceHealth:e,setInitialDeviceHealth:r,blockedPage:o})=>{let a=(0,Zn.useContext)(b),t=(0,Zn.useContext)(I),_=new URLSearchParams(window.location.search).get("notificationId"),{deviceHealth:c,getDeviceHealth:s}=xe(),[d,u]=(0,Zn.useState)(),x=a("Something isn't right. Please try again. If the problem persists, contact your administrator"),y=(0,Zn.useCallback)(k=>{if(!k)return;let w=new Date,P=new Date(k);if($i(w,P))return a("Will block today");let j=Ki(w,P);return a("Will block in {daysBlocked, plural, =1 {# day} other {# days}}",{daysBlocked:j})},[a]),N=c?.failingChecks?c?.failingChecks.filter(k=>k.status==="will_block"||k.status==="notify").map(k=>({id:k.id,title:k.title,icon:k.iconUrl,fixUrl:k.endUserUrl,blockDate:y(k?.blocksDeviceAt)})):[],B=e&&c?e?.failingChecks.filter(({id:k})=>!c?.failingChecks.some(({id:w})=>k===w)).filter(k=>k.status==="will_block"||k.status==="notify").map(k=>({id:k.id,title:k.title,icon:k.iconUrl})):[],S=a("Fix {count, plural, =1 {# issue} other {# issues}} to keep {appName} access",{appName:o||"",count:N.length||0});(0,Zn.useEffect)(()=>{s(),d&&d!==x&&u(N.length>0?a("{count, plural, =1{# issue remains} other{# issues remain}}",{count:N.length}):void 0)},[a,d,x,s,N.length]);let M=(0,Zn.useCallback)(()=>{p("ignore-device-trust-warning",void 0),p("record-click-event",{accountUuid:n,event:{componentType:"notification",category:"app",source:"notification",componentName:"DT4A_WARNING_IGNORE_BUTTON"}}),t.deleteNotification()},[]),A=async()=>{p("record-click-event",{accountUuid:n,event:{componentType:"notification",category:"app",source:"notification",componentName:"DT4A_WARNING_RECHECK_BUTTON"}});let k=await p("recheck-device",{deviceStatus:"will_block",activeNotificationId:_});if(!k.ok||k.data.type==="failure"){u(x);return}let{health:w}=k.data.data;if(w.device.status!=="will_block"&&w.device.status!=="notify")return;let P=w.failingChecks.filter(j=>j.status==="will_block"||j.status==="notify");u(P.length>0?a("{count, plural, =1{# issue remains} other{# issues remain}}",{count:P.length}):void 0),r(void 0)};return(0,wo.jsx)(L,{onClose:M,title:S,type:"deviceTrustNonBlocking",hideCloseButton:!0,closeOnBackForwardCacheLoad:!1,accountUuid:n,children:(0,wo.jsx)(Qi,{accountUuid:n,recheckDevice:A,reasons:N,resolvedIssues:B,ignoreWarningNotification:M,errorMessage:d})})};var ne=i(h());var na=i(h());var Se=i(m()),ea=({success:n})=>{let e=(0,na.useContext)(b);return n.device&&n.icon?(0,Se.jsx)(v,{direction:"column",children:(0,Se.jsx)(v,{gap:"small",direction:"row",wrap:"nowrap",children:(0,Se.jsx)(g,{className:en.reasonsListContainer_individual,width:"full",children:(0,Se.jsxs)(g,{padding:"medium",backgroundColor:"neutral",borderRadius:"medium",borderColor:"neutral",borderWidth:"1px",borderStyle:"solid",flexGrow:"1",display:"flex",alignItems:"center",justifyContent:"space-between",className:en.successNotification,children:[(0,Se.jsx)(Yn,{label:n.device,icon:{size:"medium",sources:[{type:"RichIcon",content:{url:n.icon}}]}}),(0,Se.jsx)(Oo.Success.Strong,{children:e("All good")})]})})})}):null};var yo=i(m()),ra=n=>{let e=(0,ne.useContext)(b),r=(0,ne.useContext)(I),o=(0,ne.useRef)(null),{deviceHealth:a,getDeviceHealth:t}=xe();(0,ne.useEffect)(()=>{t()},[t]);let l=(0,ne.useCallback)(()=>{r.deleteNotification()},[]),_=e("All issues resolved");return(0,ne.useEffect)(()=>{o.current=setTimeout(()=>l(),3500)},[l]),a?(0,yo.jsx)(L,{onClose:l,title:_,autoFocus:!0,type:"deviceTrustSuccess",closeOnBackForwardCacheLoad:!1,accountUuid:n.accountUuid,children:(0,yo.jsx)(ea,{success:{icon:a?.device.hardwareImageUrl,device:a?.device.name}})}):null};var oa=72e6,ia=n=>n?Co({startTime:n,duration:oa}):!0,aa=n=>n?Eo({startTime:n,duration:oa}):!1;var ir=i(h());var _t=(n,e)=>{let{notificationConfig:r,deviceHealth:o,locked:a}=e,t=r.type,l=r.params;return!a&&t==="deviceTrustNeedsUnlock"&&!n?{action:"replace",data:{type:"deviceTrustNoKolide",params:l}}:!n&&!o?{action:"none"}:!n&&o?{action:"replace",data:{type:"deviceTrustNoKolide",params:l}}:(n?.device.status==="good"||n?.failingChecks.length===0)&&t!=="deviceTrustSuccess"?{action:"replace",data:{type:"deviceTrustSuccess",params:l}}:n?.device.status==="blocked"&&t!=="deviceTrustBlocking"?{action:"replace",data:{type:"deviceTrustBlocking",params:l}}:(n?.device.status==="will_block"||n?.device.status==="notify")&&t==="deviceTrustBlocking"&&aa(n.ignoredAt)?{action:"dismiss"}:(n?.device.status==="will_block"||n?.device.status==="notify")&&t!=="deviceTrustNonBlocking"&&t!=="deviceTrustNoKolide"&&ia(n.ignoredAt)?{action:"replace",data:{type:"deviceTrustNonBlocking",params:l}}:{action:"none"}},ta=(n,e,r,o,a,t)=>{let l=(0,ir.useContext)(q),_=(0,ir.useContext)(I),c=s=>{_.transitionOccurring&&_.transitionOccurring(s)};(0,ir.useEffect)(()=>{if(!r)return;let s=_t(e,{notificationConfig:{type:n,params:a},deviceHealth:o,locked:t});switch(s.action){case"replace":if(`${s.data.type}${e?.device.status}${n}`,_.notification){c(!0),p("delete-notifications-by-type",{type:n}).then(d=>{d.ok?p("show-notification",{type:s.data.type,params:s.data.params}).finally(()=>{c(!1)}):c(!1)}).catch(()=>{c(!1)});break}l.replaceNotification(r,{type:s.data.type,params:s.data.params});break;case"dismiss":if(`${e?.device.status}${n}${e?.ignoredAt}`,_.notification){p("delete-notifications-by-type",{type:n});break}l.hideNotification(r);break;case"none":`${e?.device.status}${n}`;break;default:mr(s,xr`notificationTransition`);break}},[n,e,r,l,a,o,t])};var ar=i(m()),An=({type:n})=>{let e=(0,te.useContext)(J),{locked:r}=Pn(e.locked),a=(0,te.useContext)(I).notification?.params,t=new URLSearchParams(window.location.search),l=t.get("notificationId"),_=Vr(a,t,"blockedPage"),c=Vr(a,t,"accountUuid"),s=Vr(a,t,"accountName"),{deviceHealth:d}=xe(),[u,x]=(0,te.useState)(d),y=(0,te.useMemo)(()=>({blockedPage:_,accountUuid:c,accountName:s}),[_,c,s]);if(ta(n,d,l,u,y,r),(0,te.useEffect)(()=>{!d&&u&&x(void 0),!Yi(d?.failingChecks,u?.failingChecks)&&!u&&x(d)},[l,d,u]),!c)return Xi(Ro("missing account uuid in notification rendering")),null;switch(n){case"deviceTrustBlocking":return(0,ar.jsx)(Mi,{accountUuid:c,initialDeviceHealth:u,setInitialDeviceHealth:x,blockedPage:_},n);case"deviceTrustNonBlocking":return(0,ar.jsx)(Zi,{accountUuid:c,initialDeviceHealth:u,setInitialDeviceHealth:x,blockedPage:_},n);case"deviceTrustSuccess":return(0,ar.jsx)(ra,{accountUuid:c},n);case"deviceTrustNoKolide":case"deviceTrustNeedsUnlock":return(0,ar.jsx)(Gi,{accountUuid:c,locked:r,cause:n,deviceHealth:d,blockedPage:_,accountName:s},n);default:return mr(n,xr`notificationType`),null}};var Dn=i(h());var qn=i(m()),Gr=({notificationType:n})=>{let e=(0,Dn.useContext)(b),r=(0,Dn.useContext)(q),o=(0,Dn.useContext)(J),[a,t]=(0,Dn.useState)("default"),l=(0,Dn.useContext)(I),_=d=>{switch(d){case"generatedPasswordUserOffline":return e("Connect to the internet and then try again.");case"generatedPasswordNoDefaultSavingLocation":return e("Contact support for help, and tell them it's a problem with the default account.");case"generatedPasswordNoVaultFound":return e("Contact support for help, and tell them it's a problem with the generated password vault.");case"generatedPasswordAccountIsLocked":return e("Your {accountName} account needs to be unlocked to fill this password. Unlock it and try again.",{accountName:a});case"generatedPasswordUnexpectedError":default:return e("We're unable to use the suggested password as an unexpected error occurred.")}},c=!(n==="generatedPasswordNotSignedIn"||o.connectivityStatus==="offlineAuthenticationFailed"),s=(0,Dn.useCallback)(()=>{p("lock",void 0),l.deleteNotification()},[l]);return(0,Dn.useEffect)(()=>{r.getDefaultAccountInfo().then(d=>{d&&t(d.name)})},[r]),(0,Dn.useEffect)(()=>{if(n==="generatedPasswordUserOffline"&&o.connectivityStatus==="networkOffline"){let d=()=>l.deleteNotification();return window.addEventListener("online",d),()=>{window.removeEventListener("online",d)}}},[l,n,o.connectivityStatus]),(0,qn.jsxs)(L,{type:n,title:e("Unable to fill password"),children:[c&&(0,qn.jsx)(E.Medium,{as:"p",children:_(n)}),(n==="generatedPasswordNotSignedIn"||n==="generatedPasswordUserOffline"&&o.connectivityStatus==="offlineAuthenticationFailed")&&(0,qn.jsxs)(qn.Fragment,{children:[(0,qn.jsx)(E.Medium,{as:"p",children:e("Try locking and then unlocking 1Password to fill again.")}),(0,qn.jsx)(g,{display:"flex",flexDirection:"row-reverse",gap:"medium",marginTop:"small",children:(0,qn.jsx)(C.Primary,{width:"full",onClick:s,children:e("Lock")})})]}),(n==="generatedPasswordNoDefaultSavingLocation"||n==="generatedPasswordNoVaultFound")&&(0,qn.jsx)(g,{display:"flex",flexDirection:"row-reverse",gap:"medium",marginTop:"small",children:(0,qn.jsx)(C.Primary,{width:"full",onClick:d=>{window.location.href="mailto:support@1password.com",d.preventDefault()},children:e("Contact Support")})})]})};var La=i(Le());var Y=i(h());var sa=i(h()),ct=()=>{let e=new URLSearchParams(window.location.search).get("maxNotificationHeight");if(!e)return 400;let r=parseInt(e,10);return isNaN(r)?400:r},mt=()=>document.getElementById("notification-title-bar")?.offsetHeight??0,la=()=>{let[n,e]=(0,sa.useState)(ct());return pn("max-notification-height-changed",r=>{e(r.newHeight)},[]),n-mt()};var _a=i(Le());var da={blurBackground:"Iv"};var ma=i(m()),ca=({fullscreenNotification:n})=>n?(0,ma.jsx)(fr,{className:(0,_a.default)({[da.blurBackground]:K[n.type].blurBackground})}):null;var dr=i(h());var ya=i(h());var wn=i(h());var Ke={nestedItemListHeader:"Ev",nestedItemListHeaderText:"Cv",nestedItemList:"Rv",nestedListItem:"oa",nestedListItemDetails:"__"};var Vn=i(m()),Kr=({icon:n,primaryText:e,secondaryText:r})=>(0,Vn.jsxs)("div",{className:Ke.nestedItemListHeader,children:[(0,Vn.jsx)(kn,{...n,size:"medium"}),(0,Vn.jsxs)("div",{className:Ke.nestedItemListHeaderText,children:[(0,Vn.jsx)(Qe,{component:"span",size:Ko.HeaderXs,children:e}),(0,Vn.jsx)(Qe,{color:Go.Secondary,children:r})]})]}),$r=({children:n})=>(0,Vn.jsx)("ul",{className:Ke.nestedItemList,children:n}),Yr=({action:n,icon:e,subtitle:r,title:o})=>(0,Vn.jsx)("li",{className:Ke.nestedListItem,children:(0,Vn.jsxs)("div",{className:Ke.nestedListItemDetails,children:[(0,Vn.jsx)(Yn,{icon:{...e,size:"medium"},label:o,secondaryLabel:r}),n]})});var Tn=i(m()),kt={config:void 0,canRequestUnlock:void 0,waitForUnlock:!1,error:!1};function gt(n,e){switch(e.type){case"config":return{...n,error:!1,config:e.data};case"can-request-unlock":return{...n,canRequestUnlock:e.data};case"wait-for-unlock":return{...n,waitForUnlock:e.data};case"error":return{...n,error:e.data};default:_e(e)}}var Xr=()=>{let[n,e]=(0,wn.useReducer)(gt,kt),r=(0,wn.useContext)(q),o=(0,wn.useContext)(J),a=(0,wn.useContext)(b),t=(0,wn.useContext)(I),l=(0,wn.useCallback)(()=>{e({type:"error",data:!1}),p("sign-in-with-cancel-session",void 0),t.deleteNotification()},[t]),_=(0,wn.useCallback)(async()=>{try{await p("sign-in-with-complete-session",void 0),t.deleteNotification()}catch{e({type:"error",data:!0})}},[t]);(0,wn.useEffect)(()=>{p("sign-in-with-save-configuration",void 0).then(d=>{d.ok?e({type:"config",data:d.data}):e({type:"error",data:!0})})},[]),(0,wn.useEffect)(()=>{let d=!1,u=async()=>{let x=await r.canRequestUnlock();d||e({type:"can-request-unlock",data:x})};return o.locked&&u(),()=>{d=!0}},[r,o.locked]),(0,wn.useEffect)(()=>{!o.locked&&n.waitForUnlock&&_()},[o.locked,n.waitForUnlock,_]);let c=_n("b5x-filling-saving-telemetry"),s=(0,wn.useCallback)(()=>{o.locked?(e({type:"wait-for-unlock",data:!0}),p("request-managed-unlock",void 0)):(c()&&p("record-click-event-first-account",{event:{componentType:"button",category:"login",source:"notification",componentName:"SOCIAL_LOGIN_SAVE"}}),_())},[o.locked,_,e,c]);return n.config?(0,Tn.jsxs)(L,{type:"saveSocialLogin",onClose:l,title:a("Save in 1Password?"),children:[(0,Tn.jsx)(Kr,{icon:n.config.providerIcon,primaryText:n.config.providerDisplayString,secondaryText:a("{provider} was used to sign in to:",{provider:""})}),(0,Tn.jsx)($r,{children:(0,Tn.jsx)(Yr,{action:(!o.locked||n.canRequestUnlock?.name==="yes")&&(0,Tn.jsx)(C.Primary,{onClick:s,disabled:n.error,children:o.locked&&n.canRequestUnlock?.name==="yes"?a("Unlock to Save"):a("Save item")}),icon:n.config.icon,title:n.config.title})}),n.error&&(0,Tn.jsx)(g,{paddingBlockStart:"large",children:(0,Tn.jsx)(on.Critical,{title:a("Failed to save item."),children:(0,Tn.jsx)(on.Content,{children:a("An unexpected error occurred. Please contact support@1password.com")})})}),o.locked&&n.canRequestUnlock?.name!=="yes"&&(0,Tn.jsx)(g,{paddingBlockStart:"large",children:(0,Tn.jsx)(on.Warning,{title:a("1Password is locked"),children:(0,Tn.jsx)(on.Content,{children:a("Press the 1Password icon in your browser's toolbar to unlock.")})})})]}):null};var jn=i(h());var Ie=i(m()),ut=n=>({MacOSX:n("Touch ID or Apple Watch"),Linux:n("system authentication"),Windows:n("Windows Hello")}),$e=({success:n})=>{let e=(0,jn.useContext)(b),r=(0,jn.useContext)(q),[o,a]=(0,jn.useState)(),t=(0,jn.useContext)(I),l=(0,jn.useCallback)(()=>{r.dismissShellPluginsNotification(!n),t.deleteNotification()},[r,n,t]),_=(0,jn.useCallback)(()=>{t.deleteNotification()},[r,t]),c=(0,jn.useCallback)(()=>{o&&(window.open(o.learnMoreUrl),t.deleteNotification())},[r,o,t]);if((0,jn.useEffect)(()=>{r.shellPluginsNotificationConfig(!n).then(a).catch(_)},[r,_,n]),!o)return null;let s=ut(e),d=n?e("{credentialName} saved in 1Password",{credentialName:o.credentialName}):e("1Password Shell Plugin available for {platformName}",{platformName:o.platformName}),u=n?e("Use 1Password to authenticate {platformName} CLI with {authType}.",{platformName:o.platformName,authType:s[o.operatingSystem]??s.Linux}):e("Store your {credentialName} in 1Password and authenticate {platformName} CLI with {authType}.",{platformName:o.platformName,credentialName:o.credentialName,authType:s[o.operatingSystem]??s.Linux});return(0,Ie.jsx)(L,{type:"sshOnboardingNextSteps",title:d,children:(0,Ie.jsxs)(gn,{gap:"medium",children:[(0,Ie.jsx)(E.Medium,{as:"p",children:u}),(0,Ie.jsxs)(g,{display:"flex",flexDirection:"row-reverse",gap:"medium",children:[(0,Ie.jsx)(C.Primary,{width:"full",onClick:c,children:e("Learn more\u2026")}),n?void 0:(0,Ie.jsx)(C.Secondary,{width:"full",onClick:l,children:e("Dismiss")})]})]})})};var Nn=i(h());var ee=i(m()),Jr=()=>{let[n,e]=(0,Nn.useState)(),[r,o]=(0,Nn.useState)(),a=(0,Nn.useContext)(q),t=(0,Nn.useContext)(J),l=(0,Nn.useContext)(b),_=(0,Nn.useContext)(I);(0,Nn.useEffect)(()=>{a.shellPluginsNotificationConfig(!1).then(o),a.canRequestUnlock().then(e)},[a,t.locked]);let c=(0,Nn.useCallback)(()=>{t.locked?p("request-managed-unlock",void 0):a.triggerItemSavingPrompt().then(()=>_.deleteNotification())},[a,t.locked,_]),s=(0,Nn.useCallback)(()=>{a.dismissShellPluginsNotification(!1),_.deleteNotification()},[a,_]);return!r||!n?null:(0,ee.jsx)(L,{type:"shellPlugins",title:l("Save in 1Password?"),children:(0,ee.jsxs)(gn,{gap:"medium",children:[(0,ee.jsxs)(E.Medium,{as:"label",children:[r.platformName," ",r.credentialName]}),!t.locked||n?.name==="yes"?(0,ee.jsxs)(g,{display:"flex",flexDirection:"row-reverse",gap:"medium",children:[(0,ee.jsx)(C.Primary,{width:"full",onClick:c,children:t.locked?l("Unlock to save"):l("Save item")}),!t.locked&&(0,ee.jsx)(C.Secondary,{width:"full",onClick:s,children:l("Dismiss")})]}):(0,ee.jsx)(on.Warning,{title:l("1Password is locked"),children:(0,ee.jsx)(on.Content,{children:l("Press the 1Password icon in your browser's toolbar to unlock.")})})]})})};var xa=i(h());var So=i(m()),Qr=()=>{let n=(0,xa.useContext)(b);return(0,So.jsx)(L,{type:"signInTo1Password",title:n("Sign in to 1Password"),children:(0,So.jsx)(Qe,{children:n("Please sign in to 1Password to keep yourself safe online and make it easy to save and fill your passwords.")})})};var Gn=i(h());var Be=i(m()),Zr=()=>{let n=(0,Gn.useContext)(b),e=(0,Gn.useContext)(q),r=(0,Gn.useContext)(I),[o,a]=(0,Gn.useState)(),t=(0,Gn.useCallback)(()=>{p("dismiss-ssh-onboarding",void 0),r.deleteNotification()},[r]),l=(0,Gn.useCallback)(()=>{e.sshOnboardingOnConfirm()},[e]);return(0,Gn.useEffect)(()=>{e.sshOnboardingNextStepsConfiguration().then(a).catch(t)},[e,t]),o?(0,Be.jsxs)(L,{type:"sshOnboardingNextSteps",onClose:t,title:n("Next step: Set up SSH Agent"),children:[(0,Be.jsx)(E,{as:"p",variant:"medium",children:o.isConnectedToOp8?n("SSH key created. To use this key locally, set up the 1Password SSH agent."):n("SSH key created. To use this key locally, set up the 1Password SSH Agent, available on 1Password 8.")}),(0,Be.jsx)("div",{children:(0,Be.jsx)("a",{href:o.learnMoreUrl,target:"_blank",rel:"noopener noreferrer",children:n("Learn more\u2026")})}),(0,Be.jsx)(v,{width:"full",paddingTop:"small",children:(0,Be.jsx)(C,{width:"full",variant:"primary",onClick:l,children:o.isConnectedToOp8?n("Set up SSH Agent"):n("Download 1Password 8")})})]}):null};var Hn=i(h());var no={multiSelectionContainer:"jv",itemSection:"Mx",lockBanner:"Lv",unstyledList:"qv"};var Cn=i(m()),eo=()=>{let[n,e]=(0,Hn.useState)(),r=(0,Hn.useContext)(J),o=(0,Hn.useContext)(I),a=(0,Hn.useContext)(b),t=(0,Hn.useCallback)(()=>{p("sign-in-with-prompt-configuration",void 0).then(c=>{if(!c.ok){console.error("[Sign in with] Failed to get configuration."),o.deleteNotification();return}if(c.data.accounts.length===0){o.deleteNotification();return}e(c.data)})},[o]);(0,Hn.useEffect)(()=>t(),[t]),(0,Hn.useEffect)(()=>{r.locked?e({accounts:[]}):t()},[t,r.locked]),pn("sign-in-with-button-detected",t,[]);let l=_n("b5x-filling-saving-telemetry"),_=(0,Hn.useCallback)(c=>{l()&&p("record-click-event-first-account",{event:{componentType:"button",category:"login",source:"notification",componentName:"SOCIAL_LOGIN_SIGNIN"}}),c.clickProvider&&p("sign-in-with-click-provider",c.clickProvider),o.deleteNotification()},[o,l]);return n?(0,Cn.jsx)(L,{type:"suggestSocialLogin",title:a("Sign in with\u2026"),children:(0,Cn.jsx)(g,{display:"flex",className:no.multiSelectionContainer,children:(0,Cn.jsx)(yn,{elevateOnScroll:"top",thin:!0,children:(0,Cn.jsxs)(gn,{gap:"small",children:[n.accounts.length>0&&(0,Cn.jsx)("ul",{className:no.unstyledList,children:n.accounts.map(c=>(0,Cn.jsxs)("li",{className:no.itemSection,children:[(0,Cn.jsx)(Kr,{icon:c.icon,primaryText:c.title,secondaryText:a("{item} is linked to:",{item:""})}),(0,Cn.jsx)($r,{children:c.items.map(s=>(0,Cn.jsx)(Yr,{action:(0,Cn.jsx)(Ae,{disabled:!s.clickProvider,mode:"primary",onClick:()=>_(s),"aria-label":a("Sign in using {title}: {subtitle}",{title:s.title??"",subtitle:s.subtitle??""}),children:a("Sign in")}),icon:s.icon,subtitle:s.subtitle,title:s.title},s.title+s.subtitle))})]},c.title))}),!r.locked&&n.accounts.length===0&&(0,Cn.jsx)(Mn,{icon:{id:"info",sources:[{type:"ThemedIcon",content:{file:Ln.Information}}]},role:"status",variant:"info",children:a("No items found to sign in with.")}),r.locked&&(0,Cn.jsx)(Mn,{icon:{id:"locked",sources:[{type:"ThemedIcon",content:{file:Ln.Lock}}]},role:"status",variant:"info",children:a("Press the 1Password icon in your browser's toolbar to unlock.")})]})})})}):null};var lr=i(h());var pa=i(h()),Ye=i(m()),Te=({type:n="generic",onAction:e})=>{let r=(0,pa.useContext)(b),o=n==="missing-item";return(0,Ye.jsx)(Mn,{icon:{id:"error-callout-banner-icon",sources:[{type:"ThemedIcon",content:{file:o?Ln.Information:Ln.Warning}}]},role:o?"status":"alert",variant:o?"info":"warning",children:(0,Ye.jsxs)(v,{alignItems:"flex-start",direction:"column",gap:"small",children:[(0,Ye.jsxs)(E,{as:"p",variant:"medium",color:o?"brand":"critical",children:[n==="timeout"&&r("The request to create a passkey timed out."),n==="missing-item"&&r("No passkeys found"),n!=="timeout"&&n!=="missing-item"&&r("1Password encountered a problem.")]}),n!=="missing-item"&&(0,Ye.jsx)(Ae,{mode:o?"accent":"destructiveAlt",onClick:()=>e(),children:r("Try Again")})]})})};var tn=i(h());var Xe=i(h());var ka=n=>n!==null&&typeof n=="object"&&"message"in n&&typeof n.message=="string",ga=!1,ro=(n,e,r,o)=>{let a=(0,Xe.useRef)(e),[t,l]=(0,Xe.useState)();return(0,Xe.useEffect)(()=>{let _=r?lo.assertLogSafe(r):void 0,c=ei(lo.assertLogSafe(n),{reqId:_,reconnect:o},l),s=d=>{a.current(d,c.postMessage)};return l(c),c.onMessage.addListener(s),()=>{c.onMessage.removeListener(s);try{c.disconnect()}catch{}}},[n,r,o]),{postMessage:_=>{try{if(`${n}`,_.type,!t)throw new Error("lost reference to port");t.postMessage(_)}catch(c){ka(c)&&ga?console.error(`port.postMessage of ${n} failed: ${c.message}`):console.error(`port.postMessage of ${n} failed: port has likely been disconnected`)}},close:()=>{try{if(!t)throw new Error("lost reference to port");t.disconnect()}catch(_){ka(_)&&ga?console.error(`port.close of ${n} failed: ${_.message}`):console.error(`port.close of ${n} failed: port has likely been disconnected`)}}}};var bt=n=>!!n&&typeof n=="object"&&"mediation"in n&&typeof n.mediation=="string";function ua(n,e){return bt(n)?n.mediation:(e??new URLSearchParams(window.location.search)).get("mediation")}function oo(n,e){return n?.id??e}var fa=i(h()),se=i(m()),io=({canRequestUnlock:n,type:e,onClick:r})=>{let o=(0,fa.useContext)(b);return(0,se.jsx)(se.Fragment,{children:(0,se.jsx)(Mn,{icon:{id:"unlock-callout-banner-icon",sources:[{type:"ThemedIcon",content:{file:Ln.Lock}}]},role:"status",variant:"info",children:n?(0,se.jsxs)(v,{alignItems:"flex-start",direction:"column",gap:"small",children:[(0,se.jsx)(E,{as:"p",variant:"medium",color:"brand",children:o(e==="save"?"To save a passkey, unlock 1Password first.":"To use your passkey, unlock 1Password first.")}),(0,se.jsx)(C.Primary,{onClick:r,children:o("Unlock 1Password")})]}):o("Select the 1Password icon in your browser's toolbar to unlock.")})})};var Kn=i(m()),ba=()=>{let n=(0,tn.useContext)(b),e=(0,tn.useContext)(J),r=(0,tn.useContext)(I),a=new URLSearchParams(window.location.search).get("notificationId"),[t,l]=(0,tn.useState)(e),_=oo(r.notification,a),{locked:c,requestUnlockStatus:s,wasLockedNowUnlocked:d,wasUnlockedNowLocked:u}=Pn(t.locked),[x,y]=(0,tn.useState)({state:"unset"}),[N,B]=(0,tn.useState)(),S=typeof N<"u",M=N==="timeout",A=x.state==="register-success"&&!S,k=!0,w=(0,tn.useCallback)(()=>{y(G=>G.state==="unset"?G:{state:"preview",preview:G.preview})},[]),P=(0,tn.useRef)(null),j=(0,tn.useCallback)(({type:G,data:X})=>{G==="locked-preview-passkey-data"&&y({state:"preview",preview:{username:X.username,title:X.title,icon:X.icon}}),G==="new-passkey-data"&&y(En=>{let le={username:X.username,title:X.title,icon:X.icon,vaults:X.vaultListElements,selectedVault:X.defaultSuggestedVaultId};return{state:"pending-update",preview:En?.preview,new:le}}),G==="passkey-register-success"&&(y({state:"register-success",preview:{username:X.username,title:X.title,icon:X.icon}}),P.current=setTimeout(V,3500)),G==="update-passkey-data"&&y(En=>({state:"hydrated",preview:En?.preview,new:En?.new,update:X})),G==="error"&&B(X.loggableReason),G==="b5x-unlocked"&&l(En=>({...En,locked:!1})),G==="b5x-locked"&&l(En=>({...En,locked:!0}))},[]),O=ro("passkey-save-prompt",j,_,k),V=(0,tn.useCallback)(()=>{O.close(),r.deleteNotification()},[O,r]),fn=(0,tn.useCallback)(()=>{p("request-managed-unlock",void 0)},[]);(0,tn.useEffect)(()=>{if(d){O.postMessage({type:"passkey-unlocked",data:{}});return}u&&(O.postMessage({type:"passkey-locked",data:{}}),w())},[O,w,d,u]),(0,tn.useEffect)(()=>{r.setAutoFocus&&r.setAutoFocus(!0)},[]);let dn=_n("b5x-filling-saving-telemetry"),U=(0,tn.useCallback)(G=>{try{dn()&&p("record-click-event-first-account",{event:{componentType:"button",category:"login",source:"notification",componentName:G}})}catch{console.error("[SavePasskey] Error reporting telemetry event.")}},[dn]),R=(0,tn.useCallback)(G=>{U("PASSKEY_SAVE"),O.postMessage({type:"new-passkey-save",data:{accountVaultUuid:G}})},[O,U]),H=(0,tn.useCallback)(G=>{U("PASSKEY_UPDATE"),O.postMessage({type:"update-passkey-save",data:{id:G}})},[O,U]);return(0,Kn.jsx)(L,{onClose:V,title:n(A?"Passkey saved":"Save passkey"),autoFocus:!0,type:"passkeySavePrompt",closeOnBackForwardCacheLoad:!k,actions:A?void 0:[{onClick:()=>{O.postMessage({type:"use-system-passkeys",data:{}}),V()},disabled:M,label:n("Use a security key or another passkey"),useTooltip:!M,icon:(0,Kn.jsx)(gr,{})}],children:(0,Kn.jsxs)(v,{direction:"column",gap:"medium",children:[A&&(0,Kn.jsx)(qr,{title:x.preview.title,username:x.preview.username,icon:x.preview.icon,rowEndElement:(0,Kn.jsx)(je,{color:"success"})}),x.state==="hydrated"&&!c&&(0,Kn.jsx)(Wr,{vaultItemRowProps:{rowEndElement:(0,Kn.jsx)(je,{color:S||c?"disabled":"attention"}),color:"attention"},isDisabled:S||c,updateableItems:x.update,newItem:x.new,onSave:R,onUpdate:H}),(c||x.state!=="hydrated"&&x.state!=="register-success")&&!S&&(0,Kn.jsx)(io,{canRequestUnlock:s?s==="connected":void 0,type:"save",onClick:fn}),S?(0,Kn.jsx)(Te,{onAction:V,type:N==="timeout"?"timeout":void 0}):null]})})};var Q=i(h());var ao=i(h());var tr={passkeyItem:"Tv",multiSelectionContainer:"Hv",optionsContainer:"Te",listButton:"Ox"};var $=i(m()),ha=({options:n,onSelect:e,onSubmit:r})=>{let o=(0,ao.useContext)(b),a=ur("--knox-background-attention")??void 0,t=ur("--knox-background-attention-hover")??void 0,l=ur("--knox-background-attention-pressed")??void 0,_=n.length===1,c=s=>(0,$.jsx)(Yn,{className:tr.passkeyItem,label:s.title,secondaryLabel:s.username,icon:{size:"medium",sources:s.icon.sources,id:s.icon.id,shape:s.icon.shape}});return(0,ao.useEffect)(()=>{_&&e(n[0].localId)},[_,e,n]),(0,$.jsx)($.Fragment,{children:_?(0,$.jsxs)(po,{gradient:"purple",borderColor:"neutral",children:[(0,$.jsx)(g,{paddingRight:"small",children:c(n[0])}),(0,$.jsx)(g,{flexShrink:"0",children:(0,$.jsx)(Vo,{variables:{button:{primary:{background:a,backgroundHover:t,backgroundPressed:l}}},children:(0,$.jsx)(C.Primary,{onClick:()=>r(n[0].localId),children:(0,$.jsx)(g,{paddingX:"xs",children:(0,$.jsxs)(v,{gap:"xs",padding:"hairline",children:[(0,$.jsx)(je,{color:"inverse"}),(0,$.jsx)(E.Medium,{color:"inverse",as:"span",children:o("Sign in")})]})})})})})]},n[0].localId):(0,$.jsx)(g,{display:"flex",className:tr.multiSelectionContainer,children:(0,$.jsx)(yn,{elevateOnScroll:"top",thin:!0,children:(0,$.jsx)("ul",{className:tr.optionsContainer,children:n.map(s=>(0,$.jsx)("li",{children:(0,$.jsx)("button",{className:tr.listButton,onClick:()=>r(s.localId),children:(0,$.jsxs)(po,{hoverGradient:"purple",children:[(0,$.jsx)(g,{paddingRight:"small",textAlign:"start",flexGrow:"1",width:"min-content",children:c(s)}),(0,$.jsxs)(v,{gap:"small",children:[(0,$.jsx)(je,{color:"attention"}),(0,$.jsx)(Ho,{color:"neutral"})]})]})})},s.localId))})})})})};var Ce=i(m()),va=()=>{let n=(0,Q.useContext)(J),e=new URLSearchParams(window.location.search),r=e.get("notificationId"),[o,a]=(0,Q.useState)(n),[t,l]=(0,Q.useState)(),[_,c]=(0,Q.useState)(),s=t==="timeout",[d,u]=(0,Q.useState)(),[x,y]=(0,Q.useState)(),N=(0,Q.useRef)(!1),B=(0,Q.useRef)(null),{locked:S,requestUnlockStatus:M,wasLockedNowUnlocked:A,wasUnlockedNowLocked:k}=Pn(o.locked),w=(0,Q.useContext)(b),P=!1,j=(0,Q.useContext)(I),V=ua(j.notification?.params,e)!=="conditional",fn=j.notification,dn=oo(fn,r),U=ro("passkey-signin-prompt",f=>{f.type==="sign-in-with-passkey"&&u(f.data.options),f.type==="sign-in-success"&&X(),f.type==="error"&&(f.data.loggableReason==="missing-item"?c(f.data.loggableReason):l(f.data.loggableReason)),f.type==="b5x-unlocked"&&a(W=>({...W,locked:!1})),f.type==="b5x-locked"&&(c(void 0),u(void 0),a(W=>({...W,locked:!0})))},dn,P),R=(0,Q.useCallback)(()=>{p("request-managed-unlock",void 0)},[]),H=_n("b5x-filling-saving-telemetry"),G=(0,Q.useCallback)(f=>{H()&&p("record-click-event-first-account",{event:{componentType:"button",category:"login",source:"notification",componentName:"PASSKEY_SIGNIN"}}),U.postMessage({type:"select-passkey-item",data:{localId:f}})},[U,H]),X=(0,Q.useCallback)(()=>{U.close(),j.deleteNotification()},[U,j]),En=(0,Q.useCallback)(()=>{if(!N.current){if(S){R();return}typeof x=="number"&&(G(x),X())}},[S,R,G,x,X]);(0,Q.useEffect)(()=>{k&&U.postMessage({type:"passkey-locked",data:{}})},[U,k]),(0,Q.useEffect)(()=>{A&&(U.postMessage({type:"passkey-unlocked",data:{}}),N.current=!1)},[U,A]),(0,Q.useEffect)(()=>{let f=V||A||!!d;j.autoFocus!==f&&j.setAutoFocus&&j.setAutoFocus(f)},[V,A,d,j]);let le=(0,Q.useCallback)(f=>{if(f.key==="Tab"){N.current=!0;return}f.key==="Enter"&&En()},[En]);return(0,Q.useEffect)(()=>{let f=B.current;if(f!==null)return f.addEventListener("keydown",le),()=>{f!==null&&f.removeEventListener("keydown",le)}},[le]),(0,Ce.jsxs)(L,{onClose:X,type:"passkeySigningIn",closeOnBackForwardCacheLoad:!P,autoFocus:V||A||!!d,actions:[{onClick:()=>{U.postMessage({type:"use-system-passkeys",data:{}}),X()},label:w("Use a security key or another passkey"),disabled:s,useTooltip:!s,icon:(0,Ce.jsx)(gr,{})}],title:w("Sign in with a passkey"),ref:B,paddingStyle:!t&&!S&&d&&d?.length>1?"unset":void 0,children:[!t&&!_&&(S||!d||d.length===0)?(0,Ce.jsx)(io,{canRequestUnlock:M==="connected",type:"use",onClick:R}):null,!t&&!S&&d&&(0,Ce.jsx)(ha,{options:d,onSelect:y,onSubmit:G}),!t&&!S&&_?(0,Ce.jsx)(Te,{onAction:X,type:_==="missing-item"?_:void 0}):null,t?(0,Ce.jsx)(Te,{onAction:X,type:t==="timeout"?t:void 0}):null]})};var sr=i(m()),Ee=({type:n})=>{let e=(0,lr.useContext)(q),r=(0,lr.useContext)(b),a=new URLSearchParams(window.location.search).get("notificationId"),t=(0,lr.useCallback)(()=>{e.hideNotification(a??void 0)},[e,a]);switch(n){case"register":return(0,sr.jsx)(ba,{},n);case"signingin":return(0,sr.jsx)(va,{},n);case"generic_error":return(0,sr.jsx)(L,{type:"passkeyGenericError",title:r("Something went wrong"),closeOnBackForwardCacheLoad:!0,children:(0,sr.jsx)(Te,{type:"generic",onAction:t})},n)}};var Un=i(h());var wa="/assets/png/password-I65M5ZVL.png";var zn=i(m()),to=()=>{let n=(0,Un.useContext)(b),e=new URLSearchParams(window.location.search),r=(0,Un.useContext)(J),o=(0,Un.useContext)(I),a=o.notification?o.notification.params.itemUuid:e.get("itemUuid")||"",{wasUnlockedNowLocked:t,wasLockedNowUnlocked:l}=Pn(r.locked),[_,c]=(0,Un.useState)(),s=(0,Un.useCallback)(()=>{p("get-item-summary",{itemUuid:a}).then(u=>{u.ok&&c(u.data)})},[]);(0,Un.useEffect)(()=>{s()},[]),(0,Un.useEffect)(()=>{t&&c(void 0),l&&s()},[t,l]);let d=(0,Un.useCallback)(()=>{p("record-click-event-all-accounts",{event:{componentType:"button",category:"item",source:"notification",componentName:"WATCHTOWER_CHANGE_PASSWORD"}}),_&&_.localId&&p("watchtower-change-password",{itemId:{type:"databaseId",data:_.localId}}),o.deleteNotification()},[o,_]);return(0,zn.jsxs)(L,{type:"watchtowerBreachDetected",title:n("Change this compromised password"),children:[(0,zn.jsxs)(v,{wrap:"nowrap",alignItems:"center",gap:"medium",children:[(0,zn.jsx)(E,{as:"p",variant:"medium",children:n("A security breach on this website has put your current password at risk.")}),(0,zn.jsx)("img",{src:wa,height:"48px",alt:""})]}),_&&(0,zn.jsxs)(v,{borderWidth:"1px",borderStyle:"solid",borderColor:"neutralWeak",borderRadius:"medium",padding:"small",marginTop:"small",gap:"small",alignItems:"center",children:[(0,zn.jsx)(kn,{size:"medium",shape:To.RoundedRect,sources:_.icon}),(0,zn.jsxs)(g,{children:[(0,zn.jsx)(E,{as:"p",variant:"medium",children:_.title}),(0,zn.jsx)(E,{as:"label",variant:"small",children:_.ainfo})]}),(0,zn.jsx)(g,{marginLeft:"auto",children:(0,zn.jsx)(Ae,{mode:"primary",onClick:d,children:n("Change now")})})]})]})};var sn=i(m()),Sa=()=>{let n=(0,ya.useContext)(I);if(!n.notification)return null;switch(n.notification.type){case"autosave":return(0,sn.jsx)(Mr,{});case"autosaveTotp":return(0,sn.jsx)(Ur,{});case"addAccount":return(0,sn.jsx)(Tr,{});case"suggestSocialLogin":return(0,sn.jsx)(eo,{});case"shellPlugins":return(0,sn.jsx)(Jr,{});case"shellPluginsSuccess":return(0,sn.jsx)($e,{success:!0});case"shellPluginsFallback":return(0,sn.jsx)($e,{});case"sshOnboardingNextSteps":return(0,sn.jsx)(Zr,{});case"signInTo1Password":return(0,sn.jsx)(Qr,{});case"generatedPasswordUserOffline":case"generatedPasswordNoDefaultSavingLocation":case"generatedPasswordAccountIsLocked":case"generatedPasswordNotSignedIn":case"generatedPasswordNoVaultFound":case"generatedPasswordUnexpectedError":return(0,sn.jsx)(Gr,{notificationType:n.notification.type});case"saveSocialLogin":return(0,sn.jsx)(Xr,{});case"watchtowerBreachDetected":return(0,sn.jsx)(to,{});case"passkeyGenericError":return(0,sn.jsx)(Ee,{type:"generic_error"});case"deviceTrustNonBlocking":return(0,sn.jsx)(An,{type:"deviceTrustNonBlocking"});case"passkeySigningIn":return(0,sn.jsx)(Ee,{type:"signingin"});case"passkeySavePrompt":return(0,sn.jsx)(Ee,{type:"register"});case"deviceTrustSuccess":return(0,sn.jsx)(An,{type:"deviceTrustSuccess"});case"deviceTrustBlocking":return(0,sn.jsx)(An,{type:"deviceTrustBlocking"});case"deviceTrustNoKolide":return(0,sn.jsx)(An,{type:"deviceTrustNoKolide"});case"deviceTrustNeedsUnlock":return(0,sn.jsx)(An,{type:"deviceTrustNeedsUnlock"});default:return null}};var _r=i(m()),Io=()=>{let n=(0,dr.useContext)(b),e=(0,dr.useContext)(I);return!e.notification||!e.totalNotifications||!e.maxScrollableNotifications?null:(0,_r.jsxs)(dr.Fragment,{children:[e.orderInStack===2&&!e.stackCollapsed&&!e.isCollapseDisabled&&e.totalNotifications>e.maxScrollableNotifications&&(0,_r.jsx)(g,{display:"flex",justifyContent:"center",className:re.collapseButton,borderRadius:"large",boxShadow:"topLedge",onClick:e.onCollapse,"data-testid":"collapse-button",children:n("Collapse all")}),(0,_r.jsx)(Sa,{})]},e.notification.id)};var Ia=i(h()),Ca=i(m()),Ba=({children:n,onResize:e})=>{let[r,o]=De();return(0,Ia.useEffect)(()=>{r&&e&&e({height:r.height})},[r]),(0,Ca.jsx)("div",{ref:o,children:n})};var Ea=(n,e=24)=>Array.from(n.values()).reduce((o,a)=>o+a,0)+n.size*e;var Ra={initial:{opacity:0},animate:n=>({opacity:1,x:0,y:0,transition:{opacity:{duration:.6,ease:"easeOut",delay:n*.2},x:{x:{keyframes:["100%","0px"]},duration:.6,ease:"easeOut",delay:n*.4},y:{duration:.6,ease:[.4,0,.2,1],times:[0,.6,1],keyframes:["15px","25px","0px"],delay:n*.4}}}),exit:{opacity:0}},Ta=(n,e,r)=>{if(r.length===0)return[];let o=e.length>0?so(e[0].type):Number.MAX_SAFE_INTEGER,t=Math.min(...r.map(l=>so(l.type)))<=o;return n.length===0?[0,1,2]:t?[]:[2]},so=n=>K[n]?.priority??5,Bo=n=>[...n].sort((e,r)=>{let o=so(e.type),a=so(r.type);return o===a?new Date(r.created).getTime()-new Date(e.created).getTime():o-a}),Na=(n,e)=>{let r=n.map(l=>l.id),o=e.filter(l=>!r.includes(l.id)),a=e.filter(l=>r.includes(l.id)),t=Bo(a);return{newNotifications:o,previousNotificationsSorted:t,currentNotifications:r}};var za=(n,e)=>{switch(e.type){case"hydrate":return Bo(e.data);case"delete":return n.filter(r=>!e.data.includes(r.id));default:return n}};var xn=i(m()),Je=3,yt=300,Pa=()=>{let n=(0,Y.useContext)(b),[e,r]=(0,Y.useReducer)(za,[]),o=la(),[a,t]=(0,Y.useState)(!0),[l,_]=(0,Y.useState)(!1),[c,s]=(0,Y.useState)([0,1,2]),d=(0,Y.useRef)(null),[u,x]=(0,Y.useState)(0),y=(0,Y.useRef)(new Map),[N,B]=(0,Y.useState)(0),[S,M]=(0,Y.useState)(void 0),A=_n("b5x-filling-saving-telemetry"),[k,w]=(0,Y.useState)({}),[P,j]=(0,Y.useState)(new Set),O=e.filter(f=>K[f.type].disableCollapse).length>0,[V,fn]=(0,Y.useState)(!1),[dn,U]=(0,Y.useState)(!1),R=e.length>Je&&!O&&!dn,H=()=>{B(Ea(y.current))},G=async()=>p("hydrate-notifications",void 0).then(f=>{if(f.ok){if(e===f.data)return;X(f.data);let{newNotifications:W,previousNotificationsSorted:Z,currentNotifications:de}=Na(e,f.data);W.length>0&&s(Ta(de,Z,W)),f.data.filter(Da=>K[Da.type].disableCollapse).length>0&&U(!0),r({type:"hydrate",data:f.data})}else console.error("Unable to retrieve notifications")}).catch(()=>{console.error("Unable to retrieve notifications")}),X=async f=>{let W=f.filter(Z=>K[Z.type].fullscreen);W.length!==0&&(await p("set-fullscreen-notification",{enabled:!0}),M(W[0]),U(!0),K[W[0].type].blockPageElements&&p("set-page-inert",{enabled:!0}))},En=async()=>{S&&(M(void 0),await p("set-fullscreen-notification",{enabled:!1}),K[S.type].blockPageElements&&await p("set-page-inert",{enabled:!1}),e.length>0&&X(e))},le=(0,Y.useCallback)((f,W)=>{j(Z=>new Set(Z).add(f)),p("delete-notification",{id:f}).then(Z=>{Z.ok&&(p("clear-notifications",{ids:[f]}),A()&&wi({componentType:"button",category:"app",source:"notification",componentName:`NOTIFICATION_DISMISS_${W}`}))}),setTimeout(()=>{y.current.delete(f),H(),r({type:"delete",data:[f]}),j(Z=>{let de=new Set(Z);return de.delete(f),de})},yt)},[A]);return(0,Y.useEffect)(()=>void G().finally(()=>t(!1)),[]),(0,Y.useEffect)(()=>{a||(S&&e.filter(f=>K[f.type].fullscreen).length===0&&En(),e.length===0&&!V&&p("remove-notification-frame",void 0),w(f=>{let W={...f};for(let Z of e)W[Z.id]===void 0&&(W[Z.id]=K[Z.type]?.autoFocus??!1);return W}))},[e]),(0,Y.useLayoutEffect)(()=>{d.current&&window.requestAnimationFrame(()=>{let f=d.current?.offsetHeight??0;f&&f!==u&&x(f)})},[R,e]),pn("rehydrate-notifications",()=>{G()},[e]),pn("clear-notifications",f=>{r({type:"delete",data:f.ids})},[]),(0,xn.jsxs)(xn.Fragment,{children:[(0,xn.jsx)(ca,{fullscreenNotification:S}),(0,xn.jsx)(Br,{type:"notificationManager",title:n("Notifications"),"aria-label":n("Notifications"),children:(0,xn.jsxs)(g,{className:(0,La.default)(re.notificationScroller,{[re.notificationStack]:R}),"data-testid":R?"notification-stack":"notification-scroller",onKeyDown:f=>{R&&e.length>Je&&!O&&(f.key==="ArrowDown"||f.key==="Down")?U(!0):e.length>Je&&!O&&(f.key==="ArrowUp"||f.key==="Up")&&U(!1)},...!R&&{style:{height:Math.min(N,o),overflowY:N<o?"hidden":"scroll"}},onMouseEnter:()=>_(!0),onMouseLeave:()=>_(!1),children:[R?(0,xn.jsx)(qe,{children:e.slice(0,Je).map((f,W)=>(0,xn.jsx)(pr.div,{variants:Ra,custom:W,initial:"initial",animate:c.includes(W)?"animate":{opacity:1,x:0,y:0},style:{marginTop:W>0?-u:0,zIndex:e.length-W,position:"relative",scale:1-W*.05},ref:W===0?d:void 0,children:W===0?(0,xn.jsx)(nr,{state:{notification:f,deleteNotification:()=>le(f.id,f.type),stackCollapsed:R,orderInStack:W+1,totalNotifications:e.length,maxScrollableNotifications:Je,onCollapse:()=>{U(!1)},autoFocus:k[f.id]??!1,setAutoFocus:Z=>w(de=>({...de,[f.id]:Z})),markedForDismissal:P.has(f.id),fullscreenNotification:S,isCollapseDisabled:O,transitionOccurring:Z=>fn(Z)},children:(0,xn.jsx)(Io,{},f.id)}):(0,xn.jsx)(g,{"data-testid":"stacked-notification",className:re.expandedNotification,style:{height:`${u-10}px`},borderRadius:"medium",boxShadow:"low",role:"alert"},f.id)},W===2?f.id:W))}):e.slice(0,e.length).map((f,W)=>(0,xn.jsx)(nr,{state:{notification:f,deleteNotification:()=>le(f.id,f.type),stackCollapsed:R,orderInStack:W+1,totalNotifications:e.length,maxScrollableNotifications:Je,onCollapse:()=>{U(!1)},autoFocus:k[f.id]??!1,setAutoFocus:Z=>w(de=>({...de,[f.id]:Z})),markedForDismissal:P.has(f.id),fullscreenNotification:S,isCollapseDisabled:O,transitionOccurring:Z=>fn(Z)},children:(0,xn.jsx)(Ba,{onResize:({height:Z})=>{y.current.set(f.id,Z),H()},children:(0,xn.jsx)(Io,{},f.id)})},f.id)),R&&l&&(0,xn.jsx)(g,{marginTop:"medium",className:re.expandButton,borderRadius:"large",style:{zIndex:e.length+1},children:(0,xn.jsx)(C.Secondary,{onClick:()=>{U(!0)},"data-testid":"expand-button",children:n("View all")})})]})})]})};import St from"/assets/js/messages.i18n-BK2XZ27E.js";var Aa=()=>{No(3),bn("app-theme-changed",hn("app-theme-changed")),bn("update-connectivity-status",hn("update-connectivity-status")),bn("lock-state-changed",hn("lock-state-changed")),bn("accounts-and-vaults-changed",hn("accounts-and-vaults-changed")),bn("device-health-changed",hn("device-health-changed")),bn("device-trust-connected",hn("device-trust-connected")),bn("language-changed",hn("language-changed")),bn("can-request-unlock-changed",hn("can-request-unlock-changed")),bn("max-notification-height-changed",hn("max-notification-height-changed")),bn("refresh-notification",hn("refresh-notification")),bn("rehydrate-notifications",hn("rehydrate-notifications")),bn("clear-notifications",hn("clear-notifications")),bn("sign-in-with-button-detected",hn("sign-in-with-button-detected")),bn("notification-exiting",hn("notification-exiting"))};var D=i(m());document.addEventListener("DOMContentLoaded",()=>{Aa(),(0,qa.createRoot)(document.getElementById("root")).render((0,D.jsx)(ti,{bridge:new si(ri()),children:(0,D.jsx)(ai,{children:(0,D.jsx)(It,{})})}))});var It=()=>{let n=(0,Ne.useContext)(J),e=(0,Ne.useContext)(q),o=new URLSearchParams(window.location.search).get("notificationId")??void 0,a=(0,Ne.useRef)(null);return(0,Ne.useEffect)(()=>{let t=hr(window.location.hash);t!==a.current&&(a.current=t,document.body.setAttribute("data-notification-type",K[t].fullscreen?"fullscreen":"autosized"),t==="notificationManager"&&(document.body.style.backgroundColor="transparent"))}),(0,D.jsx)(Ao,{themeOverride:n.appTheme,children:(0,D.jsx)(Qo,{children:(0,D.jsx)(Jo,{children:(0,D.jsx)(Xo,{children:(0,D.jsx)(Zo,{locale:n.locale,messages:St,children:(0,D.jsx)(nr,{state:{deleteNotification:()=>{e.hideNotification(o)}},children:(0,D.jsx)(mi,{notificationId:o,children:Bt})})})})})})})},Bt=n=>{switch(n){case"addAccount":return(0,D.jsx)(Tr,{});case"autosave":return(0,D.jsx)(Mr,{});case"autosaveTotp":return(0,D.jsx)(Ur,{});case"passkeySavePrompt":return(0,D.jsx)(Ee,{type:"register"});case"passkeySigningIn":return(0,D.jsx)(Ee,{type:"signingin"});case"passkeyGenericError":return(0,D.jsx)(Ee,{type:"generic_error"});case"saveSocialLogin":return(0,D.jsx)(Xr,{});case"sshOnboardingNextSteps":return(0,D.jsx)(Zr,{});case"shellPlugins":return(0,D.jsx)(Jr,{});case"shellPluginsSuccess":return(0,D.jsx)($e,{success:!0});case"shellPluginsFallback":return(0,D.jsx)($e,{});case"suggestSocialLogin":return(0,D.jsx)(eo,{});case"signInTo1Password":return(0,D.jsx)(Qr,{});case"watchtowerBreachDetected":return(0,D.jsx)(to,{});case"generatedPasswordUserOffline":case"generatedPasswordNoDefaultSavingLocation":case"generatedPasswordAccountIsLocked":case"generatedPasswordNotSignedIn":case"generatedPasswordNoVaultFound":case"generatedPasswordUnexpectedError":return(0,D.jsx)(Gr,{notificationType:n});case"deviceTrustBlocking":return(0,D.jsx)(An,{type:"deviceTrustBlocking"});case"deviceTrustNonBlocking":return(0,D.jsx)(An,{type:"deviceTrustNonBlocking"});case"deviceTrustSuccess":return(0,D.jsx)(An,{type:"deviceTrustSuccess"});case"deviceTrustNoKolide":return(0,D.jsx)(An,{type:"deviceTrustNoKolide"});case"deviceTrustNeedsUnlock":return(0,D.jsx)(An,{type:"deviceTrustNeedsUnlock"});case"notificationManager":return(0,D.jsx)(Pa,{});default:_e(n)}};

//# debugId=255e5c2a-d918-5008-9d92-c44012471827
