(self.webpackChunk=self.webpackChunk||[]).push([[9888],{9888:(e,t,s)=>{s.r(t),s.d(t,{activate:()=>y});var n=s(90023),i=s(32073),a=s(59179),r=s(78129),c=s(84308),o=s(84714),d=s(90572),u=s(29416),p=s(63532),l=s(20161),b=s(28338),v=s(77115),h=s(74841),k=s(31846),S=s(5272),A=s(97594),f=s(54942),g=s(79593),w=(e,t)=>(t=Symbol[e])?t:Symbol.for("Symbol."+e),m=e=>{throw TypeError(e)};const y=e=>{return t=void 0,s=[e],y=function*({bus:e,capiConnectionStatus:t,agentGenericService:s,pushedContentService:y,experimentation:C,document:x,navigation:I,fileUploadService:E,trackingServiceProvider:P}){var R=[];try{const K=((e,t,s)=>{var n;return null!=t?("object"!=typeof t&&"function"!=typeof t&&m("Object expected"),s&&(n=t[w("asyncDispose")]),void 0===n&&(n=t[w("dispose")]),"function"!=typeof n&&m("Object not disposable"),e.push([s,n,t])):s&&e.push([s]),t})(R,new DisposableStack),T=K.adopt(new i.w0,(e=>e.unsubscribe())),_=K.use(e.state.agentState.create(x.id,{kind:h.x.State.Kind.Initial})),j=K.use(e.state.audience.create(x.id,null)),D=K.use(e.state.capiSessionId.create(x.id,null)),G=K.use(e.state.textInfo.create(x.id,{wordsCount:0,charsCount:0})),z=K.use(e.state.hasTextChanges.create(x.id,!1)),B=G.pipe(a.U((e=>e.charsCount)),r.G(),a.U((([e,t])=>t-e))),M=C.isAssigned(A.cV)?c.a([B,I.isPanelOpen],((e,t)=>t&&Math.abs(e)>g.tK)):o.of(!1),Z=k.z.create({agentGenericService:s,pushedContentService:y,fileUploadService:E,agentId:S.Qi.Id}),F=K.adopt(h.x.create({capiSessionId:D.view((e=>null!=e?e:void 0)),agenticService:Z,trackingServiceProvider:P,textInfo:G,textChanged:M,featureFlags:{customAudiences:C.isAssigned(A.bI),removeCustomAudiences:C.isAssigned(A.kz)}}),(e=>e.dispose())),L=t.pipe(a.U((e=>"connected"===e.kind?e:null)),d.h(v.C_));return T.add(F.state.subscribe((e=>_.set(e)))),T.add(F.audience.subscribe((e=>j.set(null!=e?e:null)))),T.add(L.subscribe((e=>D.set(e.sessionId)))),T.add(x.textInfo.pipe(d.h(v.C_)).subscribe((e=>G.set({wordsCount:e.wordCount,charsCount:e.charCount})))),T.add(F.hasTextChanges.subscribe((e=>z.set(e)))),T.add(e.events.trackingEvent.view(x.id).subscribe((e=>F.context.tracking.trackEvent(e.event,e.detail)))),C.isAssigned(A.l0)&&T.add(y.rebaseItems(f.Z).subscribe()),T.add(c.a([G,F.state,I.isPanelOpen],((e,t,s)=>s&&t.kind===h.x.State.Kind.Empty&&e.wordsCount>h.x.MIN_WORDS_TEXT_SIZE)).pipe(d.h(n.yR),u.b(100),d.h((()=>F.state.get().kind===h.x.State.Kind.Empty)),p.b((()=>F.loadReactions()))).subscribe()),T.add(L.pipe(l.w((e=>c.a([F.state,I.isPanelOpen],((e,t)=>t&&e.kind===h.x.State.Kind.Initial)).pipe(d.h(n.yR),u.b(100),p.b((()=>F.loadReactions())))))).subscribe()),T.add(e.events.panelUIAction.view(x.id).subscribe((e=>{switch(e.kind){case"loadReactionsAction":F.loadReactions();break;case"selectAudienceAction":F.selectAudience();break;case"setAudienceAction":F.setAudience(e.audience);break;case"editAudienceAction":F.editAudience();break;case"saveAudienceAction":F.saveAudience(e.name);break;case"removeAudienceAction":F.removeAudience(e.audience);break;case"goBackAction":F.goBack();break;default:(0,b.L0)(e)}}))),K.move()}catch(e){var O=e,U=!0}finally{((e,t,s)=>{var n="function"==typeof SuppressedError?SuppressedError:function(e,t,s,n){return(n=Error(s)).name="SuppressedError",n.error=e,n.suppressed=t,n},i=e=>t=s?new n(e,t,"An error was suppressed during disposal"):(s=!0,e),a=n=>{for(;n=e.pop();)try{var r=n[1]&&n[1].call(n[2]);if(n[0])return Promise.resolve(r).then(a,(e=>(i(e),a())))}catch(e){i(e)}if(s)throw t};a()})(R,O,U)}},new Promise(((e,n)=>{var i=e=>{try{r(y.next(e))}catch(e){n(e)}},a=e=>{try{r(y.throw(e))}catch(e){n(e)}},r=t=>t.done?e(t.value):Promise.resolve(t.value).then(i,a);r((y=y.apply(t,s)).next())}));var t,s,y}}}]);