var SS_Util=TrendMicro.TB.SAFESEARCHING;function foundImageCallback(e){TMExt_debug(e);var t=TMExt_$(e.FindInsertNode()).parent(),l=t.find("a").eq(0),n=l.find("img").eq(0);t.attr("link_level",e.level),SS_Util.isNeedToBlock(e.level)?(TMExt_debug("==========================BLOCK THE ABOVE ONE==================================="),SS_Util.checkImageBlockPopupExist(),l.css("display","inline"),n.hide(),SS_Util.setBlockImage(t),SS_Util.bindMouseEnterEvent(t)):TMExt_debug("the image level is "+e.level+", no need to block (level 8 is parent control category)")}var getParamFromURL_yahoo_fr=function(e,t){try{var l=e;if("string"==typeof l&&l.length>0)for(var n=l.split("/"),a=0;a<n.length;a++){var r=n[a].split("=");if(r[0]==t)return r[1]}return null}catch(e){return null}};function getRealUrl(e){try{var t=SS_Util.getParamFromURL(e,"rurl")||getParamFromURL_yahoo_fr(e,"RU");return decodeURIComponent(t)}catch(t){return e}}function TSSRParseResult_Image(e){var t,l=new CreateTSRLocatedObject(null,null,"a",null),n=new CreateTSRLocatedObject(null,l,"LI",null),a=new CreateTSRLocatedObject(e,n,"UL","sres");if(n.multiMatches=!0,n.appendAttribute("class","ld"),t=a.findElement())for(var r=GetAllTSRLocatedNodes(t),i=0;i<r.length;i++){var o=getRealUrl(r[i].href);o&&CreateTSRResultObject(r[i],o,null,null,null,null,foundImageCallback)}}function foundImageCallbackBasic(e){TMExt_debug(e);var t=TMExt_$(e.FindInsertNode()).parent(),l=t.find("a").eq(0),n=l.find("img").eq(0);t.attr("link_level",e.level),SS_Util.isNeedToBlock(e.level)?(TMExt_debug("==========================BLOCK THE ABOVE ONE==================================="),SS_Util.checkImageBlockPopupExist(),l.css("display","inline"),n.hide(),SS_Util.setBlockImage(t),SS_Util.bindMouseEnterEvent(t)):TMExt_debug("the image level is "+e.level+", no need to block (level 8 is parent control category)")}function getRealUrlBaic(e){try{var t=TMExt_$(e).parent().find("a").eq(0).find("img").eq(0).attr("rel"),l=t.substr(t.indexOf("**")+2),n=l.substr(l.indexOf("**")+2);return n.substr(0,n.indexOf("?"))}catch(e){return null}}function TSSRParseResult_ImageBasic(e){var t,l=new CreateTSRLocatedObject(null,null,"a",null),n=new CreateTSRLocatedObject(null,l,"DIV",null),a=new CreateTSRLocatedObject(e,n,"DIV","gridlist");if(n.multiMatches=!0,n.appendAttribute("class","gridmodule"),t=a.findElement())for(var r=GetAllTSRLocatedNodes(t),i=0;i<r.length;i++){var o=getRealUrlBaic(r[i]);o&&CreateTSRResultObject(r[i],o,null,null,null,null,foundImageCallbackBasic)}}function TSRParse(){var e=g_oEnv.Parser.iResultNumber;return TSSRParseResult_Image(document),TSSRParseResult_ImageBasic(document),TrendMicro.TB.ReduceNewNode(e+1),g_oEnv.Parser.rgobjSearchResult}TSRTagFlowID(),TMExt_debug("URL matched, start safe searching function"),TMExt_$(window).resize(function(){SS_Util.refreshBlockImages()});