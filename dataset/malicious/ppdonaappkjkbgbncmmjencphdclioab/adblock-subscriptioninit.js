SubscriptionInit=function(){"use strict";var t,r=require("subscriptionClasses").Subscription,e=require("subscriptionClasses").DownloadableSubscription,i=require("subscriptionClasses").SpecialSubscription,n=require("filterStorage").FilterStorage,s=require("filterNotifier").FilterNotifier,o=require("prefs").Prefs,u=require("synchronizer").Synchronizer,a=require("utils").Utils;require("notificationHelper").initNotifications;function c(){t=n.firstRun&&!o.suppress_first_run_page}function l(){var s=[];if(t){var u=r.fromURL("https://cdn.adblockcdn.com/filters/adblock_custom.txt");s.push(u);var c=r.fromURL("https://cdn.adblockcdn.com/filters/nominers.txt");s.push(c)}return function(){for(var t=0;t<n.subscriptions.length;++t){var r=n.subscriptions[t];if(r instanceof e&&r.url!=o.subscriptions_exceptionsurl&&r.url!=o.subscriptions_antiadblockurl)return!1;if(r instanceof i&&r.filters.length>0)return!1}return!0}()?fetch("adblock-subscriptions.xml").then((function(t){return t.text()})).then((function(t){var e=(new DOMParser).parseFromString(t,"application/xml").getElementsByTagName("subscription"),i=a.chooseFilterSubscription(e);if(i){var n=i.getAttribute("url"),o=i.getAttribute("title");if(n&&"EasyList"!==o){var u=r.fromURL(n);u.disabled=!1,u.title=o,u.homepage=i.getAttribute("homepage"),s.push(u);var c=i.getAttribute("requires");if(c)for(var l=0;l<e.length;l++){var f=e[l];if(c===f.getAttribute("title")&&f.getAttribute("url")){var p=r.fromURL(f.getAttribute("url"));p.disabled=!1,p.title=f.getAttribute("title"),p.homepage=f.getAttribute("homepage"),s.push(p)}}}}return s})):s}function f(t){for(var r=0;r<t.length;++r){var i=t[r];n.addSubscription(i),i instanceof e&&!i.lastDownload&&u.execute(i)}}var p={init:function(){Promise.all([s.once("load"),o.untilLoaded]).then(c).then(l).then(f)}};return p}();