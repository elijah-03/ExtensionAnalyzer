"use strict";
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="13c38454-263a-5c53-b1ec-2dff5047f685")}catch(e){}}();
(self.webpackChunk_loomhq_chrome_extension=self.webpackChunk_loomhq_chrome_extension||[]).push([[16384],{2967:(e,t,n)=>{n.d(t,{c:()=>A});var r=n(63101),o=n(42685),i=n(79214),a=n(75418),c=n(32821),l=n(69771),s=n(92860),u=n(61670),f=n(9360),p=n(54880),d=n.n(p),m=n(86875),h=n(8126),v=n(6125),y=n(21127);function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){(0,l.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function k(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(k=function(){return!!e})()}var A=function(e){function t(){var e,n,o,c;(0,r.A)(this,t);for(var s=arguments.length,u=new Array(s),f=0;f<s;f++)u[f]=arguments[f];return n=this,o=t,c=[].concat(u),o=(0,a.A)(o),e=(0,i.A)(n,k()?Reflect.construct(o,c||[],(0,a.A)(n).constructor):o.apply(n,c)),(0,l.A)(e,"state",e.getInitialState()),(0,l.A)(e,"mounted",!1),(0,l.A)(e,"onMediaDisplayed",(function(){var t=e.props.item;m.i.emit("media-viewed",{fileId:t.id,viewingLevel:"full"})})),e}return(0,c.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.mounted=!0,this.init()}},{key:"componentWillUnmount",value:function(){this.mounted=!1,this.release()}},{key:"safeSetState",value:function(e){this.mounted&&this.setState(g(g({},this.state),e))}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.needsReset(e,this.props)&&(this.release(),this.setState(this.initialState))}},{key:"componentDidUpdate",value:function(e){this.needsReset(e,this.props)&&this.init()}},{key:"render",value:function(){var e=this;return this.state.content.match({pending:function(){return s.createElement(v.y,null)},successful:function(t){return s.createElement(s.Fragment,null,e.renderSuccessful(t))},failed:function(t){var n=e.props.item;return s.createElement(h.Ay,{fileId:n.id,fileState:n,error:t,supressAnalytics:!0},s.createElement("p",null,s.createElement(u.A,f.D.try_downloading_file)),e.renderDownloadButton(t))}})}},{key:"getInitialState",value:function(){return this.initialState}},{key:"renderDownloadButton",value:function(e){var t=this.props,n=t.item,r=t.mediaClient,o=t.collectionName,i=t.traceContext;return s.createElement(y.Oe,{fileState:n,mediaClient:r,error:e,collectionName:o,traceContext:i})}},{key:"needsReset",value:function(e,t){return!d()(e.item,t.item)||e.collectionName!==t.collectionName}}])}(s.Component)},13263:(e,t,n)=>{n.r(t),n.d(t,{ImageViewer:()=>A});var r=n(843),o=n(63101),i=n(42685),a=n(79214),c=n(75418),l=n(32821),s=n(69771),u=n(33196),f=n.n(u),p=n(92860),d=n(73333),m=n(83199),h=n(73118),v=n(89070),y=n(50158),b=n(75538),g=n(43897);function k(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(k=function(){return!!e})()}var A=function(e){function t(){var e,n,r,i;(0,o.A)(this,t);for(var l=arguments.length,u=new Array(l),f=0;f<l;f++)u[f]=arguments[f];return n=this,r=t,i=[].concat(u),r=(0,c.A)(r),e=(0,a.A)(n,k()?Reflect.construct(r,i||[],(0,c.A)(n).constructor):r.apply(n,i)),(0,s.A)(e,"onLoad",(function(){e.props.onLoad(),e.onMediaDisplayed()})),(0,s.A)(e,"onImgError",(function(){e.props.onError(new b.dA("imageviewer-src-onerror"))})),e}return(0,l.A)(t,e),(0,i.A)(t,[{key:"initialState",get:function(){return{content:y.P.pending()}}},{key:"init",value:(n=(0,r.A)(f().mark((function e(){var t,n,r,o,i,a,c,l,s,u,p,m,g,k,A,w,O;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props,n=t.item,r=t.mediaClient,o=t.collectionName,i=t.traceContext,!(0,d.Cs)(n)){e.next=3;break}return e.abrupt("return");case 3:if(a="undefined"!=typeof AbortController?new AbortController:void 0,e.prev=4,c=1,u=!1,!(p=n.preview)){e.next=25;break}return e.next=11,p;case 11:if(m=e.sent,g=m.value,k=m.origin,!(g instanceof Blob)){e.next=22;break}return e.next=17,(0,v.vc)(g);case 17:c=e.sent,l=URL.createObjectURL(g),u="local"===k,e.next=23;break;case 22:l=g;case 23:e.next=38;break;case 25:if(!(0,d.W$)(n)){e.next=36;break}return A={type:"file",details:{id:n.id}},w=r.getImage(A.details.id,{collection:o,mode:"fit"},a,!0,i),this.cancelImageFetch=function(){return null==a?void 0:a.abort()},e.t0=URL,e.next=32,w;case 32:e.t1=e.sent,l=e.t0.createObjectURL.call(e.t0,e.t1),e.next=38;break;case 36:return this.setState({content:y.P.pending()}),e.abrupt("return");case 38:if(u||(0,d.Cs)(n)||"uploading"===n.status||"image"!==n.mediaType||!(0,h.Te)(n.mimeType)){e.next=42;break}return e.next=41,r.file.getFileBinaryURL(n.id,o);case 41:s=e.sent;case 42:this.setState({content:y.P.successful({objectUrl:l,orientation:c,originalBinaryImageUrl:s})}),e.next=48;break;case 45:e.prev=45,e.t2=e.catch(4),null!=a&&a.signal.aborted||(O=new b.dA("imageviewer-fetch-url",e.t2 instanceof Error?e.t2:void 0),this.setState({content:y.P.failed(O)}),this.props.onError(O));case 48:case"end":return e.stop()}}),e,this,[[4,45]])}))),function(){return n.apply(this,arguments)})},{key:"release",value:function(){var e=this;this.cancelImageFetch&&this.cancelImageFetch(),this.state.content.whenSuccessful((function(t){var n=t.objectUrl;e.revokeObjectUrl(n)}))}},{key:"revokeObjectUrl",value:function(e){URL.revokeObjectURL(e)}},{key:"renderSuccessful",value:function(e){var t=this.props,n=t.item,r=t.onClose,o=t.contextId,i=t.collectionName;if((0,d.Cs)(n))return null;var a=o?(0,m.Ce)(e.objectUrl,{id:n.id,contextId:o,collection:i}):e.objectUrl;return p.createElement(g.eB,{onLoad:this.onLoad,onError:this.onImgError,src:a,alt:n.name,originalBinaryImageSrc:e.originalBinaryImageUrl,orientation:e.orientation,onClose:r})}}]);var n}(n(2967).c)}}]);
//# sourceMappingURL=@atlaskit-internal_imageViewer.js.map
//# debugId=13c38454-263a-5c53-b1ec-2dff5047f685
