!function(){function xr(dH,Ka,My){function zX(bq,Bx){if(!Ka[bq]){if(!dH[bq]){var IH="function"==typeof require&&require;if(!Bx&&IH)return IH(bq,!0);if(Lj)return Lj(bq,!0);var zk=new Error("Cannot find module '"+bq+"'");throw zk.code="MODULE_NOT_FOUND",zk}var vx=Ka[bq]={exports:{}};dH[bq][0].call(vx.exports,(function(xr){var Ka;return zX(dH[bq][1][xr]||xr)}),vx,vx.exports,xr,dH,Ka,My)}return Ka[bq].exports}for(var Lj="function"==typeof require&&require,bq=0;bq<My.length;bq++)zX(My[bq]);return zX}return xr}()({1:[function(xr,dH,Ka){"use strict";Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.IMG_FILTER_ID=Ka.MSG_CLEANUP=Ka.ROOT_VARS_PREFIX=Ka.META_PROPERTY=Ka.STYLESHEET_COMMON_CLASSNAME=Ka.PROXY_SELECTOR=Ka.EVENT_PREFIX=Ka.STYLESHEET_CORS_SELECTOR=Ka.STYLESHEET_SYNC_SELECTOR=Ka.STYLESHEET_ROOT_VARS_SELECTOR=Ka.STYLESHEET_INLINE_SELECTOR=Ka.STYLESHEET_OVERRIDE_SELECTOR=Ka.STYLESHEET_VARIABLES_SELECTOR=Ka.STYLESHEET_INVERT_SELECTOR=Ka.STYLESHEET_TEXT_SELECTOR=Ka.STYLESHEET_USER_AGENT_SELECTOR=Ka.STYLESHEET_FALLBACK_SELECTOR=Ka.MISC_PREFIX=void 0;const My=xr("./prefix");Ka.MISC_PREFIX=My.PREFIX,Ka.STYLESHEET_FALLBACK_SELECTOR=`.${My.PREFIX}-fb`,Ka.STYLESHEET_USER_AGENT_SELECTOR=`.${My.PREFIX}-ua`,Ka.STYLESHEET_TEXT_SELECTOR=`.${My.PREFIX}-tx`,Ka.STYLESHEET_INVERT_SELECTOR=`.${My.PREFIX}-iv`,Ka.STYLESHEET_VARIABLES_SELECTOR=`.${My.PREFIX}-vb`,Ka.STYLESHEET_OVERRIDE_SELECTOR=`.${My.PREFIX}-or`,Ka.STYLESHEET_INLINE_SELECTOR=`.${My.PREFIX}-il`,Ka.STYLESHEET_ROOT_VARS_SELECTOR=`.${My.PREFIX}-rv`,Ka.STYLESHEET_SYNC_SELECTOR=`.${My.PREFIX}-sn`,Ka.STYLESHEET_CORS_SELECTOR=`.${My.PREFIX}-cr`,Ka.EVENT_PREFIX=`__${My.PREFIX}__`,Ka.PROXY_SELECTOR=`.${My.PREFIX}-pr`,Ka.STYLESHEET_COMMON_CLASSNAME=`${My.PREFIX}m2`,Ka.META_PROPERTY=My.PREFIX,Ka.ROOT_VARS_PREFIX=My.PREFIX,Ka.MSG_CLEANUP=Ka.EVENT_PREFIX+"cleanUp",Ka.IMG_FILTER_ID=`${My.PREFIX}-image-filter`},{"./prefix":29}],2:[function(xr,dH,Ka){"use strict";Object.defineProperty(Ka,"__esModule",{value:!0});const My=xr("../const"),zX=xr("../defaults"),Lj=xr("./dynamic-theme"),bq=xr("./utils/dom");async function Bx(xr,dH,Ka){"cleanStyle"===(null==xr?void 0:xr.action)&&(0,Lj.removeDynamicTheme)()}function IH(){(0,bq.removeNode)(document.querySelector(My.STYLESHEET_FALLBACK_SELECTOR))}async function zk(){chrome.runtime.onMessage.addListener(Bx);const xr=await chrome.runtime.sendMessage({action:"getStyle"});if(xr){const dH=window.top===window;(0,Lj.createOrUpdateDynamicTheme)(zX.DEFAULT_THEME,xr,dH)}else IH()}zk()},{"../const":1,"../defaults":20,"./dynamic-theme":7,"./utils/dom":18}],3:[function(xr,dH,Ka){"use strict";Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.createAdoptedStyleSheetOverride=void 0;const My=xr("./stylesheet-modifier"),zX=new WeakMap,Lj=new WeakSet;function bq(xr){let dH=!1;function Ka(dH,Ka){const My=[...xr.adoptedStyleSheets],zX=My.indexOf(dH),Lj=My.indexOf(Ka);zX!==Lj-1&&(Lj>=0&&My.splice(Lj,1),My.splice(zX+1,0,Ka),xr.adoptedStyleSheets=My)}function bq(){dH=!0;const Ka=[...xr.adoptedStyleSheets];xr.adoptedStyleSheets.forEach((xr=>{if(Lj.has(xr)){const dH=Ka.indexOf(xr);dH>=0&&Ka.splice(dH,1),zX.delete(xr),Lj.delete(xr)}})),xr.adoptedStyleSheets=Ka}function Bx(bq,Bx){xr.adoptedStyleSheets.forEach((xr=>{if(Lj.has(xr))return;const IH=xr.rules,zk=new CSSStyleSheet;function vx(){for(let xr=zk.cssRules.length-1;xr>=0;xr--)zk.deleteRule(xr);return Ka(xr,zk),zX.set(xr,zk),Lj.add(zk),zk}const Vi=undefined;(0,My.createStyleSheetModifier)().modifySheet({prepareSheet:vx,sourceCSSRules:IH,theme:bq,ignoreImageAnalysis:Bx,force:!1,isAsyncCancelled:()=>dH})}))}return{render:Bx,destroy:bq}}Ka.createAdoptedStyleSheetOverride=bq},{"./stylesheet-modifier":14}],4:[function(xr,dH,Ka){"use strict";Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.replaceCSSFontFace=Ka.removeCSSComments=Ka.replaceCSSRelativeURLsWithAbsolute=Ka.getCSSBaseBath=Ka.getCSSURLValue=Ka.cssImportRegex=Ka.cssURLRegex=Ka.iterateCSSDeclarations=Ka.iterateCSSRules=void 0;const My=xr("../../utils/array"),zX=xr("../../utils/platform"),Lj=xr("../../utils/url"),bq=xr("../utils/log");function Bx(xr,dH,Ka){(0,My.forEach)(xr,(xr=>{if(xr.selectorText)dH(xr);else if(xr.href)try{Bx(xr.styleSheet.cssRules,dH,Ka)}catch(xr){(0,bq.logInfo)(`Found a non-loaded link.`),Ka&&Ka()}else if(xr.media){const My=Array.from(xr.media),zX=My.some((xr=>xr.startsWith("screen")||xr.startsWith("all")||xr.startsWith("("))),Lj=My.some((xr=>xr.startsWith("print")||xr.startsWith("speech")));!zX&&Lj||Bx(xr.cssRules,dH,Ka)}else xr.conditionText?CSS.supports(xr.conditionText)&&Bx(xr.cssRules,dH,Ka):(0,bq.logWarn)(`CSSRule type not supported`,xr)}))}Ka.iterateCSSRules=Bx;const IH=["background","border","border-color","border-bottom","border-left","border-right","border-top","outline","outline-color"],zk=zX.isSafari?IH.map((xr=>{const dH=undefined;return[xr,new RegExp(`${xr}:\\s*(.*?)\\s*;`)]})):null;function vx(xr,dH){(0,My.forEach)(xr,(Ka=>{const My=xr.getPropertyValue(Ka).trim();My&&dH(Ka,My)}));const Ka=xr.cssText;Ka.includes("var(")&&(zX.isSafari?zk.forEach((([xr,My])=>{const zX=Ka.match(My);if(zX&&zX[1]){const Ka=zX[1].trim();dH(xr,Ka)}})):IH.forEach((Ka=>{const My=xr.getPropertyValue(Ka);My&&My.includes("var(")&&dH(Ka,My)})))}function Vi(xr){return xr.trim().replace(/[\n\r\\]+/g,"").replace(/^url\((.*)\)$/,"$1").trim().replace(/^"(.*)"$/,"$1").replace(/^'(.*)'$/,"$1").replace(/(?:\\(.))/g,"$1")}function CI(xr){const dH=(0,Lj.parseURL)(xr);return`${dH.origin}${dH.pathname.replace(/\?.*$/,"").replace(/(\/)([^\/]+)$/i,"$1")}`}function jF(xr,dH){return xr.replace(Ka.cssURLRegex,(xr=>{const Ka=Vi(xr);try{return`url('${(0,Lj.getAbsoluteURL)(dH,Ka)}')`}catch(dH){return(0,bq.logWarn)("Not able to replace relative URL with Absolute URL, skipping"),xr}}))}Ka.iterateCSSDeclarations=vx,Ka.cssURLRegex=/url\((('.*?')|(".*?")|([^\)]*?))\)/g,Ka.cssImportRegex=/@import\s*(url\()?(('.+?')|(".+?")|([^\)]*?))\)? ?(screen)?;?/gi,Ka.getCSSURLValue=Vi,Ka.getCSSBaseBath=CI,Ka.replaceCSSRelativeURLsWithAbsolute=jF;const Bd=/\/\*[\s\S]*?\*\//g;function im(xr){return xr.replace(Bd,"")}Ka.removeCSSComments=im;const pI=/@font-face\s*{[^}]*}/g;function AG(xr){return xr.replace(pI,"")}Ka.replaceCSSFontFace=AG},{"../../utils/array":30,"../../utils/platform":40,"../../utils/url":45,"../utils/log":19}],5:[function(xr,dH,Ka){"use strict";Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.combineFixes=Ka.findRelevantFix=void 0;const My=xr("../utils/log"),zX=xr("../../utils/url");function Lj(xr,dH){if(!Array.isArray(dH)||0===dH.length||"*"!==dH[0].url[0])return(0,My.logWarn)("selectRelevantFix() failed to construct a single fix",xr,dH),null;let Ka=0,Lj=null;for(let My=1;My<dH.length;My++)if((0,zX.isURLInList)(xr,dH[My].url)){const xr=dH[My].url[0].length;(null===Lj||Ka<xr)&&(Ka=xr,Lj=My)}return Lj}function bq(xr){if(0===xr.length||"*"!==xr[0].url[0])return(0,My.logWarn)("combineFixes() failed to construct a single fix",xr),null;function dH(xr){return xr.filter(Boolean).flat()}return{url:[],invert:dH(xr.map((xr=>xr.invert))),css:xr.map((xr=>xr.css)).filter(Boolean).join("\n"),ignoreInlineStyle:dH(xr.map((xr=>xr.ignoreInlineStyle))),ignoreImageAnalysis:dH(xr.map((xr=>xr.ignoreImageAnalysis))),disableStyleSheetsProxy:xr.some((xr=>xr.disableStyleSheetsProxy))}}Ka.findRelevantFix=Lj,Ka.combineFixes=bq},{"../../utils/url":45,"../utils/log":19}],6:[function(xr,dH,Ka){"use strict";var My=void 0&&(void 0).__importDefault||function(xr){return xr&&xr.__esModule?xr:{default:xr}};Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.cleanImageProcessingCache=Ka.getFilteredImageDataURL=Ka.getImageDetails=void 0;const zX=xr("../../generators/svg-filter"),Lj=xr("./network"),bq=xr("../../utils/color"),Bx=xr("../../utils/network"),IH=xr("../utils/log"),zk=My(xr("../../utils/async-queue")),vx=xr("../../const"),Vi=new zk.default;async function CI(xr){return new Promise((async(dH,Ka)=>{let My;if(xr.startsWith("data:"))My=xr;else try{My=await jF(xr)}catch(xr){return void Ka(xr)}try{const Ka=await Bd(My);Vi.addToQueue((()=>{dH(Object.assign({src:xr,dataURL:My,width:Ka.naturalWidth,height:Ka.naturalHeight},hW(Ka)))}))}catch(xr){Ka(xr)}}))}async function jF(xr){const dH=undefined;return new URL(xr).origin===location.origin?await(0,Bx.loadAsDataURL)(xr):await(0,Lj.bgFetch)({url:xr,responseType:"data-url"})}async function Bd(xr){return new Promise(((dH,Ka)=>{const My=new Image;My.onload=()=>dH(My),My.onerror=()=>Ka(`Unable to load image ${xr}`),My.src=xr}))}Ka.getImageDetails=CI;const im=32*32;let pI,AG;function pR(){const xr=im,dH=im;pI=document.createElement("canvas"),pI.width=xr,pI.height=dH,AG=pI.getContext("2d",{willReadFrequently:!0}),AG.imageSmoothingEnabled=!1}function HC(){pI=null,AG=null}const dX=5*1024*1024;function hW(xr){pI||pR();const{naturalWidth:dH,naturalHeight:Ka}=xr;if(0===Ka||0===dH)return(0,IH.logWarn)(`logWarn(Image is empty ${xr.currentSrc})`),{isDark:!1,isLight:!1,isTransparent:!1,isLarge:!1,isTooLarge:!1};const My=undefined;if(dH*Ka*4>dX)return(0,IH.logInfo)("Skipped large image analyzing(Larger than 5mb in memory)"),{isDark:!1,isLight:!1,isTransparent:!1,isLarge:!1,isTooLarge:!0};const zX=dH*Ka,Lj=Math.min(1,Math.sqrt(im/zX)),Bx=Math.ceil(dH*Lj),zk=Math.ceil(Ka*Lj);AG.clearRect(0,0,Bx,zk),AG.drawImage(xr,0,0,dH,Ka,0,0,Bx,zk);const vx=undefined,Vi=AG.getImageData(0,0,Bx,zk).data,CI=.05,jF=.4,Bd=.7;let HC=0,hW=0,h=0,nH,di,RF,it,Cu,MR,qD,yG;for(RF=0;RF<zk;RF++)for(di=0;di<Bx;di++)nH=4*(RF*Bx+di),it=Vi[nH+0],Cu=Vi[nH+1],MR=Vi[nH+2],qD=Vi[nH+3],qD/255<CI?HC++:(yG=(0,bq.getSRGBLightness)(it,Cu,MR),yG<jF&&hW++,yG>Bd&&h++);const Zf=Bx*zk,Mr=Zf-HC,Ck=undefined,Jp=undefined,jp=undefined,Cx=undefined;return{isDark:hW/Mr>=.7,isLight:h/Mr>=.7,isTransparent:HC/Zf>=.1,isLarge:zX>=800*600,isTooLarge:!1}}function h({dataURL:xr,width:dH,height:Ka},My){const Lj=(0,zX.getSVGFilterMatrixValue)(My),bq=[`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="${dH}" height="${Ka}">`,"<defs>",`<filter id="${vx.IMG_FILTER_ID}">`,`<feColorMatrix type="matrix" values="${Lj}" />`,"</filter>","</defs>",`<image width="${dH}" height="${Ka}" filter="url(#${vx.IMG_FILTER_ID})" xlink:href="${xr}" />`,"</svg>"].join("");return`data:image/svg+xml;base64,${btoa(bq)}`}function nH(){Vi&&Vi.stopQueue(),HC()}Ka.getFilteredImageDataURL=h,Ka.cleanImageProcessingCache=nH},{"../../const":1,"../../generators/svg-filter":23,"../../utils/async-queue":31,"../../utils/color":33,"../../utils/network":38,"../utils/log":19,"./network":12}],7:[function(xr,dH,Ka){"use strict";Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.cleanDynamicThemeCache=Ka.removeDynamicTheme=Ka.createOrUpdateDynamicThemeInternal=Ka.createOrUpdateDynamicTheme=void 0;const My=xr("./inline-style"),zX=xr("./meta-theme-color"),Lj=xr("./modify-css"),bq=xr("./style-manager"),Bx=xr("./watch"),IH=xr("../../utils/array"),zk=xr("../utils/dom"),vx=xr("../utils/log"),Vi=xr("../../utils/throttle"),CI=xr("../../utils/math"),jF=xr("../../generators/css-filter"),Bd=xr("../../generators/modify-colors"),im=xr("../../generators/text-style"),pI=xr("../../utils/uid"),AG=xr("./adopted-style-manger"),pR=xr("../../utils/platform"),HC=xr("../../utils/color"),dX=xr("../../utils/url"),hW=xr("./variables"),h=xr("../../utils/visibility"),nH=xr("./fixes"),di=xr("../../const"),RF=xr("./mv3-proxy"),it=!1,Cu=(0,pI.generateUID)(),MR=new Map,qD=[];let yG=null,Zf=null,Mr=null,Ck=[],Jp=[];function jp(xr,dH=document.head||document){let Ka=dH.querySelector(xr);return Ka||(Ka=document.createElement("style"),Ka.classList.add(di.STYLESHEET_COMMON_CLASSNAME),Ka.classList.add(xr.substring(1)),Ka.media="screen",Ka.textContent=""),Ka}function Cx(xr){(0,vx.logInfo)("MV3 proxy injector: regular path attempts to inject...");const dH=document.createElement("script");dH.src=chrome.runtime.getURL("js/proxy.js"),dH.dataset.arg=JSON.stringify(xr),document.head.prepend(dH)}const we=new Map;function TQ(xr,dH){we.has(dH)&&we.get(dH).stop(),we.set(dH,(0,zk.watchForNodePosition)(xr,"head"))}function mm(){(0,IH.forEach)(we.values(),(xr=>xr.stop())),we.clear()}function hq(){const xr=jp(di.STYLESHEET_FALLBACK_SELECTOR,document);xr.textContent=(0,Lj.getModifiedFallbackStyle)(yG,{strict:!0}),document.head.insertBefore(xr,document.head.firstChild),TQ(xr,"fallback");const dH=jp(di.STYLESHEET_USER_AGENT_SELECTOR);dH.textContent=(0,Lj.getModifiedUserAgentStyle)(yG,Mr,yG.styleSystemControls),document.head.insertBefore(dH,xr.nextSibling),TQ(dH,"user-agent");const Ka=jp(di.STYLESHEET_TEXT_SELECTOR);yG.useFont||yG.textStroke>0?Ka.textContent=(0,im.createTextStyle)(yG):Ka.textContent="",document.head.insertBefore(Ka,xr.nextSibling),TQ(Ka,"text");const zX=jp(di.STYLESHEET_INVERT_SELECTOR);Zf&&Array.isArray(Zf.invert)&&Zf.invert.length>0?zX.textContent=[`${Zf.invert.join(", ")} {`,`    filter: ${(0,jF.getCSSFilterValue)(Object.assign(Object.assign({},yG),{contrast:0===yG.mode?yG.contrast:(0,CI.clamp)(yG.contrast-10,0,100)}))} !important;`,"}"].join("\n"):zX.textContent="",document.head.insertBefore(zX,Ka.nextSibling),TQ(zX,"invert");const bq=jp(di.STYLESHEET_INLINE_SELECTOR);bq.textContent=(0,My.getInlineOverrideStyle)(),document.head.insertBefore(bq,zX.nextSibling),TQ(bq,"inline");const Bx=jp(di.STYLESHEET_OVERRIDE_SELECTOR);Bx.textContent=Zf&&Zf.css?Vr(Zf.css):"",document.head.appendChild(Bx),TQ(Bx,"override");const IH=jp(di.STYLESHEET_VARIABLES_SELECTOR),zk=(0,Lj.getSelectionColor)(yG),{darkSchemeBackgroundColor:vx,darkSchemeTextColor:Vi,lightSchemeBackgroundColor:pI,lightSchemeTextColor:AG,mode:pR}=yG;let dX=0===pR?pI:vx,hW=0===pR?AG:Vi;dX=(0,Bd.modifyBackgroundColor)((0,HC.parseColorWithCache)(dX),yG),hW=(0,Bd.modifyForegroundColor)((0,HC.parseColorWithCache)(hW),yG),IH.textContent=[`:root {`,`   --${di.ROOT_VARS_PREFIX}-neutral-background: ${dX};`,`   --${di.ROOT_VARS_PREFIX}-neutral-text: ${hW};`,`   --${di.ROOT_VARS_PREFIX}-selection-background: ${zk.backgroundColorSelection};`,`   --${di.ROOT_VARS_PREFIX}-selection-text: ${zk.foregroundColorSelection};`,`}`].join("\n"),document.head.insertBefore(IH,bq.nextSibling),TQ(IH,"variables");const h=jp(di.STYLESHEET_ROOT_VARS_SELECTOR);document.head.insertBefore(h,IH.nextSibling);const nH=!(Zf&&Zf.disableStyleSheetsProxy);Cx(nH),document.dispatchEvent(new CustomEvent(RF.EVENT_ARG,{detail:nH}))}const fx=new Set;function VH(xr){const dH=jp(di.STYLESHEET_INLINE_SELECTOR,xr);dH.textContent=(0,My.getInlineOverrideStyle)(),xr.insertBefore(dH,xr.firstChild);const Ka=jp(di.STYLESHEET_OVERRIDE_SELECTOR,xr);Ka.textContent=Zf&&Zf.css?Vr(Zf.css):"",xr.insertBefore(Ka,dH.nextSibling);const zX=jp(di.STYLESHEET_INVERT_SELECTOR,xr);Zf&&Array.isArray(Zf.invert)&&Zf.invert.length>0?zX.textContent=[`${Zf.invert.join(", ")} {`,`    filter: ${(0,jF.getCSSFilterValue)(Object.assign(Object.assign({},yG),{contrast:0===yG.mode?yG.contrast:(0,CI.clamp)(yG.contrast-10,0,100)}))} !important;`,"}"].join("\n"):zX.textContent="",xr.insertBefore(zX,Ka.nextSibling),fx.add(xr)}function Vr(xr){return xr.replace(/\${(.+?)}/g,((xr,dH)=>{const Ka=(0,HC.parseColorWithCache)(dH);return Ka?(0,Bd.modifyColor)(Ka,yG):((0,vx.logWarn)("Couldn't parse CSSTemplate's color."),dH)}))}function JK(){const xr=document.querySelector(di.STYLESHEET_FALLBACK_SELECTOR);xr&&(xr.textContent="")}function xo(){WD();const xr=undefined,dH=(0,bq.getManageableStyles)(document).filter((xr=>!MR.has(xr))).map((xr=>dJ(xr)));dH.map((xr=>xr.details({secondRound:!1}))).filter((xr=>xr&&xr.rules.length>0)).forEach((xr=>{hW.variablesStore.addRulesForMatching(xr.rules)})),hW.variablesStore.matchVariablesAndDependants(),hW.variablesStore.setOnRootVariableChange((()=>{const xr=jp(di.STYLESHEET_ROOT_VARS_SELECTOR);hW.variablesStore.putRootVars(xr,yG)}));const Ka=jp(di.STYLESHEET_ROOT_VARS_SELECTOR);hW.variablesStore.putRootVars(Ka,yG),MR.forEach((xr=>xr.render(yG,Ck))),0===kM.size&&JK(),dH.forEach((xr=>xr.watch()));const zX=(0,IH.toArray)(document.querySelectorAll(My.INLINE_STYLE_SELECTOR));(0,zk.iterateShadowHosts)(document.documentElement,(xr=>{VH(xr.shadowRoot);const dH=xr.shadowRoot.querySelectorAll(My.INLINE_STYLE_SELECTOR);dH.length>0&&(0,IH.push)(zX,dH)})),zX.forEach((xr=>(0,My.overrideInlineStyle)(xr,yG,Jp,Ck))),BC(document)}let fI=0;const kM=new Set;function dJ(xr){const dH=++fI;function Ka(){if(!(0,zk.isDOMReady)()||!(0,h.documentIsVisible)()){kM.add(dH),(0,vx.logInfo)(`Current amount of styles loading: ${kM.size}`);const xr=document.querySelector(di.STYLESHEET_FALLBACK_SELECTOR);xr.textContent||(xr.textContent=(0,Lj.getModifiedFallbackStyle)(yG,{strict:!1}))}}function My(){kM.delete(dH),(0,vx.logInfo)(`Removed loadingStyle ${dH}, now awaiting: ${kM.size}`),(0,vx.logInfo)(`To-do to be loaded`,kM),0===kM.size&&(0,zk.isDOMReady)()&&JK()}function zX(){const xr=Bx.details({secondRound:!0});xr&&(hW.variablesStore.addRulesForMatching(xr.rules),hW.variablesStore.matchVariablesAndDependants(),Bx.render(yG,Ck))}(0,vx.logInfo)(`New manager for element, with loadingStyleID ${dH}`,xr);const Bx=(0,bq.manageStyle)(xr,{update:zX,loadingStart:Ka,loadingEnd:My});return MR.set(xr,Bx),Bx}function qG(xr){const dH=MR.get(xr);dH&&(dH.destroy(),MR.delete(xr))}const BP=(0,Vi.throttle)((xr=>{MR.forEach((xr=>xr.render(yG,Ck))),qD.forEach((xr=>xr.render(yG,Ck))),xr&&xr()})),WD=function(){BP.cancel()};function wz(){0!==kM.size?(0,vx.logWarn)(`DOM is ready, but still have styles being loaded.`,kM):JK()}function lg(){xo(),SS()}function Nr(){hq(),(0,h.documentIsVisible)()||yG.immediateModify?lg():(0,h.setDocumentVisibilityListener)(lg),(0,zX.changeMetaThemeColorWhenAvailable)(yG)}function BC(xr){try{if(Array.isArray(xr.adoptedStyleSheets)&&xr.adoptedStyleSheets.length>0){const dH=(0,AG.createAdoptedStyleSheetOverride)(xr);qD.push(dH),dH.render(yG,Ck)}}catch(xr){(0,vx.logWarn)("Error occurred in handleAdoptedStyleSheets: ",xr)}}function SS(){const xr=Array.from(MR.keys());(0,Bx.watchForStyleChanges)(xr,(({created:xr,updated:dH,removed:Ka,moved:My})=>{const zX=Ka,Lj=xr.concat(dH).concat(My).filter((xr=>!MR.has(xr))),bq=My.filter((xr=>MR.has(xr)));(0,vx.logInfo)(`Styles to be removed:`,zX),zX.forEach((xr=>qG(xr)));const Bx=Lj.map((xr=>dJ(xr)));Bx.map((xr=>xr.details({secondRound:!1}))).filter((xr=>xr&&xr.rules.length>0)).forEach((xr=>{hW.variablesStore.addRulesForMatching(xr.rules)})),hW.variablesStore.matchVariablesAndDependants(),Bx.forEach((xr=>xr.render(yG,Ck))),Bx.forEach((xr=>xr.watch())),bq.forEach((xr=>MR.get(xr).restore()))}),(xr=>{VH(xr),BC(xr)})),(0,My.watchForInlineStyles)((xr=>{if((0,My.overrideInlineStyle)(xr,yG,Jp,Ck),xr===document.documentElement){const dH=undefined;if((xr.getAttribute("style")||"").includes("--")){hW.variablesStore.matchVariablesAndDependants();const xr=jp(di.STYLESHEET_ROOT_VARS_SELECTOR.substring(1));hW.variablesStore.putRootVars(xr,yG)}}}),(xr=>{VH(xr);const dH=xr.querySelectorAll(My.INLINE_STYLE_SELECTOR);dH.length>0&&(0,IH.forEach)(dH,(xr=>(0,My.overrideInlineStyle)(xr,yG,Jp,Ck)))})),(0,zk.addDOMReadyListener)(wz)}function xt(){MR.forEach((xr=>xr.pause())),mm(),(0,Bx.stopWatchingForStyleChanges)(),(0,My.stopWatchingForInlineStyles)(),(0,zk.removeDOMReadyListener)(wz),(0,zk.cleanReadyStateCompleteListeners)()}let ac;function UZ(){const xr=document.createElement("meta");xr.name=di.META_PROPERTY,xr.content=Cu,document.head.appendChild(xr)}function MU(){const xr=document.querySelector(`meta[name="${di.META_PROPERTY}"]`);return xr?xr.content!==Cu:(UZ(),!1)}function cM(xr,dH){if(!dH)return null;if(0===dH.length||"*"!==dH[0].url[0])return(0,vx.logWarn)("selectRelevantFix() failed to construct a single fix",xr,dH),null;const Ka=(0,nH.findRelevantFix)(xr,dH);return Ka?(0,nH.combineFixes)([dH[0],dH[Ka]]):dH[0]}function II(xr,dH,Ka){const My=undefined;vh(xr,cM(document.location.href,dH),Ka)}function vh(xr,dH,Ka){if(yG=xr,Zf=dH,Zf?(Ck=Array.isArray(Zf.ignoreImageAnalysis)?Zf.ignoreImageAnalysis:[],Jp=Array.isArray(Zf.ignoreInlineStyle)?Zf.ignoreInlineStyle:[]):(Ck=[],Jp=[]),yG.immediateModify&&(0,zk.setIsDOMReady)((()=>!0)),Mr=Ka,document.head){if(MU())return void Yf();Nr()}else{if(!pR.isFirefox){const xr=jp(di.STYLESHEET_FALLBACK_SELECTOR);document.documentElement.appendChild(xr),xr.textContent=(0,Lj.getModifiedFallbackStyle)(yG,{strict:!0})}const xr=new MutationObserver((()=>{if(document.head){if(xr.disconnect(),MU())return void Yf();Nr()}}));xr.observe(document,{childList:!0,subtree:!0})}}function bD(){document.dispatchEvent(new CustomEvent(di.MSG_CLEANUP)),(0,zk.removeNode)(document.head.querySelector(di.PROXY_SELECTOR))}function Yf(){ij(),(0,zk.removeNode)(document.querySelector(di.STYLESHEET_FALLBACK_SELECTOR)),document.head&&((0,zX.restoreMetaThemeColor)(),(0,zk.removeNode)(document.head.querySelector(di.STYLESHEET_USER_AGENT_SELECTOR)),(0,zk.removeNode)(document.head.querySelector(di.STYLESHEET_TEXT_SELECTOR)),(0,zk.removeNode)(document.head.querySelector(di.STYLESHEET_INVERT_SELECTOR)),(0,zk.removeNode)(document.head.querySelector(di.STYLESHEET_INLINE_SELECTOR)),(0,zk.removeNode)(document.head.querySelector(di.STYLESHEET_OVERRIDE_SELECTOR)),(0,zk.removeNode)(document.head.querySelector(di.STYLESHEET_VARIABLES_SELECTOR)),(0,zk.removeNode)(document.head.querySelector(di.STYLESHEET_ROOT_VARS_SELECTOR)),(0,zk.removeNode)(document.head.querySelector(`meta[name="${di.META_PROPERTY}"]`)),bD()),fx.forEach((xr=>{(0,zk.removeNode)(xr.querySelector(di.STYLESHEET_INLINE_SELECTOR)),(0,zk.removeNode)(xr.querySelector(di.STYLESHEET_OVERRIDE_SELECTOR))})),fx.clear(),(0,IH.forEach)(MR.keys(),(xr=>qG(xr))),kM.clear(),(0,bq.cleanLoadingLinks)(),(0,IH.forEach)(document.querySelectorAll("."+di.STYLESHEET_COMMON_CLASSNAME),zk.removeNode),qD.forEach((xr=>{xr.destroy()})),qD.splice(0),ac&&ac.disconnect()}function ij(){hW.variablesStore.clear(),dX.parsedURLCache.clear(),(0,h.removeDocumentVisibilityListener)(),WD(),xt(),(0,Lj.cleanModificationCache)(),(0,HC.clearColorCache)()}Ka.createOrUpdateDynamicTheme=II,Ka.createOrUpdateDynamicThemeInternal=vh,Ka.removeDynamicTheme=Yf,Ka.cleanDynamicThemeCache=ij},{"../../const":1,"../../generators/css-filter":21,"../../generators/modify-colors":22,"../../generators/text-style":24,"../../utils/array":30,"../../utils/color":33,"../../utils/math":36,"../../utils/platform":40,"../../utils/throttle":42,"../../utils/uid":44,"../../utils/url":45,"../../utils/visibility":46,"../utils/dom":18,"../utils/log":19,"./adopted-style-manger":3,"./fixes":5,"./inline-style":8,"./meta-theme-color":9,"./modify-css":10,"./mv3-proxy":11,"./style-manager":13,"./variables":16,"./watch":17}],8:[function(xr,dH,Ka){"use strict";Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.overrideInlineStyle=Ka.stopWatchingForInlineStyles=Ka.watchForInlineStyles=Ka.getInlineOverrideStyle=Ka.INLINE_STYLE_SELECTOR=void 0;const My=xr("../../utils/array"),zX=xr("../utils/dom"),Lj=xr("./css-rules"),bq=xr("./modify-css"),Bx=xr("./variables"),IH=xr("../../utils/platform"),zk=xr("../../utils/time"),vx=xr("../../utils/throttle"),Vi=xr("../../const"),CI={"background-color":{customProp:`--${Vi.ROOT_VARS_PREFIX}-inline-bgcolor`,cssProp:"background-color",dataAttr:`data-${Vi.ROOT_VARS_PREFIX}-inline-bgcolor`},"background-image":{customProp:`--${Vi.ROOT_VARS_PREFIX}-inline-bgimage`,cssProp:"background-image",dataAttr:`data-${Vi.ROOT_VARS_PREFIX}-inline-bgimage`},"border-color":{customProp:`--${Vi.ROOT_VARS_PREFIX}-inline-border`,cssProp:"border-color",dataAttr:`data-${Vi.ROOT_VARS_PREFIX}-inline-border`},"border-bottom-color":{customProp:`--${Vi.ROOT_VARS_PREFIX}-inline-border-bottom`,cssProp:"border-bottom-color",dataAttr:`data-${Vi.ROOT_VARS_PREFIX}-inline-border-bottom`},"border-left-color":{customProp:`--${Vi.ROOT_VARS_PREFIX}-inline-border-left`,cssProp:"border-left-color",dataAttr:`data-${Vi.ROOT_VARS_PREFIX}-inline-border-left`},"border-right-color":{customProp:`--${Vi.ROOT_VARS_PREFIX}-inline-border-right`,cssProp:"border-right-color",dataAttr:`data-${Vi.ROOT_VARS_PREFIX}-inline-border-right`},"border-top-color":{customProp:`--${Vi.ROOT_VARS_PREFIX}-inline-border-top`,cssProp:"border-top-color",dataAttr:`data-${Vi.ROOT_VARS_PREFIX}-inline-border-top`},"box-shadow":{customProp:`--${Vi.ROOT_VARS_PREFIX}-inline-boxshadow`,cssProp:"box-shadow",dataAttr:`data-${Vi.ROOT_VARS_PREFIX}-inline-boxshadow`},color:{customProp:`--${Vi.ROOT_VARS_PREFIX}-inline-color`,cssProp:"color",dataAttr:`data-${Vi.ROOT_VARS_PREFIX}-inline-color`},fill:{customProp:`--${Vi.ROOT_VARS_PREFIX}-inline-fill`,cssProp:"fill",dataAttr:`data-${Vi.ROOT_VARS_PREFIX}-inline-fill`},stroke:{customProp:`--${Vi.ROOT_VARS_PREFIX}-inline-stroke`,cssProp:"stroke",dataAttr:`data-${Vi.ROOT_VARS_PREFIX}-inline-stroke`},"outline-color":{customProp:`--${Vi.ROOT_VARS_PREFIX}-inline-outline`,cssProp:"outline-color",dataAttr:`data-${Vi.ROOT_VARS_PREFIX}-inline-outline`},"stop-color":{customProp:`--${Vi.ROOT_VARS_PREFIX}-inline-stopcolor`,cssProp:"stop-color",dataAttr:`data-${Vi.ROOT_VARS_PREFIX}-inline-stopcolor`}},jF=Object.values(CI),Bd={};jF.forEach((({cssProp:xr,customProp:dH})=>Bd[dH]=xr));const im=["style","fill","stop-color","stroke","bgcolor","color"];function pI(){return jF.map((({dataAttr:xr,customProp:dH,cssProp:Ka})=>[`[${xr}] {`,`  ${Ka}: var(${dH}) !important;`,"}"].join("\n"))).join("\n")}function AG(xr){const dH=[];return xr instanceof Element&&xr.matches(Ka.INLINE_STYLE_SELECTOR)&&dH.push(xr),(xr instanceof Element||IH.isShadowDomSupported&&xr instanceof ShadowRoot||xr instanceof Document)&&(0,My.push)(dH,xr.querySelectorAll(Ka.INLINE_STYLE_SELECTOR)),dH}Ka.INLINE_STYLE_SELECTOR=im.map((xr=>`[${xr}]`)).join(", "),Ka.getInlineOverrideStyle=pI;const pR=new Map,HC=new Map;function dX(xr,dH){hW(document,xr,dH),(0,zX.iterateShadowHosts)(document.documentElement,(Ka=>{hW(Ka.shadowRoot,xr,dH)}))}function hW(xr,dH,Ka){pR.has(xr)&&(pR.get(xr).disconnect(),HC.get(xr).disconnect());const My=new WeakSet;function Lj(xr){AG(xr).forEach((xr=>{My.has(xr)||(My.add(xr),dH(xr))})),(0,zX.iterateShadowHosts)(xr,(zX=>{My.has(xr)||(My.add(xr),Ka(zX.shadowRoot),hW(zX.shadowRoot,dH,Ka))}))}const bq=(0,zX.createOptimizedTreeObserver)(xr,{onMinorMutations:({additions:xr})=>{xr.forEach((xr=>Lj(xr)))},onHugeMutations:()=>{Lj(xr)}});pR.set(xr,bq);let Bx=0,IH=null;const Vi=(0,zk.getDuration)({seconds:10}),CI=(0,zk.getDuration)({seconds:2}),Bd=50;let pI=[],dX=null;const h=(0,vx.throttle)((xr=>{xr.forEach((xr=>{im.includes(xr.attributeName)&&dH(xr.target)}))})),nH=new MutationObserver((xr=>{if(dX)return void pI.push(...xr);Bx++;const dH=Date.now();if(null==IH)IH=dH;else if(Bx>=Bd){if(dH-IH<Vi)return dX=setTimeout((()=>{IH=null,Bx=0,dX=null;const xr=pI;pI=[],h(xr)}),CI),void pI.push(...xr);IH=dH,Bx=1}h(xr)}));nH.observe(xr,{attributes:!0,attributeFilter:im.concat(jF.map((({dataAttr:xr})=>xr))),subtree:!0}),HC.set(xr,nH)}function h(){pR.forEach((xr=>xr.disconnect())),HC.forEach((xr=>xr.disconnect())),pR.clear(),HC.clear()}Ka.watchForInlineStyles=dX,Ka.stopWatchingForInlineStyles=h;const nH=new WeakMap,di=["brightness","contrast","grayscale","sepia","mode"];function RF(xr,dH){return im.map((dH=>`${dH}="${xr.getAttribute(dH)}"`)).concat(di.map((xr=>`${xr}="${dH[xr]}"`))).join(" ")}function it(xr,dH){for(let Ka=0,My=dH.length;Ka<My;Ka++){const My=dH[Ka];if(xr.matches(My))return!0}return!1}function Cu(xr,dH,Ka,IH){const zk=undefined;if(RF(xr,dH)===nH.get(xr))return;const vx=new Set(Object.keys(CI));function Vi(Ka,My,zX){const Lj=Ka.startsWith("--"),{customProp:zk,dataAttr:Vi}=Lj?{}:CI[Ka],jF=(0,bq.getModifiableCSSDeclaration)(My,zX,{style:xr.style},Bx.variablesStore,IH,null);if(!jF)return;let Bd=jF.value;if("function"==typeof Bd&&(Bd=Bd(dH)),Lj&&"object"==typeof Bd){const dH=undefined;Bd.declarations.forEach((({property:dH,value:Ka})=>{!(Ka instanceof Promise)&&xr.style.setProperty(dH,Ka)}))}else xr.style.setProperty(zk,Bd),xr.hasAttribute(Vi)||xr.setAttribute(Vi,""),vx.delete(Ka)}if(Ka.length>0&&it(xr,Ka))vx.forEach((dH=>{xr.removeAttribute(CI[dH].dataAttr)}));else{if(xr.hasAttribute("bgcolor")){let dH=xr.getAttribute("bgcolor");(dH.match(/^[0-9a-f]{3}$/i)||dH.match(/^[0-9a-f]{6}$/i))&&(dH=`#${dH}`),Vi("background-color","background-color",dH)}if(xr.hasAttribute("color")&&"mask-icon"!==xr.rel){let dH=xr.getAttribute("color");(dH.match(/^[0-9a-f]{3}$/i)||dH.match(/^[0-9a-f]{6}$/i))&&(dH=`#${dH}`),Vi("color","color",dH)}if(xr instanceof SVGElement){if(xr.hasAttribute("fill")){const dH=32,Ka=xr.getAttribute("fill");if("none"!==Ka)if(xr instanceof SVGTextElement)Vi("fill","color",Ka);else{const My=()=>{const{width:My,height:zX}=xr.getBoundingClientRect(),Lj=undefined;Vi("fill",My>dH||zX>dH?"background-color":"color",Ka)};(0,zX.isReadyStateComplete)()?My():(0,zX.addReadyStateCompleteListener)(My)}}xr.hasAttribute("stop-color")&&Vi("stop-color","background-color",xr.getAttribute("stop-color"))}if(xr.hasAttribute("stroke")){const dH=xr.getAttribute("stroke");Vi("stroke",xr instanceof SVGLineElement||xr instanceof SVGTextElement?"border-color":"color",dH)}xr.style&&(0,Lj.iterateCSSDeclarations)(xr.style,((dH,Ka)=>{if("background-image"!==dH||!Ka.includes("url"))if(CI.hasOwnProperty(dH)||dH.startsWith("--")&&!Bd[dH])Vi(dH,dH,Ka);else{const Ka=Bd[dH];if(Ka&&!xr.style.getPropertyValue(Ka)&&!xr.hasAttribute(Ka)){if("background-color"===Ka&&xr.hasAttribute("bgcolor"))return;xr.style.setProperty(dH,"")}}})),xr.style&&xr instanceof SVGTextElement&&xr.style.fill&&Vi("fill","color",xr.style.getPropertyValue("fill")),(0,My.forEach)(vx,(dH=>{xr.removeAttribute(CI[dH].dataAttr)})),nH.set(xr,RF(xr,dH))}}Ka.overrideInlineStyle=Cu},{"../../const":1,"../../utils/array":30,"../../utils/platform":40,"../../utils/throttle":42,"../../utils/time":43,"../utils/dom":18,"./css-rules":4,"./modify-css":10,"./variables":16}],9:[function(xr,dH,Ka){"use strict";Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.restoreMetaThemeColor=Ka.changeMetaThemeColorWhenAvailable=void 0;const My=xr("../../utils/color"),zX=xr("../../generators/modify-colors"),Lj=xr("../utils/log"),bq="theme-color",Bx=`meta[name="${bq}"]`;let IH=null,zk=null;function vx(xr,dH){IH=IH||xr.content;const Ka=(0,My.parseColorWithCache)(IH);Ka?xr.content=(0,zX.modifyBackgroundColor)(Ka,dH):(0,Lj.logWarn)("Invalid meta color",Ka)}function Vi(xr){const dH=document.querySelector(Bx);dH?vx(dH,xr):(zk&&zk.disconnect(),zk=new MutationObserver((dH=>{xr:for(let Ka=0;Ka<dH.length;Ka++){const{addedNodes:My}=dH[Ka];for(let dH=0;dH<My.length;dH++){const Ka=My[dH];if(Ka instanceof HTMLMetaElement&&Ka.name===bq){zk.disconnect(),zk=null,vx(Ka,xr);break xr}}}})),zk.observe(document.head,{childList:!0}))}function CI(){zk&&(zk.disconnect(),zk=null);const xr=document.querySelector(Bx);xr&&IH&&(xr.content=IH)}Ka.changeMetaThemeColorWhenAvailable=Vi,Ka.restoreMetaThemeColor=CI},{"../../generators/modify-colors":22,"../../utils/color":33,"../utils/log":19}],10:[function(xr,dH,Ka){"use strict";Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.cleanModificationCache=Ka.getShadowModifier=Ka.getShadowModifierWithInfo=Ka.getBgImageModifier=Ka.getModifiedFallbackStyle=Ka.getSelectionColor=Ka.getModifiedUserAgentStyle=Ka.getModifiableCSSDeclaration=void 0;const My=xr("../../utils/color"),zX=xr("../../utils/math"),Lj=xr("../../utils/text"),bq=xr("../../utils/url"),Bx=xr("../../generators/modify-colors"),IH=xr("./css-rules"),zk=xr("./image"),vx=xr("../utils/log"),Vi=xr("../../utils/platform"),CI=xr("../../utils/parsing");function jF(xr,dH){return Boolean(xr&&xr.getPropertyPriority(dH))}function Bd(xr,dH,Ka,My,zX,Lj){if(xr.startsWith("--")){const bq=qD(My,xr,dH,Ka,zX,Lj);if(bq)return{property:xr,value:bq,important:jF(Ka.style,xr),sourceValue:dH}}else if(dH.includes("var(")){const zX=yG(My,xr,dH);if(zX)return{property:xr,value:zX,important:jF(Ka.style,xr),sourceValue:dH}}else{if("color-scheme"===xr)return(0,vx.logWarn)("CSS property color-scheme is not supported"),null;if(xr.includes("color")&&"-webkit-print-color-adjust"!==xr||"fill"===xr||"stroke"===xr||"stop-color"===xr){const My=h(xr,dH,Ka);if(My)return{property:xr,value:My,important:jF(Ka.style,xr),sourceValue:dH}}else if("background-image"===xr||"list-style-image"===xr){const My=it(dH,Ka,zX,Lj);if(My)return{property:xr,value:My,important:jF(Ka.style,xr),sourceValue:dH}}else if(xr.includes("shadow")){const My=MR(dH);if(My)return{property:xr,value:My,important:jF(Ka.style,xr),sourceValue:dH}}}return null}function im(...xr){return xr.filter(Boolean).join(", ")}function pI(xr,dH,Ka){const My=[];dH||(My.push("html {"),My.push(`    background-color: ${(0,Bx.modifyBackgroundColor)({r:255,g:255,b:255},xr)} !important;`),My.push("}")),My.push("html {"),My.push(`    color-scheme: ${1===xr.mode?"dark":"dark light"} !important;`),My.push("}");const zX=im(dH?"":"html, body",Ka?"input, textarea, select, button, dialog":"");return zX&&(My.push(`${zX} {`),My.push(`    background-color: ${(0,Bx.modifyBackgroundColor)({r:255,g:255,b:255},xr)};`),My.push("}")),My.push(`${im("html, body",Ka?"input, textarea, select, button":"")} {`),My.push(`    border-color: ${(0,Bx.modifyBorderColor)({r:76,g:76,b:76},xr)};`),My.push(`    color: ${(0,Bx.modifyForegroundColor)({r:0,g:0,b:0},xr)};`),My.push("}"),My.push("a {"),My.push(`    color: ${(0,Bx.modifyForegroundColor)({r:0,g:64,b:255},xr)};`),My.push("}"),My.push("table {"),My.push(`    border-color: ${(0,Bx.modifyBorderColor)({r:128,g:128,b:128},xr)};`),My.push("}"),My.push("::placeholder {"),My.push(`    color: ${(0,Bx.modifyForegroundColor)({r:169,g:169,b:169},xr)};`),My.push("}"),My.push("input:-webkit-autofill,"),My.push("textarea:-webkit-autofill,"),My.push("select:-webkit-autofill {"),My.push(`    background-color: ${(0,Bx.modifyBackgroundColor)({r:250,g:255,b:189},xr)} !important;`),My.push(`    color: ${(0,Bx.modifyForegroundColor)({r:0,g:0,b:0},xr)} !important;`),My.push("}"),xr.scrollbarColor&&My.push(HC(xr)),xr.selectionColor&&My.push(pR(xr)),My.join("\n")}function AG(xr){let dH,Ka;if("auto"===xr.selectionColor)dH=(0,Bx.modifyBackgroundColor)({r:0,g:96,b:212},Object.assign(Object.assign({},xr),{grayscale:0})),Ka=(0,Bx.modifyForegroundColor)({r:255,g:255,b:255},Object.assign(Object.assign({},xr),{grayscale:0}));else{const zX=(0,My.parseColorWithCache)(xr.selectionColor),Lj=(0,My.rgbToHSL)(zX);dH=xr.selectionColor,Ka=Lj.l<.5?"#FFF":"#000"}return{backgroundColorSelection:dH,foregroundColorSelection:Ka}}function pR(xr){const dH=[],Ka=AG(xr),My=Ka.backgroundColorSelection,zX=Ka.foregroundColorSelection;return["::selection","::-moz-selection"].forEach((xr=>{dH.push(`${xr} {`),dH.push(`    background-color: ${My} !important;`),dH.push(`    color: ${zX} !important;`),dH.push("}")})),dH.join("\n")}function HC(xr){const dH=[];let Ka,Lj,bq,IH,zk,vx;if("auto"===xr.scrollbarColor)Ka=(0,Bx.modifyBackgroundColor)({r:241,g:241,b:241},xr),Lj=(0,Bx.modifyForegroundColor)({r:96,g:96,b:96},xr),bq=(0,Bx.modifyBackgroundColor)({r:176,g:176,b:176},xr),IH=(0,Bx.modifyBackgroundColor)({r:144,g:144,b:144},xr),zk=(0,Bx.modifyBackgroundColor)({r:96,g:96,b:96},xr),vx=(0,Bx.modifyBackgroundColor)({r:255,g:255,b:255},xr);else{const dH=(0,My.parseColorWithCache)(xr.scrollbarColor),Bx=(0,My.rgbToHSL)(dH),vx=Bx.l>.5,Vi=xr=>Object.assign(Object.assign({},Bx),{l:(0,zX.clamp)(Bx.l+xr,0,1)}),CI=xr=>Object.assign(Object.assign({},Bx),{l:(0,zX.clamp)(Bx.l-xr,0,1)});Ka=(0,My.hslToString)(CI(.4)),Lj=(0,My.hslToString)(vx?CI(.4):Vi(.4)),bq=(0,My.hslToString)(Bx),IH=(0,My.hslToString)(Vi(.1)),zk=(0,My.hslToString)(Vi(.2))}return dH.push("::-webkit-scrollbar {"),dH.push(`    background-color: ${Ka};`),dH.push(`    color: ${Lj};`),dH.push("}"),dH.push("::-webkit-scrollbar-thumb {"),dH.push(`    background-color: ${bq};`),dH.push("}"),dH.push("::-webkit-scrollbar-thumb:hover {"),dH.push(`    background-color: ${IH};`),dH.push("}"),dH.push("::-webkit-scrollbar-thumb:active {"),dH.push(`    background-color: ${zk};`),dH.push("}"),dH.push("::-webkit-scrollbar-corner {"),dH.push(`    background-color: ${vx};`),dH.push("}"),Vi.isFirefox&&(dH.push("* {"),dH.push(`    scrollbar-color: ${bq} ${Ka};`),dH.push("}")),dH.join("\n")}function dX(xr,{strict:dH}){const Ka=[],My=["microsoft.com","docs.microsoft.com"].includes(location.hostname);return Ka.push(`html, body, ${dH?`body :not(iframe)${My?':not(div[style^="position:absolute;top:0;left:-"]':""}`:"body > :not(iframe)"} {`),Ka.push(`    background-color: ${(0,Bx.modifyBackgroundColor)({r:255,g:255,b:255},xr)} !important;`),Ka.push(`    border-color: ${(0,Bx.modifyBorderColor)({r:64,g:64,b:64},xr)} !important;`),Ka.push(`    color: ${(0,Bx.modifyForegroundColor)({r:0,g:0,b:0},xr)} !important;`),Ka.push("}"),Ka.join("\n")}Ka.getModifiableCSSDeclaration=Bd,Ka.getModifiedUserAgentStyle=pI,Ka.getSelectionColor=AG,Ka.getModifiedFallbackStyle=dX;const hW=new Set(["inherit","transparent","initial","currentcolor","none","unset"]);function h(xr,dH,Ka){if(hW.has(dH.toLowerCase()))return dH;const zX=(0,My.parseColorWithCache)(dH);return zX?xr.includes("background")?Ka.style.webkitMaskImage&&"none"!==Ka.style.webkitMaskImage||Ka.style.webkitMask&&!Ka.style.webkitMask.startsWith("none")||Ka.style.mask&&"none"!==Ka.style.mask||Ka.style.getPropertyValue("mask-image")&&"none"!==Ka.style.getPropertyValue("mask-image")?xr=>(0,Bx.modifyForegroundColor)(zX,xr):xr=>(0,Bx.modifyBackgroundColor)(zX,xr):xr.includes("border")||xr.includes("outline")?xr=>(0,Bx.modifyBorderColor)(zX,xr):xr=>(0,Bx.modifyForegroundColor)(zX,xr):((0,vx.logWarn)("Couldn't parse color",dH),null)}const nH=new Map,di=new Map;function RF(xr,dH){if(!xr||0===dH.length)return!1;if(dH.some((xr=>"*"===xr)))return!0;const Ka=xr.split(/,\s*/g);for(let xr=0;xr<dH.length;xr++){const My=dH[xr];if(Ka.some((xr=>xr===My)))return!0}return!1}function it(xr,dH,Ka,Vi){try{const jF=(0,CI.parseGradient)(xr),Bd=(0,Lj.getMatches)(IH.cssURLRegex,xr);if(0===Bd.length&&0===jF.length)return xr;const im=dH=>{let Ka=0;return dH.map((dH=>{const My=xr.indexOf(dH,Ka);return Ka=My+dH.length,{match:dH,index:My}}))},pI=jF.map((xr=>Object.assign({type:"gradient"},xr))).concat(im(Bd).map((xr=>Object.assign({type:"url",offset:0},xr)))).sort(((xr,dH)=>xr.index>dH.index?1:-1)),AG=xr=>{const{typeGradient:dH,match:Ka,hasComma:zX}=xr,bq=/([^\(\),]+(\([^\(\)]*(\([^\(\)]*\)*[^\(\)]*)?\))?([^\(\), ]|( (?!calc)))*),?/g,IH=/^(from|color-stop|to)\(([^\(\)]*?,\s*)?(.*?)\)$/,zk=(0,Lj.getMatches)(bq,Ka,1).map((xr=>{xr=xr.trim();let dH=(0,My.parseColorWithCache)(xr);if(dH)return xr=>(0,Bx.modifyGradientColor)(dH,xr);const Ka=xr.lastIndexOf(" ");if(dH=(0,My.parseColorWithCache)(xr.substring(0,Ka)),dH)return My=>`${(0,Bx.modifyGradientColor)(dH,My)} ${xr.substring(Ka+1)}`;const zX=xr.match(IH);return zX&&(dH=(0,My.parseColorWithCache)(zX[3]),dH)?xr=>`${zX[1]}(${zX[2]?`${zX[2]}, `:""}${(0,Bx.modifyGradientColor)(dH,xr)})`:()=>xr}));return xr=>`${dH}(${zk.map((dH=>dH(xr))).join(", ")})${zX?", ":""}`},pR=xr=>{var My;if(RF(dH.selectorText,Ka))return null;let zX=(0,IH.getCSSURLValue)(xr);const Lj=0===zX.length,{parentStyleSheet:Bx}=dH,CI=Bx&&Bx.href?(0,IH.getCSSBaseBath)(Bx.href):(null===(My=Bx.ownerNode)||void 0===My?void 0:My.baseURI)||location.origin;zX=(0,bq.getAbsoluteURL)(CI,zX);const jF=`url("${zX}")`;return async xr=>{if(Lj)return"url('')";let dH;if(nH.has(zX))dH=nH.get(zX);else try{if(di.has(zX)){const xr=di.get(zX);if(dH=await new Promise((dH=>xr.push(dH))),!dH)return null}else di.set(zX,[]),dH=await(0,zk.getImageDetails)(zX),nH.set(zX,dH),di.get(zX).forEach((xr=>xr(dH))),di.delete(zX);if(Vi())return null}catch(xr){return(0,vx.logWarn)(xr),di.has(zX)&&(di.get(zX).forEach((xr=>xr(null))),di.delete(zX)),jF}const Ka=undefined;return HC(dH,xr)||jF}},HC=(xr,dH)=>{const{isDark:Ka,isLight:My,isTransparent:Lj,isLarge:bq,isTooLarge:Bx,width:IH}=xr;let Vi;if(Bx)(0,vx.logInfo)(`Not modifying too large image ${xr.src}`),Vi=`url("${xr.src}")`;else if(Ka&&Lj&&1===dH.mode&&!bq&&IH>2){(0,vx.logInfo)(`Inverting dark image ${xr.src}`);const Ka=undefined;Vi=`url("${(0,zk.getFilteredImageDataURL)(xr,Object.assign(Object.assign({},dH),{sepia:(0,zX.clamp)(dH.sepia+10,0,100)}))}")`}else if(My&&!Lj&&1===dH.mode)if(bq)(0,vx.logInfo)(`Not modifying light non-transparent large image ${xr.src}`),Vi="none";else{(0,vx.logInfo)(`Dimming light image ${xr.src}`);const Ka=undefined;Vi=`url("${(0,zk.getFilteredImageDataURL)(xr,dH)}")`}else if(0===dH.mode&&My&&!bq){(0,vx.logInfo)(`Applying filter to image ${xr.src}`);const Ka=undefined;Vi=`url("${(0,zk.getFilteredImageDataURL)(xr,Object.assign(Object.assign({},dH),{brightness:(0,zX.clamp)(dH.brightness-10,5,200),sepia:(0,zX.clamp)(dH.sepia+10,0,100)}))}")`}else(0,vx.logInfo)(`Not modifying too large image ${xr.src}`),Vi=null;return Vi},dX=[];let hW=0,h=!1;return pI.forEach((({type:dH,match:Ka,index:My,typeGradient:zX,hasComma:Lj,offset:bq},Bx)=>{const IH=My,zk=hW,vx=IH+Ka.length+bq;hW=vx,zk!==IH&&(h?dX.push((()=>{let dH=xr.substring(zk,IH);return","===dH[0]&&(dH=dH.substring(1)),dH})):dX.push((()=>xr.substring(zk,IH)))),h=Lj||!1,"url"===dH?dX.push(pR(Ka)):"gradient"===dH&&dX.push(AG({match:Ka,index:My,typeGradient:zX,hasComma:Lj||!1,offset:bq})),Bx===pI.length-1&&dX.push((()=>xr.substring(vx)))})),xr=>{const dH=dX.filter(Boolean).map((dH=>dH(xr)));if(dH.some((xr=>xr instanceof Promise)))return Promise.all(dH).then((xr=>xr.filter(Boolean).join("")));const Ka=dH.join("");return Ka.endsWith(", initial")?Ka.slice(0,-9):Ka}}catch(dH){return(0,vx.logWarn)(`Unable to parse gradient ${xr}`,dH),null}}function Cu(xr){try{let dH=0;const Ka=(0,Lj.getMatches)(/(^|\s)(?!calc)([a-z]+\(.+?\)|#[0-9a-f]+|[a-z]+)(.*?(inset|outset)?($|,))/gi,xr,2);let zX=0;const bq=Ka.map(((Lj,bq)=>{const IH=dH,zk=xr.indexOf(Lj,dH),vx=zk+Lj.length;dH=vx;const Vi=(0,My.parseColorWithCache)(Lj);return Vi?dH=>`${xr.substring(IH,zk)}${(0,Bx.modifyShadowColor)(Vi,dH)}${bq===Ka.length-1?xr.substring(vx):""}`:(zX++,()=>xr.substring(IH,vx))}));return xr=>{const dH=bq.map((dH=>dH(xr))).join("");return{matchesLength:Ka.length,unparseableMatchesLength:zX,result:dH}}}catch(dH){return(0,vx.logWarn)(`Unable to parse shadow ${xr}`,dH),null}}function MR(xr){const dH=Cu(xr);return dH?xr=>dH(xr).result:null}function qD(xr,dH,Ka,My,zX,Lj){return xr.getModifierForVariable({varName:dH,sourceValue:Ka,rule:My,ignoredImgSelectors:zX,isCancelled:Lj})}function yG(xr,dH,Ka){return xr.getModifierForVarDependant(dH,Ka)}function Zf(){(0,Bx.clearColorModificationCache)(),nH.clear(),(0,zk.cleanImageProcessingCache)(),di.clear()}Ka.getBgImageModifier=it,Ka.getShadowModifierWithInfo=Cu,Ka.getShadowModifier=MR,Ka.cleanModificationCache=Zf},{"../../generators/modify-colors":22,"../../utils/color":33,"../../utils/math":36,"../../utils/parsing":39,"../../utils/platform":40,"../../utils/text":41,"../../utils/url":45,"../utils/log":19,"./css-rules":4,"./image":6}],11:[function(xr,dH,Ka){"use strict";Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.EVENT_ARG=void 0;const My=xr("./stylesheet-proxy"),zX=xr("../utils/log"),Lj=xr("../../const");document.currentScript&&document.currentScript.remove();const bq=`${Lj.MISC_PREFIX}ProxyInjected`,Bx=`${Lj.EVENT_PREFIX}stylesheetProxy__done`;Ka.EVENT_ARG=`${Lj.EVENT_PREFIX}stylesheetProxy__arg`;const IH=!document.currentScript;function zk(xr){(0,My.injectProxy)(xr),CI(),document.dispatchEvent(new CustomEvent(Bx))}function vx(){const xr=document.currentScript.dataset.arg;if(void 0!==xr){document.documentElement.dataset[bq]="true";const dH=JSON.parse(xr);(0,zX.logInfo)(`MV3 proxy injector: regular path runs injectProxy(${dH}).`),zk(dH)}}function Vi(xr){document.removeEventListener(Ka.EVENT_ARG,Vi),void 0===document.documentElement.dataset[bq]?(document.documentElement.dataset[bq]="true",(0,zX.logInfo)(`MV3 proxy injector: ${IH?"registerd":"dedicated"} path runs injectProxy(${xr.detail}).`),zk(xr.detail)):(0,zX.logInfo)(`MV3 proxy injector: ${IH?"registerd":"dedicated"} path exits because everything is done.`)}function CI(){document.removeEventListener(Ka.EVENT_ARG,Vi),document.removeEventListener(Bx,CI)}function jF(){(0,zX.logInfo)(`MV3 proxy injector: ${IH?"registerd":"dedicated"} path setup...`),document.addEventListener(Ka.EVENT_ARG,Vi),document.addEventListener(Bx,CI)}function Bd(){void 0===document.documentElement.dataset[bq]?((0,zX.logInfo)("MV3 proxy injector: proxy attempts to inject..."),document.currentScript&&vx(),jF()):(0,zX.logInfo)("MV3 proxy injector: proxy exits because everything is done.")}Bd()},{"../../const":1,"../utils/log":19,"./stylesheet-proxy":15}],12:[function(xr,dH,Ka){"use strict";Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.bgFetch=void 0;const My=xr("../../utils/message");let zX=0;const Lj=new Map,bq=new Map;async function Bx(xr){return new Promise(((dH,Ka)=>{const Bx=++zX;Lj.set(Bx,dH),bq.set(Bx,Ka),chrome.runtime.sendMessage({type:My.MessageType.CS_FETCH,data:xr,id:Bx})}))}Ka.bgFetch=Bx,chrome.runtime.onMessage.addListener((({type:xr,data:dH,error:Ka,id:zX})=>{if(xr===My.MessageType.BG_FETCH_RESPONSE){const xr=Lj.get(zX),My=bq.get(zX);Lj.delete(zX),bq.delete(zX),Ka?My&&My(Ka):xr&&xr(dH)}}))},{"../../utils/message":37}],13:[function(xr,dH,Ka){"use strict";Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.manageStyle=Ka.cleanLoadingLinks=Ka.getManageableStyles=Ka.shouldManageStyle=Ka.STYLE_SELECTOR=void 0;const My=xr("../../utils/array"),zX=xr("../../utils/text"),Lj=xr("../../utils/url"),bq=xr("../utils/dom"),Bx=xr("../utils/log"),IH=xr("./css-rules"),zk=xr("./network"),vx=xr("./stylesheet-modifier"),Vi=xr("../../utils/platform"),CI=xr("../../const"),jF=!1;function Bd(xr){if(!xr.href)return!1;try{const dH=undefined;return"fonts.googleapis.com"===new URL(xr.href).hostname}catch(dH){return(0,Bx.logInfo)(`Couldn't construct ${xr.href} as URL`),!1}}function im(xr){return(xr instanceof HTMLStyleElement||xr instanceof SVGStyleElement||xr instanceof HTMLLinkElement&&Boolean(xr.rel)&&xr.rel.toLowerCase().includes("stylesheet")&&Boolean(xr.href)&&!xr.disabled&&(!Vi.isFirefox||!xr.href.startsWith("moz-extension://"))&&!Bd(xr))&&!xr.classList.contains(CI.STYLESHEET_COMMON_CLASSNAME)&&"print"!==xr.media.toLowerCase()&&!xr.classList.contains("stylus")}function pI(xr,dH=[],zX=!0){return im(xr)?dH.push(xr):(xr instanceof Element||Vi.isShadowDomSupported&&xr instanceof ShadowRoot||xr===document)&&((0,My.forEach)(xr.querySelectorAll(Ka.STYLE_SELECTOR),(xr=>pI(xr,dH,!1))),zX&&(0,bq.iterateShadowHosts)(xr,(xr=>pI(xr.shadowRoot,dH,!1)))),dH}Ka.STYLE_SELECTOR='style, link[rel*="stylesheet" i]:not([disabled])',Ka.shouldManageStyle=im,Ka.getManageableStyles=pI;const AG=new WeakSet,pR=new WeakSet;let HC=!1;document.addEventListener(`${CI.EVENT_PREFIX}inlineScriptsAllowed`,(()=>{HC=!0}));let dX=0;const hW=new Map;function h(){hW.clear()}function nH(xr,{update:dH,loadingStart:Ka,loadingEnd:My}){const zX=[];let zk=xr;for(;(zk=zk.nextElementSibling)&&zk.matches(`.${CI.STYLESHEET_COMMON_CLASSNAME}`);)zX.push(zk);let Bd=zX.find((xr=>xr.matches(CI.STYLESHEET_CORS_SELECTOR)&&!pR.has(xr)))||null,im=zX.find((xr=>xr.matches(CI.STYLESHEET_SYNC_SELECTOR)&&!AG.has(xr)))||null,pI=null,h=null,nH=!1,RF=!0;const qD=(0,vx.createStyleSheetModifier)(),yG=new MutationObserver((()=>{dH()})),Zf={attributes:!0,childList:!0,subtree:!0,characterData:!0};function Mr(){return xr instanceof HTMLStyleElement&&xr.textContent.trim().match(IH.cssImportRegex)}function Ck(xr,dH){let Ka=!1;if(xr){let My;xr:for(let zX=0,Lj=xr.length;zX<Lj;zX++)if(My=xr[zX],My.href){if(!dH){Ka=!0;break xr}if(!My.href.startsWith("https://fonts.googleapis.com/")&&My.href.startsWith("http")&&!My.href.startsWith(location.origin)){Ka=!0;break xr}}}return Ka}function Jp(){if(Bd)return(0,Bx.logInfo)("[getRulesSync] Using cors-copy."),Bd.sheet.cssRules;if(Mr())return(0,Bx.logInfo)("[getRulesSync] CSSImport detected."),null;const dH=fI();return xr instanceof HTMLLinkElement&&!(0,Lj.isRelativeHrefOnAbsolutePath)(xr.href)&&Ck(dH,!1)?((0,Bx.logInfo)("[getRulesSync] CSSImportRule detected on non-local href."),null):Ck(dH,!0)?((0,Bx.logInfo)("[getRulesSync] Cross-Origin CSSImportRule detected."),null):((0,Bx.logInfo)("[getRulesSync] Using cssRules."),!dH&&(0,Bx.logWarn)("[getRulesSync] cssRules is null, trying again."),dH)}function jp(){Bd?(xr.nextSibling!==Bd&&xr.parentNode.insertBefore(Bd,xr.nextSibling),Bd.nextSibling!==im&&xr.parentNode.insertBefore(im,Bd.nextSibling)):xr.nextSibling!==im&&xr.parentNode.insertBefore(im,xr.nextSibling)}function Cx(){im=xr instanceof SVGStyleElement?document.createElementNS("http://www.w3.org/2000/svg","style"):document.createElement("style"),im.classList.add(CI.STYLESHEET_COMMON_CLASSNAME),im.classList.add(CI.STYLESHEET_SYNC_SELECTOR.substring(1)),im.media="screen",xr.title&&(im.title=xr.title),AG.add(im)}let we=!1,TQ=!1;const mm=++dX;async function hq(){let dH,Ka;if(xr instanceof HTMLLinkElement){let[My,zX]=JK();if(zX&&(0,Bx.logWarn)(zX),!My&&!zX&&!Vi.isSafari||Vi.isSafari&&!xr.sheet||xo(zX)){try{(0,Bx.logInfo)(`Linkelement ${mm} is not loaded yet and thus will be await for`,xr),await di(xr,mm)}catch(xr){(0,Bx.logWarn)(xr),TQ=!0}if(nH)return null;[My,zX]=JK(),zX&&(0,Bx.logWarn)(zX)}if(My&&!Ck(My,!1))return My;if(dH=await it(xr.href),Ka=(0,IH.getCSSBaseBath)(xr.href),nH)return null}else{if(!Mr())return null;dH=xr.textContent.trim(),Ka=(0,IH.getCSSBaseBath)(location.href)}if(dH){try{const My=await Cu(dH,Ka);Bd=MR(xr,My)}catch(xr){(0,Bx.logWarn)(xr)}if(Bd)return pI=(0,bq.watchForNodePosition)(Bd,"prev-sibling"),Bd.sheet.cssRules}return null}function fx(xr){const zX=Jp();return zX?{rules:zX}:xr.secondRound?((0,Bx.logWarn)("Detected dead-lock at details(), returning early to prevent it."),null):(we||TQ||(we=!0,Ka(),hq().then((xr=>{we=!1,My(),xr&&dH()})).catch((xr=>{(0,Bx.logWarn)(xr),we=!1,My()}))),null)}let VH=!1;function Vr(xr,Ka){const My=Jp();function zX(xr){if(xr)for(let dH=xr.cssRules.length-1;dH>=0;dH--)xr.deleteRule(dH)}function Lj(){im||Cx(),h&&h.stop(),jp(),null==im.sheet&&(im.textContent="");const xr=undefined;return zX(im.sheet),h?h.run():h=(0,bq.watchForNodePosition)(im,"prev-sibling",(()=>{VH=!0,Bx()})),im.sheet}function Bx(){const zX=VH;VH=!1,qD.modifySheet({prepareSheet:Lj,sourceCSSRules:My,theme:xr,ignoreImageAnalysis:Ka,force:zX,isAsyncCancelled:()=>nH}),RF=0===im.sheet.cssRules.length,qD.shouldRebuildStyle()&&(0,bq.addReadyStateCompleteListener)((()=>dH()))}My&&(nH=!1,Bx())}function JK(){try{return null==xr.sheet?[null,null]:[xr.sheet.cssRules,null]}catch(xr){return[null,xr]}}function xo(xr){return xr&&xr.message&&xr.message.includes("loading")}function fI(){const[xr,dH]=JK();return dH?((0,Bx.logWarn)(dH),null):xr}function kM(){SS(),jF||HC&&xr.sheet||wz()}let dJ=null,qG=null;function BP(){const xr=fI();return xr?xr.length:null}function WD(){return BP()!==dJ}function wz(){dJ=BP(),lg();const Ka=()=>{WD()&&(dJ=BP(),dH()),HC&&xr.sheet?lg():qG=requestAnimationFrame(Ka)};Ka()}function lg(){cancelAnimationFrame(qG)}let Nr=!1;function BC(){function xr(){Nr=!1,nH||dH()}HC=!0,lg(),Nr||(Nr=!0,"function"==typeof queueMicrotask?queueMicrotask(xr):requestAnimationFrame(xr))}function SS(){xr.addEventListener(`${CI.EVENT_PREFIX}updateSheet`,BC)}function xt(){xr.removeEventListener(`${CI.EVENT_PREFIX}updateSheet`,BC)}function ac(){xt(),lg()}function UZ(){yG.disconnect(),nH=!0,pI&&pI.stop(),h&&h.stop(),ac()}function MU(){if(UZ(),(0,bq.removeNode)(Bd),(0,bq.removeNode)(im),My(),hW.has(mm)){const xr=hW.get(mm);hW.delete(mm),xr&&xr()}}function cM(){yG.observe(xr,Zf),xr instanceof HTMLStyleElement&&kM()}const II=10;let vh=0;function bD(){im&&(vh++,vh>II?(0,Bx.logWarn)("Style sheet was moved multiple times",xr):((0,Bx.logWarn)("Restore style",im,xr),jp(),pI&&pI.skip(),h&&h.skip(),RF||(VH=!0,dH())))}return{details:fx,render:Vr,pause:UZ,destroy:MU,watch:cM,restore:bD}}async function di(xr,dH){return new Promise(((Ka,My)=>{const zX=()=>{xr.removeEventListener("load",Lj),xr.removeEventListener("error",bq),hW.delete(dH)},Lj=()=>{zX(),(0,Bx.logInfo)(`Linkelement ${dH} has been loaded`),Ka()},bq=()=>{zX(),My(`Linkelement ${dH} couldn't be loaded. ${xr.href}`)};hW.set(dH,(()=>{zX(),My()})),xr.addEventListener("load",Lj),xr.addEventListener("error",bq),xr.href||bq()}))}function RF(xr){return(0,IH.getCSSURLValue)(xr.substring(7).trim().replace(/;$/,"").replace(/screen$/,""))}async function it(xr){return xr.startsWith("data:")?await(await fetch(xr)).text():await(0,zk.bgFetch)({url:xr,responseType:"text",mimeType:"text/css",origin:window.location.origin})}async function Cu(xr,dH,Ka=new Map){xr=(0,IH.removeCSSComments)(xr),xr=(0,IH.replaceCSSFontFace)(xr),xr=(0,IH.replaceCSSRelativeURLsWithAbsolute)(xr,dH);const My=(0,zX.getMatches)(IH.cssImportRegex,xr);for(const zX of My){const My=RF(zX),bq=(0,Lj.getAbsoluteURL)(dH,My);let zk;if(Ka.has(bq))zk=Ka.get(bq);else try{zk=await it(bq),Ka.set(bq,zk),zk=await Cu(zk,(0,IH.getCSSBaseBath)(bq),Ka)}catch(xr){(0,Bx.logWarn)(xr),zk=""}xr=xr.split(zX).join(zk)}return xr=xr.trim()}function MR(xr,dH){if(!dH)return null;const Ka=document.createElement("style");return Ka.classList.add(CI.STYLESHEET_COMMON_CLASSNAME),Ka.classList.add(CI.STYLESHEET_CORS_SELECTOR.substring(1)),Ka.media="screen",Ka.textContent=dH,xr.parentNode.insertBefore(Ka,xr.nextSibling),Ka.sheet.disabled=!0,pR.add(Ka),Ka}Ka.cleanLoadingLinks=h,Ka.manageStyle=nH},{"../../const":1,"../../utils/array":30,"../../utils/platform":40,"../../utils/text":41,"../../utils/url":45,"../utils/dom":18,"../utils/log":19,"./css-rules":4,"./network":12,"./stylesheet-modifier":14}],14:[function(xr,dH,Ka){"use strict";Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.createStyleSheetModifier=void 0;const My=xr("../../utils/throttle"),zX=xr("./css-rules"),Lj=xr("./modify-css"),bq=xr("./variables"),Bx=["mode","brightness","contrast","grayscale","sepia","darkSchemeBackgroundColor","darkSchemeTextColor","lightSchemeBackgroundColor","lightSchemeTextColor"];function IH(xr){let dH="";return Bx.forEach((Ka=>{dH+=`${Ka}:${xr[Ka]};`})),dH}const zk=(0,My.createAsyncTasksQueue)();function vx(){let xr=0;const dH=new Set,Ka=new Map,My=new Set;let Bx=null,vx=!1,Vi=!1;function CI(){return vx&&!Vi}function jF(CI){const jF=CI.sourceCSSRules,{theme:Bd,ignoreImageAnalysis:im,force:pI,prepareSheet:AG,isAsyncCancelled:pR}=CI;let HC=0===Ka.size;const dX=new Set(Ka.keys()),hW=IH(Bd),h=hW!==Bx;vx&&(Vi=!0);const nH=[];if((0,zX.iterateCSSRules)(jF,(xr=>{let My=xr.cssText,Bx=!1;if(dX.delete(My),xr.parentRule instanceof CSSMediaRule&&(My+=`;${xr.parentRule.media.mediaText}`),dH.has(My)||(dH.add(My),Bx=!0),!Bx)return void nH.push(Ka.get(My));if(HC=!0,"revert"===xr.style.all)return;const IH=[];xr.style&&(0,zX.iterateCSSDeclarations)(xr.style,((dH,Ka)=>{const My=(0,Lj.getModifiableCSSDeclaration)(dH,Ka,xr,bq.variablesStore,im,pR);My&&IH.push(My)}));let zk=null;if(IH.length>0){const dH=xr.parentRule;zk={selector:xr.selectorText,declarations:IH,parentRule:dH},nH.push(zk)}Ka.set(My,zk)}),(()=>{vx=!0})),dX.forEach((xr=>{dH.delete(xr),Ka.delete(xr)})),Bx=hW,!pI&&!HC&&!h)return;function di(xr,dH,Ka){const{selector:My,declarations:zX}=Ka,Lj=xr=>{const{property:dH,value:Ka,important:My,sourceValue:zX}=xr;return`${dH}: ${null==Ka?zX:Ka}${My?" !important":""};`};let bq="";zX.forEach((xr=>{bq+=`${Lj(xr)} `}));const Bx=`${My} { ${bq} }`;xr.insertRule(Bx,dH)}xr++;const RF=new Map,it=new Map;let Cu=0,MR=0;const qD={rule:null,rules:[],isGroup:!0},yG=new WeakMap;function Zf(xr){if(null==xr)return qD;if(yG.has(xr))return yG.get(xr);const dH={rule:xr,rules:[],isGroup:!0};yG.set(xr,dH);const Ka=undefined;return Zf(xr.parentRule).rules.push(dH),dH}My.forEach((xr=>xr())),My.clear(),nH.filter((xr=>xr)).forEach((({selector:dH,declarations:Ka,parentRule:zX})=>{const Lj=Zf(zX),bq={selector:dH,declarations:[],isGroup:!1},Bx=bq.declarations;function IH(dH,Ka,My,zX){const Lj=++Cu,bq={property:dH,value:null,important:My,asyncKey:Lj,sourceValue:zX};Bx.push(bq);const IH=xr;Ka.then((dH=>{dH&&!pR()&&IH===xr&&(bq.value=dH,zk.add((()=>{pR()||IH!==xr||Jp(Lj)})))}))}function vx(dH,Ka,zX,Lj){const{declarations:bq,onTypeChange:zk}=Ka,vx=++MR,Vi=xr,CI=Bx.length;let jF=[];if(0===bq.length){const xr={property:dH,value:Lj,important:zX,sourceValue:Lj,varKey:vx};Bx.push(xr),jF=[xr]}bq.forEach((xr=>{if(xr.value instanceof Promise)IH(xr.property,xr.value,zX,Lj);else{const dH={property:xr.property,value:xr.value,important:zX,sourceValue:Lj,varKey:vx};Bx.push(dH),jF.push(dH)}})),zk.addListener((dH=>{if(pR()||Vi!==xr)return;const Ka=dH.map((xr=>({property:xr.property,value:xr.value,important:zX,sourceValue:Lj,varKey:vx}))),My=Bx.indexOf(jF[0],CI);Bx.splice(My,jF.length,...Ka),jF=Ka,jp(vx)})),My.add((()=>zk.removeListeners()))}Lj.rules.push(bq),Ka.forEach((({property:xr,value:dH,important:Ka,sourceValue:My})=>{if("function"==typeof dH){const zX=dH(Bd);zX instanceof Promise?IH(xr,zX,Ka,My):xr.startsWith("--")?vx(xr,zX,Ka,My):Bx.push({property:xr,value:zX,important:Ka,sourceValue:My})}else Bx.push({property:xr,value:dH,important:Ka,sourceValue:My})}))}));const Mr=AG();function Ck(){function xr(xr,dH){const{rule:Ka}=xr;if(Ka instanceof CSSMediaRule){const{media:xr}=Ka,My=dH.cssRules.length;return dH.insertRule(`@media ${xr.mediaText} {}`,My),dH.cssRules[My]}return dH}function dH(Ka,My,zX){Ka.rules.forEach((Ka=>{if(Ka.isGroup){const Lj=undefined;dH(Ka,xr(Ka,My),zX)}else zX(Ka,My)}))}dH(qD,Mr,((xr,dH)=>{const Ka=dH.cssRules.length;xr.declarations.forEach((({asyncKey:My,varKey:zX})=>{null!=My&&RF.set(My,{rule:xr,target:dH,index:Ka}),null!=zX&&it.set(zX,{rule:xr,target:dH,index:Ka})})),di(dH,Ka,xr)}))}function Jp(xr){const{rule:dH,target:Ka,index:My}=RF.get(xr);Ka.deleteRule(My),di(Ka,My,dH),RF.delete(xr)}function jp(xr){const{rule:dH,target:Ka,index:My}=it.get(xr);Ka.deleteRule(My),di(Ka,My,dH)}Ck()}return{modifySheet:jF,shouldRebuildStyle:CI}}Ka.createStyleSheetModifier=vx},{"../../utils/throttle":42,"./css-rules":4,"./modify-css":10,"./variables":16}],15:[function(xr,dH,Ka){"use strict";Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.injectProxy=void 0;const My=xr("../../const");function zX(xr){document.dispatchEvent(new CustomEvent(`${My.EVENT_PREFIX}inlineScriptsAllowed`));const dH=Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype,"addRule"),Ka=Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype,"insertRule"),zX=Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype,"deleteRule"),Lj=Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype,"removeRule"),bq=xr?Object.getOwnPropertyDescriptor(Document.prototype,"styleSheets"):null,Bx=["baidu.com","baike.baidu.com","ditu.baidu.com","map.baidu.com","maps.baidu.com","haokan.baidu.com","pan.baidu.com","passport.baidu.com","tieba.baidu.com","www.baidu.com"].includes(location.hostname),IH=Bx?Object.getOwnPropertyDescriptor(Element.prototype,"getElementsByTagName"):null,zk="www.vy.no"===location.hostname,vx=zk?Object.getOwnPropertyDescriptor(Node.prototype,"childNodes"):null,Vi=()=>{Object.defineProperty(CSSStyleSheet.prototype,"addRule",dH),Object.defineProperty(CSSStyleSheet.prototype,"insertRule",Ka),Object.defineProperty(CSSStyleSheet.prototype,"deleteRule",zX),Object.defineProperty(CSSStyleSheet.prototype,"removeRule",Lj),document.removeEventListener(`${My.EVENT_PREFIX}cleanUp`,Vi),document.removeEventListener(`${My.EVENT_PREFIX}addUndefinedResolver`,CI),xr&&Object.defineProperty(Document.prototype,"styleSheets",bq),Bx&&Object.defineProperty(Element.prototype,"getElementsByTagName",IH),zk&&Object.defineProperty(Node.prototype,"childNodes",vx)},CI=xr=>{customElements.whenDefined(xr.detail.tag).then((()=>{document.dispatchEvent(new CustomEvent(`${My.EVENT_PREFIX}isDefined`,{detail:{tag:xr.detail.tag}}))}))};document.addEventListener(My.MSG_CLEANUP,Vi),document.addEventListener(`${My.EVENT_PREFIX}addUndefinedResolver`,CI);const jF=new Event(`${My.EVENT_PREFIX}updateSheet`);function Bd(xr,Ka,zX){return dH.value.call(this,xr,Ka,zX),this.ownerNode&&!this.ownerNode.classList.contains(My.STYLESHEET_COMMON_CLASSNAME)&&this.ownerNode.dispatchEvent(jF),-1}function im(xr,dH){const zX=Ka.value.call(this,xr,dH);return this.ownerNode&&!this.ownerNode.classList.contains(My.STYLESHEET_COMMON_CLASSNAME)&&this.ownerNode.dispatchEvent(jF),zX}function pI(xr){zX.value.call(this,xr),this.ownerNode&&!this.ownerNode.classList.contains(My.STYLESHEET_COMMON_CLASSNAME)&&this.ownerNode.dispatchEvent(jF)}function AG(xr){Lj.value.call(this,xr),this.ownerNode&&!this.ownerNode.classList.contains(My.STYLESHEET_COMMON_CLASSNAME)&&this.ownerNode.dispatchEvent(jF)}function pR(){const xr=()=>{const xr=undefined,dH=[...bq.get.call(this)].filter((xr=>xr.ownerNode&&!xr.ownerNode.classList.contains(My.STYLESHEET_COMMON_CLASSNAME)));return dH.item=xr=>dH[xr],Object.setPrototypeOf(dH,StyleSheetList.prototype)};let dH=xr();const Ka=undefined;return dH=new Proxy(dH,{get:function(dH,Ka){return xr()[Ka]}}),dH}function HC(xr){if("style"!==xr)return IH.value.call(this,xr);const dH=()=>{const dH=IH.value.call(this,xr);return Object.setPrototypeOf([...dH].filter((xr=>!xr.classList.contains(My.STYLESHEET_COMMON_CLASSNAME))),NodeList.prototype)};let Ka=dH();const zX=undefined;return Ka=new Proxy(Ka,{get:function(xr,Ka){return dH()[Number(Ka)||Ka]}}),Ka}function dX(){const xr=vx.get.call(this);return Object.setPrototypeOf([...xr].filter((xr=>!xr.classList||!xr.classList.contains(My.STYLESHEET_COMMON_CLASSNAME))),NodeList.prototype)}Object.defineProperty(CSSStyleSheet.prototype,"addRule",Object.assign({},dH,{value:Bd})),Object.defineProperty(CSSStyleSheet.prototype,"insertRule",Object.assign({},Ka,{value:im})),Object.defineProperty(CSSStyleSheet.prototype,"deleteRule",Object.assign({},zX,{value:pI})),Object.defineProperty(CSSStyleSheet.prototype,"removeRule",Object.assign({},Lj,{value:AG})),xr&&Object.defineProperty(Document.prototype,"styleSheets",Object.assign({},bq,{get:pR})),Bx&&Object.defineProperty(Element.prototype,"getElementsByTagName",Object.assign({},IH,{value:HC})),zk&&Object.defineProperty(Node.prototype,"childNodes",Object.assign({},vx,{get:dX}))}Ka.injectProxy=zX},{"../../const":1}],16:[function(xr,dH,Ka){"use strict";Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.replaceCSSVariablesNames=Ka.variablesStore=Ka.VariablesStore=void 0;const My=xr("../../generators/modify-colors"),zX=xr("../../utils/text"),Lj=xr("./css-rules"),bq=xr("./modify-css"),Bx=xr("../../utils/color"),IH=xr("../../const"),zk=1<<0,vx=1<<1,Vi=1<<2,CI=1<<3;class jF{constructor(){this.varTypes=new Map,this.rulesQueue=[],this.definedVars=new Set,this.varRefs=new Map,this.unknownColorVars=new Set,this.unknownBgVars=new Set,this.undefinedVars=new Set,this.initialVarTypes=new Map,this.changedTypeVars=new Set,this.typeChangeSubscriptions=new Map,this.unstableVarValues=new Map}clear(){this.varTypes.clear(),this.rulesQueue.splice(0),this.definedVars.clear(),this.varRefs.clear(),this.unknownColorVars.clear(),this.unknownBgVars.clear(),this.undefinedVars.clear(),this.initialVarTypes.clear(),this.changedTypeVars.clear(),this.typeChangeSubscriptions.clear(),this.unstableVarValues.clear()}isVarType(xr,dH){return this.varTypes.has(xr)&&(this.varTypes.get(xr)&dH)>0}addRulesForMatching(xr){this.rulesQueue.push(xr)}matchVariablesAndDependants(){this.changedTypeVars.clear(),this.initialVarTypes=new Map(this.varTypes),this.collectRootVariables(),this.collectVariablesAndVarDep(this.rulesQueue),this.rulesQueue.splice(0),this.collectRootVarDependants(),this.varRefs.forEach(((xr,dH)=>{xr.forEach((xr=>{this.varTypes.has(dH)&&this.resolveVariableType(xr,this.varTypes.get(dH))}))})),this.unknownColorVars.forEach((xr=>{this.unknownBgVars.has(xr)?(this.unknownColorVars.delete(xr),this.unknownBgVars.delete(xr),this.resolveVariableType(xr,zk)):this.isVarType(xr,zk|vx|Vi)?this.unknownColorVars.delete(xr):this.undefinedVars.add(xr)})),this.unknownBgVars.forEach((xr=>{const dH=undefined;null!=this.findVarRef(xr,(xr=>this.unknownColorVars.has(xr)||this.isVarType(xr,vx|Vi)))?this.itarateVarRefs(xr,(xr=>{this.resolveVariableType(xr,zk)})):this.isVarType(xr,zk|CI)?this.unknownBgVars.delete(xr):this.undefinedVars.add(xr)})),this.changedTypeVars.forEach((xr=>{this.typeChangeSubscriptions.has(xr)&&this.typeChangeSubscriptions.get(xr).forEach((xr=>{xr()}))})),this.changedTypeVars.clear()}getModifierForVariable(xr){return dH=>{const{varName:Ka,sourceValue:My,rule:zX,ignoredImgSelectors:Lj,isCancelled:Bx}=xr,IH=()=>{const xr=[],IH=(zX,Lj,bq)=>{if(!this.isVarType(Ka,zX))return;const Bx=Lj(Ka);let IH;if(RF(My))if(it(My)){let xr=Jp(My,this.unstableVarValues);xr||(xr=zX===zk?"#ffffff":"#000000"),IH=bq(xr,dH)}else IH=pR(My,(xr=>Lj(xr)),(xr=>bq(xr,dH)));else IH=bq(My,dH);xr.push({property:Bx,value:IH})};if(IH(zk,dX,Zf),IH(vx,hW,Mr),IH(Vi,h,Ck),this.isVarType(Ka,CI)){const IH=nH(Ka);let zk=My;RF(My)&&(zk=pR(My,(xr=>dX(xr)),(xr=>Zf(xr,dH))));const vx=(0,bq.getBgImageModifier)(zk,zX,Lj,Bx);zk="function"==typeof vx?vx(dH):vx,xr.push({property:IH,value:zk})}return xr},jF=new Set,Bd=xr=>{const dH=()=>{const dH=IH();xr(dH)};jF.add(dH),this.subscribeForVarTypeChange(Ka,dH)},im=()=>{jF.forEach((xr=>{this.unsubscribeFromVariableTypeChanges(Ka,xr)}))};return{declarations:IH(),onTypeChange:{addListener:Bd,removeListeners:im}}}}getModifierForVarDependant(xr,dH){if(dH.match(/^\s*(rgb|hsl)a?\(/)){const Ka=xr.startsWith("background"),My=Cu(xr);return xr=>{let zX=Jp(dH,this.unstableVarValues);zX||(zX=Ka?"#ffffff":"#000000");const Lj=undefined;return(Ka?Zf:My?Mr:Ck)(zX,xr)}}return"background-color"===xr?xr=>pR(dH,(xr=>dX(xr)),(dH=>Zf(dH,xr))):Cu(xr)?xr=>pR(dH,(xr=>hW(xr)),(dH=>Mr(dH,xr))):"background"===xr||"background-image"===xr||"box-shadow"===xr?Ka=>{const My=new Set,zX=()=>{const zX=pR(dH,(xr=>this.isVarType(xr,zk)?dX(xr):this.isVarType(xr,CI)?nH(xr):(My.add(xr),xr)),(xr=>Zf(xr,Ka)));if("box-shadow"===xr){const xr=undefined,dH=(0,bq.getShadowModifierWithInfo)(zX)(Ka);if(dH.unparseableMatchesLength!==dH.matchesLength)return dH.result}return zX},Lj=zX();return My.size>0?new Promise((xr=>{const dH=My.values().next().value,Ka=()=>{this.unsubscribeFromVariableTypeChanges(dH,Ka);const My=zX();xr(My)};this.subscribeForVarTypeChange(dH,Ka)})):Lj}:xr.startsWith("border")||xr.startsWith("outline")?xr=>pR(dH,(xr=>h(xr)),(dH=>Ck(dH,xr))):null}subscribeForVarTypeChange(xr,dH){this.typeChangeSubscriptions.has(xr)||this.typeChangeSubscriptions.set(xr,new Set);const Ka=this.typeChangeSubscriptions.get(xr);Ka.has(dH)||Ka.add(dH)}unsubscribeFromVariableTypeChanges(xr,dH){this.typeChangeSubscriptions.has(xr)&&this.typeChangeSubscriptions.get(xr).delete(dH)}collectVariablesAndVarDep(xr){xr.forEach((xr=>{(0,Lj.iterateCSSRules)(xr,(xr=>{xr.style&&(0,Lj.iterateCSSDeclarations)(xr.style,((xr,dH)=>{di(xr)&&this.inspectVariable(xr,dH),RF(dH)&&this.inspectVarDependant(xr,dH)}))}))}))}collectRootVariables(){(0,Lj.iterateCSSDeclarations)(document.documentElement.style,((xr,dH)=>{di(xr)&&this.inspectVariable(xr,dH)}))}inspectVariable(xr,dH){if(this.unstableVarValues.set(xr,dH),RF(dH)&&it(dH)&&(this.unknownColorVars.add(xr),this.definedVars.add(xr)),this.definedVars.has(xr))return;this.definedVars.add(xr);const Ka=undefined;MR.test(dH)||(0,Bx.parseColorWithCache)(dH)?this.unknownColorVars.add(xr):(dH.includes("url(")||dH.includes("linear-gradient(")||dH.includes("radial-gradient("))&&this.resolveVariableType(xr,CI)}resolveVariableType(xr,dH){const Ka=this.initialVarTypes.get(xr)||0,My=undefined,zX=(this.varTypes.get(xr)||0)|dH;this.varTypes.set(xr,zX),(zX!==Ka||this.undefinedVars.has(xr))&&(this.changedTypeVars.add(xr),this.undefinedVars.delete(xr)),this.unknownColorVars.delete(xr),this.unknownBgVars.delete(xr)}collectRootVarDependants(){(0,Lj.iterateCSSDeclarations)(document.documentElement.style,((xr,dH)=>{RF(dH)&&this.inspectVarDependant(xr,dH)}))}inspectVarDependant(xr,dH){di(xr)?this.iterateVarDeps(dH,(dH=>{this.varRefs.has(xr)||this.varRefs.set(xr,new Set),this.varRefs.get(xr).add(dH)})):"background-color"===xr||"box-shadow"===xr?this.iterateVarDeps(dH,(xr=>this.resolveVariableType(xr,zk))):Cu(xr)?this.iterateVarDeps(dH,(xr=>this.resolveVariableType(xr,vx))):xr.startsWith("border")||xr.startsWith("outline")?this.iterateVarDeps(dH,(xr=>this.resolveVariableType(xr,Vi))):"background"!==xr&&"background-image"!==xr||this.iterateVarDeps(dH,(xr=>{if(this.isVarType(xr,zk|CI))return;const dH=null!=this.findVarRef(xr,(xr=>this.unknownColorVars.has(xr)||this.isVarType(xr,vx|Vi)));this.itarateVarRefs(xr,(xr=>{dH?this.resolveVariableType(xr,zk):this.unknownBgVars.add(xr)}))}))}iterateVarDeps(xr,dH){const Ka=new Set;HC(xr,(xr=>Ka.add(xr))),Ka.forEach((xr=>dH(xr)))}findVarRef(xr,dH,Ka=new Set){if(Ka.has(xr))return null;Ka.add(xr);const My=undefined;if(dH(xr))return xr;const zX=this.varRefs.get(xr);if(!zX||0===zX.size)return null;for(const xr of zX){const My=this.findVarRef(xr,dH,Ka);if(My)return My}return null}itarateVarRefs(xr,dH){this.findVarRef(xr,(xr=>(dH(xr),!1)))}setOnRootVariableChange(xr){this.onRootVariableDefined=xr}putRootVars(xr,dH){const Ka=xr.sheet;Ka.cssRules.length>0&&Ka.deleteRule(0);const My=new Map;(0,Lj.iterateCSSDeclarations)(document.documentElement.style,((xr,Ka)=>{di(xr)&&(this.isVarType(xr,zk)&&My.set(dX(xr),Zf(Ka,dH)),this.isVarType(xr,vx)&&My.set(hW(xr),Mr(Ka,dH)),this.isVarType(xr,Vi)&&My.set(h(xr),Ck(Ka,dH)),this.subscribeForVarTypeChange(xr,this.onRootVariableDefined))}));const zX=[];zX.push(":root {");for(const[xr,dH]of My)zX.push(`    ${xr}: ${dH};`);zX.push("}");const bq=zX.join("\n");Ka.insertRule(bq)}}function Bd(xr,dH=0){const Ka=xr.indexOf("var(",dH);if(Ka>=0){const dH=(0,zX.getParenthesesRange)(xr,Ka+3);if(dH)return{start:Ka,end:dH.end}}return null}function im(xr){const dH=[];let Ka=0,My;for(;My=Bd(xr,Ka);){const{start:zX,end:Lj}=My;dH.push({start:zX,end:Lj,value:xr.substring(zX,Lj)}),Ka=My.end+1}return dH}function pI(xr,dH){const Ka=im(xr),My=Ka.length;if(0===My)return xr;const zX=xr.length,Lj=Ka.map((xr=>dH(xr.value))),bq=[];bq.push(xr.substring(0,Ka[0].start));for(let dH=0;dH<My;dH++){bq.push(Lj[dH]);const Bx=Ka[dH].end,IH=dH<My-1?Ka[dH+1].start:zX;bq.push(xr.substring(Bx,IH))}return bq.join("")}function AG(xr){const dH=xr.indexOf(",");let Ka,My;return dH>=0?(Ka=xr.substring(4,dH).trim(),My=xr.substring(dH+1,xr.length-1).trim()):(Ka=xr.substring(4,xr.length-1).trim(),My=""),{name:Ka,fallback:My}}function pR(xr,dH,Ka){const My=undefined;return pI(xr,(xr=>{const{name:My,fallback:zX}=AG(xr),Lj=dH(My);if(!zX)return`var(${Lj})`;let bq;return bq=RF(zX)?pR(zX,dH,Ka):Ka?Ka(zX):zX,`var(${Lj}, ${bq})`}))}function HC(xr,dH){pR(xr,(xr=>(dH(xr),xr)))}function dX(xr){return`--${IH.ROOT_VARS_PREFIX}-bg${xr}`}function hW(xr){return`--${IH.ROOT_VARS_PREFIX}-text${xr}`}function h(xr){return`--${IH.ROOT_VARS_PREFIX}-border${xr}`}function nH(xr){return`--${IH.ROOT_VARS_PREFIX}-bgimg${xr}`}function di(xr){return xr.startsWith("--")}function RF(xr){return xr.includes("var(")}function it(xr){return xr.match(/^\s*(rgb|hsl)a?\(/)}function Cu(xr){return"color"===xr||"caret-color"===xr||"-webkit-text-fill-color"===xr}Ka.VariablesStore=jF,Ka.variablesStore=new jF,Ka.replaceCSSVariablesNames=pR;const MR=/^\d{1,3}, ?\d{1,3}, ?\d{1,3}$/;function qD(xr){if(MR.test(xr)){const dH=xr.split(",");let Ka="rgb(";return dH.forEach((xr=>{Ka+=`${xr.trim()}, `})),Ka=Ka.substring(0,Ka.length-2),Ka+=")",{isRaw:!0,color:Ka}}return{isRaw:!1,color:xr}}function yG(xr,dH,Ka){const{isRaw:My,color:zX}=qD(xr),Lj=(0,Bx.parseColorWithCache)(zX);if(Lj){const xr=Ka(Lj,dH);if(My){const dH=(0,Bx.parseColorWithCache)(xr);return dH?`${dH.r}, ${dH.g}, ${dH.b}`:xr}return xr}return zX}function Zf(xr,dH){return yG(xr,dH,My.modifyBackgroundColor)}function Mr(xr,dH){return yG(xr,dH,My.modifyForegroundColor)}function Ck(xr,dH){return yG(xr,dH,My.modifyBorderColor)}function Jp(xr,dH,Ka=new Set){let My=!1;const zX=undefined,Lj=pI(xr,(xr=>{const{name:zX,fallback:Lj}=AG(xr);if(Ka.has(zX))return My=!0,null;Ka.add(zX);const bq=dH.get(zX)||Lj;let Bx=null;return bq&&(Bx=RF(bq)?Jp(bq,dH,Ka):bq),Bx||(My=!0,null)}));return My?null:Lj}},{"../../const":1,"../../generators/modify-colors":22,"../../utils/color":33,"../../utils/text":41,"./css-rules":4,"./modify-css":10}],17:[function(xr,dH,Ka){"use strict";Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.stopWatchingForStyleChanges=Ka.watchForStyleChanges=void 0;const My=xr("../../utils/array"),zX=xr("../utils/dom"),Lj=xr("./style-manager"),bq=xr("../../utils/platform"),Bx=xr("../../const"),IH=[];let zk;const vx=new Map;let Vi;function CI(xr){bq.isDefinedSelectorSupported&&(0,My.forEach)(xr.querySelectorAll(":not(:defined)"),(xr=>{let dH=xr.tagName.toLowerCase();if(!dH.includes("-")){const Ka=xr.getAttribute("is");if(!Ka)return;dH=Ka}vx.has(dH)||(vx.set(dH,new Set),pI(dH).then((()=>{if(Vi){const xr=vx.get(dH);vx.delete(dH),Vi(Array.from(xr))}}))),vx.get(dH).add(xr)}))}let jF=!1;document.addEventListener(`${Bx.EVENT_PREFIX}inlineScriptsAllowed`,(()=>{jF=!0}));const Bd=new Map;function im(xr){if(jF=!0,Bd.has(xr.detail.tag)){const dH=undefined;Bd.get(xr.detail.tag)()}}async function pI(xr){return new Promise((dH=>{if(window.customElements&&"function"==typeof customElements.whenDefined)customElements.whenDefined(xr).then((()=>dH()));else{const Ka=()=>{const My=vx.get(xr);My&&My.size>0&&(My.values().next().value.matches(":defined")?dH():requestAnimationFrame(Ka))};requestAnimationFrame(Ka)}}))}function AG(xr){Vi=xr}function pR(){Vi=null,vx.clear(),document.removeEventListener(`${Bx.EVENT_PREFIX}isDefined`,im)}function HC(xr,dH,Ka){hW();const bq=new Set(xr),vx=new WeakMap,Vi=new WeakMap;function jF(xr){vx.set(xr,xr.previousElementSibling),Vi.set(xr,xr.nextElementSibling)}function Bd(xr){vx.delete(xr),Vi.delete(xr)}function pI(xr){return xr.previousElementSibling!==vx.get(xr)||xr.nextElementSibling!==Vi.get(xr)}function pR(xr){const{createdStyles:Ka,removedStyles:My,movedStyles:zX}=xr;Ka.forEach((xr=>jF(xr))),zX.forEach((xr=>jF(xr))),My.forEach((xr=>Bd(xr))),Ka.forEach((xr=>bq.add(xr))),My.forEach((xr=>bq.delete(xr))),Ka.size+My.size+zX.size>0&&dH({created:Array.from(Ka),removed:Array.from(My),moved:Array.from(zX),updated:[]})}function HC({additions:xr,moves:dH,deletions:Ka}){const My=new Set,bq=new Set,Bx=new Set;xr.forEach((xr=>(0,Lj.getManageableStyles)(xr).forEach((xr=>My.add(xr))))),Ka.forEach((xr=>(0,Lj.getManageableStyles)(xr).forEach((xr=>bq.add(xr))))),dH.forEach((xr=>(0,Lj.getManageableStyles)(xr).forEach((xr=>Bx.add(xr))))),pR({createdStyles:My,removedStyles:bq,movedStyles:Bx}),xr.forEach((xr=>{(0,zX.iterateShadowHosts)(xr,di),CI(xr)}))}function dX(xr){const dH=new Set((0,Lj.getManageableStyles)(xr)),Ka=new Set,My=new Set,Bx=new Set;dH.forEach((xr=>{bq.has(xr)||Ka.add(xr)})),bq.forEach((xr=>{dH.has(xr)||My.add(xr)})),dH.forEach((xr=>{Ka.has(xr)||My.has(xr)||!pI(xr)||Bx.add(xr)})),pR({createdStyles:Ka,removedStyles:My,movedStyles:Bx}),(0,zX.iterateShadowHosts)(xr,di),CI(xr)}function h(xr){const Ka=new Set,My=new Set;xr.forEach((xr=>{const{target:dH}=xr;dH.isConnected&&((0,Lj.shouldManageStyle)(dH)?Ka.add(dH):dH instanceof HTMLLinkElement&&dH.disabled&&My.add(dH))})),Ka.size+My.size>0&&dH({updated:Array.from(Ka),created:[],removed:Array.from(My),moved:[]})}function nH(xr){const dH=(0,zX.createOptimizedTreeObserver)(xr,{onMinorMutations:HC,onHugeMutations:dX}),Ka=new MutationObserver(h);Ka.observe(xr,{attributes:!0,attributeFilter:["rel","disabled","media","href"],subtree:!0}),IH.push(dH,Ka),zk.add(xr)}function di(xr){const{shadowRoot:dH}=xr;null==dH||zk.has(dH)||(nH(dH),Ka(dH))}xr.forEach(jF),nH(document),(0,zX.iterateShadowHosts)(document.documentElement,di),AG((xr=>{const Ka=[];xr.forEach((xr=>(0,My.push)(Ka,(0,Lj.getManageableStyles)(xr.shadowRoot)))),dH({created:Ka,updated:[],removed:[],moved:[]}),xr.forEach((xr=>{const{shadowRoot:dH}=xr;null!=dH&&(di(xr),(0,zX.iterateShadowHosts)(dH,di),CI(dH))}))})),document.addEventListener(`${Bx.EVENT_PREFIX}isDefined`,im),CI(document)}function dX(){IH.forEach((xr=>xr.disconnect())),IH.splice(0,IH.length),zk=new WeakSet}function hW(){dX(),pR()}Ka.watchForStyleChanges=HC,Ka.stopWatchingForStyleChanges=hW},{"../../const":1,"../../utils/array":30,"../../utils/platform":40,"../utils/dom":18,"./style-manager":13}],18:[function(xr,dH,Ka){"use strict";Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.createOptimizedTreeObserver=Ka.cleanReadyStateCompleteListeners=Ka.addReadyStateCompleteListener=Ka.isReadyStateComplete=Ka.removeDOMReadyListener=Ka.addDOMReadyListener=Ka.setIsDOMReady=Ka.isDOMReady=Ka.iterateShadowHosts=Ka.watchForNodePosition=Ka.removeNode=Ka.createNodeAsap=void 0;const My=xr("../utils/log"),zX=xr("../../utils/throttle"),Lj=xr("../../utils/array"),bq=xr("../../utils/time");function Bx({selectNode:xr,createNode:dH,updateNode:Ka,selectTarget:My,createTarget:zX,isTargetMutation:Lj}){const bq=My();if(bq){const My=xr();My?Ka(My):dH(bq)}else{const Ka=new MutationObserver((Ka=>{const zX=undefined;if(Ka.find(Lj)){Bx();const Ka=My();xr()||dH(Ka)}})),bq=()=>{if("complete"!==document.readyState)return;Bx();const Ka=My()||zX();xr()||dH(Ka)},Bx=()=>{document.removeEventListener("readystatechange",bq),Ka.disconnect()};"complete"===document.readyState?bq():(document.addEventListener("readystatechange",bq),Ka.observe(document,{childList:!0,subtree:!0}))}}function IH(xr){xr&&xr.parentNode&&xr.parentNode.removeChild(xr)}function zk(xr,dH,Ka=Function.prototype){const Lj=10,Bx=(0,bq.getDuration)({seconds:2}),IH=(0,bq.getDuration)({seconds:10}),zk=xr.previousSibling;let vx=xr.parentNode;if(!vx)throw new Error("Unable to watch for node position: parent element not found");if("prev-sibling"===dH&&!zk)throw new Error("Unable to watch for node position: there is no previous sibling");let Vi=0,CI=null,jF=null;const Bd=(0,zX.throttle)((()=>{if(jF)return;Vi++;const zX=Date.now();if(null==CI)CI=zX;else if(Vi>=Lj){if(zX-CI<IH)return(0,My.logWarn)(`Node position watcher paused: retry in ${Bx}ms`,xr,zk),void(jF=setTimeout((()=>{CI=null,Vi=0,jF=null,Bd()}),Bx));CI=zX,Vi=1}if("head"===dH&&zk&&zk.parentNode!==vx)return(0,My.logWarn)("Unable to restore node position: sibling parent changed",xr,zk,vx),void AG();if("prev-sibling"===dH){if(null==zk.parentNode)return(0,My.logWarn)("Unable to restore node position: sibling was removed",xr,zk,vx),void AG();zk.parentNode!==vx&&((0,My.logWarn)("Style was moved to another parent",xr,zk,vx),HC(zk.parentNode))}"head"!==dH||vx.isConnected||(vx=document.head),(0,My.logWarn)("Restoring node position",xr,zk,vx),vx.insertBefore(xr,zk&&zk.isConnected?zk.nextSibling:vx.firstChild),im.takeRecords(),Ka&&Ka()})),im=new MutationObserver((()=>{("head"===dH&&(xr.parentNode!==vx||!xr.parentNode.isConnected)||"prev-sibling"===dH&&xr.previousSibling!==zk)&&Bd()})),pI=()=>{im.observe(vx,{childList:!0})},AG=()=>{clearTimeout(jF),im.disconnect(),Bd.cancel()},pR=()=>{im.takeRecords()},HC=xr=>{vx=xr,AG(),pI()};return pI(),{run:pI,stop:AG,skip:pR}}function vx(xr,dH){if(null==xr)return;const Ka=document.createTreeWalker(xr,NodeFilter.SHOW_ELEMENT,{acceptNode:xr=>null==xr.shadowRoot?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT});for(let My=xr.shadowRoot?Ka.currentNode:Ka.nextNode();null!=My;My=Ka.nextNode())My.classList.contains("surfingkeys_hints_host")||(dH(My),vx(My.shadowRoot,dH))}Ka.createNodeAsap=Bx,Ka.removeNode=IH,Ka.watchForNodePosition=zk,Ka.iterateShadowHosts=vx;let Vi=()=>"complete"===document.readyState||"interactive"===document.readyState;function CI(xr){Ka.isDOMReady=xr}Ka.isDOMReady=Vi,Ka.setIsDOMReady=CI;const jF=new Set;function Bd(xr){(0,Ka.isDOMReady)()?xr():jF.add(xr)}function im(xr){jF.delete(xr)}function pI(){return"complete"===document.readyState}Ka.addDOMReadyListener=Bd,Ka.removeDOMReadyListener=im,Ka.isReadyStateComplete=pI;const AG=new Set;function pR(xr){pI()?xr():AG.add(xr)}function HC(){AG.clear()}if(Ka.addReadyStateCompleteListener=pR,Ka.cleanReadyStateCompleteListeners=HC,!(0,Ka.isDOMReady)()){const xr=()=>{(0,Ka.isDOMReady)()&&(jF.forEach((xr=>xr())),jF.clear(),pI()&&(document.removeEventListener("readystatechange",xr),AG.forEach((xr=>xr())),AG.clear()))};document.addEventListener("readystatechange",xr)}const dX=1e3;function hW(xr){if(xr.length>dX)return!0;let dH=0;for(let Ka=0;Ka<xr.length;Ka++)if(dH+=xr[Ka].addedNodes.length,dH>dX)return!0;return!1}function h(xr){const dH=new Set,Ka=new Set,My=new Set;xr.forEach((xr=>{(0,Lj.forEach)(xr.addedNodes,(xr=>{xr instanceof Element&&xr.isConnected&&dH.add(xr)})),(0,Lj.forEach)(xr.removedNodes,(xr=>{xr instanceof Element&&(xr.isConnected?(My.add(xr),dH.delete(xr)):Ka.add(xr))}))}));const zX=[],bq=[];return dH.forEach((xr=>{dH.has(xr.parentElement)&&zX.push(xr)})),Ka.forEach((xr=>{Ka.has(xr.parentElement)&&bq.push(xr)})),zX.forEach((xr=>dH.delete(xr))),bq.forEach((xr=>Ka.delete(xr))),{additions:dH,moves:My,deletions:Ka}}const nH=new Map,di=new WeakMap;function RF(xr,dH){let My,zX,Lj;if(nH.has(xr))My=nH.get(xr),zX=di.get(My);else{let dH=!1,bq=!1;My=new MutationObserver((My=>{if(hW(My))!dH||(0,Ka.isDOMReady)()?zX.forEach((({onHugeMutations:dH})=>dH(xr))):bq||(Lj=()=>zX.forEach((({onHugeMutations:dH})=>dH(xr))),Bd(Lj),bq=!0),dH=!0;else{const xr=h(My);zX.forEach((({onMinorMutations:dH})=>dH(xr)))}})),My.observe(xr,{childList:!0,subtree:!0}),nH.set(xr,My),zX=new Set,di.set(My,zX)}return zX.add(dH),{disconnect(){zX.delete(dH),Lj&&im(Lj),0===zX.size&&(My.disconnect(),di.delete(My),nH.delete(xr))}}}Ka.createOptimizedTreeObserver=RF},{"../../utils/array":30,"../../utils/throttle":42,"../../utils/time":43,"../utils/log":19}],19:[function(xr,dH,Ka){"use strict";Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.logInfoCollapsed=Ka.logWarn=Ka.logInfo=void 0;const My=xr("../../utils/message"),zX=!0,Lj=!1,bq="info";function Bx(xr,...dH){Lj&&bq&&("info"===bq||"warn"===xr)&&chrome.runtime.sendMessage({type:My.MessageType.CS_LOG,data:{level:xr,log:dH}})}function IH(...xr){zX&&Bx("info",...xr)}function zk(...xr){zX&&Bx("warn",...xr)}function vx(xr,...dH){}Ka.logInfo=IH,Ka.logWarn=zk,Ka.logInfoCollapsed=vx},{"../../utils/message":37}],20:[function(xr,dH,Ka){"use strict";Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.DEFAULT_SETTINGS=Ka.DEFAULT_COLORSCHEME=Ka.DEFAULT_THEME=Ka.DEFAULT_COLORS=void 0;const My=xr("./generators/theme-engines"),zX=xr("./utils/platform"),Lj=xr("./utils/automation");Ka.DEFAULT_COLORS={darkScheme:{background:"#181a1b",text:"#e8e6e3"},lightScheme:{background:"#181a1b",text:"#e8e6e3"}},Ka.DEFAULT_THEME={mode:1,brightness:100,contrast:110,grayscale:0,sepia:0,useFont:!1,fontFamily:zX.isMacOS?"Helvetica Neue":zX.isWindows?"Segoe UI":"Open Sans",textStroke:0,engine:My.ThemeEngine.dynamicTheme,stylesheet:"",darkSchemeBackgroundColor:Ka.DEFAULT_COLORS.darkScheme.background,darkSchemeTextColor:Ka.DEFAULT_COLORS.darkScheme.text,lightSchemeBackgroundColor:Ka.DEFAULT_COLORS.lightScheme.background,lightSchemeTextColor:Ka.DEFAULT_COLORS.lightScheme.text,scrollbarColor:zX.isMacOS?"":"auto",selectionColor:"auto",styleSystemControls:!1,lightColorScheme:"Default",darkColorScheme:"Default",immediateModify:!1},Ka.DEFAULT_COLORSCHEME={light:{Default:{backgroundColor:Ka.DEFAULT_COLORS.lightScheme.background,textColor:Ka.DEFAULT_COLORS.lightScheme.text}},dark:{Default:{backgroundColor:Ka.DEFAULT_COLORS.darkScheme.background,textColor:Ka.DEFAULT_COLORS.darkScheme.text}}},Ka.DEFAULT_SETTINGS={enabled:!0,fetchNews:!0,theme:Ka.DEFAULT_THEME,presets:[],customThemes:[],siteList:[],siteListEnabled:[],applyToListedOnly:!1,changeBrowserTheme:!1,syncSettings:!0,syncSitesFixes:!1,automation:{enabled:!1,mode:Lj.AutomationMode.NONE,behavior:"OnOff"},time:{activation:"18:00",deactivation:"9:00"},location:{latitude:null,longitude:null},previewNewDesign:!1,enableForPDF:!0,enableForProtectedPages:!1,enableContextMenus:!1,detectDarkTheme:!1}},{"./generators/theme-engines":25,"./utils/automation":32,"./utils/platform":40}],21:[function(xr,dH,Ka){"use strict";Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.formatInversionFixes=Ka.parseInversionFixes=Ka.getInversionFixesFor=Ka.getCSSFilterValue=Ka.cssFilterStyleSheetTemplate=Ka.hasFirefoxNewRootBehavior=Ka.hasPatchForChromiumIssue501582=Ka.FilterMode=void 0;const My=xr("./utils/format"),zX=xr("./utils/matrix"),Lj=xr("./utils/parse"),bq=xr("../utils/text"),Bx=xr("../utils/url"),IH=xr("./text-style"),zk=xr("../utils/platform");var vx;function Vi(){return!0}function CI(){return Boolean(zk.isFirefox&&(0,zk.compareChromeVersions)(zk.firefoxVersion,"102.0")>=0)}function jF(xr,dH,Ka,My,zX){const Lj=undefined,bq=undefined;return Bd(im(xr),"invert(100%) hue-rotate(180deg)",xr,dH,Ka,My,zX)}function Bd(xr,dH,Ka,My,Lj,bq,Bx){const zk=HC(My,bq,Bx),jF=[];if(jF.push("@media screen {"),xr&&Lj&&(jF.push(""),jF.push("/* Leading rule */"),jF.push(pI(xr))),Ka.mode===vx.dark&&(jF.push(""),jF.push("/* Reverse rule */"),jF.push(pR(dH,zk))),(Ka.useFont||Ka.textStroke>0)&&(jF.push(""),jF.push("/* Font */"),jF.push((0,IH.createTextStyle)(Ka))),jF.push(""),jF.push("/* Text contrast */"),jF.push("html {"),jF.push("  text-shadow: 0 0 0 !important;"),jF.push("}"),jF.push(""),jF.push("/* Full screen */"),[":-webkit-full-screen",":-moz-full-screen",":fullscreen"].forEach((xr=>{jF.push(`${xr}, ${xr} * {`),jF.push("  -webkit-filter: none !important;"),jF.push("  filter: none !important;"),jF.push("}")})),Lj){const xr=[255,255,255],dH=Vi()||CI()||Ka.mode!==vx.dark?xr:(0,zX.applyColorMatrix)(xr,(0,zX.createFilterMatrix)(Ka)).map(Math.round);jF.push(""),jF.push("/* Page background */"),jF.push("html {"),jF.push(`  background: rgb(${dH.join(",")}) !important;`),jF.push("}")}return zk.css&&zk.css.length>0&&Ka.mode===vx.dark&&(jF.push(""),jF.push("/* Custom rules */"),jF.push(zk.css)),jF.push(""),jF.push("}"),jF.join("\n")}function im(xr){const dH=[];return xr.mode===vx.dark&&dH.push("invert(100%) hue-rotate(180deg)"),100!==xr.brightness&&dH.push(`brightness(${xr.brightness}%)`),100!==xr.contrast&&dH.push(`contrast(${xr.contrast}%)`),0!==xr.grayscale&&dH.push(`grayscale(${xr.grayscale}%)`),0!==xr.sepia&&dH.push(`sepia(${xr.sepia}%)`),0===dH.length?null:dH.join(" ")}function pI(xr){return["html {",`  -webkit-filter: ${xr} !important;`,`  filter: ${xr} !important;`,"}"].join("\n")}function AG(xr){return xr.map((xr=>xr.replace(/\,$/,""))).join(",\n")}function pR(xr,dH){const Ka=[];return dH.invert.length>0&&(Ka.push(`${AG(dH.invert)} {`),Ka.push(`  -webkit-filter: ${xr} !important;`),Ka.push(`  filter: ${xr} !important;`),Ka.push("}")),dH.noinvert.length>0&&(Ka.push(`${AG(dH.noinvert)} {`),Ka.push("  -webkit-filter: none !important;"),Ka.push("  filter: none !important;"),Ka.push("}")),dH.removebg.length>0&&(Ka.push(`${AG(dH.removebg)} {`),Ka.push("  background: white !important;"),Ka.push("}")),Ka.join("\n")}function HC(xr,dH,Ka){const My=(0,Lj.getSitesFixesFor)(xr,dH,Ka,{commands:Object.keys(dX),getCommandPropName:xr=>dX[xr],parseCommandValue:(xr,dH)=>"CSS"===xr?dH.trim():(0,bq.parseArray)(dH)}),zX={url:My[0].url,invert:My[0].invert||[],noinvert:My[0].noinvert||[],removebg:My[0].removebg||[],css:My[0].css||""};if(xr){const dH=My.slice(1).filter((dH=>(0,Bx.isURLInList)(xr,dH.url))).sort(((xr,dH)=>dH.url[0].length-xr.url[0].length));if(dH.length>0){const xr=dH[0];return{url:xr.url,invert:zX.invert.concat(xr.invert||[]),noinvert:zX.noinvert.concat(xr.noinvert||[]),removebg:zX.removebg.concat(xr.removebg||[]),css:[zX.css,xr.css].filter((xr=>xr)).join("\n")}}}return zX}!function(xr){xr[xr["light"]=0]="light",xr[xr["dark"]=1]="dark"}(vx=Ka.FilterMode||(Ka.FilterMode={})),Ka.hasPatchForChromiumIssue501582=Vi,Ka.hasFirefoxNewRootBehavior=CI,Ka.default=jF,Ka.cssFilterStyleSheetTemplate=Bd,Ka.getCSSFilterValue=im,Ka.getInversionFixesFor=HC;const dX={INVERT:"invert","NO INVERT":"noinvert","REMOVE BG":"removebg",CSS:"css"};function hW(xr){return(0,Lj.parseSitesFixesConfig)(xr,{commands:Object.keys(dX),getCommandPropName:xr=>dX[xr],parseCommandValue:(xr,dH)=>"CSS"===xr?dH.trim():(0,bq.parseArray)(dH)})}function h(xr){const dH=xr.slice().sort(((xr,dH)=>(0,Bx.compareURLPatterns)(xr.url[0],dH.url[0])));return(0,My.formatSitesFixesConfig)(dH,{props:Object.values(dX),getPropCommandName:xr=>Object.entries(dX).find((([,dH])=>dH===xr))[0],formatPropValue:(xr,dH)=>"css"===xr?dH.trim().replace(/\n+/g,"\n"):(0,bq.formatArray)(dH).trim(),shouldIgnoreProp:(xr,dH)=>"css"===xr?!dH:!(Array.isArray(dH)&&dH.length>0)})}Ka.parseInversionFixes=hW,Ka.formatInversionFixes=h},{"../utils/platform":40,"../utils/text":41,"../utils/url":45,"./text-style":24,"./utils/format":26,"./utils/matrix":27,"./utils/parse":28}],22:[function(xr,dH,Ka){"use strict";Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.modifyGradientColor=Ka.modifyShadowColor=Ka.modifyBorderColor=Ka.modifyForegroundColor=Ka.modifyBackgroundColor=Ka.modifyColor=Ka.clearColorModificationCache=void 0;const My=xr("../utils/color"),zX=xr("../utils/math"),Lj=xr("./utils/matrix");function bq(xr){const dH=undefined,Ka=undefined;return xr[1===xr.mode?"darkSchemeBackgroundColor":"lightSchemeBackgroundColor"]}function Bx(xr){const dH=undefined,Ka=undefined;return xr[1===xr.mode?"darkSchemeTextColor":"lightSchemeTextColor"]}const IH=new Map;function zk(){IH.clear()}Ka.clearColorModificationCache=zk;const vx=["r","g","b","a"],Vi=["mode","brightness","contrast","grayscale","sepia","darkSchemeBackgroundColor","darkSchemeTextColor","lightSchemeBackgroundColor","lightSchemeTextColor"];function CI(xr,dH){let Ka="";return vx.forEach((dH=>{Ka+=`${xr[dH]};`})),Vi.forEach((xr=>{Ka+=`${dH[xr]};`})),Ka}function jF(xr,dH,Ka,zX,bq){let Bx;IH.has(Ka)?Bx=IH.get(Ka):(Bx=new Map,IH.set(Ka,Bx));const zk=CI(xr,dH);if(Bx.has(zk))return Bx.get(zk);const vx=undefined,Vi=undefined,jF=undefined,Bd=Ka((0,My.rgbToHSL)(xr),null==zX?null:(0,My.parseToHSLWithCache)(zX),null==bq?null:(0,My.parseToHSLWithCache)(bq)),{r:im,g:pI,b:AG,a:pR}=(0,My.hslToRGB)(Bd),HC=(0,Lj.createFilterMatrix)(dH),[dX,hW,h]=(0,Lj.applyColorMatrix)([im,pI,AG],HC),nH=1===pR?(0,My.rgbToHexString)({r:dX,g:hW,b:h}):(0,My.rgbToString)({r:dX,g:hW,b:h,a:pR});return Bx.set(zk,nH),nH}function Bd(xr){return xr}function im(xr,dH){return jF(xr,dH,Bd)}function pI(xr,dH){const Ka=bq(dH),My=undefined;return jF(xr,dH,AG,Bx(dH),Ka)}function AG({h:xr,s:dH,l:Ka,a:My},Lj,bq){const Bx=Ka<.5;let IH;if(Bx)IH=Ka<.2||dH<.12;else{const My=undefined;IH=dH<.24||Ka>.8&&(xr>200&&xr<280)}let zk=xr,vx=Ka;IH&&(Bx?(zk=Lj.h,vx=Lj.s):(zk=bq.h,vx=bq.s));const Vi=undefined;return{h:zk,s:vx,l:(0,zX.scale)(Ka,0,1,Lj.l,bq.l),a:My}}Ka.modifyColor=im;const pR=.4;function HC({h:xr,s:dH,l:Ka,a:My},Lj){const bq=undefined,Bx=undefined,IH=dH<.12||Ka>.8&&(xr>200&&xr<280);if(Ka<.5){const bq=(0,zX.scale)(Ka,0,.5,0,pR);if(IH){const xr=undefined,dH=undefined;return{h:Lj.h,s:Lj.s,l:bq,a:My}}return{h:xr,s:dH,l:bq,a:My}}let zk=(0,zX.scale)(Ka,.5,1,pR,Lj.l);if(IH){const xr=undefined,dH=undefined;return{h:Lj.h,s:Lj.s,l:zk,a:My}}let vx=xr;const Vi=undefined;if(xr>60&&xr<180){const dH=undefined;vx=xr>120?(0,zX.scale)(xr,120,180,135,180):(0,zX.scale)(xr,60,120,60,105)}return vx>40&&vx<80&&(zk*=.75),{h:vx,s:dH,l:zk,a:My}}function dX(xr,dH){if(0===dH.mode)return pI(xr,dH);const Ka=bq(dH);return jF(xr,Object.assign(Object.assign({},dH),{mode:0}),HC,Ka)}Ka.modifyBackgroundColor=dX;const hW=.55;function h(xr){return(0,zX.scale)(xr,205,245,205,220)}function nH({h:xr,s:dH,l:Ka,a:My},Lj){const bq=undefined,Bx=Ka<.2||dH<.24,IH=!Bx&&xr>205&&xr<245;if(Ka>.5){const bq=(0,zX.scale)(Ka,.5,1,hW,Lj.l);if(Bx){const xr=undefined,dH=undefined;return{h:Lj.h,s:Lj.s,l:bq,a:My}}let zk=xr;return IH&&(zk=h(xr)),{h:zk,s:dH,l:bq,a:My}}if(Bx){const xr=undefined,dH=undefined,bq=undefined;return{h:Lj.h,s:Lj.s,l:(0,zX.scale)(Ka,0,.5,Lj.l,hW),a:My}}let zk=xr,vx;return IH?(zk=h(xr),vx=(0,zX.scale)(Ka,0,.5,Lj.l,Math.min(1,hW+.05))):vx=(0,zX.scale)(Ka,0,.5,Lj.l,hW),{h:zk,s:dH,l:vx,a:My}}function di(xr,dH){if(0===dH.mode)return pI(xr,dH);const Ka=Bx(dH);return jF(xr,Object.assign(Object.assign({},dH),{mode:0}),nH,Ka)}function RF({h:xr,s:dH,l:Ka,a:My},Lj,bq){const Bx=undefined,IH=undefined;let zk=xr,vx=dH;(Ka<.2||dH<.24)&&(Ka<.5?(zk=Lj.h,vx=Lj.s):(zk=bq.h,vx=bq.s));const Vi=undefined;return{h:zk,s:vx,l:(0,zX.scale)(Ka,0,1,.5,.2),a:My}}function it(xr,dH){if(0===dH.mode)return pI(xr,dH);const Ka=Bx(dH),My=bq(dH);return jF(xr,Object.assign(Object.assign({},dH),{mode:0}),RF,Ka,My)}function Cu(xr,dH){return dX(xr,dH)}function MR(xr,dH){return dX(xr,dH)}Ka.modifyForegroundColor=di,Ka.modifyBorderColor=it,Ka.modifyShadowColor=Cu,Ka.modifyGradientColor=MR},{"../utils/color":33,"../utils/math":36,"./utils/matrix":27}],23:[function(xr,dH,Ka){"use strict";Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.getSVGReverseFilterMatrixValue=Ka.getSVGFilterMatrixValue=Ka.createSVGFilterStylesheet=void 0;const My=xr("./utils/matrix"),zX=xr("./css-filter"),Lj=xr("../utils/platform"),bq=xr("../const");function Bx(xr,dH,Ka,My,Bx){let zk,CI;return Lj.isFirefox?(zk=IH(vx(xr)),CI=IH(Vi())):(zk=`url(#${bq.MISC_PREFIX}-filter)`,CI=`url(#${bq.MISC_PREFIX}-reverse-filter)`),(0,zX.cssFilterStyleSheetTemplate)(zk,CI,xr,dH,Ka,My,Bx)}function IH(xr){const dH=`${bq.MISC_PREFIX}-filter`,Ka=['<svg xmlns="http://www.w3.org/2000/svg">',`<filter id="${dH}" style="color-interpolation-filters: sRGB;">`,`<feColorMatrix type="matrix" values="${xr}" />`,"</filter>","</svg>"].join("");return`url(data:image/svg+xml;base64,${btoa(Ka)}#${dH})`}function zk(xr){return xr.slice(0,4).map((xr=>xr.map((xr=>xr.toFixed(3))).join(" "))).join(" ")}function vx(xr){return zk((0,My.createFilterMatrix)(xr))}function Vi(){return zk(My.Matrix.invertNHue())}Ka.createSVGFilterStylesheet=Bx,Ka.getSVGFilterMatrixValue=vx,Ka.getSVGReverseFilterMatrixValue=Vi},{"../const":1,"../utils/platform":40,"./css-filter":21,"./utils/matrix":27}],24:[function(xr,dH,Ka){"use strict";function My(xr){const dH=[];return dH.push('*:not(pre, pre *, code, .far, .fa, .glyphicon, [class*="vjs-"], .fab, .fa-github, .fas, .material-icons, .icofont, .typcn, mu, [class*="mu-"], .glyphicon, .icon) {'),xr.useFont&&xr.fontFamily&&dH.push(`  font-family: ${xr.fontFamily} !important;`),xr.textStroke>0&&(dH.push(`  -webkit-text-stroke: ${xr.textStroke}px !important;`),dH.push(`  text-stroke: ${xr.textStroke}px !important;`)),dH.push("}"),dH.join("\n")}Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.createTextStyle=void 0,Ka.createTextStyle=My},{}],25:[function(xr,dH,Ka){"use strict";var My;Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.ThemeEngine=void 0,function(xr){xr["cssFilter"]="cssFilter",xr["svgFilter"]="svgFilter",xr["staticTheme"]="staticTheme",xr["dynamicTheme"]="dynamicTheme"}(My=Ka.ThemeEngine||(Ka.ThemeEngine={}))},{}],26:[function(xr,dH,Ka){"use strict";Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.formatSitesFixesConfig=void 0;const My=xr("../../utils/array");function zX(xr,dH){const Ka=[];return xr.forEach(((zX,Lj)=>{(0,My.push)(Ka,zX.url),dH.props.forEach((xr=>{const My=dH.getPropCommandName(xr),Lj=zX[xr];if(dH.shouldIgnoreProp(xr,Lj))return;Ka.push(""),Ka.push(My);const bq=dH.formatPropValue(xr,Lj);bq&&Ka.push(bq)})),Lj<xr.length-1&&(Ka.push(""),Ka.push("=".repeat(32)),Ka.push(""))})),Ka.push(""),Ka.join("\n")}Ka.formatSitesFixesConfig=zX},{"../../utils/array":30}],27:[function(xr,dH,Ka){"use strict";Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.Matrix=Ka.applyColorMatrix=Ka.createFilterMatrix=void 0;const My=xr("../../utils/math");function zX(xr){let dH=Ka.Matrix.identity();return 0!==xr.sepia&&(dH=(0,My.multiplyMatrices)(dH,Ka.Matrix.sepia(xr.sepia/100))),0!==xr.grayscale&&(dH=(0,My.multiplyMatrices)(dH,Ka.Matrix.grayscale(xr.grayscale/100))),100!==xr.contrast&&(dH=(0,My.multiplyMatrices)(dH,Ka.Matrix.contrast(xr.contrast/100))),100!==xr.brightness&&(dH=(0,My.multiplyMatrices)(dH,Ka.Matrix.brightness(xr.brightness/100))),1===xr.mode&&(dH=(0,My.multiplyMatrices)(dH,Ka.Matrix.invertNHue())),dH}function Lj([xr,dH,Ka],zX){const Lj=[[xr/255],[dH/255],[Ka/255],[1],[1]],bq=(0,My.multiplyMatrices)(zX,Lj);return[0,1,2].map((xr=>(0,My.clamp)(Math.round(255*bq[xr][0]),0,255)))}Ka.createFilterMatrix=zX,Ka.applyColorMatrix=Lj,Ka.Matrix={identity:()=>[[1,0,0,0,0],[0,1,0,0,0],[0,0,1,0,0],[0,0,0,1,0],[0,0,0,0,1]],invertNHue:()=>[[.333,-.667,-.667,0,1],[-.667,.333,-.667,0,1],[-.667,-.667,.333,0,1],[0,0,0,1,0],[0,0,0,0,1]],brightness:xr=>[[xr,0,0,0,0],[0,xr,0,0,0],[0,0,xr,0,0],[0,0,0,1,0],[0,0,0,0,1]],contrast(xr){const dH=(1-xr)/2;return[[xr,0,0,0,dH],[0,xr,0,0,dH],[0,0,xr,0,dH],[0,0,0,1,0],[0,0,0,0,1]]},sepia:xr=>[[.393+.607*(1-xr),.769-.769*(1-xr),.189-.189*(1-xr),0,0],[.349-.349*(1-xr),.686+.314*(1-xr),.168-.168*(1-xr),0,0],[.272-.272*(1-xr),.534-.534*(1-xr),.131+.869*(1-xr),0,0],[0,0,0,1,0],[0,0,0,0,1]],grayscale:xr=>[[.2126+.7874*(1-xr),.7152-.7152*(1-xr),.0722-.0722*(1-xr),0,0],[.2126-.2126*(1-xr),.7152+.2848*(1-xr),.0722-.0722*(1-xr),0,0],[.2126-.2126*(1-xr),.7152-.7152*(1-xr),.0722+.9278*(1-xr),0,0],[0,0,0,1,0],[0,0,0,0,1]]}},{"../../utils/math":36}],28:[function(xr,dH,Ka){"use strict";Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.isURLInSiteList=Ka.indexSiteListConfig=Ka.getSitesFixesFor=Ka.indexSitesFixesConfig=Ka.getDomain=Ka.parseSitesFixesConfig=void 0;const My=xr("../../utils/url"),zX=xr("../../utils/text"),Lj=6e4;function bq(xr,dH){const Ka=[],My=undefined;return xr.replace(/\r/g,"").split(/^\s*={2,}\s*$/gm).forEach((xr=>{const My=xr.split("\n"),Lj=[];if(My.forEach(((xr,dH)=>{xr.match(/^[A-Z]+(\s[A-Z]+){0,2}$/)&&Lj.push(dH)})),0===Lj.length)return;const bq={url:(0,zX.parseArray)(My.slice(0,Lj[0]).join("\n"))};Lj.forEach(((xr,Ka)=>{const zX=My[xr].trim(),Bx=My.slice(xr+1,Ka===Lj.length-1?My.length:Lj[Ka+1]).join("\n"),IH=dH.getCommandPropName(zX);if(!IH)return;const zk=dH.parseCommandValue(zX,Bx);bq[IH]=zk})),Ka.push(bq)})),Ka}function Bx(xr){try{return new URL(xr).hostname.toLowerCase()}catch(dH){return xr.split("/")[0].toLowerCase()}}function IH(xr){return xr.map((([xr,dH])=>{const Ka=xr.toString(36),My=dH.toString(36);return"0".repeat(4-Ka.length)+Ka+"0".repeat(3-My.length)+My})).join("")}function zk(xr,dH){const Ka=(4+3)*dH,My=parseInt(xr.substring(Ka+0,Ka+4),36),zX=undefined;return[My,My+parseInt(xr.substring(Ka+4,Ka+4+3),36)]}function vx(xr,dH,Ka){xr[dH]?xr[dH].includes(Ka)||xr[dH].push(Ka):xr[dH]=[Ka]}function Vi(xr){const dH=xr.lastIndexOf("*"),Ka=xr.substring(dH+2);if(dH<0||0===Ka.length)return xr.split(".");const My=[Ka],zX=undefined;return xr.substring(0,dH).split(".").filter(Boolean).forEach((xr=>My.concat(xr))),My}function CI(xr){const dH={},Ka={},zX=[],Lj={},bq=[];for(let Ka=0;Ka<xr.length;Ka++){const IH=xr[Ka],zk=new Set;for(const xr of IH){const Lj=Bx(xr);if((0,My.isFullyQualifiedDomain)(Lj))vx(dH,Lj,Ka);else{if(!(0,My.isFullyQualifiedDomainWildcard)(Lj)){zX.push(Ka);break}{const xr=Vi(Lj);bq.push({labels:xr,index:Ka}),xr.forEach((xr=>zk.add(xr)))}}}for(const xr of zk)Lj[xr]?Lj[xr]++:Lj[xr]=1}for(const{labels:xr,index:dH}of bq){let My=xr[0];for(const dH of xr)Lj[dH]<Lj[My]&&(My=dH);vx(Ka,My,dH)}return{domains:dH,domainLabels:Ka,nonstandard:zX}}function jF(xr,dH,Ka,My,Lj){const bq=undefined,Bx=xr.substring(Ka,My).split("\n"),IH=[];if(Bx.forEach(((xr,dH)=>{xr.match(/^[A-Z]+(\s[A-Z]+){0,2}$/)&&IH.push(dH)})),0===IH.length)return;dH.push([Ka,My-Ka]);const zk=(0,zX.parseArray)(Bx.slice(0,IH[0]).join("\n"));Lj.push(zk)}function Bd(xr){const dH=[],Ka=[];let My=0;const zX=/^\s*={2,}\s*$/gm;let Lj;for(;Lj=zX.exec(xr);){const zX=Lj.index,bq=Lj.index+Lj[0].length;jF(xr,Ka,My,zX,dH),My=bq}return jF(xr,Ka,My,xr.length,dH),{urls:dH,offsets:Ka}}function im(xr){const{urls:dH,offsets:Ka}=Bd(xr),{domains:My,domainLabels:zX,nonstandard:Lj}=CI(dH);return{offsets:IH(Ka),domains:My,domainLabels:zX,nonstandard:Lj,cacheDomainIndex:{},cacheSiteFix:{},cacheCleanupTimer:null}}function pI(xr,dH,Ka){const zX=Bx(xr),Lj=zX.split(".");let bq=[];"*"in dH.domainLabels&&(bq=bq.concat(dH.domainLabels["*"]));for(const xr of Lj)if(xr in dH.domainLabels){const Lj=dH.domainLabels[xr];for(const xr of Lj){const dH=Ka(xr);for(const Ka of dH){const dH=Bx(Ka);(0,My.isFullyQualifiedDomainWildcard)(dH)&&(0,My.fullyQualifiedDomainMatchesWildcard)(dH,zX)&&bq.push(xr)}}}for(let xr=0;xr<Lj.length;xr++){const Ka=Lj.slice(xr).join(".");Ka in dH.domains&&(bq=bq.concat(dH.domains[Ka])),Ka in dH.domainLabels&&(bq=bq.concat(dH.domainLabels[Ka]))}return bq=bq.concat(dH.nonstandard),bq=Array.from(new Set(bq)),bq}function AG(xr,dH,Ka,My){if(My in dH.cacheSiteFix)return dH.cacheSiteFix[My];const[zX,Lj]=zk(dH.offsets,My),Bx=undefined,IH=bq(xr.substring(zX,Lj),Ka)[0];return dH.cacheSiteFix[My]=IH,IH}function pR(xr){clearTimeout(xr.cacheCleanupTimer),xr.cacheCleanupTimer=setTimeout((()=>{xr.cacheCleanupTimer=null,xr.cacheDomainIndex={},xr.cacheSiteFix={}}),Lj)}function HC(xr,dH,Ka,My){const zX=[],Lj=Bx(xr);Ka.cacheDomainIndex[Lj]||(Ka.cacheDomainIndex[Lj]=pI(Lj,Ka,(xr=>AG(dH,Ka,My,xr).url)));const bq=Ka.cacheDomainIndex[Lj];for(const xr of bq){const Lj=AG(dH,Ka,My,xr);zX.push(Lj)}return pR(Ka),zX}function dX(xr){const dH=(0,zX.parseArray)(xr),Ka=dH.map((xr=>[xr])),{domains:My,domainLabels:Lj,nonstandard:bq}=CI(Ka);return{domains:My,domainLabels:Lj,nonstandard:bq,urls:dH}}function hW(xr,dH){const Ka=undefined,My=pI(Bx(xr),dH,(xr=>[dH.urls[xr]])),zX=[];for(const xr of My)zX.push(dH.urls[xr]);return zX}function h(xr,dH){if(null===dH)return!1;const Ka=hW(xr,dH);return(0,My.isURLInList)(xr,Ka)}Ka.parseSitesFixesConfig=bq,Ka.getDomain=Bx,Ka.indexSitesFixesConfig=im,Ka.getSitesFixesFor=HC,Ka.indexSiteListConfig=dX,Ka.isURLInSiteList=h},{"../../utils/text":41,"../../utils/url":45}],29:[function(xr,dH,Ka){"use strict";Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.PREFIX=void 0,Ka.PREFIX="dm"},{}],30:[function(xr,dH,Ka){"use strict";function My(xr){return null!=xr.length}function zX(xr,dH){if(My(xr))for(let Ka=0,My=xr.length;Ka<My;Ka++)dH(xr[Ka]);else for(const Ka of xr)dH(Ka)}function Lj(xr,dH){zX(dH,(dH=>xr.push(dH)))}function bq(xr){const dH=[];for(let Ka=0,My=xr.length;Ka<My;Ka++)dH.push(xr[Ka]);return dH}Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.toArray=Ka.push=Ka.forEach=void 0,Ka.forEach=zX,Ka.push=Lj,Ka.toArray=bq},{}],31:[function(xr,dH,Ka){"use strict";Object.defineProperty(Ka,"__esModule",{value:!0});class My{constructor(){this.queue=[],this.timerId=null,this.frameDuration=1e3/60}addToQueue(xr){this.queue.push(xr),this.startQueue()}stopQueue(){null!==this.timerId&&(cancelAnimationFrame(this.timerId),this.timerId=null),this.queue=[]}startQueue(){this.timerId||(this.timerId=requestAnimationFrame((()=>{this.timerId=null;const xr=Date.now();let dH;for(;dH=this.queue.shift();)if(dH(),Date.now()-xr>=this.frameDuration){this.startQueue();break}})))}}Ka.default=My},{}],32:[function(xr,dH,Ka){"use strict";var My;Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.AutomationMode=void 0,function(xr){xr["NONE"]="",xr["TIME"]="time",xr["SYSTEM"]="system",xr["LOCATION"]="location"}(My=Ka.AutomationMode||(Ka.AutomationMode={}))},{}],33:[function(xr,dH,Ka){"use strict";Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.getSRGBLightness=Ka.lowerCalcExpression=Ka.parse=Ka.hslToString=Ka.rgbToHexString=Ka.rgbToString=Ka.rgbToHSL=Ka.hslToRGB=Ka.clearColorCache=Ka.parseToHSLWithCache=Ka.parseColorWithCache=void 0;const My=xr("./math-eval"),zX=xr("./text"),Lj=new Map,bq=new Map;function Bx(xr){if(xr=xr.trim(),bq.has(xr))return bq.get(xr);xr.includes("calc(")&&(xr=Zf(xr));const dH=HC(xr);return dH&&bq.set(xr,dH),dH}function IH(xr){if(Lj.has(xr))return Lj.get(xr);const dH=Bx(xr);if(!dH)return null;const Ka=Vi(dH);return Lj.set(xr,Ka),Ka}function zk(){Lj.clear(),bq.clear()}function vx({h:xr,s:dH,l:Ka,a:My=1}){if(0===dH){const[xr,dH,zX]=[Ka,Ka,Ka].map((xr=>Math.round(255*xr)));return{r:xr,g:zX,b:dH,a:My}}const zX=(1-Math.abs(2*Ka-1))*dH,Lj=zX*(1-Math.abs(xr/60%2-1)),bq=Ka-zX/2,[Bx,IH,zk]=(xr<60?[zX,Lj,0]:xr<120?[Lj,zX,0]:xr<180?[0,zX,Lj]:xr<240?[0,Lj,zX]:xr<300?[Lj,0,zX]:[zX,0,Lj]).map((xr=>Math.round(255*(xr+bq))));return{r:Bx,g:IH,b:zk,a:My}}function Vi({r:xr,g:dH,b:Ka,a:My=1}){const zX=xr/255,Lj=dH/255,bq=Ka/255,Bx=Math.max(zX,Lj,bq),IH=Math.min(zX,Lj,bq),zk=Bx-IH,vx=(Bx+IH)/2;if(0===zk)return{h:0,s:0,l:vx,a:My};let Vi=60*(Bx===zX?(Lj-bq)/zk%6:Bx===Lj?(bq-zX)/zk+2:(zX-Lj)/zk+4);Vi<0&&(Vi+=360);const CI=undefined;return{h:Vi,s:zk/(1-Math.abs(2*vx-1)),l:vx,a:My}}function CI(xr,dH=0){const Ka=xr.toFixed(dH);if(0===dH)return Ka;const My=Ka.indexOf(".");if(My>=0){const xr=Ka.match(/0+$/);if(xr)return xr.index===My+1?Ka.substring(0,My):Ka.substring(0,xr.index)}return Ka}function jF(xr){const{r:dH,g:Ka,b:My,a:zX}=xr;return null!=zX&&zX<1?`rgba(${CI(dH)}, ${CI(Ka)}, ${CI(My)}, ${CI(zX,2)})`:`rgb(${CI(dH)}, ${CI(Ka)}, ${CI(My)})`}function Bd({r:xr,g:dH,b:Ka,a:My}){return`#${(null!=My&&My<1?[xr,dH,Ka,Math.round(255*My)]:[xr,dH,Ka]).map((xr=>`${xr<16?"0":""}${xr.toString(16)}`)).join("")}`}function im(xr){const{h:dH,s:Ka,l:My,a:zX}=xr;return null!=zX&&zX<1?`hsla(${CI(dH)}, ${CI(100*Ka)}%, ${CI(100*My)}%, ${CI(zX,2)})`:`hsl(${CI(dH)}, ${CI(100*Ka)}%, ${CI(100*My)}%)`}Ka.parseColorWithCache=Bx,Ka.parseToHSLWithCache=IH,Ka.clearColorCache=zk,Ka.hslToRGB=vx,Ka.rgbToHSL=Vi,Ka.rgbToString=jF,Ka.rgbToHexString=Bd,Ka.hslToString=im;const pI=/^rgba?\([^\(\)]+\)$/,AG=/^hsla?\([^\(\)]+\)$/,pR=/^#[0-9a-f]+$/i;function HC(xr){const dH=xr.trim().toLowerCase();return dH.match(pI)?di(dH):dH.match(AG)?Cu(dH):dH.match(pR)?MR(dH):Mr.has(dH)?qD(dH):Ck.has(dH)?yG(dH):"transparent"===xr?{r:0,g:0,b:0,a:0}:null}function dX(xr){const dH=[];let Ka=0,My=!1;const zX=xr.indexOf("(");xr=xr.substring(zX+1,xr.length-1);for(let zX=0;zX<xr.length;zX++){const Lj=xr[zX];Lj>="0"&&Lj<="9"||"."===Lj||"+"===Lj||"-"===Lj?My=!0:!My||" "!==Lj&&","!==Lj&&"/"!==Lj?My||(Ka=zX+1):(dH.push(xr.substring(Ka,zX)),My=!1,Ka=zX+1)}return My&&dH.push(xr.substring(Ka,xr.length)),dH}function hW(xr,dH,Ka){const My=dX(xr),zX=Object.entries(Ka),Lj=undefined;return My.map((xr=>xr.trim())).map(((xr,Ka)=>{let My;const Lj=zX.find((([dH])=>xr.endsWith(dH)));return My=Lj?parseFloat(xr.substring(0,xr.length-Lj[0].length))/Lj[1]*dH[Ka]:parseFloat(xr),dH[Ka]>1?Math.round(My):My}))}Ka.parse=HC;const h=[255,255,255,1],nH={"%":100};function di(xr){const[dH,Ka,My,zX=1]=hW(xr,h,nH);return{r:dH,g:Ka,b:My,a:zX}}const RF=[360,1,1,1],it={"%":100,deg:360,rad:2*Math.PI,turn:1};function Cu(xr){const[dH,Ka,My,zX=1]=hW(xr,RF,it);return vx({h:dH,s:Ka,l:My,a:zX})}function MR(xr){const dH=xr.substring(1);switch(dH.length){case 3:case 4:{const[xr,Ka,My]=[0,1,2].map((xr=>parseInt(`${dH[xr]}${dH[xr]}`,16))),zX=undefined;return{r:xr,g:Ka,b:My,a:3===dH.length?1:parseInt(`${dH[3]}${dH[3]}`,16)/255}}case 6:case 8:{const[xr,Ka,My]=[0,2,4].map((xr=>parseInt(dH.substring(xr,xr+2),16))),zX=undefined;return{r:xr,g:Ka,b:My,a:6===dH.length?1:parseInt(dH.substring(6,8),16)/255}}}return null}function qD(xr){const dH=Mr.get(xr);return{r:dH>>16&255,g:dH>>8&255,b:dH>>0&255,a:1}}function yG(xr){const dH=Ck.get(xr);return{r:dH>>16&255,g:dH>>8&255,b:dH>>0&255,a:1}}function Zf(xr){let dH=0;const Ka=(dH,Ka,My)=>{xr=xr.substring(0,dH)+My+xr.substring(Ka)};for(;-1!==(dH=xr.indexOf("calc("));){const Lj=(0,zX.getParenthesesRange)(xr,dH);if(!Lj)break;let bq=xr.slice(Lj.start+1,Lj.end-1);const Bx=bq.includes("%");bq=bq.split("%").join("");const IH=Math.round((0,My.evalMath)(bq));Ka(Lj.start-4,Lj.end,IH+(Bx?"%":""))}return xr}Ka.lowerCalcExpression=Zf;const Mr=new Map(Object.entries({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgrey:11119017,darkgreen:25600,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,grey:8421504,green:32768,greenyellow:11403055,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgrey:13882323,lightgreen:9498256,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074})),Ck=new Map(Object.entries({ActiveBorder:3906044,ActiveCaption:0,AppWorkspace:11184810,Background:6513614,ButtonFace:16777215,ButtonHighlight:15329769,ButtonShadow:10461343,ButtonText:0,CaptionText:0,GrayText:8355711,Highlight:11720703,HighlightText:0,InactiveBorder:16777215,InactiveCaption:16777215,InactiveCaptionText:0,InfoBackground:16514245,InfoText:0,Menu:16185078,MenuText:16777215,Scrollbar:11184810,ThreeDDarkShadow:0,ThreeDFace:12632256,ThreeDHighlight:16777215,ThreeDLightShadow:16777215,ThreeDShadow:0,Window:15527148,WindowFrame:11184810,WindowText:0,"-webkit-focus-ring-color":15046400}).map((([xr,dH])=>[xr.toLowerCase(),dH])));function Jp(xr,dH,Ka){return(.2126*xr+.7152*dH+.0722*Ka)/255}Ka.getSRGBLightness=Jp},{"./math-eval":35,"./text":41}],34:[function(xr,dH,Ka){"use strict";Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.compareIPV6=Ka.isIPV6=void 0;const My=/\[[0-9:a-zA-Z]+?\]/;function zX(xr){const dH=My.exec(xr);if(!dH)return!1;const Ka=xr.indexOf("?");return!(Ka>=0&&dH.index>Ka)}Ka.isIPV6=zX;const Lj=/\[.*?\](\:\d+)?/;function bq(xr,dH){const Ka=undefined,My=undefined;return xr.match(Lj)[0]===dH.match(Lj)[0]}Ka.compareIPV6=bq},{}],35:[function(xr,dH,Ka){"use strict";function My(xr){const dH=[],Ka=[];let My;for(let zX=0,bq=xr.length;zX<bq;zX++){const bq=xr[zX];if(bq&&" "!==bq){if(Lj.has(bq)){const xr=Lj.get(bq);for(;Ka.length;){const My=Lj.get(Ka[0]);if(!My)break;if(!xr.lessOrEqualThan(My))break;dH.push(Ka.shift())}Ka.unshift(bq)}else!My||Lj.has(My)?dH.push(bq):dH[dH.length-1]+=bq;My=bq}}dH.push(...Ka);const zX=[];for(let xr=0,Ka=dH.length;xr<Ka;xr++){const Ka=Lj.get(dH[xr]);if(Ka){const xr=zX.splice(0,2);zX.push(Ka.exec(xr[1],xr[0]))}else zX.unshift(parseFloat(dH[xr]))}return zX[0]}Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.evalMath=void 0,Ka.evalMath=My;class zX{constructor(xr,dH){this.precendce=xr,this.execMethod=dH}exec(xr,dH){return this.execMethod(xr,dH)}lessOrEqualThan(xr){return this.precendce<=xr.precendce}}const Lj=new Map([["+",new zX(1,((xr,dH)=>xr+dH))],["-",new zX(1,((xr,dH)=>xr-dH))],["*",new zX(2,((xr,dH)=>xr*dH))],["/",new zX(2,((xr,dH)=>xr/dH))]])},{}],36:[function(xr,dH,Ka){"use strict";function My(xr,dH,Ka,My,zX){return(xr-dH)*(zX-My)/(Ka-dH)+My}function zX(xr,dH,Ka){return Math.min(Ka,Math.max(dH,xr))}function Lj(xr,dH){const Ka=[];for(let My=0,zX=xr.length;My<zX;My++){Ka[My]=[];for(let zX=0,Lj=dH[0].length;zX<Lj;zX++){let Lj=0;for(let Ka=0,bq=xr[0].length;Ka<bq;Ka++)Lj+=xr[My][Ka]*dH[Ka][zX];Ka[My][zX]=Lj}}return Ka}Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.multiplyMatrices=Ka.clamp=Ka.scale=void 0,Ka.scale=My,Ka.clamp=zX,Ka.multiplyMatrices=Lj},{}],37:[function(xr,dH,Ka){"use strict";var My;Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.MessageType=void 0,function(xr){xr["UI_GET_DATA"]="ui-get-data",xr["UI_GET_DEVTOOLS_DATA"]="ui-get-devtools-data",xr["UI_SUBSCRIBE_TO_CHANGES"]="ui-subscribe-to-changes",xr["UI_UNSUBSCRIBE_FROM_CHANGES"]="ui-unsubscribe-from-changes",xr["UI_CHANGE_SETTINGS"]="ui-change-settings",xr["UI_SET_THEME"]="ui-set-theme",xr["UI_TOGGLE_ACTIVE_TAB"]="ui-toggle-active-tab",xr["UI_MARK_NEWS_AS_READ"]="ui-mark-news-as-read",xr["UI_MARK_NEWS_AS_DISPLAYED"]="ui-mark-news-as-displayed",xr["UI_LOAD_CONFIG"]="ui-load-config",xr["UI_APPLY_DEV_DYNAMIC_THEME_FIXES"]="ui-apply-dev-dynamic-theme-fixes",xr["UI_RESET_DEV_DYNAMIC_THEME_FIXES"]="ui-reset-dev-dynamic-theme-fixes",xr["UI_APPLY_DEV_INVERSION_FIXES"]="ui-apply-dev-inversion-fixes",xr["UI_RESET_DEV_INVERSION_FIXES"]="ui-reset-dev-inversion-fixes",xr["UI_APPLY_DEV_STATIC_THEMES"]="ui-apply-dev-static-themes",xr["UI_RESET_DEV_STATIC_THEMES"]="ui-reset-dev-static-themes",xr["UI_SAVE_FILE"]="ui-save-file",xr["UI_REQUEST_EXPORT_CSS"]="ui-request-export-css",xr["UI_COLOR_SCHEME_CHANGE"]="ui-color-scheme-change",xr["BG_CHANGES"]="bg-changes",xr["BG_ADD_CSS_FILTER"]="bg-add-css-filter",xr["BG_ADD_STATIC_THEME"]="bg-add-static-theme",xr["BG_ADD_SVG_FILTER"]="bg-add-svg-filter",xr["BG_ADD_DYNAMIC_THEME"]="bg-add-dynamic-theme",xr["BG_EXPORT_CSS"]="bg-export-css",xr["BG_UNSUPPORTED_SENDER"]="bg-unsupported-sender",xr["BG_CLEAN_UP"]="bg-clean-up",xr["BG_RELOAD"]="bg-reload",xr["BG_FETCH_RESPONSE"]="bg-fetch-response",xr["BG_UI_UPDATE"]="bg-ui-update",xr["BG_CSS_UPDATE"]="bg-css-update",xr["CS_COLOR_SCHEME_CHANGE"]="cs-color-scheme-change",xr["CS_FRAME_CONNECT"]="cs-frame-connect",xr["CS_FRAME_FORGET"]="cs-frame-forget",xr["CS_FRAME_FREEZE"]="cs-frame-freeze",xr["CS_FRAME_RESUME"]="cs-frame-resume",xr["CS_EXPORT_CSS_RESPONSE"]="cs-export-css-response",xr["CS_FETCH"]="cs-fetch",xr["CS_DARK_THEME_DETECTED"]="cs-dark-theme-detected",xr["CS_DARK_THEME_NOT_DETECTED"]="cs-dark-theme-not-detected",xr["CS_LOG"]="cs-log"}(My=Ka.MessageType||(Ka.MessageType={}))},{}],38:[function(xr,dH,Ka){"use strict";Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.loadAsText=Ka.readResponseAsDataURL=Ka.loadAsDataURL=void 0;const My=xr("./platform");async function zX(xr,dH,Ka){const zX=await fetch(xr,{cache:"force-cache",credentials:"omit",referrer:Ka});if(My.isFirefox&&"text/css"===dH&&xr.startsWith("moz-extension://")&&xr.endsWith(".css"))return zX;if(dH&&!zX.headers.get("Content-Type").startsWith(dH))throw new Error(`Mime type mismatch when loading ${xr}`);if(!zX.ok)throw new Error(`Unable to load ${xr} ${zX.status} ${zX.statusText}`);return zX}async function Lj(xr,dH){const Ka=await zX(xr,dH);return await bq(Ka)}async function bq(xr){const dH=await xr.blob(),Ka=undefined;return await new Promise((xr=>{const Ka=new FileReader;Ka.onloadend=()=>xr(Ka.result),Ka.readAsDataURL(dH)}))}async function Bx(xr,dH,Ka){const My=await zX(xr,dH,Ka);return await My.text()}Ka.loadAsDataURL=Lj,Ka.readResponseAsDataURL=bq,Ka.loadAsText=Bx},{"./platform":40}],39:[function(xr,dH,Ka){"use strict";Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.parseGradient=void 0;const My=xr("./text"),zX="gradient".length,Lj="conic-",bq=Lj.length,Bx="radial-",IH="linear-";function zk(xr){const dH=[];let Ka=0,zk=Lj.length;for(;-1!==(Ka=xr.indexOf("gradient",zk));){let vx;if([IH,Bx,Lj].find((dH=>{if(Ka-dH.length>=0){const My=undefined;if(xr.substring(Ka-dH.length,Ka)===dH)return"repeating"===xr.slice(Ka-dH.length-10,Ka-dH.length-1)?(vx=`repeating-${dH}gradient`,!0):"-webkit"===xr.slice(Ka-dH.length-8,Ka-dH.length-1)?(vx=`-webkit-${dH}gradient`,!0):(vx=`${dH}gradient`,!0)}})),!vx)break;const{start:Vi,end:CI}=(0,My.getParenthesesRange)(xr,Ka+zX),jF=xr.substring(Vi+1,CI-1);zk=CI+1+bq,dH.push({typeGradient:vx,match:jF,offset:vx.length+2,index:Ka-vx.length+zX,hasComma:!0})}return dH.length&&(dH[dH.length-1].hasComma=!1),dH}Ka.parseGradient=zk},{"./text":41}],40:[function(xr,dH,Ka){"use strict";Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.isCSSColorSchemePropSupported=Ka.isFetchSupported=Ka.isXMLHttpRequestSupported=Ka.compareChromeVersions=Ka.isDefinedSelectorSupported=Ka.firefoxVersion=Ka.chromiumVersion=Ka.isNonPersistent=Ka.isMatchMediaChangeEventListenerBuggy=Ka.isMatchMediaChangeEventListenerSupported=Ka.isShadowDomSupported=Ka.isMobile=Ka.isMacOS=Ka.isWindows=Ka.isSafari=Ka.isEdge=Ka.isOpera=Ka.isYaBrowser=Ka.isVivaldi=Ka.isFirefox=Ka.isThunderbird=Ka.isChromium=void 0;const My="undefined"!=typeof navigator,zX=My?navigator.userAgentData&&Array.isArray(navigator.userAgentData.brands)?navigator.userAgentData.brands.map((xr=>`${xr.brand.toLowerCase()} ${xr.version}`)).join(" "):navigator.userAgent.toLowerCase():"some useragent",Lj=My?navigator.userAgentData&&"string"==typeof navigator.userAgentData.platform?navigator.userAgentData.platform.toLowerCase():navigator.platform.toLowerCase():"some platform";function bq(xr,dH){const Ka=xr.split(".").map((xr=>parseInt(xr))),My=dH.split(".").map((xr=>parseInt(xr)));for(let xr=0;xr<Ka.length;xr++)if(Ka[xr]!==My[xr])return Ka[xr]<My[xr]?-1:1;return 0}Ka.isChromium=!0,Ka.isThunderbird=!1,Ka.isFirefox=!1,Ka.isVivaldi=!1,Ka.isYaBrowser=!1,Ka.isOpera=!1,Ka.isEdge=!1,Ka.isSafari=!1,Ka.isWindows=Lj.startsWith("win"),Ka.isMacOS=Lj.startsWith("mac"),Ka.isMobile=My&&navigator.userAgentData?navigator.userAgentData.mobile:zX.includes("mobile"),Ka.isShadowDomSupported="function"==typeof ShadowRoot,Ka.isMatchMediaChangeEventListenerSupported=!0,Ka.isMatchMediaChangeEventListenerBuggy=My&&navigator.userAgentData&&["Linux","Android"].includes(navigator.userAgentData.platform)||Lj.startsWith("linux"),Ka.isNonPersistent=!0,Ka.chromiumVersion=(()=>{const xr=zX.match(/chrom(?:e|ium)(?:\/| )([^ ]+)/);return xr&&xr[1]?xr[1]:""})(),Ka.firefoxVersion=(()=>{const xr=zX.match(/(?:firefox|librewolf)(?:\/| )([^ ]+)/);return xr&&xr[1]?xr[1]:""})(),Ka.isDefinedSelectorSupported=(()=>{try{return document.querySelector(":defined"),!0}catch(xr){return!1}})(),Ka.compareChromeVersions=bq,Ka.isXMLHttpRequestSupported="function"==typeof XMLHttpRequest,Ka.isFetchSupported="function"==typeof fetch,Ka.isCSSColorSchemePropSupported=!0},{}],41:[function(xr,dH,Ka){"use strict";function My(xr,dH){if(!isFinite(dH))throw new Error(`Wrong char index ${dH}`);let Ka="",My=0,zX,Lj=0;do{My++,zX=Lj,Lj=xr.indexOf("\n",zX+1)}while(Lj>=0&&Lj<=dH);const bq=dH-zX;return Ka+=`line ${My}, column ${bq}`,Ka+="\n",dH<xr.length?Ka+=xr.substring(zX+1,Lj):Ka+=xr.substring(xr.lastIndexOf("\n")+1),Ka+="\n",Ka+=`${new Array(bq).join("-")}^`,Ka}function zX(xr,dH){const Ka=Math.min(xr.length,dH.length);for(let My=0;My<Ka;My++)if(xr[My]!==dH[My])return My;return xr.length!==dH.length?Ka:-1}function Lj(xr){return xr.replace(/\r/g,"").split("\n").map((xr=>xr.trim())).filter((xr=>xr))}function bq(xr){return xr.concat("").join("\n")}function Bx(xr,dH,Ka=0){const My=[];let zX;for(;zX=xr.exec(dH);)My.push(zX[Ka]);return My}function IH(xr){return 2*xr.length}function zk(xr){function dH(xr){return xr.replace(/^\s+/,"")}function Ka(xr){return 0===xr?"":" ".repeat(4*xr)}if(xr.length<5e4){const dH=/[^{}]+{\s*}/;for(;dH.test(xr);)xr=xr.replace(dH,"")}const My=xr.replace(/\s{2,}/g," ").replace(/\{/g,"{\n").replace(/\}/g,"\n}\n").replace(/\;(?![^\(|\"]*(\)|\"))/g,";\n").replace(/\,(?![^\(|\"]*(\)|\"))/g,",\n").replace(/\n\s*\n/g,"\n").split("\n");let zX=0;const Lj=[];for(let xr=0,bq=My.length;xr<bq;xr++){const bq=`${My[xr]}\n`;bq.includes("{")?Lj.push(Ka(zX++)+dH(bq)):bq.includes("}")?Lj.push(Ka(--zX)+dH(bq)):Lj.push(Ka(zX)+dH(bq))}return Lj.join("").trim()}function vx(xr,dH=0){const Ka=xr.length;let My=0,zX=-1;for(let Lj=dH;Lj<Ka;Lj++)if(0===My){const dH=xr.indexOf("(",Lj);if(dH<0)break;zX=dH,My++,Lj=dH}else{const dH=xr.indexOf(")",Lj);if(dH<0)break;const Ka=xr.indexOf("(",Lj);if(Ka<0||dH<Ka){if(My--,0===My)return{start:zX,end:dH+1};Lj=dH}else My++,Lj=Ka}return null}Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.getParenthesesRange=Ka.formatCSS=Ka.getStringSize=Ka.getMatches=Ka.formatArray=Ka.parseArray=Ka.getTextDiffIndex=Ka.getTextPositionMessage=void 0,Ka.getTextPositionMessage=My,Ka.getTextDiffIndex=zX,Ka.parseArray=Lj,Ka.formatArray=bq,Ka.getMatches=Bx,Ka.getStringSize=IH,Ka.formatCSS=zk,Ka.getParenthesesRange=vx},{}],42:[function(xr,dH,Ka){"use strict";function My(xr){let dH=!1,Ka=null,My;const zX=(...zX)=>{My=zX,Ka?dH=!0:(xr(...My),Ka=requestAnimationFrame((()=>{Ka=null,dH&&(xr(...My),dH=!1)})))},Lj=()=>{cancelAnimationFrame(Ka),dH=!1,Ka=null};return Object.assign(zX,{cancel:Lj})}function zX(){const xr=[];let dH=null;function Ka(){let Ka;for(;Ka=xr.shift();)Ka();dH=null}function My(My){xr.push(My),dH||(dH=requestAnimationFrame(Ka))}function zX(){xr.splice(0),cancelAnimationFrame(dH),dH=null}return{add:My,cancel:zX}}Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.createAsyncTasksQueue=Ka.throttle=void 0,Ka.throttle=My,Ka.createAsyncTasksQueue=zX},{}],43:[function(xr,dH,Ka){"use strict";function My(xr){const dH=xr.split(":").slice(0,2),Ka=xr.trim().toLowerCase(),My=Ka.endsWith("am")||Ka.endsWith("a.m."),zX=Ka.endsWith("pm")||Ka.endsWith("p.m.");let Lj=dH.length>0?parseInt(dH[0]):0;(isNaN(Lj)||Lj>23)&&(Lj=0),My&&12===Lj&&(Lj=0),zX&&Lj<12&&(Lj+=12);let bq=dH.length>1?parseInt(dH[1]):0;return(isNaN(bq)||bq>59)&&(bq=0),[Lj,bq]}function zX(xr){return xr.split(":").map((xr=>parseInt(xr)))}function Lj(xr,dH){return xr[0]===dH[0]&&xr[1]===dH[1]?0:xr[0]<dH[0]||xr[0]===dH[0]&&xr[1]<dH[1]?-1:1}function bq(xr,dH,Ka=new Date){const My=zX(xr),Bx=zX(dH),IH=[Ka.getHours(),Ka.getMinutes()];return Lj(My,Bx)>0?bq(dH,xr,Ka):0===Lj(My,Bx)?null:Lj(IH,My)<0?(Ka.setHours(My[0]),Ka.setMinutes(My[1]),Ka.setSeconds(0),Ka.setMilliseconds(0),Ka.getTime()):Lj(IH,Bx)<0?(Ka.setHours(Bx[0]),Ka.setMinutes(Bx[1]),Ka.setSeconds(0),Ka.setMilliseconds(0),Ka.getTime()):new Date(Ka.getFullYear(),Ka.getMonth(),Ka.getDate()+1,My[0],My[1]).getTime()}function Bx(xr,dH,Ka=new Date){const My=zX(xr),bq=zX(dH),Bx=[Ka.getHours(),Ka.getMinutes()];return Lj(My,bq)>0?Lj(My,Bx)<=0||Lj(Bx,bq)<0:Lj(My,Bx)<=0&&Lj(Bx,bq)<0}function IH(xr,dH,Ka){return dH<xr?Ka<=dH||xr<=Ka:xr<Ka&&Ka<dH}function zk(xr){let dH=0;return xr.seconds&&(dH+=1e3*xr.seconds),xr.minutes&&(dH+=60*xr.minutes*1e3),xr.hours&&(dH+=60*xr.hours*60*1e3),xr.days&&(dH+=24*xr.days*60*60*1e3),dH}function vx(xr){return zk(xr)/1e3/60}function Vi(xr,dH,Ka){const My=Date.UTC(Ka.getUTCFullYear(),0,0,0,0,0,0),zX=zk({days:1}),Lj=Math.floor((Ka.getTime()-My)/zX),bq=90.83333333333333,Bx=Math.PI/180,IH=180/Math.PI,vx=dH/15;function Vi(dH){const Ka=Lj+((dH?6:18)-vx)/24,My=.9856*Ka-3.289;let zX=My+1.916*Math.sin(My*Bx)+.02*Math.sin(2*My*Bx)+282.634;zX>360?zX-=360:zX<0&&(zX+=360);let Vi=IH*Math.atan(.91764*Math.tan(zX*Bx));Vi>360?Vi-=360:Vi<0&&(Vi+=360);const CI=undefined,jF=undefined;Vi+=90*Math.floor(zX/90)-90*Math.floor(Vi/90),Vi/=15;const Bd=.39782*Math.sin(zX*Bx),im=Math.cos(Math.asin(Bd)),pI=(Math.cos(bq*Bx)-Bd*Math.sin(xr*Bx))/(im*Math.cos(xr*Bx));if(pI>1)return{alwaysDay:!1,alwaysNight:!0,time:0};if(pI<-1)return{alwaysDay:!0,alwaysNight:!1,time:0};const AG=undefined,pR=undefined;let HC=(dH?360-IH*Math.acos(pI):IH*Math.acos(pI))/15+Vi-.06571*Ka-6.622-vx;return HC>24?HC-=24:HC<0&&(HC+=24),{alwaysDay:!1,alwaysNight:!1,time:Math.round(HC*zk({hours:1}))}}const CI=Vi(!0),jF=Vi(!1);return CI.alwaysDay||jF.alwaysDay?{alwaysDay:!0}:CI.alwaysNight||jF.alwaysNight?{alwaysNight:!0}:{sunriseTime:CI.time,sunsetTime:jF.time}}function CI(xr,dH,Ka=new Date){const My=Vi(xr,dH,Ka);if(My.alwaysDay)return!1;if(My.alwaysNight)return!0;const zX=My.sunriseTime,Lj=undefined,bq=undefined;return IH(My.sunsetTime,zX,Ka.getUTCHours()*zk({hours:1})+Ka.getUTCMinutes()*zk({minutes:1})+Ka.getUTCSeconds()*zk({seconds:1})+Ka.getUTCMilliseconds())}function jF(xr,dH,Ka=new Date){const My=Vi(xr,dH,Ka);if(My.alwaysDay)return Ka.getTime()+zk({days:1});if(My.alwaysNight)return Ka.getTime()+zk({days:1});const[zX,Lj]=My.sunriseTime<My.sunsetTime?[My.sunriseTime,My.sunsetTime]:[My.sunsetTime,My.sunriseTime],bq=Ka.getUTCHours()*zk({hours:1})+Ka.getUTCMinutes()*zk({minutes:1})+Ka.getUTCSeconds()*zk({seconds:1})+Ka.getUTCMilliseconds();return bq<=zX?Date.UTC(Ka.getUTCFullYear(),Ka.getUTCMonth(),Ka.getUTCDate(),0,0,0,zX):bq<=Lj?Date.UTC(Ka.getUTCFullYear(),Ka.getUTCMonth(),Ka.getUTCDate(),0,0,0,Lj):Date.UTC(Ka.getUTCFullYear(),Ka.getUTCMonth(),Ka.getUTCDate()+1,0,0,0,zX)}Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.nextTimeChangeAtLocation=Ka.isNightAtLocation=Ka.getDurationInMinutes=Ka.getDuration=Ka.isInTimeIntervalLocal=Ka.nextTimeInterval=Ka.parseTime=void 0,Ka.parseTime=My,Ka.nextTimeInterval=bq,Ka.isInTimeIntervalLocal=Bx,Ka.getDuration=zk,Ka.getDurationInMinutes=vx,Ka.isNightAtLocation=CI,Ka.nextTimeChangeAtLocation=jF},{}],44:[function(xr,dH,Ka){"use strict";function My(xr){return(xr<16?"0":"")+xr.toString(16)}function zX(){if("randomUUID"in crypto){const xr=crypto.randomUUID();return xr.substring(0,8)+xr.substring(9,13)+xr.substring(14,18)+xr.substring(19,23)+xr.substring(24)}return Array.from(crypto.getRandomValues(new Uint8Array(16))).map((xr=>My(xr))).join("")}Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.generateUID=void 0,Ka.generateUID=zX},{}],45:[function(xr,dH,Ka){"use strict";Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.isLocalFile=Ka.fullyQualifiedDomainMatchesWildcard=Ka.isFullyQualifiedDomainWildcard=Ka.isFullyQualifiedDomain=Ka.isURLEnabled=Ka.isPDF=Ka.isURLMatched=Ka.isURLInList=Ka.compareURLPatterns=Ka.getURLHostOrProtocol=Ka.isRelativeHrefOnAbsolutePath=Ka.getAbsoluteURL=Ka.parseURL=Ka.parsedURLCache=void 0;const My=xr("./ipv6"),zX=!1;let Lj;function bq(xr){return Lj||(Lj=document.createElement("a")),Lj.href=xr,Lj.href}function Bx(xr,dH=null){const My=`${xr}${dH?`;${dH}`:""}`;if(Ka.parsedURLCache.has(My))return Ka.parsedURLCache.get(My);if(dH){const zX=new URL(xr,bq(dH));return Ka.parsedURLCache.set(My,zX),zX}const zX=new URL(bq(xr));return Ka.parsedURLCache.set(xr,zX),zX}function IH(xr,dH){if(dH.match(/^data\\?\:/))return dH;if(/^\/\//.test(dH))return`${location.protocol}${dH}`;const Ka=Bx(xr),My=undefined;return Bx(dH,Ka.href).href}function zk(xr){if(xr.startsWith("data:"))return!0;const dH=Bx(xr);return dH.protocol===location.protocol&&(dH.hostname===location.hostname&&(dH.port===location.port&&dH.pathname===location.pathname))}function vx(xr){const dH=new URL(xr);return dH.host?dH.host:"file:"===dH.protocol?dH.pathname:dH.protocol}function Vi(xr,dH){return xr.localeCompare(dH)}function CI(xr,dH){for(let Ka=0;Ka<dH.length;Ka++)if(jF(xr,dH[Ka]))return!0;return!1}function jF(xr,dH){const Ka=(0,My.isIPV6)(xr),zX=(0,My.isIPV6)(dH);if(Ka&&zX)return(0,My.compareIPV6)(xr,dH);if(!Ka&&!zX){const Ka=Bd(dH);return null!==Ka&&Boolean(xr.match(Ka))}return!1}function Bd(xr){try{const dH="^"===(xr=xr.trim())[0],Ka="$"===xr[xr.length-1],My=/\/\$?$/.test(xr);let zX,Lj,bq;(zX=(xr=xr.replace(/^\^/,"").replace(/\$$/,"").replace(/^.*?\/{2,3}/,"").replace(/\?.*$/,"").replace(/\/$/,"")).indexOf("/"))>=0?(Lj=xr.substring(0,zX),bq=xr.replace(/\$/g,"").substring(zX)):Lj=xr.replace(/\$/g,"");let Bx=dH?"^(.*?\\:\\/{2,3})?":"^(.*?\\:\\/{2,3})?([^/]*?\\.)?";const IH=Lj.split(".");Bx+="(";for(let xr=0;xr<IH.length;xr++)"*"===IH[xr]&&(IH[xr]="[^\\.\\/]+?");return Bx+=IH.join("\\."),Bx+=")",bq&&(Bx+="(",Bx+=bq.replace("/","\\/"),Bx+=")"),Bx+=Ka?"(\\/?(\\?[^/]*?)?)$":`(\\/${My?"":"?"}.*?)$`,new RegExp(Bx,"i")}catch(xr){return null}}function im(xr){if(xr.includes(".pdf")){if(xr.includes("?")&&(xr=xr.substring(0,xr.lastIndexOf("?"))),xr.includes("#")&&(xr=xr.substring(0,xr.lastIndexOf("#"))),xr.match(/(wikipedia|wikimedia)\.org/i)&&xr.match(/(wikipedia|wikimedia)\.org\/.*\/[a-z]+\:[^\:\/]+\.pdf/i)||xr.match(/timetravel\.mementoweb\.org\/reconstruct/i)&&xr.match(/\.pdf$/i)||xr.match(/dropbox\.com\/s\//i)&&xr.match(/\.pdf$/i))return!1;if(!xr.endsWith(".pdf"))return!1;for(let dH=xr.length;dH>0;dH--){if("="===xr[dH])return!1;if("/"===xr[dH])return!0}}return!1}function pI(xr,dH,{isProtected:Ka,isInDarkList:My,isDarkThemeDetected:Lj},bq=!0){if(dX(xr)&&!bq)return!1;if(Ka&&!dH.enableForProtectedPages)return!1;if(zX)return!0;if(im(xr))return dH.enableForPDF;const Bx=CI(xr,dH.siteList),IH=CI(xr,dH.siteListEnabled);return dH.applyToListedOnly?IH||Bx:!!IH||!(My||dH.detectDarkTheme&&Lj)&&!Bx}function AG(xr){return/^[a-z0-9\.\-]+$/i.test(xr)&&-1===xr.indexOf("..")}function pR(xr){if(!xr.includes("*")||!/^[a-z0-9\.\-\*]+$/i.test(xr))return!1;const dH=xr.split(".");for(const xr of dH)if("*"!==xr&&!/^[a-z0-9\-]+$/i.test(xr))return!1;return!0}function HC(xr,dH){const Ka=xr.toLowerCase().split("."),My=dH.toLowerCase().split(".");if(My.length<Ka.length)return!1;for(;Ka.length;){const xr=Ka.pop(),dH=My.pop();if("*"!==xr&&xr!==dH)return!1}return!0}function dX(xr){return xr&&xr.startsWith("file:///")}Ka.parsedURLCache=new Map,Ka.parseURL=Bx,Ka.getAbsoluteURL=IH,Ka.isRelativeHrefOnAbsolutePath=zk,Ka.getURLHostOrProtocol=vx,Ka.compareURLPatterns=Vi,Ka.isURLInList=CI,Ka.isURLMatched=jF,Ka.isPDF=im,Ka.isURLEnabled=pI,Ka.isFullyQualifiedDomain=AG,Ka.isFullyQualifiedDomainWildcard=pR,Ka.fullyQualifiedDomainMatchesWildcard=HC,Ka.isLocalFile=dX},{"./ipv6":34}],46:[function(xr,dH,Ka){"use strict";Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.documentIsVisible=Ka.removeDocumentVisibilityListener=Ka.setDocumentVisibilityListener=void 0;let My=null,zX=!document.hidden;const Lj={capture:!0,passive:!0};function bq(){document.addEventListener("visibilitychange",My,Lj),window.addEventListener("pageshow",My,Lj),window.addEventListener("focus",My,Lj)}function Bx(){document.removeEventListener("visibilitychange",My,Lj),window.removeEventListener("pageshow",My,Lj),window.removeEventListener("focus",My,Lj)}function IH(xr){const dH=Boolean(My);My=()=>{document.hidden||(zk(),xr(),zX=!0)},dH||bq()}function zk(){Bx(),My=null}function vx(){return zX}Ka.setDocumentVisibilityListener=IH,Ka.removeDocumentVisibilityListener=zk,Ka.documentIsVisible=vx},{}],47:[function(xr,dH,Ka){"use strict";Object.defineProperty(Ka,"__esModule",{value:!0}),xr("../../../darkmode-core/src/js/content/content")},{"../../../darkmode-core/src/js/content/content":2}]},{},[47]);