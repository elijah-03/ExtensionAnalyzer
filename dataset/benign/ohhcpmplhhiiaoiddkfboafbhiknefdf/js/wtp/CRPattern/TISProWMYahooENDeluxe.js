function TSWMYahooShowRatingResultUI(){var e=this.level;return g_oRatingLevel[e]!=g_oImgDefine.Safe&&g_oRatingLevel[e]!=g_oImgDefine.Neutral&&g_oRatingLevel[e]!=g_oImgDefine.Trusted}function TSWMYahooFetchTargetURL(e,t){var a=new RegExp("^(http|https)://","i"),l=new RegExp("^(http|https)://"+e,"i");return a.test(t)&&!l.test(t)?t:""}function TSWMYahooMailJPParseResult(e){var t,a=new CreateTSRLocatedObject(null,null,"A",null),l=new CreateTSRLocatedObject(e,a,"DIV","msg-preview");if(console.log(l),l.tagIDregexFirst=!0,t=l.findElement())for(var o=GetAllTSRLocatedNodes(t),n=e.location.host,r=6;r<o.length;r++){var i=TSWMYahooFetchTargetURL(n,o[r].href);0!=i.length&&CreateTSRResultObject(o[r],i,null,TSWMYahooShowRatingResultUI)}}function TSWMYahooMailParseResult(e){var t,a=new CreateTSRLocatedObject(null,null,"A",null),l=new CreateTSRLocatedObject(e,a,"DIV","mail-app-component");if(l.tagIDregexFirst=!0,t=l.findElement())for(var o=GetAllTSRLocatedNodes(t),n=e.location.host,r=0;r<o.length;r++){var i=TSWMYahooFetchTargetURL(n,o[r].href);0!=i.length&&CreateTSRResultObject(o[r],i,null,TSWMYahooShowRatingResultUI)}}function TSWMOldYahooMailParseResult(e){var t,a=new CreateTSRLocatedObject(null,null,"A",null),l=new CreateTSRLocatedObject(e,a,"DIV","shellinner");if(l.tagIDregexFirst=!0,t=l.findElement())for(var o=GetAllTSRLocatedNodes(t),n=e.location.host,r=0;r<o.length;r++){var i=TSWMYahooFetchTargetURL(n,o[r].href);0!=i.length&&CreateTSRResultObject(o[r],i,null,TSWMYahooShowRatingResultUI)}}function TSWMYahooMailJPParseResult2(e){var t=new CreateTSRLocatedObject(null,null,"a",null),a=new CreateTSRLocatedObject(null,t,"DIV",null),l=new CreateTSRLocatedObject(e,a,"DIV",null);l.multiMatches=!0,a.multiMatches=!0,t.multiMatches=!0,l.appendAttribute("class","msg-body");var o=l.findElement();if(o)for(var n=GetAllTSRLocatedNodes(o),r=e.location.host,i=0;i<n.length;i++){var s=TSWMYahooFetchTargetURL(r,n[i].href);0!=s.length&&CreateTSRResultObject(n[i],s,null,TSWMYahooShowRatingResultUI)}}function TSWMYahooMailJPParseResult3(e){let t=e.getElementsByTagName("article");if(0===t.length)return;let a=t[0].getElementsByTagName("iframe"),l=[];for(let e of a)"none"!==e.style.display&&l.push(e);if(0===l.length)return;let o=e.location.host;for(let e of l){let t=e.contentDocument.getElementsByTagName("a");for(let e of t){let t=TSWMYahooFetchTargetURL(o,e.href);0!=t.length&&CreateTSRResultObject(e,t,null,TSWMYahooShowRatingResultUI)}}}function TSWMYahooMailJPParseResult4(e){var t,a=new CreateTSRLocatedObject(null,null,"A",null),l=new CreateTSRLocatedObject(e,a,"DIV","textMail");if(l.tagIDregexFirst=!0,t=l.findElement())for(var o=GetAllTSRLocatedNodes(t),n=e.location.host,r=0;r<o.length;r++){var i=TSWMYahooFetchTargetURL(n,o[r].href);0!=i.length&&CreateTSRResultObject(o[r],i,null,TSWMYahooShowRatingResultUI)}}function TSRParse(){var e=g_oEnv.Parser.iResultNumber;TrendMicro.TB.DOMIdExist("msg-preview")&&(TSWMYahooMailJPParseResult(document),TSWMYahooMailJPParseResult2(document)),TrendMicro.TB.DOMIdExist("mail-app-component")&&TSWMYahooMailParseResult(document),TrendMicro.TB.DOMIdExist("shellinner")&&TSWMOldYahooMailParseResult(document);let t=document.querySelector('[data-cy="textMail"]');return t&&(t.setAttribute("id","textMail"),TSWMYahooMailJPParseResult4(document)),TSWMYahooMailJPParseResult3(document),TrendMicro.TB.ReduceNewNode(e+1),g_oEnv.Parser.rgobjSearchResult}g_bIsNeedCheckSPan=!0,TSRTagFlowID();