"use strict";const{Utils:Utils}=require("utils"),{Notification:Notification}=require("notification"),{getActiveNotification:getActiveNotification,shouldDisplay:shouldDisplay}=require("notificationHelper");function getDocLinks(t){if(!t.links)return[];let e=[];return t.links.forEach((t=>{e.push(Utils.getDocLink(t))})),e}function insertMessage(t,e,i){let n=/^(.*?)<(a|strong)>(.*?)<\/\2>(.*)$/.exec(e);if(!n)return void t.appendChild(document.createTextNode(e));let o=n[1],a=n[2],s=n[3],c=n[4];insertMessage(t,o,i);let l=document.createElement(a);"a"===a&&i&&i.length&&(l.href=i.shift()),insertMessage(l,s,i),t.appendChild(l),insertMessage(t,c,i)}window.addEventListener("load",(()=>{let t=getActiveNotification();if(!t||!shouldDisplay("popup",t.type))return;let e=Notification.getLocalizedTexts(t);document.getElementById("notification-title").textContent=e.title;let i=getDocLinks(t),n=document.getElementById("notification-message");insertMessage(n,e.message,i),n.addEventListener("click",(t=>{let e=t.target;for(;e&&e!==n&&"a"!==e.localName;)e=e.parentNode;e&&(t.preventDefault(),t.stopPropagation(),ext.pages.open(e.href))}));let o=document.getElementById("notification");o.className=t.type,o.hidden=!1,o.addEventListener("click",(e=>{"notification-close"==e.target.id?o.classList.add("closing"):"notification-optout"!=e.target.id&&"notification-hide"!=e.target.id||("notification-optout"==e.target.id&&Notification.toggleIgnoreCategory("*",!0),o.hidden=!0,t.onClicked())}),!0)}),!1);