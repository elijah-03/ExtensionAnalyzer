import{b as r,c as u}from"./chunk-DPMK7ZVG.js";import{g as d,h as m,l,o as g,t as y}from"./chunk-4XUWKJYA.js";var c="blocksNotification";function T({type:t,name:n,shouldSendTracking:o,content:a,throttleDurationMs:e,throttleKey:s,pageType:i,propsData:f={}}){o&&p({extensionTrackingType:"page",name:n},{content:a,pageType:i,type:t,...f}),e&&h(s)}function P({type:t,name:n,shouldSendTracking:o,content:a,dismissLabel:e,pageType:s,propsData:i={}}){o&&p({extensionTrackingType:"track",name:n},{content:a,dismissLabel:e,pageType:s,type:t,...i})}function D({type:t,name:n,shouldSendTracking:o,pageType:a,propsData:e={}}){if(!o)return;let{name:s,...i}=e;p({extensionTrackingType:"page",name:n},{pageType:a,type:t,...i})}function E({type:t,name:n,shouldSendTracking:o,propsData:a={}}){o&&p({extensionTrackingType:"track",name:n},{type:t,...a})}function p({extensionTrackingType:t,name:n},...o){g(t,n,{view:c,type:"notification",...o.reduce((a,e)=>({...a,...e}),{})})}function b(t,n){let o=t.data?.propsData?.shouldsendtracking,a=typeof o=="boolean"?o:!0;switch(t.type){case r.Destroy:n?.();break;case r.NotificationShow:{let e=t.data;T({type:t.type,name:e?.notificationName||t.type,shouldSendTracking:a,content:e?.notificationContent,throttleDurationMs:e?.throttleDurationMs,throttleKey:e?.throttleKey??c,pageType:e?.pageType,propsData:e?.propsData});break}case r.NotificationDismiss:{let e=t.data,{click_event_name:s,...i}=e?.propsData||{};P({type:t.type,name:s||e?.notificationName||t.type,shouldSendTracking:a,content:e?.notificationContent,dismissLabel:e?.dismissLabel??"",pageType:e?.pageType,propsData:i});break}case r.PageView:{let e=t.data;D({type:t.type,name:e?.name||e?.propsData?.name||t.type,shouldSendTracking:a,pageType:e?.pageType,propsData:e?.propsData});break}case r.Custom:{let e=t.data,{click_event_name:s,...i}=e?.propsData||{};E({type:t.type,name:s||t.eventName||t.type,shouldSendTracking:a,propsData:i});break}}}async function S(t){switch(t.type){case u.CheckNotifThrottled:{let n=t.data;return v(n?.throttleDurationMs,n?.throttleKey)}}}function h(t){d({message:"saveThrottle",throttleKey:t})}function v(t,n){return d({message:"checkSavedThrottle",throttleDurationMs:t,throttleKey:n??c})}var K=async()=>{let t=null;try{t=(await chrome.storage.sync.get("profileId")).profileId}catch{console.error("could not get profileId from local storage")}let n=m.get(["session","id"]),o=m.get("siteAPIData"),a=o?.siteData?.cashback?.reward||{},e=(await y())?.pageType,s={domain:o?.tld,merchant:o?.vendorName,siteCurrency:o?.siteData?.merchantPage?.currency,pageType:e,siteReward:a},i={featureFlags:l(),profileId:t??void 0,id:n??void 0};return{host:s,user:i}};export{h as a,v as b,b as c,S as d,K as e};
