const DEBUG=!1;!function(){if(!window.location.hostname.includes("instagram.com"))return void 0;const e=[],t=new Set,r="instagram",n=1357004;function a(r){if(!r)return!1;const n=function(e){return e?.id||`${e?.content?.cta?.url||""}|${(e?.content?.caption||"").slice(0,80)}`}(r);return!(!n||t.has(n))&&(t.add(n),e.push(r),!0)}function o(e){if(!e||!e.length)return;const t=e.map((e=>function(e){if(!e)return null;const t=e?.content?.media?.images||[],r=e?.content?.media?.videos||[],n=r[0]||null,a=new Set;return(e?.content?.externalUrls||[]).forEach((e=>e&&a.add(e))),e?.content?.cta?.url&&a.add(e.content.cta.url),{postId:e.id||null,advertiserId:e.advertiser?.advertiserUsername||e.id||null,campaignId:e.metadata?.campaignId||null,adType:e.metadata?.adType||null,username:e.advertiser?.advertiserUsername||null,userProfileUrl:e.advertiser?.advertiserProfileUrl||null,profile_picture:e.advertiser?.advertiserProfileImage||null,userId:null,message:e.content?.caption||null,textBlocks:e.content?.textBlocks||[],callToAction:e.content?.cta?.text||null,ctaSectionUrl:e.content?.cta?.url||null,footerCtaSectionUrl:null,ctaUrl:e.content?.cta?.url||null,videoUrl:n,postImg:t,mediaImages:t,mediaVideos:r,urls:Array.from(a),isSponsored:!!e.metadata?.isSponsored,origin:e.metadata?.origin||"network",platform:e.platform||"instagram",format:e.metadata?.format||null,placement:e.metadata?.placement||null,mediaType:e.content?.media?.type||null,isCarousel:e.content?.media?.isCarousel||!1,mediaCount:e.content?.media?.count||t.length||r.length||1,timestamp:e.timestamp||Date.now(),collection:"instagram"}}(e))).filter(Boolean);t.length&&window.postMessage({type:"IGA",platform:r,ads:t},"*")}window.__IG_ADS_COLLECTOR={getAll:()=>e.slice(),clear:()=>{e.length=0,t.clear()}};const i=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(e,t){return this._url="string"==typeof t?t:null,i.apply(this,arguments)};const l=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.send=function(){return this.addEventListener("load",(function(){try{if(!this._url||"string"!=typeof this.responseText)return;(this._url.includes("/api/graphql")||this._url.includes("/graphql/query")||this._url.includes("/api/v1/feed"))&&c(this.responseText)}catch(e){}})),l.apply(this,arguments)};const s=window.fetch;function c(e){if(e)if(e.includes("\n"))e.split("\n").map((e=>e.trim())).filter(Boolean).forEach((e=>{try{u(JSON.parse(e))}catch{}}));else try{u(JSON.parse(e))}catch{}}function u(e){if(!e)return;if(e?.error===n)return;const t=function(e){const t=[];if(!e||"object"!=typeof e)return t;const r=e?.feed_items||e?.items||e?.data?.xdt_api__v1__feed__timeline?.feed_items||[];Array.isArray(r)&&r.forEach((e=>{const r=e?.media_or_ad||e?.media||e?.node||e;if(r&&d(r)){const e=f(r);e&&t.push(e)}}));const n=e?.data?.user?.edge_web_feed_timeline?.edges||[];Array.isArray(n)&&n.forEach((e=>{const r=e?.node||e?.media||e;if(r&&d(r)){const e=f(r);e&&t.push(e)}}));const a=e?.data?.xdt_api__v1__clips__home__connection_v2?.edges||[];Array.isArray(a)&&a.forEach((e=>{const r=e?.node?.media||e?.media;if(r&&d(r)){const e=f(r);e&&(e.metadata.format="reel",e.metadata.origin="network",t.push(e))}}));const o=e?.data?.reels_media||[];Array.isArray(o)&&o.forEach((e=>{(e?.items||[]).forEach((e=>{if(d(e)){const r=f(e);r&&(r.metadata.format="story",t.push(r))}}))}));const i=e?.data?.node;if(i&&d(i)){const e=f(i);e&&t.push(e)}return t}(e);if(t.length){const e=[];t.forEach((t=>a(t)&&e.push(t))),o(e)}}function d(e){return!!(!0===e?.is_sponsored||!0===e?.sponsored||"sponsored"===e?.commerciality_status||"Sponsored"===e?.injected?.label||"Sponsored"===e?.overlay_text||e?.ad_id||e?.ad_action||e?.cta_info||e?.ad_metadata&&Object.keys(e.ad_metadata).length>0)}function m(e){if(!y(e))return null;const t=function(e){const t=new Set;return["h1, h2, h3",'span[dir="auto"]','div[dir="auto"]','div[role="button"] span[dir="auto"]'].forEach((r=>{e.querySelectorAll(r).forEach((e=>{const r=function(e){if(!e)return"";const t=e.trim();return/^(See translation|See Translation)$/i.test(t)||/^View \d+ comment/i.test(t)||/^\d+\s+likes?$/i.test(t)||/^more$/i.test(t)||/^Add a comment/i.test(t)?"":t}(e.textContent);r&&(/^(Sponsored|Paid partnership)$/i.test(r)||r.length<2||t.add(r))}))})),Array.from(t)}(e),n=t.find((e=>e.length>0))||"",{ctaText:a,ctaUrl:o}=function(e){const t=new Set;[...e.querySelectorAll('a[href*="l.instagram.com"], a[href*="click.instagram.com"], a[href*="?u="], a[href*="?url="]'),...e.querySelectorAll('a[role="link"]'),...e.querySelectorAll('button, div[role="button"]'),...e.querySelectorAll('div[class*="x1"] a[href]')].forEach((e=>t.add(e)));let r={text:"",url:null,weight:0};return t.forEach((e=>{let t=(e.textContent||Array.from(e.querySelectorAll("span, div")).map((e=>e.textContent||"")).join(" ")||"").replace(/\s+/g," ").trim();t=t.replace(/(Right chevron|›|»)+/gi,"").trim();let n=e.getAttribute("href")||e.dataset?.href||null;if(n=g(n),!t&&!n)return;let a=0;n&&!n.includes("instagram.com")&&(a+=3),/shop|learn|sign|buy|order|download|apply|subscribe|contact|book|get|try|discover|install/i.test(t)&&(a+=4),t.length>3&&(a+=1),n&&(a+=1),a>r.weight&&(r={text:t,url:n,weight:a})})),{ctaText:r.text||"",ctaUrl:r.url||null}}(e),i=function(e){const t=new Set;e.querySelectorAll("img").forEach((e=>{let r=e.currentSrc||e.src||"";if(!r&&e.getAttribute("srcset")&&(r=e.getAttribute("srcset").split(",").map((e=>e.trim().split(" ")[0])).filter(Boolean).pop()||""),!r)return;const n=e.naturalWidth||e.width,a=e.naturalHeight||e.height;n&&a&&(n<80||a<80)||t.add(r)}));const r=new Set;return e.querySelectorAll("video").forEach((e=>{let t=e.currentSrc;t||(t=Array.from(e.querySelectorAll("source")).map((e=>e.src)).find(Boolean)),t&&r.add(t)})),{images:Array.from(t),videos:Array.from(r)}}(e),l=function(e){const t=new Set;return e.querySelectorAll('a[href*="l.instagram.com"], a[href*="click.instagram.com"], a[target="_blank"], a[rel~="noopener"]').forEach((e=>{let r=e.getAttribute("href");r=g(r),r&&!r.includes("instagram.com")&&t.add(r)})),Array.from(t)}(e),s=e.querySelectorAll('ul li[role="presentation"]'),c=s.length>1,u=i.videos.length>0,d=function(e){try{const t=e.querySelector('header a[href^="/"][role="link"]')||e.querySelector('a[href^="/"][tabindex]'),r=e.querySelector("header img")||e.querySelector('img[alt*="profile"]');let n=null;if(t){const e=(t.textContent||"").trim();e&&!/^(Sponsored|Paid partnership)$/i.test(e)&&(n=e.split("\n")[0].trim())}const a=r&&r.width<120&&r.height<120?r.currentSrc||r.src:null,o=t&&t.getAttribute("href")?new URL(t.getAttribute("href"),location.origin).href:null;return n?{advertiserUsername:n,advertiserProfileUrl:o,advertiserProfileImage:a}:null}catch{return null}}(e);return n||o||a||0!==i.images.length||0!==i.videos.length?{id:p(n,o),timestamp:Date.now(),platform:r,advertiser:d||null,content:{caption:n,textBlocks:t,cta:{text:a||null,url:o||null},media:{images:i.images,videos:i.videos,type:u?"video":c?"carousel":"image",isCarousel:c,count:c?s.length:i.images.length||i.videos.length||1},externalUrls:l},metadata:{isSponsored:!0,origin:"dom",format:u?"video":c?"carousel":"image",placement:"feed"}}:null}function f(e){try{if(!d(e))return null;const t={text:e?.cta_info?.text||e?.ad_action||e?.overlay_cta_text||null,url:g(e?.cta_info?.url||e?.ad_link||e?.link||e?.weblink||null)},n=[];e?.image_versions2?.candidates&&e.image_versions2.candidates.forEach((e=>e?.url&&n.push(e.url))),Array.isArray(e?.carousel_media)&&e.carousel_media.forEach((e=>{e?.image_versions2?.candidates&&e.image_versions2.candidates.forEach((e=>e?.url&&n.push(e.url)))}));const a=[];Array.isArray(e?.video_versions)&&e.video_versions.forEach((e=>e?.url&&a.push(e.url))),Array.isArray(e?.carousel_media)&&e.carousel_media.forEach((e=>{Array.isArray(e?.video_versions)&&e.video_versions.forEach((e=>e?.url&&a.push(e.url)))}));const o=[];[e?.ad_title,e?.overlay_title,e?.ad_subtitle,e?.overlay_subtitle,e?.caption?.text,e?.text].filter(Boolean).forEach((e=>o.push(e)));const i=e?.caption?.text||e?.text||"",l=!!e?.carousel_media_count,s=a.length>0;if(!(i||t.url||n.length||a.length))return null;const c=e?.user?.username||e?.author?.username?{advertiserUsername:e?.user?.username||e?.author?.username||null,advertiserProfileUrl:e?.user?.username?`https://www.instagram.com/${e.user.username}/`:null,advertiserProfileImage:e?.user?.profile_pic_url||e?.user?.profile_pic_url_hd||null}:null;return{id:e?.ad_id||e?.pk||e?.id||p(i,t.url),timestamp:Date.now(),platform:r,advertiser:c,content:{caption:i,textBlocks:Array.from(new Set(o)),cta:t,media:{images:Array.from(new Set(n)),videos:Array.from(new Set(a)),type:s?"video":l?"carousel":"image",isCarousel:l,count:l?e?.carousel_media_count:n.length||a.length||1},externalUrls:t.url?[t.url]:[]},metadata:{isSponsored:!0,format:h(e),placement:e?.product_type||"feed",campaignId:e?.ad_campaign_id||null,adType:e?.dr_ad_type||e?.ad_metadata?.type||null,origin:"network"}}}catch(e){return null}}function p(e,t){const r=`${(e||"").slice(0,120)}|${t||""}|${Date.now()}`;try{return btoa(unescape(encodeURIComponent(r))).replace(/=+$/,"").slice(0,30)}catch{return`ig_ad_${Date.now()}_${Math.random().toString(36).slice(2,8)}`}}function h(e){return"story"===e?.product_type?"story":"igtv"===e?.product_type?"igtv":e?.carousel_media_count>0?"carousel":e?.video_versions?.length?"video":"post"}function g(e){if(!e)return null;try{const t=new URL(e,location.origin),r=t.searchParams.get("u")||t.searchParams.get("url");if(r){const e=decodeURIComponent(r);try{return decodeURIComponent(e)}catch{return e}}return e}catch{return e}}function y(e){return!!Array.from(e.querySelectorAll("span, a, div")).some((e=>{const t=e.textContent?.trim();return"Sponsored"===t||"Paid partnership"===t}))||!!e.querySelector('a[href*="l.instagram.com"], a[href*="click.instagram.com"]')}function _(e){const t=e.querySelector("img")?.currentSrc||"",r=e.querySelector("video")?.currentSrc||"",n=Array.from(e.querySelectorAll('span[dir="auto"], div[dir="auto"]')).map((e=>(e.textContent||"").trim())).filter(Boolean).join(" ").slice(0,100);return btoa(unescape(encodeURIComponent(`${t||r}|${n}`))).replace(/=+$/,"").slice(0,40)}function v(e,t){e.dataset._igAdKey=t,w.add(t)}function A(e){const t=e.dataset._igAdKey;return t&&w.has(t)}function S(){new MutationObserver((e=>{const t=[];e.forEach((e=>{e.addedNodes.forEach((e=>{if(1!==e.nodeType)return;("ARTICLE"===e.tagName?[e]:Array.from(e.querySelectorAll?.("article")||[])).forEach((e=>{if(A(e))return;if(!y(e))return;const r=m(e);if(r&&a(r)){v(e,_(e)),t.push(r)}}))}))})),t.length&&o(t)})).observe(document.documentElement||document.body,{subtree:!0,childList:!0}),setInterval((()=>{const e=[];document.querySelectorAll("article").forEach((t=>{if(!y(t))return;if(A(t))return;const r=m(t);if(r&&a(r)){v(t,_(t)),e.push(r)}})),e.length&&o(e)}),1e4)}window.fetch=async function(...e){const t=await s.apply(this,e);try{const r=e[0]?.url||e[0];if("string"==typeof r&&(r.includes("/api/graphql")||r.includes("/graphql/query")||r.includes("/api/v1/feed"))){t.clone().text().then((e=>c(e))).catch((e=>false))}}catch(e){}return t};const w=new Set;"loading"===document.readyState?document.addEventListener("DOMContentLoaded",S):S()}();