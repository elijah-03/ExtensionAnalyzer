import{a as d}from"./chunk-JDXM4SX2.js";import{s as n,v as c}from"./chunk-4XUWKJYA.js";import{c as D}from"./chunk-AYDLOBCW.js";import{e as f}from"./chunk-3GYLW4KZ.js";var l=f(D());var g=({domain:a,pid:t,title:p})=>c("getWirelessDeviceMeta",{domain:a,pid:t,title:p});async function v(a){if(a.pageData?.meta?.products_list){a.pageData.products=a.pageData.meta.products_list.reduce((i,e,s)=>(!e.product_titles?.length||!e.product_urls?.length||!e.product_sellers?.length||!e.product_images?.length||!e.product_brands?.length||!e.product_price_after_discounts?.length||i.push({key:s.toString(),url:e.product_urls[0],seller:e.product_sellers[0],title:e.product_titles[0],image:e.product_images[0],brand:e.product_brands[0],price_after_discount:e.product_price_after_discounts[0],price:e.product_list_prices?.[0]||null}),i),[]);let t=a.pageData.products.length,p=await d(a.pageData.products.map(i=>i.url));l.default.remove(a.pageData.products,i=>!l.default.includes(p,i.url)),l.default.set(a.pageData,"meta.domain_removed",a.pageData.products.length!==t)}}async function x(a){let t=l.default.cloneDeep(a||{}),p=t.domain||"",i=t.pageType||"",e=!!t.pageData?.tag?.some(s=>s.indexOf("wireless_device")===0);if(i==="productPage"&&e){let s=t.pageData.products?.find(o=>(o.sku||o.pid)&&o.title)||{},{sku:u,pid:_,title:m}=s,r=await g({domain:p,pid:_||u,title:m});typeof r?.id=="string"&&(s.wireless_device_id=r.id,s.wireless_device_name=r.name,s.wireless_device_type=r.type,t.pageData.wireless=Object.assign({},t.pageData.wireless||{},{deviceId:r.id}),t.pageData.tag.push(`device_id_${r.id.replaceAll("-","_")}`))}else i==="sponsoredProductsPage"&&(await v(t),t.url=null);return t}var M=n;export{x as a,M as b};
