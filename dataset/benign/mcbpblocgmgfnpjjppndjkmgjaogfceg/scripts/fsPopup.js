/**
* @license FireShot - Webpage Screenshots and Annotations
* Copyright (C) 2007-2025 Evgeny Vokilsus (contacts@getfireshot.com)
*/

!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="b75f1eaf-338c-5a7b-8313-b1f2b9e144eb")}catch(e){}}();
(()=>{var k={m:0,E:1,G:2,z:3,q:4,Y:5,J:7,Qe:8,g:10,X:11,P:12,Ze:13,et:100,tt:101,v:0,i:1,o:2,U:3,a:4,nt:268435456,Q:8192,Z:"lastAction",ee:"lastMode",Ee:"enableAPI",te:"fsDebug",Se:"errorReporting",Ie:"notifyOnUpdates",rt:!1,it:"disableWASMWorker",ot:"allTabsCaptureOnlyVisiblePart",t:"pluginProMode",u:"registeredMode",xe:"curVersion",st:"curVersion1",S:"filenameTemplate",I:"filenameNumber",D:"filenameNumberPadCheck",R:"filenameNumberPadValue",M:"filenameMaxLen",ke:"contextMenuIntegration",at:"pageScrollSpeedValue",ut:"allowInfiniteScrolling",ct:"sendUsageDataToGA",Te:"newTabIsNextToSource",lt:"screenshotDelay",ft:"defaultFolderLite",dt:"FireShot",pt:"openFolderAfterSavingLite",ht:"noFilenamePrompt",mt:"closeTabAfterSavingLite",gt:"batchModePrefs",yt:"historyRetainPeriod",vt:"notifyOnUpdates",bt:"captureTimeLimit",Ce:"nativeFetchErrorCntr-",wt:"uCheck",_t:"uEmit",Et:"https://ssl.getfireshot.com/images/api/utm.gif?dummy:",St:"canBeCapturedBetterNextShow",ne:"errorFilter",Ae:"https://ssl.getfireshot.com/sentry-filter-%VERSION%.csv",re:"onlyLite",It:"nativeInstall",xt:"userLikedFireShot",kt:"userRatedFireShot",Tt:"resultPageShown",Ct:"WASMErrorReported",At:"nextAdShownTime",k:"guid",Ot:1296e6,Pt:2592e5,Dt:432e5,Rt:1e4,Mt:"png",ie:"queuedBadgeURL.1",Nt:"showSelectionHint.1",Ft:"advancedFeaturesAvailable",Lt:"showAdvertising",Bt:"betaPreviewWarningExpanded",Kt:"betaPreviewCompactMode",$t:"PDFOptionsEverDisplayed",oe:"regUserCorrected",se:"regKeyCorrected",N:"regUser",b:"regKey",Oe:"taskProgressValue",jt:"https://ssl.getfireshot.com/images/api/chromefeatures.gif?dummy:",ae:"FireShot Capture %n - %t - [%e]",Ut:"https://getfireshot.com/downloads/%VERSION%/fireshot-chrome-plugin.exe",Pe:"https://screenshot-program.com/fireshot/crash_report.php",F:"captureState",T:"nativeHostReady",De:"resumeMenuEnabled",Ht:"disableSelectionImprovements",f:"t",C:"te",Re:"checksum",L:1,ue:0,ce:1,le:2,Vt:4,fe:8,de:16};var _n=(function(e){let t=Object.prototype.toString;function i(n){switch(t.call(n)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return I(n,Error)}}function o(n,r){return t.call(n)===`[object ${r}]`}function s(n){return o(n,"ErrorEvent")}function u(n){return o(n,"DOMError")}function l(n){return o(n,"DOMException")}function d(n){return o(n,"String")}function p(n){return typeof n=="object"&&n!==null&&"__sentry_template_string__"in n&&"__sentry_template_values__"in n}function m(n){return n===null||p(n)||typeof n!="object"&&typeof n!="function"}function y(n){return o(n,"Object")}function g(n){return typeof Event<"u"&&I(n,Event)}function _(n){return typeof Element<"u"&&I(n,Element)}function S(n){return o(n,"RegExp")}function v(n){return!!(n&&n.then&&typeof n.then=="function")}function w(n){return y(n)&&"nativeEvent"in n&&"preventDefault"in n&&"stopPropagation"in n}function I(n,r){try{return n instanceof r}catch{return!1}}function T(n){return!!(typeof n=="object"&&n!==null&&(n.__isVue||n._isVue))}function A(n,r=0){return typeof n!="string"||r===0||n.length<=r?n:`${n.slice(0,r)}...`}function P(n,r){if(!Array.isArray(n))return"";let a=[];for(let c=0;c<n.length;c++){let f=n[c];try{T(f)?a.push("[VueViewModel]"):a.push(String(f))}catch{a.push("[value cannot be serialized]")}}return a.join(r)}function C(n,r,a=!1){return d(n)?S(r)?r.test(n):d(r)?a?n===r:n.includes(r):!1:!1}function D(n,r=[],a=!1){return r.some(c=>C(n,c,a))}function M(n,r,a=250,c,f,h,b){if(!h.exception||!h.exception.values||!b||!I(b.originalException,Error))return;let E=h.exception.values.length>0?h.exception.values[h.exception.values.length-1]:void 0;E&&(h.exception.values=Y(L(n,r,f,b.originalException,c,h.exception.values,E,0),a))}function L(n,r,a,c,f,h,b,E){if(h.length>=a+1)return h;let O=[...h];if(I(c[f],Error)){N(b,E);let R=n(r,c[f]),j=O.length;H(R,f,j,E),O=L(n,r,a,c[f],f,[R,...O],R,j)}return Array.isArray(c.errors)&&c.errors.forEach((R,j)=>{if(I(R,Error)){N(b,E);let $=n(r,R),te=O.length;H($,`errors[${j}]`,te,E),O=L(n,r,a,R,f,[$,...O],$,te)}}),O}function N(n,r){n.mechanism=n.mechanism||{type:"generic",handled:!0},n.mechanism={...n.mechanism,...n.type==="AggregateError"&&{is_exception_group:!0},exception_id:r}}function H(n,r,a,c){n.mechanism=n.mechanism||{type:"generic",handled:!0},n.mechanism={...n.mechanism,type:"chained",source:r,exception_id:a,parent_id:c}}function Y(n,r){return n.map(a=>(a.value&&(a.value=A(a.value,r)),a))}let F="8.18.0",K=globalThis;function G(n,r,a){let c=a||K,f=c._=c._||{},h=f[F]=f[F]||{};return h[n]||(h[n]=r())}let X=K,V=80;function ae(n,r={}){if(!n)return"<unknown>";try{let a=n,c=5,f=[],h=0,b=0,E=" > ",O=E.length,R,j=Array.isArray(r)?r:r.keyAttrs,$=!Array.isArray(r)&&r.maxStringLength||V;for(;a&&h++<c&&(R=me(a,j),!(R==="html"||h>1&&b+f.length*O+R.length>=$));)f.push(R),b+=R.length,a=a.parentNode;return f.reverse().join(E)}catch{return"<unknown>"}}function me(n,r){let a=n,c=[];if(!a||!a.tagName)return"";if(X.HTMLElement&&a instanceof HTMLElement&&a.dataset){if(a.dataset.sentryComponent)return a.dataset.sentryComponent;if(a.dataset.sentryElement)return a.dataset.sentryElement}c.push(a.tagName.toLowerCase());let f=r&&r.length?r.filter(b=>a.getAttribute(b)).map(b=>[b,a.getAttribute(b)]):null;if(f&&f.length)f.forEach(b=>{c.push(`[${b[0]}="${b[1]}"]`)});else{a.id&&c.push(`#${a.id}`);let b=a.className;if(b&&d(b)){let E=b.split(/\s+/);for(let O of E)c.push(`.${O}`)}}let h=["aria-label","type","name","title","alt"];for(let b of h){let E=a.getAttribute(b);E&&c.push(`[${b}="${E}"]`)}return c.join("")}function je(){try{return X.document.location.href}catch{return""}}function Ie(n){if(!X.HTMLElement)return null;let r=n,a=5;for(let c=0;c<a;c++){if(!r)return null;if(r instanceof HTMLElement){if(r.dataset.sentryComponent)return r.dataset.sentryComponent;if(r.dataset.sentryElement)return r.dataset.sentryElement}r=r.parentNode}return null}let Pe="Sentry Logger ",We=["debug","info","warn","error","log","assert","trace"],Te={};function De(n){if(!("console"in K))return n();let r=K.console,a={},c=Object.keys(Te);c.forEach(f=>{let h=Te[f];a[f]=r[f],r[f]=h});try{return n()}finally{c.forEach(f=>{r[f]=a[f]})}}function Le(){let n=!1,r={enable:()=>{n=!0},disable:()=>{n=!1},isEnabled:()=>n};return We.forEach(a=>{r[a]=(...c)=>{n&&De(()=>{K.console[a](`${Pe}[${a}]:`,...c)})}}),r}let z=Le(),Qr=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function Yu(n){return n==="http"||n==="https"}function fn(n,r=!1){let{host:a,path:c,pass:f,port:h,projectId:b,protocol:E,publicKey:O}=n;return`${E}://${O}${r&&f?`:${f}`:""}@${a}${h?`:${h}`:""}/${c&&`${c}/`}${b}`}function Ju(n){let r=Qr.exec(n);if(!r){De(()=>{console.error(`Invalid Sentry Dsn: ${n}`)});return}let[a,c,f="",h="",b="",E=""]=r.slice(1),O="",R=E,j=R.split("/");if(j.length>1&&(O=j.slice(0,-1).join("/"),R=j.pop()),R){let $=R.match(/^\d+/);$&&(R=$[0])}return Mo({host:h,pass:f,path:O,projectId:R,port:b,protocol:a,publicKey:c})}function Mo(n){return{protocol:n.protocol,publicKey:n.publicKey||"",pass:n.pass||"",host:n.host,port:n.port||"",path:n.path||"",projectId:n.projectId}}function Xu(n){let{port:r,projectId:a,protocol:c}=n;return["protocol","publicKey","host","projectId"].find(b=>n[b]?!1:(z.error(`Invalid Sentry Dsn: ${b} missing`),!0))?!1:a.match(/^\d+$/)?Yu(c)?r&&isNaN(parseInt(r,10))?(z.error(`Invalid Sentry Dsn: Invalid port ${r}`),!1):!0:(z.error(`Invalid Sentry Dsn: Invalid protocol ${c}`),!1):(z.error(`Invalid Sentry Dsn: Invalid projectId ${a}`),!1)}function No(n){let r=typeof n=="string"?Ju(n):Mo(n);if(!(!r||!Xu(r)))return r}class ze extends Error{constructor(r,a="warn"){super(r),this.message=r,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype),this.logLevel=a}}function ve(n,r,a){if(!(r in n))return;let c=n[r],f=a(c);typeof f=="function"&&Fo(f,c),n[r]=f}function Et(n,r,a){try{Object.defineProperty(n,r,{value:a,writable:!0,configurable:!0})}catch{z.log(`Failed to add non-enumerable property "${r}" to object`,n)}}function Fo(n,r){try{let a=r.prototype||{};n.prototype=r.prototype=a,Et(n,"__sentry_original__",r)}catch{}}function Zr(n){return n.Wt}function Qu(n){return Object.keys(n).map(r=>`${encodeURIComponent(r)}=${encodeURIComponent(n[r])}`).join("&")}function Lo(n){if(i(n))return{message:n.message,name:n.name,stack:n.stack,...Ko(n)};if(g(n)){let r={type:n.type,target:Bo(n.target),currentTarget:Bo(n.currentTarget),...Ko(n)};return typeof CustomEvent<"u"&&I(n,CustomEvent)&&(r.detail=n.detail),r}else return n}function Bo(n){try{return _(n)?ae(n):Object.prototype.toString.call(n)}catch{return"<unknown>"}}function Ko(n){if(typeof n=="object"&&n!==null){let r={};for(let a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a]);return r}else return{}}function Zu(n,r=40){let a=Object.keys(Lo(n));a.sort();let c=a[0];if(!c)return"[object has no keys]";if(c.length>=r)return A(c,r);for(let f=a.length;f>0;f--){let h=a.slice(0,f).join(", ");if(!(h.length>r))return f===a.length?h:A(h,r)}return""}function Ue(n){return ei(n,new Map)}function ei(n,r){if(ec(n)){let a=r.get(n);if(a!==void 0)return a;let c={};r.set(n,c);for(let f of Object.keys(n))typeof n[f]<"u"&&(c[f]=ei(n[f],r));return c}if(Array.isArray(n)){let a=r.get(n);if(a!==void 0)return a;let c=[];return r.set(n,c),n.forEach(f=>{c.push(ei(f,r))}),c}return n}function ec(n){if(!y(n))return!1;try{let r=Object.getPrototypeOf(n).constructor.name;return!r||r==="Object"}catch{return!0}}let $o=50,qe="?",jo=/\(error: (.*)\)/,Uo=/captureMessage|captureException/;function Ho(...n){let r=n.sort((a,c)=>a[0]-c[0]).map(a=>a[1]);return(a,c=0,f=0)=>{let h=[],b=a.split(`
`);for(let E=c;E<b.length;E++){let O=b[E];if(O.length>1024)continue;let R=jo.test(O)?O.replace(jo,"$1"):O;if(!R.match(/\S*Error: /)){for(let j of r){let $=j(R);if($){h.push($);break}}if(h.length>=$o+f)break}}return nc(h.slice(f))}}function tc(n){return Array.isArray(n)?Ho(...n):n}function nc(n){if(!n.length)return[];let r=Array.from(n);return/sentryWrapped/.test(qn(r).function||"")&&r.pop(),r.reverse(),Uo.test(qn(r).function||"")&&(r.pop(),Uo.test(qn(r).function||"")&&r.pop()),r.slice(0,$o).map(a=>({...a,filename:a.filename||qn(r).filename,function:a.function||qe}))}function qn(n){return n[n.length-1]||{}}let ti="<anonymous>";function ut(n){try{return!n||typeof n!="function"?ti:n.name||ti}catch{return ti}}function Vo(n){let r=n.exception;if(r){let a=[];try{return r.values.forEach(c=>{c.stacktrace.frames&&a.push(...c.stacktrace.frames)}),a}catch{return}}}let Yn={},Wo={};function St(n,r){Yn[n]=Yn[n]||[],Yn[n].push(r)}function It(n,r){Wo[n]||(r(),Wo[n]=!0)}function Ge(n,r){let a=n&&Yn[n];if(a)for(let c of a)try{c(r)}catch(f){z.error(`Error while triggering instrumentation handler.
Type: ${n}
Name: ${ut(c)}
Error:`,f)}}function rc(n){let r="console";St(r,n),It(r,ic)}function ic(){"console"in K&&We.forEach(function(n){n in K.console&&ve(K.console,n,function(r){return Te[n]=r,function(...a){Ge("console",{args:a,level:n});let f=Te[n];f&&f.apply(K.console,a)}})})}let ni=K;function Go(){if(!("fetch"in ni))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}}function ri(n){return n&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(n.toString())}function oc(){if(typeof EdgeRuntime=="string")return!0;if(!Go())return!1;if(ri(ni.fetch))return!0;let n=!1,r=ni.document;if(r&&typeof r.createElement=="function")try{let a=r.createElement("iframe");a.hidden=!0,r.head.appendChild(a),a.contentWindow&&a.contentWindow.fetch&&(n=ri(a.contentWindow.fetch)),r.head.removeChild(a)}catch(a){z.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",a)}return n}let zo=1e3;function dn(){return Date.now()/zo}function sc(){let{performance:n}=K;if(!n||!n.now)return dn;let r=Date.now()-n.now(),a=n.timeOrigin==null?r:n.timeOrigin;return()=>(a+n.now())/zo}let Qe=sc();(()=>{let{performance:n}=K;if(!n||!n.now)return;let r=3600*1e3,a=n.now(),c=Date.now(),f=n.timeOrigin?Math.abs(n.timeOrigin+a-c):r,h=f<r,b=n.timing&&n.timing.navigationStart,O=typeof b=="number"?Math.abs(b+a-c):r,R=O<r;return h||R?f<=O?n.timeOrigin:b:c})();function ac(n){let r="fetch";St(r,n),It(r,uc)}function uc(){oc()&&ve(K,"fetch",function(n){return function(...r){let{method:a,url:c}=cc(r),f={args:r,fetchData:{method:a,url:c},startTimestamp:Qe()*1e3};Ge("fetch",{...f});let h=new Error().stack;return n.apply(K,r).then(b=>{let E={...f,endTimestamp:Qe()*1e3,response:b};return Ge("fetch",E),b},b=>{let E={...f,endTimestamp:Qe()*1e3,error:b};throw Ge("fetch",E),i(b)&&b.stack===void 0&&(b.stack=h,Et(b,"framesToPop",1)),b})}})}function ii(n,r){return!!n&&typeof n=="object"&&!!n[r]}function qo(n){return typeof n=="string"?n:n?ii(n,"url")?n.url:n.toString?n.toString():"":""}function cc(n){if(n.length===0)return{method:"GET",url:""};if(n.length===2){let[a,c]=n;return{url:qo(a),method:ii(c,"method")?String(c.method).toUpperCase():"GET"}}let r=n[0];return{url:qo(r),method:ii(r,"method")?String(r.method).toUpperCase():"GET"}}let Jn=null;function lc(n){let r="error";St(r,n),It(r,fc)}function fc(){Jn=K.onerror,K.onerror=function(n,r,a,c,f){return Ge("error",{column:c,error:f,line:a,msg:n,url:r}),Jn&&!Jn.Me?Jn.apply(this,arguments):!1},K.onerror.Ne=!0}let Xn=null;function dc(n){let r="unhandledrejection";St(r,n),It(r,pc)}function pc(){Xn=K.onunhandledrejection,K.onunhandledrejection=function(n){return Ge("unhandledrejection",n),Xn&&!Xn.Me?Xn.apply(this,arguments):!0},K.onunhandledrejection.Ne=!0}function hc(){return"npm"}function mc(){let n=typeof WeakSet=="function",r=n?new WeakSet:[];function a(f){if(n)return r.has(f)?!0:(r.add(f),!1);for(let h=0;h<r.length;h++)if(r[h]===f)return!0;return r.push(f),!1}function c(f){if(n)r.delete(f);else for(let h=0;h<r.length;h++)if(r[h]===f){r.splice(h,1);break}}return[a,c]}function de(){let n=K,r=n.crypto||n.msCrypto,a=()=>Math.random()*16;try{if(r&&r.randomUUID)return r.randomUUID().replace(/-/g,"");r&&r.getRandomValues&&(a=()=>{let c=new Uint8Array(1);return r.getRandomValues(c),c[0]})}catch{}return("10000000100040008000"+1e11).replace(/[018]/g,c=>(c^(a()&15)>>c/4).toString(16))}function Yo(n){return n.exception&&n.exception.values?n.exception.values[0]:void 0}function ct(n){let{message:r,event_id:a}=n;if(r)return r;let c=Yo(n);return c?c.type&&c.value?`${c.type}: ${c.value}`:c.type||c.value||a||"<unknown>":a||"<unknown>"}function oi(n,r,a){let c=n.exception=n.exception||{},f=c.values=c.values||[],h=f[0]=f[0]||{};h.value||(h.value=r||""),h.type||(h.type=a||"Error")}function pn(n,r){let a=Yo(n);if(!a)return;let c={type:"generic",handled:!0},f=a.mechanism;if(a.mechanism={...c,...f,...r},r&&"data"in r){let h={...f&&f.data,...r.data};a.mechanism.data=h}}function Jo(n){if(n&&n.Gt)return!0;try{Et(n,"__sentry_captured__",!0)}catch{}return!1}function Xo(n){return Array.isArray(n)?n:[n]}function lt(n,r=100,a=1/0){try{return si("",n,r,a)}catch(c){return{ERROR:`**non-serializable** (${c})`}}}function Qo(n,r=3,a=102400){let c=lt(n,r);return bc(c)>a?Qo(n,r-1,a):c}function si(n,r,a=1/0,c=1/0,f=mc()){let[h,b]=f;if(r==null||["number","boolean","string"].includes(typeof r)&&!Number.isNaN(r))return r;let E=gc(n,r);if(!E.startsWith("[object "))return E;if(r.__sentry_skip_normalization__)return r;let O=typeof r.__sentry_override_normalization_depth__=="number"?r.__sentry_override_normalization_depth__:a;if(O===0)return E.replace("object ","");if(h(r))return"[Circular ~]";let R=r;if(R&&typeof R.toJSON=="function")try{let ie=R.toJSON();return si("",ie,O-1,c,f)}catch{}let j=Array.isArray(r)?[]:{},$=0,te=Lo(r);for(let ie in te){if(!Object.prototype.hasOwnProperty.call(te,ie))continue;if($>=c){j[ie]="[MaxProperties ~]";break}let ne=te[ie];j[ie]=si(ie,ne,O-1,c,f),$++}return b(r),j}function gc(n,r){try{if(n==="domain"&&r&&typeof r=="object"&&r._events)return"[Domain]";if(n==="domainEmitter")return"[DomainEmitter]";if(typeof global<"u"&&r===global)return"[Global]";if(typeof window<"u"&&r===window)return"[Window]";if(typeof document<"u"&&r===document)return"[Document]";if(T(r))return"[VueViewModel]";if(w(r))return"[SyntheticEvent]";if(typeof r=="number"&&r!==r)return"[NaN]";if(typeof r=="function")return`[Function: ${ut(r)}]`;if(typeof r=="symbol")return`[${String(r)}]`;if(typeof r=="bigint")return`[BigInt: ${String(r)}]`;let a=yc(r);return/^HTML(\w*)Element$/.test(a)?`[HTMLElement: ${a}]`:`[object ${a}]`}catch(a){return`**non-serializable** (${a})`}}function yc(n){let r=Object.getPrototypeOf(n);return r?r.constructor.name:"null prototype"}function vc(n){return~-encodeURI(n).split(/%..|./).length}function bc(n){return vc(JSON.stringify(n))}var Ze;(function(n){n[n.PENDING=0]="PENDING";let a=1;n[n.RESOLVED=a]="RESOLVED";let c=2;n[n.REJECTED=c]="REJECTED"})(Ze||(Ze={}));function xt(n){return new He(r=>{r(n)})}function Qn(n){return new He((r,a)=>{a(n)})}class He{constructor(r){He.prototype.__init.call(this),He.prototype.__init2.call(this),He.prototype.__init3.call(this),He.prototype.__init4.call(this),this._state=Ze.PENDING,this._handlers=[];try{r(this._resolve,this._reject)}catch(a){this._reject(a)}}then(r,a){return new He((c,f)=>{this._handlers.push([!1,h=>{if(!r)c(h);else try{c(r(h))}catch(b){f(b)}},h=>{if(!a)f(h);else try{c(a(h))}catch(b){f(b)}}]),this._executeHandlers()})}catch(r){return this.then(a=>a,r)}finally(r){return new He((a,c)=>{let f,h;return this.then(b=>{h=!1,f=b,r&&r()},b=>{h=!0,f=b,r&&r()}).then(()=>{if(h){c(f);return}a(f)})})}__init(){this._resolve=r=>{this._setResult(Ze.RESOLVED,r)}}__init2(){this._reject=r=>{this._setResult(Ze.REJECTED,r)}}__init3(){this._setResult=(r,a)=>{if(this._state===Ze.PENDING){if(v(a)){a.then(this._resolve,this._reject);return}this._state=r,this._value=a,this._executeHandlers()}}}__init4(){this._executeHandlers=()=>{if(this._state===Ze.PENDING)return;let r=this._handlers.slice();this._handlers=[],r.forEach(a=>{a[0]||(this._state===Ze.RESOLVED&&a[1](this._value),this._state===Ze.REJECTED&&a[2](this._value),a[0]=!0)})}}}function wc(n){let r=[];function a(){return n===void 0||r.length<n}function c(b){return r.splice(r.indexOf(b),1)[0]||Promise.resolve(void 0)}function f(b){if(!a())return Qn(new ze("Not adding Promise because buffer limit was reached."));let E=b();return r.indexOf(E)===-1&&r.push(E),E.then(()=>c(E)).then(null,()=>c(E).then(null,()=>{})),E}function h(b){return new He((E,O)=>{let R=r.length;if(!R)return E(!0);let j=setTimeout(()=>{b&&b>0&&E(!1)},b);r.forEach($=>{xt($).then(()=>{--R||(clearTimeout(j),E(!0))},O)})})}return{$:r,add:f,drain:h}}function ai(n){if(!n)return{};let r=n.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!r)return{};let a=r[6]||"",c=r[8]||"";return{host:r[4],path:r[5],protocol:r[2],search:a,hash:c,relative:r[5]+a+c}}let _c=["fatal","error","warning","log","info","debug"];function Ec(n){return n==="warn"?"warning":_c.includes(n)?n:"log"}let Zo="sentry-",Sc=/^sentry-/,Ic=8192;function es(n){let r=kc(n);if(!r)return;let a=Object.entries(r).reduce((c,[f,h])=>{if(f.match(Sc)){let b=f.slice(Zo.length);c[b]=h}return c},{});if(Object.keys(a).length>0)return a}function xc(n){if(!n)return;let r=Object.entries(n).reduce((a,[c,f])=>(f&&(a[`${Zo}${c}`]=f),a),{});return Tc(r)}function kc(n){if(!(!n||!d(n)&&!Array.isArray(n)))return Array.isArray(n)?n.reduce((r,a)=>{let c=ts(a);return Object.entries(c).forEach(([f,h])=>{r[f]=h}),r},{}):ts(n)}function ts(n){return n.split(",").map(r=>r.split("=").map(a=>decodeURIComponent(a.trim()))).reduce((r,[a,c])=>(a&&c&&(r[a]=c),r),{})}function Tc(n){if(Object.keys(n).length!==0)return Object.entries(n).reduce((r,[a,c],f)=>{let h=`${encodeURIComponent(a)}=${encodeURIComponent(c)}`,b=f===0?h:`${r},${h}`;return b.length>Ic?(z.warn(`Not adding key: ${a} with val: ${c} to baggage header due to exceeding baggage size limits.`),r):b},"")}let Cc=new RegExp("^[ \\t]*([0-9a-f]{32})?-?([0-9a-f]{16})?-?([01])?[ \\t]*$");function Ac(n){if(!n)return;let r=n.match(Cc);if(!r)return;let a;return r[3]==="1"?a=!0:r[3]==="0"&&(a=!1),{traceId:r[1],parentSampled:a,parentSpanId:r[2]}}function Oc(n,r){let a=Ac(n),c=es(r),{traceId:f,parentSpanId:h,parentSampled:b}=a||{};return a?{traceId:f||de(),parentSpanId:h||de().substring(16),spanId:de().substring(16),sampled:b,dsc:c||{}}:{traceId:f||de(),spanId:de().substring(16)}}function Pc(n=de(),r=de().substring(16),a){let c="";return a!==void 0&&(c=a?"-1":"-0"),`${n}-${r}${c}`}function hn(n,r=[]){return[n,r]}function Dc(n,r){let[a,c]=n;return[a,[...c,r]]}function ns(n,r){let a=n[1];for(let c of a){let f=c[0].type;if(r(c,f))return!0}return!1}function ui(n){return K._&&K._.encodePolyfill?K._.encodePolyfill(n):new TextEncoder().encode(n)}function Rc(n){let[r,a]=n,c=JSON.stringify(r);function f(h){typeof c=="string"?c=typeof h=="string"?c+h:[ui(c),h]:c.push(typeof h=="string"?ui(h):h)}for(let h of a){let[b,E]=h;if(f(`
${JSON.stringify(b)}
`),typeof E=="string"||E instanceof Uint8Array)f(E);else{let O;try{O=JSON.stringify(E)}catch{O=JSON.stringify(lt(E))}f(O)}}return typeof c=="string"?c:Mc(c)}function Mc(n){let r=n.reduce((f,h)=>f+h.length,0),a=new Uint8Array(r),c=0;for(let f of n)a.set(f,c),c+=f.length;return a}function Nc(n){let r=typeof n.data=="string"?ui(n.data):n.data;return[Ue({type:"attachment",length:r.length,filename:n.filename,content_type:n.contentType,attachment_type:n.attachmentType}),r]}let Fc={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",statsd:"metric_bucket"};function rs(n){return Fc[n]}function is(n){if(!n||!n.sdk)return;let{name:r,version:a}=n.sdk;return{name:r,version:a}}function Lc(n,r,a,c){let f=n.sdkProcessingMetadata&&n.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:n.event_id,sent_at:new Date().toISOString(),...r&&{sdk:r},...!!a&&c&&{dsn:fn(c)},...f&&{trace:Ue({...f})}}}function Bc(n,r,a){let c=[{type:"client_report"},{timestamp:a||dn(),discarded_events:n}];return hn(r?{dsn:r}:{},[c])}let Kc=60*1e3;function $c(n,r=Date.now()){let a=parseInt(`${n}`,10);if(!isNaN(a))return a*1e3;let c=Date.parse(`${n}`);return isNaN(c)?Kc:c-r}function jc(n,r){return n[r]||n.all||0}function Uc(n,r,a=Date.now()){return jc(n,r)>a}function Hc(n,{statusCode:r,headers:a},c=Date.now()){let f={...n},h=a&&a["x-sentry-rate-limits"],b=a&&a["retry-after"];if(h)for(let E of h.trim().split(",")){let[O,R,,,j]=E.split(":",5),$=parseInt(O,10),te=(isNaN($)?60:$)*1e3;if(!R)f.all=c+te;else for(let ie of R.split(";"))ie==="metric_bucket"?(!j||j.split(";").includes("custom"))&&(f[ie]=c+te):f[ie]=c+te}else b?f.all=c+$c(b,c):r===429&&(f.all=c+6e4);return f}function os(){return{traceId:de(),spanId:de().substring(16)}}let Zn=K;function Vc(){let n=Zn.chrome,r=n&&n.app&&n.app.runtime,a="history"in Zn&&!!Zn.history.pushState&&!!Zn.history.replaceState;return!r&&a}let ss=()=>{},Wc=["attachTo","createWidget","remove"];function as(n){return De(()=>{console.warn("You are using feedbackIntegration() even though this bundle does not include feedback.")}),{name:"Feedback",...Wc.reduce((r,a)=>(r[a]=ss,r),{})}}let Gc=["start","stop","flush"];function zc(n){return De(()=>{console.warn("You are using replayIntegration() even though this bundle does not include replay.")}),{name:"Replay",...Gc.reduce((r,a)=>(r[a]=ss,r),{})}}function mn(){return ci(K),K}function ci(n){let r=n._=n._||{};return r.version=r.version||F,r[F]=r[F]||{}}function qc(n){let r=Qe(),a={sid:de(),init:!0,timestamp:r,started:r,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>Jc(a)};return n&&jt(a,n),a}function jt(n,r={}){if(r.user&&(!n.ipAddress&&r.user.ip_address&&(n.ipAddress=r.user.ip_address),!n.did&&!r.did&&(n.did=r.user.id||r.user.email||r.user.username)),n.timestamp=r.timestamp||Qe(),r.abnormal_mechanism&&(n.abnormal_mechanism=r.abnormal_mechanism),r.ignoreDuration&&(n.ignoreDuration=r.ignoreDuration),r.sid&&(n.sid=r.sid.length===32?r.sid:de()),r.init!==void 0&&(n.init=r.init),!n.did&&r.did&&(n.did=`${r.did}`),typeof r.started=="number"&&(n.started=r.started),n.ignoreDuration)n.duration=void 0;else if(typeof r.duration=="number")n.duration=r.duration;else{let a=n.timestamp-n.started;n.duration=a>=0?a:0}r.release&&(n.release=r.release),r.environment&&(n.environment=r.environment),!n.ipAddress&&r.ipAddress&&(n.ipAddress=r.ipAddress),!n.userAgent&&r.userAgent&&(n.userAgent=r.userAgent),typeof r.errors=="number"&&(n.errors=r.errors),r.status&&(n.status=r.status)}function Yc(n,r){let a={};r?a={status:r}:n.status==="ok"&&(a={status:"exited"}),jt(n,a)}function Jc(n){return Ue({sid:`${n.sid}`,init:n.init,started:new Date(n.started*1e3).toISOString(),timestamp:new Date(n.timestamp*1e3).toISOString(),status:n.status,errors:n.errors,did:typeof n.did=="number"||typeof n.did=="string"?`${n.did}`:void 0,duration:n.duration,abnormal_mechanism:n.abnormal_mechanism,attrs:{release:n.release,environment:n.environment,ip_address:n.ipAddress,user_agent:n.userAgent}})}let li="_sentrySpan";function us(n,r){r?Et(n,li,r):delete n[li]}function cs(n){return n[li]}let Xc=100;class fi{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext=os()}clone(){let r=new fi;return r._breadcrumbs=[...this._breadcrumbs],r._tags={...this._tags},r._extra={...this._extra},r._contexts={...this._contexts},r._user=this._user,r._level=this._level,r._session=this._session,r._transactionName=this._transactionName,r._fingerprint=this._fingerprint,r._eventProcessors=[...this._eventProcessors],r._requestSession=this._requestSession,r._attachments=[...this._attachments],r._sdkProcessingMetadata={...this._sdkProcessingMetadata},r._propagationContext={...this._propagationContext},r._client=this._client,r._lastEventId=this._lastEventId,us(r,cs(this)),r}setClient(r){this._client=r}setLastEventId(r){this._lastEventId=r}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(r){this._scopeListeners.push(r)}addEventProcessor(r){return this._eventProcessors.push(r),this}setUser(r){return this._user=r||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&jt(this._session,{user:r}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(r){return this._requestSession=r,this}setTags(r){return this._tags={...this._tags,...r},this._notifyScopeListeners(),this}setTag(r,a){return this._tags={...this._tags,[r]:a},this._notifyScopeListeners(),this}setExtras(r){return this._extra={...this._extra,...r},this._notifyScopeListeners(),this}setExtra(r,a){return this._extra={...this._extra,[r]:a},this._notifyScopeListeners(),this}setFingerprint(r){return this._fingerprint=r,this._notifyScopeListeners(),this}setLevel(r){return this._level=r,this._notifyScopeListeners(),this}setTransactionName(r){return this._transactionName=r,this._notifyScopeListeners(),this}setContext(r,a){return a===null?delete this._contexts[r]:this._contexts[r]=a,this._notifyScopeListeners(),this}setSession(r){return r?this._session=r:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(r){if(!r)return this;let a=typeof r=="function"?r(this):r,[c,f]=a instanceof et?[a.getScopeData(),a.getRequestSession()]:y(a)?[r,r.requestSession]:[],{tags:h,extra:b,user:E,contexts:O,level:R,fingerprint:j=[],propagationContext:$}=c||{};return this._tags={...this._tags,...h},this._extra={...this._extra,...b},this._contexts={...this._contexts,...O},E&&Object.keys(E).length&&(this._user=E),R&&(this._level=R),j.length&&(this._fingerprint=j),$&&(this._propagationContext=$),f&&(this._requestSession=f),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._session=void 0,us(this,void 0),this._attachments=[],this._propagationContext=os(),this._notifyScopeListeners(),this}addBreadcrumb(r,a){let c=typeof a=="number"?a:Xc;if(c<=0)return this;let f={timestamp:dn(),...r},h=this._breadcrumbs;return h.push(f),this._breadcrumbs=h.length>c?h.slice(-c):h,this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(r){return this._attachments.push(r),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:cs(this)}}setSDKProcessingMetadata(r){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...r},this}setPropagationContext(r){return this._propagationContext=r,this}getPropagationContext(){return this._propagationContext}captureException(r,a){let c=a&&a.event_id?a.event_id:de();if(!this._client)return z.warn("No client configured on scope - will not capture exception!"),c;let f=new Error("Sentry syntheticException");return this._client.captureException(r,{originalException:r,syntheticException:f,...a,event_id:c},this),c}captureMessage(r,a,c){let f=c&&c.event_id?c.event_id:de();if(!this._client)return z.warn("No client configured on scope - will not capture message!"),f;let h=new Error(r);return this._client.captureMessage(r,a,{originalException:r,syntheticException:h,...c,event_id:f},this),f}captureEvent(r,a){let c=a&&a.event_id?a.event_id:de();return this._client?(this._client.captureEvent(r,{...a,event_id:c},this),c):(z.warn("No client configured on scope - will not capture event!"),c)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(r=>{r(this)}),this._notifyingListeners=!1)}}let et=fi;function Qc(){return G("defaultCurrentScope",()=>new et)}function Zc(){return G("defaultIsolationScope",()=>new et)}class el{constructor(r,a){let c;r?c=r:c=new et;let f;a?f=a:f=new et,this._stack=[{scope:c}],this._isolationScope=f}withScope(r){let a=this._pushScope(),c;try{c=r(a)}catch(f){throw this._popScope(),f}return v(c)?c.then(f=>(this._popScope(),f),f=>{throw this._popScope(),f}):(this._popScope(),c)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){let r=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:r}),r}_popScope(){return this._stack.length<=1?!1:!!this._stack.pop()}}function Ut(){let n=mn(),r=ci(n);return r.stack=r.stack||new el(Qc(),Zc())}function tl(n){return Ut().withScope(n)}function nl(n,r){let a=Ut();return a.withScope(()=>(a.getStackTop().scope=n,r(n)))}function ls(n){return Ut().withScope(()=>n(Ut().getIsolationScope()))}function rl(){return{withIsolationScope:ls,withScope:tl,withSetScope:nl,withSetIsolationScope:(n,r)=>ls(r),getCurrentScope:()=>Ut().getScope(),getIsolationScope:()=>Ut().getIsolationScope()}}function er(n){let r=ci(n);return r.acs?r.acs:rl()}function xe(){let n=mn();return er(n).getCurrentScope()}function Ce(){let n=mn();return er(n).getIsolationScope()}function fs(){return G("globalScope",()=>new et)}function tr(...n){let r=mn(),a=er(r);if(n.length===2){let[c,f]=n;return c?a.withSetScope(c,f):a.withScope(f)}return a.withScope(n[0])}function il(...n){let r=mn(),a=er(r);if(n.length===2){let[c,f]=n;return c?a.withSetIsolationScope(c,f):a.withIsolationScope(f)}return a.withIsolationScope(n[0])}function ue(){return xe().getClient()}let ol="_sentryMetrics";function sl(n){let r=n[ol];if(!r)return;let a={};for(let[,[c,f]]of r)(a[c]||(a[c]=[])).push(Ue(f));return a}let ds="sentry.source",ps="sentry.sample_rate",hs="sentry.op",ms="sentry.origin",al=0,ul=1,cl=1;function ll(n){let{spanId:r,traceId:a}=n.spanContext(),{parent_span_id:c}=gn(n);return Ue({parent_span_id:c,span_id:r,trace_id:a})}function fl(n){let{traceId:r,spanId:a}=n.spanContext(),c=vs(n);return Pc(r,a,c)}function gs(n){return typeof n=="number"?ys(n):Array.isArray(n)?n[0]+n[1]/1e9:n instanceof Date?ys(n.getTime()):Qe()}function ys(n){return n>9999999999?n/1e3:n}function gn(n){if(pl(n))return n.getSpanJSON();try{let{spanId:r,traceId:a}=n.spanContext();if(dl(n)){let{attributes:c,startTime:f,name:h,endTime:b,parentSpanId:E,status:O}=n;return Ue({span_id:r,trace_id:a,data:c,description:h,parent_span_id:E,start_timestamp:gs(f),timestamp:gs(b)||void 0,status:hl(O),op:c[hs],origin:c[ms],_metrics_summary:sl(n)})}return{span_id:r,trace_id:a}}catch{return{}}}function dl(n){let r=n;return!!r.attributes&&!!r.startTime&&!!r.name&&!!r.endTime&&!!r.status}function pl(n){return typeof n.getSpanJSON=="function"}function vs(n){let{traceFlags:r}=n.spanContext();return r===cl}function hl(n){if(!(!n||n.code===al))return n.code===ul?"ok":n.message||"unknown_error"}let ml="_sentryRootSpan";function bs(n){return n[ml]||n}let di="production",gl="_frozenDsc";function ws(n,r){let a=r.getOptions(),{publicKey:c}=r.getDsn()||{},f=Ue({environment:a.environment||di,release:a.release,public_key:c,trace_id:n});return r.emit("createDsc",f),f}function _s(n){let r=ue();if(!r)return{};let a=ws(gn(n).trace_id||"",r),c=bs(n),f=c[gl];if(f)return f;let h=c.spanContext().traceState,b=h&&h.get("sentry.dsc"),E=b&&es(b);if(E)return E;let O=gn(c),R=O.data||{},j=R[ps];j!=null&&(a.sample_rate=`${j}`);let $=R[ds],te=O.description;return $!=="url"&&te&&(a.transaction=te),a.sampled=String(vs(c)),r.emit("createDsc",a,c),a}function yl(n){let r=_s(n);return xc(r)}function vl(n){if(typeof n=="boolean")return Number(n);let r=typeof n=="string"?parseFloat(n):n;if(typeof r!="number"||isNaN(r)||r<0||r>1){z.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(n)} of type ${JSON.stringify(typeof n)}.`);return}return r}function bl(n,r){return r&&(n.sdk=n.sdk||{},n.sdk.name=n.sdk.name||r.name,n.sdk.version=n.sdk.version||r.version,n.sdk.integrations=[...n.sdk.integrations||[],...r.integrations||[]],n.sdk.packages=[...n.sdk.packages||[],...r.packages||[]]),n}function wl(n,r,a,c){let f=is(a),h={sent_at:new Date().toISOString(),...f&&{sdk:f},...!!c&&r&&{dsn:fn(r)}},b="aggregates"in n?[{type:"sessions"},n]:[{type:"session"},n.toJSON()];return hn(h,[b])}function _l(n,r,a,c){let f=is(a),h=n.type&&n.type!=="replay_event"?n.type:"event";bl(n,a&&a.sdk);let b=Lc(n,f,c,r);return delete n.sdkProcessingMetadata,hn(b,[[{type:h},n]])}let El=({sentryTrace:n,baggage:r},a)=>tr(c=>{let f=Oc(n,r);return c.setPropagationContext(f),a()});function pi(n,r,a,c=0){return new He((f,h)=>{let b=n[c];if(r===null||typeof b!="function")f(r);else{let E=b({...r},a);b.id&&E===null&&z.log(`Event processor "${b.id}" dropped event`),v(E)?E.then(O=>pi(n,O,a,c+1).then(f)).then(null,h):pi(n,E,a,c+1).then(f).then(null,h)}})}function Sl(n,r){let{fingerprint:a,span:c,breadcrumbs:f,sdkProcessingMetadata:h}=r;Il(n,r),c&&Tl(n,c),Cl(n,a),xl(n,f),kl(n,h)}function Es(n,r){let{extra:a,tags:c,user:f,contexts:h,level:b,sdkProcessingMetadata:E,breadcrumbs:O,fingerprint:R,eventProcessors:j,attachments:$,propagationContext:te,transactionName:ie,span:ne}=r;yn(n,"extra",a),yn(n,"tags",c),yn(n,"user",f),yn(n,"contexts",h),yn(n,"sdkProcessingMetadata",E),b&&(n.level=b),ie&&(n.transactionName=ie),ne&&(n.span=ne),O.length&&(n.breadcrumbs=[...n.breadcrumbs,...O]),R.length&&(n.fingerprint=[...n.fingerprint,...R]),j.length&&(n.eventProcessors=[...n.eventProcessors,...j]),$.length&&(n.attachments=[...n.attachments,...$]),n.propagationContext={...n.propagationContext,...te}}function yn(n,r,a){if(a&&Object.keys(a).length){n[r]={...n[r]};for(let c in a)Object.prototype.hasOwnProperty.call(a,c)&&(n[r][c]=a[c])}}function Il(n,r){let{extra:a,tags:c,user:f,contexts:h,level:b,transactionName:E}=r,O=Ue(a);O&&Object.keys(O).length&&(n.extra={...O,...n.extra});let R=Ue(c);R&&Object.keys(R).length&&(n.tags={...R,...n.tags});let j=Ue(f);j&&Object.keys(j).length&&(n.user={...j,...n.user});let $=Ue(h);$&&Object.keys($).length&&(n.contexts={...$,...n.contexts}),b&&(n.level=b),E&&n.type!=="transaction"&&(n.transaction=E)}function xl(n,r){let a=[...n.breadcrumbs||[],...r];n.breadcrumbs=a.length?a:void 0}function kl(n,r){n.sdkProcessingMetadata={...n.sdkProcessingMetadata,...r}}function Tl(n,r){n.contexts={trace:ll(r),...n.contexts},n.sdkProcessingMetadata={dynamicSamplingContext:_s(r),...n.sdkProcessingMetadata};let a=bs(r),c=gn(a).description;c&&!n.transaction&&n.type==="transaction"&&(n.transaction=c)}function Cl(n,r){n.fingerprint=n.fingerprint?Xo(n.fingerprint):[],r&&(n.fingerprint=n.fingerprint.concat(r)),n.fingerprint&&!n.fingerprint.length&&delete n.fingerprint}function Al(n,r,a,c,f,h){let{normalizeDepth:b=3,normalizeMaxBreadth:E=1e3}=n,O={...r,event_id:r.event_id||a.event_id||de(),timestamp:r.timestamp||dn()},R=a.integrations||n.integrations.map(Ae=>Ae.name);Ol(O,n),Rl(O,R),f&&f.emit("applyFrameMetadata",r),r.type===void 0&&Pl(O,n.stackParser);let j=Nl(c,a.captureContext);a.mechanism&&pn(O,a.mechanism);let $=f?f.getEventProcessors():[],te=fs().getScopeData();if(h){let Ae=h.getScopeData();Es(te,Ae)}if(j){let Ae=j.getScopeData();Es(te,Ae)}let ie=[...a.attachments||[],...te.attachments];ie.length&&(a.attachments=ie),Sl(O,te);let ne=[...$,...te.eventProcessors];return pi(ne,O,a).then(Ae=>(Ae&&Dl(Ae),typeof b=="number"&&b>0?Ml(Ae,b,E):Ae))}function Ol(n,r){let{environment:a,release:c,dist:f,maxValueLength:h=250}=r;"environment"in n||(n.environment="environment"in r?a:di),n.release===void 0&&c!==void 0&&(n.release=c),n.dist===void 0&&f!==void 0&&(n.dist=f),n.message&&(n.message=A(n.message,h));let b=n.exception&&n.exception.values&&n.exception.values[0];b&&b.value&&(b.value=A(b.value,h));let E=n.request;E&&E.url&&(E.url=A(E.url,h))}let Ss=new WeakMap;function Pl(n,r){let a=K._sentryDebugIds;if(!a)return;let c,f=Ss.get(r);f?c=f:(c=new Map,Ss.set(r,c));let h=Object.entries(a).reduce((b,[E,O])=>{let R,j=c.get(E);j?R=j:(R=r(E),c.set(E,R));for(let $=R.length-1;$>=0;$--){let te=R[$];if(te.filename){b[te.filename]=O;break}}return b},{});try{n.exception.values.forEach(b=>{b.stacktrace.frames.forEach(E=>{E.filename&&(E.debug_id=h[E.filename])})})}catch{}}function Dl(n){let r={};try{n.exception.values.forEach(c=>{c.stacktrace.frames.forEach(f=>{f.debug_id&&(f.abs_path?r[f.abs_path]=f.debug_id:f.filename&&(r[f.filename]=f.debug_id),delete f.debug_id)})})}catch{}if(Object.keys(r).length===0)return;n.debug_meta=n.debug_meta||{},n.debug_meta.images=n.debug_meta.images||[];let a=n.debug_meta.images;Object.entries(r).forEach(([c,f])=>{a.push({type:"sourcemap",code_file:c,debug_id:f})})}function Rl(n,r){r.length>0&&(n.sdk=n.sdk||{},n.sdk.integrations=[...n.sdk.integrations||[],...r])}function Ml(n,r,a){if(!n)return null;let c={...n,...n.breadcrumbs&&{breadcrumbs:n.breadcrumbs.map(f=>({...f,...f.data&&{data:lt(f.data,r,a)}}))},...n.user&&{user:lt(n.user,r,a)},...n.contexts&&{contexts:lt(n.contexts,r,a)},...n.extra&&{extra:lt(n.extra,r,a)}};return n.contexts&&n.contexts.trace&&c.contexts&&(c.contexts.trace=n.contexts.trace,n.contexts.trace.data&&(c.contexts.trace.data=lt(n.contexts.trace.data,r,a))),n.spans&&(c.spans=n.spans.map(f=>({...f,...f.data&&{data:lt(f.data,r,a)}}))),c}function Nl(n,r){if(!r)return n;let a=n?n.clone():new et;return a.update(r),a}function Fl(n){if(n)return Ll(n)?{captureContext:n}:Kl(n)?{captureContext:n}:n}function Ll(n){return n instanceof et||typeof n=="function"}let Bl=["user","level","extra","contexts","tags","fingerprint","requestSession","propagationContext"];function Kl(n){return Object.keys(n).some(r=>Bl.includes(r))}function Is(n,r){return xe().captureException(n,Fl(r))}function $l(n,r){let a=typeof r=="string"?r:void 0,c=typeof r!="string"?{captureContext:r}:void 0;return xe().captureMessage(n,a,c)}function nr(n,r){return xe().captureEvent(n,r)}function xs(n,r){Ce().setContext(n,r)}function ks(n){Ce().setExtras(n)}function Ts(n,r){Ce().setExtra(n,r)}function Cs(n){Ce().setTags(n)}function As(n,r){Ce().setTag(n,r)}function Os(n){Ce().setUser(n)}function Ps(){return Ce().lastEventId()}async function jl(n){let r=ue();return r?r.flush(n):(z.warn("Cannot flush events. No client defined."),Promise.resolve(!1))}async function Ul(n){let r=ue();return r?r.close(n):(z.warn("Cannot flush events and disable SDK. No client defined."),Promise.resolve(!1))}function Hl(){return!!ue()}function Vl(n){Ce().addEventProcessor(n)}function rr(n){let r=ue(),a=Ce(),c=xe(),{release:f,environment:h=di}=r&&r.getOptions()||{},{userAgent:b}=K.navigator||{},E=qc({release:f,environment:h,user:c.getUser()||a.getUser(),...b&&{userAgent:b},...n}),O=a.getSession();return O&&O.status==="ok"&&jt(O,{status:"exited"}),vn(),a.setSession(E),c.setSession(E),E}function vn(){let n=Ce(),r=xe(),a=r.getSession()||n.getSession();a&&Yc(a),Ds(),n.setSession(),r.setSession()}function Ds(){let n=Ce(),r=xe(),a=ue(),c=r.getSession()||n.getSession();c&&a&&a.captureSession(c)}function hi(n=!1){if(n){vn();return}Ds()}let Wl="7";function Rs(n){let r=n.protocol?`${n.protocol}:`:"",a=n.port?`:${n.port}`:"";return`${r}//${n.host}${a}${n.path?`/${n.path}`:""}/api/`}function Gl(n){return`${Rs(n)}${n.projectId}/envelope/`}function zl(n,r){return Qu({sentry_key:n.publicKey,sentry_version:Wl,...r&&{sentry_client:`${r.name}/${r.version}`}})}function ql(n,r,a){return r||`${Gl(n)}?${zl(n,a)}`}function Yl(n,r){let a=No(n);if(!a)return"";let c=`${Rs(a)}embed/error-page/`,f=`dsn=${fn(a)}`;for(let h in r)if(h!=="dsn"&&h!=="onClose")if(h==="user"){let b=r.user;if(!b)continue;b.name&&(f+=`&name=${encodeURIComponent(b.name)}`),b.email&&(f+=`&email=${encodeURIComponent(b.email)}`)}else f+=`&${encodeURIComponent(h)}=${encodeURIComponent(r[h])}`;return`${c}?${f}`}let Ms=[];function Jl(n){let r={};return n.forEach(a=>{let{name:c}=a,f=r[c];f&&!f.isDefaultInstance&&a.isDefaultInstance||(r[c]=a)}),Object.values(r)}function Xl(n){let r=n.defaultIntegrations||[],a=n.integrations;r.forEach(b=>{b.isDefaultInstance=!0});let c;Array.isArray(a)?c=[...r,...a]:typeof a=="function"?c=Xo(a(r)):c=r;let f=Jl(c),h=f.findIndex(b=>b.name==="Debug");if(h>-1){let[b]=f.splice(h,1);f.push(b)}return f}function Ql(n,r){let a={};return r.forEach(c=>{c&&Fs(n,c,a)}),a}function Ns(n,r){for(let a of r)a&&a.afterAllSetup&&a.afterAllSetup(n)}function Fs(n,r,a){if(a[r.name]){z.log(`Integration skipped because it was already installed: ${r.name}`);return}if(a[r.name]=r,Ms.indexOf(r.name)===-1&&typeof r.setupOnce=="function"&&(r.setupOnce(),Ms.push(r.name)),r.setup&&typeof r.setup=="function"&&r.setup(n),typeof r.preprocessEvent=="function"){let c=r.preprocessEvent.bind(r);n.on("preprocessEvent",(f,h)=>c(f,h,n))}if(typeof r.processEvent=="function"){let c=r.processEvent.bind(r),f=Object.assign((h,b)=>c(h,b,n),{id:r.name});n.addEventProcessor(f)}z.log(`Integration installed: ${r.name}`)}function Zl(n){let r=ue();if(!r){z.warn(`Cannot add integration "${n.name}" because no SDK Client is available.`);return}r.addIntegration(n)}function lm(n){return n}let Ls="Not capturing exception because it's already been captured.";class ef{constructor(r){if(this._options=r,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],r.dsn?this._dsn=No(r.dsn):z.warn("No DSN provided, client will not send events."),this._dsn){let a=ql(this._dsn,r.tunnel,r._metadata?r._metadata.sdk:void 0);this._transport=r.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...r.transportOptions,url:a})}}captureException(r,a,c){let f=de();if(Jo(r))return z.log(Ls),f;let h={event_id:f,...a};return this._process(this.eventFromException(r,h).then(b=>this._captureEvent(b,h,c))),h.event_id}captureMessage(r,a,c,f){let h={event_id:de(),...c},b=p(r)?r:String(r),E=m(r)?this.eventFromMessage(b,a,h):this.eventFromException(r,h);return this._process(E.then(O=>this._captureEvent(O,h,f))),h.event_id}captureEvent(r,a,c){let f=de();if(a&&a.originalException&&Jo(a.originalException))return z.log(Ls),f;let h={event_id:f,...a},E=(r.sdkProcessingMetadata||{}).capturedSpanScope;return this._process(this._captureEvent(r,h,E||c)),h.event_id}captureSession(r){typeof r.release!="string"?z.warn("Discarded session because of missing or non-string release"):(this.sendSession(r),jt(r,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(r){let a=this._transport;return a?(this.emit("flush"),this._isClientDoneProcessing(r).then(c=>a.flush(r).then(f=>c&&f))):xt(!0)}close(r){return this.flush(r).then(a=>(this.getOptions().enabled=!1,this.emit("close"),a))}getEventProcessors(){return this._eventProcessors}addEventProcessor(r){this._eventProcessors.push(r)}init(){this._isEnabled()&&this._setupIntegrations()}getIntegrationByName(r){return this._integrations[r]}addIntegration(r){let a=this._integrations[r.name];Fs(this,r,this._integrations),a||Ns(this,[r])}sendEvent(r,a={}){this.emit("beforeSendEvent",r,a);let c=_l(r,this._dsn,this._options._metadata,this._options.tunnel);for(let h of a.attachments||[])c=Dc(c,Nc(h));let f=this.sendEnvelope(c);f&&f.then(h=>this.emit("afterSendEvent",r,h),null)}sendSession(r){let a=wl(r,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(a)}recordDroppedEvent(r,a,c){if(this._options.sendClientReports){let f=`${r}:${a}`;z.log(`Adding outcome: "${f}"`),this._outcomes[f]=(this._outcomes[f]||0)+1}}on(r,a){let c=this._hooks[r]=this._hooks[r]||[];return c.push(a),()=>{let f=c.indexOf(a);f>-1&&c.splice(f,1)}}emit(r,...a){let c=this._hooks[r];c&&c.forEach(f=>f(...a))}sendEnvelope(r){return this.emit("beforeEnvelope",r),this._isEnabled()&&this._transport?this._transport.send(r).then(null,a=>(z.error("Error while sending event:",a),a)):(z.error("Transport disabled"),xt({}))}_setupIntegrations(){let{integrations:r}=this._options;this._integrations=Ql(this,r),Ns(this,r)}_updateSessionFromEvent(r,a){let c=!1,f=!1,h=a.exception&&a.exception.values;if(h){f=!0;for(let O of h){let R=O.mechanism;if(R&&R.handled===!1){c=!0;break}}}let b=r.status==="ok";(b&&r.errors===0||b&&c)&&(jt(r,{...c&&{status:"crashed"},errors:r.errors||Number(f||c)}),this.captureSession(r))}_isClientDoneProcessing(r){return new He(a=>{let c=0,f=1,h=setInterval(()=>{this._numProcessing==0?(clearInterval(h),a(!0)):(c+=f,r&&c>=r&&(clearInterval(h),a(!1)))},f)})}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(r,a,c,f=Ce()){let h=this.getOptions(),b=Object.keys(this._integrations);return!a.integrations&&b.length>0&&(a.integrations=b),this.emit("preprocessEvent",r,a),r.type||f.setLastEventId(r.event_id||a.event_id),Al(h,r,a,c,this,f).then(E=>{if(E===null)return E;let O={...f.getPropagationContext(),...c?c.getPropagationContext():void 0};if(!(E.contexts&&E.contexts.trace)&&O){let{traceId:j,spanId:$,parentSpanId:te,dsc:ie}=O;E.contexts={trace:Ue({trace_id:j,span_id:$,parent_span_id:te}),...E.contexts};let ne=ie||ws(j,this);E.sdkProcessingMetadata={dynamicSamplingContext:ne,...E.sdkProcessingMetadata}}return E})}_captureEvent(r,a={},c){return this._processEvent(r,a,c).then(f=>f.event_id,f=>{{let h=f;h.logLevel==="log"?z.log(h.message):z.warn(h)}})}_processEvent(r,a,c){let f=this.getOptions(),{sampleRate:h}=f,b=mi(r),E=Bs(r),O=r.type||"error",R=`before send for type \`${O}\``,j=typeof h>"u"?void 0:vl(h);if(E&&typeof j=="number"&&Math.random()>j)return this.recordDroppedEvent("sample_rate","error",r),Qn(new ze(`Discarding event because it's not included in the random sample (sampling rate = ${h})`,"log"));let $=O==="replay_event"?"replay":O,ie=(r.sdkProcessingMetadata||{}).capturedSpanIsolationScope;return this._prepareEvent(r,a,c,ie).then(ne=>{if(ne===null)throw this.recordDroppedEvent("event_processor",$,r),new ze("An event processor returned `null`, will not send event.","log");if(a.data&&a.data.Fe===!0)return ne;let Ae=nf(this,f,ne,a);return tf(Ae,R)}).then(ne=>{if(ne===null){if(this.recordDroppedEvent("before_send",$,r),mi(r)){let Wd=1+(r.spans||[]).length;this._outcomes.span=(this._outcomes.span||0)+Wd}throw new ze(`${R} returned \`null\`, will not send event.`,"log")}let cr=c&&c.getSession();!b&&cr&&this._updateSessionFromEvent(cr,ne);let Ae=ne.transaction_info;if(b&&Ae&&ne.transaction!==r.transaction){let wa="custom";ne.transaction_info={...Ae,source:wa}}return this.sendEvent(ne,a),ne}).then(null,ne=>{throw ne instanceof ze?ne:(this.captureException(ne,{data:{Fe:!0},originalException:ne}),new ze(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${ne}`))})}_process(r){this._numProcessing++,r.then(a=>(this._numProcessing--,a),a=>(this._numProcessing--,a))}_clearOutcomes(){let r=this._outcomes;return this._outcomes={},Object.entries(r).map(([a,c])=>{let[f,h]=a.split(":");return{reason:f,category:h,quantity:c}})}}function tf(n,r){let a=`${r} must return \`null\` or a valid event.`;if(v(n))return n.then(c=>{if(!y(c)&&c!==null)throw new ze(a);return c},c=>{throw new ze(`${r} rejected with ${c}`)});if(!y(n)&&n!==null)throw new ze(a);return n}function nf(n,r,a,c){let{beforeSend:f,beforeSendTransaction:h,beforeSendSpan:b}=r;if(Bs(a)&&f)return f(a,c);if(mi(a)){if(a.spans&&b){let E=[];for(let O of a.spans){let R=b(O);R?E.push(R):n.recordDroppedEvent("before_send","span")}a.spans=E}if(h)return h(a,c)}return a}function Bs(n){return n.type===void 0}function mi(n){return n.type==="transaction"}function rf(n,r){r.debug===!0&&z.enable(),xe().update(r.initialScope);let c=new n(r);return Ks(c),c.init(),c}function Ks(n){xe().setClient(n)}let of=64;function $s(n,r,a=wc(n.bufferSize||of)){let c={},f=b=>a.drain(b);function h(b){let E=[];if(ns(b,($,te)=>{let ie=rs(te);if(Uc(c,ie)){let ne=js($,te);n.recordDroppedEvent("ratelimit_backoff",ie,ne)}else E.push($)}),E.length===0)return xt({});let O=hn(b[0],E),R=$=>{ns(O,(te,ie)=>{let ne=js(te,ie);n.recordDroppedEvent($,rs(ie),ne)})},j=()=>r({body:Rc(O)}).then($=>($.statusCode!==void 0&&($.statusCode<200||$.statusCode>=300)&&z.warn(`Sentry responded with status code ${$.statusCode} to sent event.`),c=Hc(c,$),$),$=>{throw R("network_error"),$});return a.add(j).then($=>$,$=>{if($ instanceof ze)return z.error("Skipped sending event because buffer is full."),R("queue_overflow"),xt({});throw $})}return{send:h,flush:f}}function js(n,r){if(!(r!=="event"&&r!=="transaction"))return Array.isArray(n)?n[1]:void 0}function sf(n,...r){let a=new String(String.raw(n,...r));return a.Le=n.join("\0").replace(/%/g,"%%").replace(/\0/g,"%s"),a.Be=r,a}function af(n,r,a=[r],c="npm"){let f=n._metadata||{};f.sdk||(f.sdk={name:`sentry.javascript.${r}`,packages:a.map(h=>({name:`${c}:@sentry/${h}`,version:F})),version:F}),n._metadata=f}let uf=100;function tt(n,r){let a=ue(),c=Ce();if(!a)return;let{beforeBreadcrumb:f=null,maxBreadcrumbs:h=uf}=a.getOptions();if(h<=0)return;let E={timestamp:dn(),...n},O=f?De(()=>f(E,r)):E;O!==null&&(a.emit&&a.emit("beforeAddBreadcrumb",O,r),c.addBreadcrumb(O,h))}let Us,cf="FunctionToString",Hs=new WeakMap,Vs=(()=>({name:cf,setupOnce(){Us=Function.prototype.toString;try{Function.prototype.toString=function(...n){let r=Zr(this),a=Hs.has(ue())&&r!==void 0?r:this;return Us.apply(a,n)}}catch{}},setup(n){Hs.set(n,!0)}})),lf=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,"undefined is not an object (evaluating 'a.L')",`can't redefine non-configurable property "solana"`,"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler"],ff="InboundFilters",Ws=((n={})=>({name:ff,processEvent(r,a,c){let f=c.getOptions(),h=df(n,f);return pf(r,h)?null:r}}));function df(n={},r={}){return{allowUrls:[...n.allowUrls||[],...r.allowUrls||[]],denyUrls:[...n.denyUrls||[],...r.denyUrls||[]],ignoreErrors:[...n.ignoreErrors||[],...r.ignoreErrors||[],...n.disableErrorDefaults?[]:lf],ignoreTransactions:[...n.ignoreTransactions||[],...r.ignoreTransactions||[]],ignoreInternal:n.ignoreInternal!==void 0?n.ignoreInternal:!0}}function pf(n,r){return r.ignoreInternal&&bf(n)?(z.warn(`Event dropped due to being internal Sentry Error.
Event: ${ct(n)}`),!0):hf(n,r.ignoreErrors)?(z.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${ct(n)}`),!0):_f(n)?(z.warn(`Event dropped due to not having an error message, error type or stacktrace.
Event: ${ct(n)}`),!0):mf(n,r.ignoreTransactions)?(z.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${ct(n)}`),!0):gf(n,r.denyUrls)?(z.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${ct(n)}.
Url: ${ir(n)}`),!0):yf(n,r.allowUrls)?!1:(z.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${ct(n)}.
Url: ${ir(n)}`),!0)}function hf(n,r){return n.type||!r||!r.length?!1:vf(n).some(a=>D(a,r))}function mf(n,r){if(n.type!=="transaction"||!r||!r.length)return!1;let a=n.transaction;return a?D(a,r):!1}function gf(n,r){if(!r||!r.length)return!1;let a=ir(n);return a?D(a,r):!1}function yf(n,r){if(!r||!r.length)return!0;let a=ir(n);return a?D(a,r):!0}function vf(n){let r=[];n.message&&r.push(n.message);let a;try{a=n.exception.values[n.exception.values.length-1]}catch{}return a&&a.value&&(r.push(a.value),a.type&&r.push(`${a.type}: ${a.value}`)),r}function bf(n){try{return n.exception.values[0].type==="SentryError"}catch{}return!1}function wf(n=[]){for(let r=n.length-1;r>=0;r--){let a=n[r];if(a&&a.filename!=="<anonymous>"&&a.filename!=="[native code]")return a.filename||null}return null}function ir(n){try{let r;try{r=n.exception.values[0].stacktrace.frames}catch{}return r?wf(r):null}catch{return z.error(`Cannot extract url for event ${ct(n)}`),null}}function _f(n){return n.type||!n.exception||!n.exception.values||n.exception.values.length===0?!1:!n.message&&!n.exception.values.some(r=>r.stacktrace||r.type&&r.type!=="Error"||r.value)}let Ef="Dedupe",Gs=(()=>{let n;return{name:Ef,processEvent(r){if(r.type)return r;try{if(Sf(r,n))return z.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return n=r}}});function Sf(n,r){return r?!!(If(n,r)||xf(n,r)):!1}function If(n,r){let a=n.message,c=r.message;return!(!a&&!c||a&&!c||!a&&c||a!==c||!qs(n,r)||!zs(n,r))}function xf(n,r){let a=Ys(r),c=Ys(n);return!(!a||!c||a.type!==c.type||a.value!==c.value||!qs(n,r)||!zs(n,r))}function zs(n,r){let a=Vo(n),c=Vo(r);if(!a&&!c)return!0;if(a&&!c||!a&&c||(a=a,c=c,c.length!==a.length))return!1;for(let f=0;f<c.length;f++){let h=c[f],b=a[f];if(h.filename!==b.filename||h.lineno!==b.lineno||h.colno!==b.colno||h.function!==b.function)return!1}return!0}function qs(n,r){let a=n.fingerprint,c=r.fingerprint;if(!a&&!c)return!0;if(a&&!c||!a&&c)return!1;a=a,c=c;try{return a.join("")===c.join("")}catch{return!1}}function Ys(n){return n.exception&&n.exception.values&&n.exception.values[0]}function kf(){return{bindClient(n){xe().setClient(n)},withScope:tr,getClient:()=>ue(),getScope:xe,getIsolationScope:Ce,captureException:(n,r)=>xe().captureException(n,r),captureMessage:(n,r,a)=>xe().captureMessage(n,r,a),captureEvent:nr,addBreadcrumb:tt,setUser:Os,setTags:Cs,setTag:As,setExtra:Ts,setExtras:ks,setContext:xs,getIntegration(n){let r=ue();return r&&r.getIntegrationByName(n.id)||null},startSession:rr,endSession:vn,captureSession(n){if(n)return vn();Cf()}}}let Tf=kf;function Cf(){let n=xe(),r=ue(),a=n.getSession();r&&a&&r.captureSession(a)}let Af=n=>(De(()=>{console.warn("You are using browserTracingIntegration() even though this bundle does not include tracing.")}),{name:"BrowserTracing"});function bn(){De(()=>{console.warn("You are using metrics even though this bundle does not include tracing.")})}let Of={increment:bn,distribution:bn,set:bn,gauge:bn,timing:(n,r)=>{if(bn(),typeof r=="function")return r()}},Q=K,gi=0;function Js(){return gi>0}function Pf(){gi++,setTimeout(()=>{gi--})}function Ht(n,r={},a){if(typeof n!="function")return n;try{let f=n.Ke;if(f)return f;if(Zr(n))return n}catch{return n}let c=function(){let f=Array.prototype.slice.call(arguments);try{a&&typeof a=="function"&&a.apply(this,arguments);let h=f.map(b=>Ht(b,r));return n.apply(this,h)}catch(h){throw Pf(),tr(b=>{b.addEventProcessor(E=>(r.mechanism&&(oi(E,void 0,void 0),pn(E,r.mechanism)),E.extra={...E.extra,arguments:f},E)),Is(h)}),h}};try{for(let f in n)Object.prototype.hasOwnProperty.call(n,f)&&(c[f]=n[f])}catch{}Fo(c,n),Et(n,"__sentry_wrapped__",c);try{Object.getOwnPropertyDescriptor(c,"name").configurable&&Object.defineProperty(c,"name",{get(){return n.name}})}catch{}return c}function or(n,r){let a=vi(n,r),c={type:r&&r.name,value:Ff(r)};return a.length&&(c.stacktrace={frames:a}),c.type===void 0&&c.value===""&&(c.value="Unrecoverable error caught"),c}function Df(n,r,a,c){let f=ue(),h=f&&f.getOptions().normalizeDepth,b=Kf(r),E={zt:Qo(r,h)};if(b)return{exception:{values:[or(n,b)]},extra:E};let O={exception:{values:[{type:g(r)?r.constructor.name:c?"UnhandledRejection":"Error",value:Lf(r,{isUnhandledRejection:c})}]},extra:E};if(a){let R=vi(n,a);R.length&&(O.exception.values[0].stacktrace={frames:R})}return O}function yi(n,r){return{exception:{values:[or(n,r)]}}}function vi(n,r){let a=r.stacktrace||r.stack||"",c=Mf(r),f=Nf(r);try{return n(a,c,f)}catch{}return[]}let Rf=/Minified React error #\d+;/i;function Mf(n){return n&&Rf.test(n.message)?1:0}function Nf(n){return typeof n.framesToPop=="number"?n.framesToPop:0}function Ff(n){let r=n&&n.message;return r?r.error&&typeof r.error.message=="string"?r.error.message:r:"No error message"}function Xs(n,r,a,c){let f=a&&a.syntheticException||void 0,h=bi(n,r,f,c);return pn(h),h.level="error",a&&a.event_id&&(h.event_id=a.event_id),xt(h)}function Qs(n,r,a="info",c,f){let h=c&&c.syntheticException||void 0,b=wi(n,r,h,f);return b.level=a,c&&c.event_id&&(b.event_id=c.event_id),xt(b)}function bi(n,r,a,c,f){let h;if(s(r)&&r.error)return yi(n,r.error);if(u(r)||l(r)){let b=r;if("stack"in r)h=yi(n,r);else{let E=b.name||(u(b)?"DOMError":"DOMException"),O=b.message?`${E}: ${b.message}`:E;h=wi(n,O,a,c),oi(h,O)}return"code"in b&&(h.tags={...h.tags,"DOMException.code":`${b.code}`}),h}return i(r)?yi(n,r):y(r)||g(r)?(h=Df(n,r,a,f),pn(h,{synthetic:!0}),h):(h=wi(n,r,a,c),oi(h,`${r}`,void 0),pn(h,{synthetic:!0}),h)}function wi(n,r,a,c){let f={};if(c&&a){let h=vi(n,a);h.length&&(f.exception={values:[{value:r,stacktrace:{frames:h}}]})}if(p(r)){let{Le:h,Be:b}=r;return f.logentry={message:h,params:b},f}return f.message=r,f}function Lf(n,{isUnhandledRejection:r}){let a=Zu(n),c=r?"promise rejection":"exception";return s(n)?`Event \`ErrorEvent\` captured as ${c} with message \`${n.message}\``:g(n)?`Event \`${Bf(n)}\` (type=${n.type}) captured as ${c}`:`Object captured as ${c} with keys: ${a}`}function Bf(n){try{let r=Object.getPrototypeOf(n);return r?r.constructor.name:void 0}catch{}}function Kf(n){for(let r in n)if(Object.prototype.hasOwnProperty.call(n,r)){let a=n[r];if(a instanceof Error)return a}}function Zs(n,{metadata:r,tunnel:a,dsn:c}){let f={event_id:n.event_id,sent_at:new Date().toISOString(),...r&&r.sdk&&{sdk:{name:r.sdk.name,version:r.sdk.version}},...!!a&&!!c&&{dsn:fn(c)}},h=$f(n);return hn(f,[h])}function $f(n){return[{type:"user_report"},n]}class ea extends ef{constructor(r){let a={parentSpanIsAlwaysRootSpan:!0,...r},c=Q.SENTRY_SDK_SOURCE||hc();af(a,"browser",["browser"],c),super(a),a.sendClientReports&&Q.document&&Q.document.addEventListener("visibilitychange",()=>{Q.document.visibilityState==="hidden"&&this._flushOutcomes()})}eventFromException(r,a){return Xs(this._options.stackParser,r,a,this._options.attachStacktrace)}eventFromMessage(r,a="info",c){return Qs(this._options.stackParser,r,a,c,this._options.attachStacktrace)}captureUserFeedback(r){if(!this._isEnabled()){z.warn("SDK not enabled, will not capture user feedback.");return}let a=Zs(r,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this.sendEnvelope(a)}_prepareEvent(r,a,c){return r.platform=r.platform||"javascript",super._prepareEvent(r,a,c)}_flushOutcomes(){let r=this._clearOutcomes();if(r.length===0){z.log("No outcomes to send");return}if(!this._dsn){z.log("No dsn provided, will not send outcomes");return}z.log("Sending outcomes:",r);let a=Bc(r,this._options.tunnel&&fn(this._dsn));this.sendEnvelope(a)}}let ke=K,jf=1e3,ta,_i,Ei;function Uf(n){St("dom",n),It("dom",Hf)}function Hf(){if(!ke.document)return;let n=Ge.bind(null,"dom"),r=na(n,!0);ke.document.addEventListener("click",r,!1),ke.document.addEventListener("keypress",r,!1),["EventTarget","Node"].forEach(a=>{let c=ke[a]&&ke[a].prototype;!c||!c.hasOwnProperty||!c.hasOwnProperty("addEventListener")||(ve(c,"addEventListener",function(f){return function(h,b,E){if(h==="click"||h=="keypress")try{let O=this,R=O.H=O.H||{},j=R[h]=R[h]||{refCount:0};if(!j.handler){let $=na(n);j.handler=$,f.call(this,h,$,E)}j.refCount++}catch{}return f.call(this,h,b,E)}}),ve(c,"removeEventListener",function(f){return function(h,b,E){if(h==="click"||h=="keypress")try{let O=this,R=O.H||{},j=R[h];j&&(j.refCount--,j.refCount<=0&&(f.call(this,h,j.handler,E),j.handler=void 0,delete R[h]),Object.keys(R).length===0&&delete O.H)}catch{}return f.call(this,h,b,E)}}))})}function Vf(n){if(n.type!==_i)return!1;try{if(!n.target||n.target._sentryId!==Ei)return!1}catch{}return!0}function Wf(n,r){return n!=="keypress"?!1:!r||!r.tagName?!0:!(r.tagName==="INPUT"||r.tagName==="TEXTAREA"||r.isContentEditable)}function na(n,r=!1){return a=>{if(!a||a._sentryCaptured)return;let c=Gf(a);if(Wf(a.type,c))return;Et(a,"_sentryCaptured",!0),c&&!c._sentryId&&Et(c,"_sentryId",de());let f=a.type==="keypress"?"input":a.type;Vf(a)||(n({event:a,name:f,global:r}),_i=a.type,Ei=c?c._sentryId:void 0),clearTimeout(ta),ta=ke.setTimeout(()=>{Ei=void 0,_i=void 0},jf)}}function Gf(n){try{return n.target}catch{return null}}let sr;function ra(n){let r="history";St(r,n),It(r,zf)}function zf(){if(!Vc())return;let n=ke.onpopstate;ke.onpopstate=function(...a){let c=ke.location.href,f=sr;if(sr=c,Ge("history",{from:f,to:c}),n)try{return n.apply(this,a)}catch{}};function r(a){return function(...c){let f=c.length>2?c[2]:void 0;if(f){let h=sr,b=String(f);sr=b,Ge("history",{from:h,to:b})}return a.apply(this,c)}}ve(ke.history,"pushState",r),ve(ke.history,"replaceState",r)}let ar={};function qf(n){let r=ar[n];if(r)return r;let a=ke[n];if(ri(a))return ar[n]=a.bind(ke);let c=ke.document;if(c&&typeof c.createElement=="function")try{let f=c.createElement("iframe");f.hidden=!0,c.head.appendChild(f);let h=f.contentWindow;h&&h[n]&&(a=h[n]),c.head.removeChild(f)}catch(f){z.warn(`Could not create sandbox iframe for ${n} check, bailing to window.${n}: `,f)}return a&&(ar[n]=a.bind(ke))}function ia(n){ar[n]=void 0}let wn="__sentry_xhr_v3__";function Yf(n){St("xhr",n),It("xhr",Jf)}function Jf(){if(!ke.XMLHttpRequest)return;let n=XMLHttpRequest.prototype;ve(n,"open",function(r){return function(...a){let c=Qe()*1e3,f=d(a[0])?a[0].toUpperCase():void 0,h=Xf(a[1]);if(!f||!h)return r.apply(this,a);this[wn]={method:f,url:h,request_headers:{}},f==="POST"&&h.match(/sentry_key/)&&(this.qt=!0);let b=()=>{let E=this[wn];if(E&&this.readyState===4){try{E.status_code=this.status}catch{}let O={endTimestamp:Qe()*1e3,startTimestamp:c,xhr:this};Ge("xhr",O)}};return"onreadystatechange"in this&&typeof this.onreadystatechange=="function"?ve(this,"onreadystatechange",function(E){return function(...O){return b(),E.apply(this,O)}}):this.addEventListener("readystatechange",b),ve(this,"setRequestHeader",function(E){return function(...O){let[R,j]=O,$=this[wn];return $&&d(R)&&d(j)&&($.request_headers[R.toLowerCase()]=j),E.apply(this,O)}}),r.apply(this,a)}}),ve(n,"send",function(r){return function(...a){let c=this[wn];if(!c)return r.apply(this,a);a[0]!==void 0&&(c.body=a[0]);let f={startTimestamp:Qe()*1e3,xhr:this};return Ge("xhr",f),r.apply(this,a)}})}function Xf(n){if(d(n))return n;try{return n.toString()}catch{}}function oa(n,r=qf("fetch")){let a=0,c=0;function f(h){let b=h.body.length;a+=b,c++;let E={body:h.body,method:"POST",referrerPolicy:"origin",headers:n.headers,keepalive:a<=6e4&&c<15,...n.fetchOptions};if(!r)return ia("fetch"),Qn("No fetch implementation available");try{return r(n.url,E).then(O=>(a-=b,c--,{statusCode:O.status,headers:{"x-sentry-rate-limits":O.headers.get("X-Sentry-Rate-Limits"),"retry-after":O.headers.get("Retry-After")}}))}catch(O){return ia("fetch"),a-=b,c--,Qn(O)}}return $s(n,f)}let Qf=10,Zf=20,ed=30,td=40,nd=50;function Vt(n,r,a,c){let f={filename:n,function:r==="<anonymous>"?qe:r,in_app:!0};return a!==void 0&&(f.lineno=a),c!==void 0&&(f.colno=c),f}let rd=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,id=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,od=/\((\S*)(?::(\d+))(?::(\d+))\)/,sa=[ed,n=>{let r=rd.exec(n);if(r){let[,c,f,h]=r;return Vt(c,qe,+f,+h)}let a=id.exec(n);if(a){if(a[2]&&a[2].indexOf("eval")===0){let b=od.exec(a[2]);b&&(a[2]=b[1],a[3]=b[2],a[4]=b[3])}let[f,h]=la(a[1]||qe,a[2]);return Vt(h,f,a[3]?+a[3]:void 0,a[4]?+a[4]:void 0)}}],sd=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,ad=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,aa=[nd,n=>{let r=sd.exec(n);if(r){if(r[3]&&r[3].indexOf(" > eval")>-1){let h=ad.exec(r[3]);h&&(r[1]=r[1]||"eval",r[3]=h[1],r[4]=h[2],r[5]="")}let c=r[3],f=r[1]||qe;return[f,c]=la(f,c),Vt(c,f,r[4]?+r[4]:void 0,r[5]?+r[5]:void 0)}}],ud=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:[-a-z]+):.*?):(\d+)(?::(\d+))?\)?\s*$/i,cd=[td,n=>{let r=ud.exec(n);return r?Vt(r[2],r[1]||qe,+r[3],r[4]?+r[4]:void 0):void 0}],ld=/ line (\d+).*script (?:in )?(\S+)(?:: in function (\S+))?$/i,fd=[Qf,n=>{let r=ld.exec(n);return r?Vt(r[2],r[3]||qe,+r[1]):void 0}],dd=/ line (\d+), column (\d+)\s*(?:in (?:<anonymous function: ([^>]+)>|([^)]+))\(.*\))? in (.*):\s*$/i,pd=[Zf,n=>{let r=dd.exec(n);return r?Vt(r[5],r[3]||r[4]||qe,+r[1],+r[2]):void 0}],ua=[sa,aa],ca=Ho(...ua),la=(n,r)=>{let a=n.indexOf("safari-extension")!==-1,c=n.indexOf("safari-web-extension")!==-1;return a||c?[n.indexOf("@")!==-1?n.split("@")[0]:qe,a?`safari-extension:${r}`:`safari-web-extension:${r}`]:[n,r]},ur=1024,hd="Breadcrumbs",fa=((n={})=>{let r={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...n};return{name:hd,setup(a){r.console&&rc(yd(a)),r.dom&&Uf(gd(a,r.dom)),r.xhr&&Yf(vd(a)),r.fetch&&ac(bd(a)),r.history&&ra(wd(a)),r.sentry&&a.on("beforeSendEvent",md(a))}}});function md(n){return function(a){ue()===n&&tt({category:`sentry.${a.type==="transaction"?"transaction":"event"}`,event_id:a.event_id,level:a.level,message:ct(a)},{event:a})}}function gd(n,r){return function(c){if(ue()!==n)return;let f,h,b=typeof r=="object"?r.serializeAttribute:void 0,E=typeof r=="object"&&typeof r.maxStringLength=="number"?r.maxStringLength:void 0;E&&E>ur&&(z.warn(`\`dom.maxStringLength\` cannot exceed ${ur}, but a value of ${E} was configured. Sentry will use ${ur} instead.`),E=ur),typeof b=="string"&&(b=[b]);try{let R=c.event,j=_d(R)?R.target:R;f=ae(j,{keyAttrs:b,maxStringLength:E}),h=Ie(j)}catch{f="<unknown>"}if(f.length===0)return;let O={category:`ui.${c.name}`,message:f};h&&(O.data={"ui.component_name":h}),tt(O,{event:c.event,name:c.name,global:c.global})}}function yd(n){return function(a){if(ue()!==n)return;let c={category:"console",data:{arguments:a.args,logger:"console"},level:Ec(a.level),message:P(a.args," ")};if(a.level==="assert")if(a.args[0]===!1)c.message=`Assertion failed: ${P(a.args.slice(1)," ")||"console.assert"}`,c.data.arguments=a.args.slice(1);else return;tt(c,{input:a.args,level:a.level})}}function vd(n){return function(a){if(ue()!==n)return;let{startTimestamp:c,endTimestamp:f}=a,h=a.xhr[wn];if(!c||!f||!h)return;let{method:b,url:E,status_code:O,body:R}=h,j={method:b,url:E,status_code:O},$={xhr:a.xhr,input:R,startTimestamp:c,endTimestamp:f};tt({category:"xhr",data:j,type:"http"},$)}}function bd(n){return function(a){if(ue()!==n)return;let{startTimestamp:c,endTimestamp:f}=a;if(f&&!(a.fetchData.url.match(/sentry_key/)&&a.fetchData.method==="POST"))if(a.error){let h=a.fetchData,b={data:a.error,input:a.args,startTimestamp:c,endTimestamp:f};tt({category:"fetch",data:h,level:"error",type:"http"},b)}else{let h=a.response,b={...a.fetchData,status_code:h&&h.status},E={input:a.args,response:h,startTimestamp:c,endTimestamp:f};tt({category:"fetch",data:b,type:"http"},E)}}}function wd(n){return function(a){if(ue()!==n)return;let c=a.from,f=a.to,h=ai(Q.location.href),b=c?ai(c):void 0,E=ai(f);(!b||!b.path)&&(b=h),h.protocol===E.protocol&&h.host===E.host&&(f=E.relative),h.protocol===b.protocol&&h.host===b.host&&(c=b.relative),tt({category:"navigation",data:{from:c,to:f}})}}function _d(n){return!!n&&!!n.target}let Ed=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],Sd="BrowserApiErrors",da=((n={})=>{let r={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...n};return{name:Sd,setupOnce(){r.setTimeout&&ve(Q,"setTimeout",pa),r.setInterval&&ve(Q,"setInterval",pa),r.requestAnimationFrame&&ve(Q,"requestAnimationFrame",Id),r.XMLHttpRequest&&"XMLHttpRequest"in Q&&ve(XMLHttpRequest.prototype,"send",xd);let a=r.eventTarget;a&&(Array.isArray(a)?a:Ed).forEach(kd)}}});function pa(n){return function(...r){let a=r[0];return r[0]=Ht(a,{mechanism:{data:{function:ut(n)},handled:!1,type:"instrument"}}),n.apply(this,r)}}function Id(n){return function(r){return n.apply(this,[Ht(r,{mechanism:{data:{function:"requestAnimationFrame",handler:ut(n)},handled:!1,type:"instrument"}})])}}function xd(n){return function(...r){let a=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(f=>{f in a&&typeof a[f]=="function"&&ve(a,f,function(h){let b={mechanism:{data:{function:f,handler:ut(h)},handled:!1,type:"instrument"}},E=Zr(h);return E&&(b.mechanism.data.handler=ut(E)),Ht(h,b)})}),n.apply(this,r)}}function kd(n){let r=Q,a=r[n]&&r[n].prototype;!a||!a.hasOwnProperty||!a.hasOwnProperty("addEventListener")||(ve(a,"addEventListener",function(c){return function(f,h,b){try{typeof h.handleEvent=="function"&&(h.handleEvent=Ht(h.handleEvent,{mechanism:{data:{function:"handleEvent",handler:ut(h),target:n},handled:!1,type:"instrument"}}))}catch{}return c.apply(this,[f,Ht(h,{mechanism:{data:{function:"addEventListener",handler:ut(h),target:n},handled:!1,type:"instrument"}}),b])}}),ve(a,"removeEventListener",function(c){return function(f,h,b){let E=h;try{let O=E&&E.Ke;O&&c.call(this,f,O,b)}catch{}return c.call(this,f,E,b)}}))}let Td="GlobalHandlers",ha=((n={})=>{let r={onerror:!0,onunhandledrejection:!0,...n};return{name:Td,setupOnce(){Error.stackTraceLimit=50},setup(a){r.onerror&&(Cd(a),ma("onerror")),r.onunhandledrejection&&(Ad(a),ma("onunhandledrejection"))}}});function Cd(n){lc(r=>{let{stackParser:a,attachStacktrace:c}=ga();if(ue()!==n||Js())return;let{msg:f,url:h,line:b,column:E,error:O}=r,R=Dd(bi(a,O||f,void 0,c,!1),h,b,E);R.level="error",nr(R,{originalException:O,mechanism:{handled:!1,type:"onerror"}})})}function Ad(n){dc(r=>{let{stackParser:a,attachStacktrace:c}=ga();if(ue()!==n||Js())return;let f=Od(r),h=m(f)?Pd(f):bi(a,f,void 0,c,!0);h.level="error",nr(h,{originalException:f,mechanism:{handled:!1,type:"onunhandledrejection"}})})}function Od(n){if(m(n))return n;try{if("reason"in n)return n.reason;if("detail"in n&&"reason"in n.detail)return n.detail.reason}catch{}return n}function Pd(n){return{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(n)}`}]}}}function Dd(n,r,a,c){let f=n.exception=n.exception||{},h=f.values=f.values||[],b=h[0]=h[0]||{},E=b.stacktrace=b.stacktrace||{},O=E.frames=E.frames||[],R=isNaN(parseInt(c,10))?void 0:c,j=isNaN(parseInt(a,10))?void 0:a,$=d(r)&&r.length>0?r:je();return O.length===0&&O.push({colno:R,filename:$,function:qe,in_app:!0,lineno:j}),n}function ma(n){z.log(`Global Handler attached: ${n}`)}function ga(){let n=ue();return n&&n.getOptions()||{stackParser:()=>[],attachStacktrace:!1}}let ya=()=>({name:"HttpContext",preprocessEvent(n){if(!Q.navigator&&!Q.location&&!Q.document)return;let r=n.request&&n.request.url||Q.location&&Q.location.href,{referrer:a}=Q.document||{},{userAgent:c}=Q.navigator||{},f={...n.request&&n.request.headers,...a&&{Referer:a},...c&&{"User-Agent":c}},h={...n.request,...r&&{url:r},headers:f};n.request=h}}),Rd="cause",Md=5,Nd="LinkedErrors",va=((n={})=>{let r=n.limit||Md,a=n.key||Rd;return{name:Nd,preprocessEvent(c,f,h){let b=h.getOptions();M(or,b.stackParser,b.maxValueLength,a,r,c,f)}}});function ba(n){return[Ws(),Vs(),da(),fa(),ha(),va(),Gs(),ya()]}function Fd(n={}){return{...{defaultIntegrations:ba(),release:typeof __SENTRY_RELEASE__=="string"?__SENTRY_RELEASE__:Q.SENTRY_RELEASE&&Q.SENTRY_RELEASE.id?Q.SENTRY_RELEASE.id:void 0,autoSessionTracking:!0,sendClientReports:!0},...n}}function Ld(){let n=Q,r=n.chrome?"chrome":"browser",a=n[r],c=a&&a.runtime&&a.runtime.id,f=Q.location&&Q.location.href||"",h=["chrome-extension:","moz-extension:","ms-browser-extension:"],b=!!c&&Q===Q.top&&h.some(O=>f.startsWith(`${O}//`)),E=typeof n.nw<"u";return!!c&&!b&&!E}function Bd(n={}){let r=Fd(n);if(Ld()){De(()=>{console.error("[Sentry] You cannot run Sentry this way in a browser extension, check: https://docs.sentry.io/platforms/javascript/best-practices/browser-extensions/")});return}Go()||z.warn("No Fetch API detected. The Sentry SDK requires a Fetch API compatible environment to send events. Please add a Fetch API polyfill.");let a={...r,stackParser:tc(r.stackParser||ca),integrations:Xl(r),transport:r.transport||oa},c=rf(ea,a);return r.autoSessionTracking&&Ud(),c}function Kd(n={}){if(!Q.document){z.error("Global document not defined in showReportDialog call");return}let r=xe(),a=r.getClient(),c=a&&a.getDsn();if(!c){z.error("DSN not configured for showReportDialog call");return}if(r&&(n.user={...r.getUser(),...n.user}),!n.eventId){let E=Ps();E&&(n.eventId=E)}let f=Q.document.createElement("script");f.async=!0,f.crossOrigin="anonymous",f.src=Yl(c,n),n.onLoad&&(f.onload=n.onLoad);let{onClose:h}=n;if(h){let E=O=>{if(O.data==="__sentry_reportdialog_closed__")try{h()}finally{Q.removeEventListener("message",E)}};Q.addEventListener("message",E)}let b=Q.document.head||Q.document.body;b?b.appendChild(f):z.error("Not injecting report dialog. No injection point found in HTML")}function $d(){}function jd(n){n()}function Ud(){if(typeof Q.document>"u"){z.warn("Session tracking in non-browser environment with @sentry/browser is not supported.");return}rr({ignoreDuration:!0}),hi(),ra(({from:n,to:r})=>{n!==void 0&&n!==r&&(rr({ignoreDuration:!0}),hi())})}function Hd(n){let r=ue();r&&r.captureUserFeedback(n)}let Sm={replayIntegration:"replay",replayCanvasIntegration:"replay-canvas",feedbackIntegration:"feedback",feedbackModalIntegration:"feedback-modal",feedbackScreenshotIntegration:"feedback-screenshot",captureConsoleIntegration:"captureconsole",contextLinesIntegration:"contextlines",linkedErrorsIntegration:"linkederrors",debugIntegration:"debug",dedupeIntegration:"dedupe",extraErrorDataIntegration:"extraerrordata",httpClientIntegration:"httpclient",reportingObserverIntegration:"reportingobserver",rewriteFramesIntegration:"rewriteframes",sessionTimingIntegration:"sessiontiming",browserProfilingIntegration:"browserprofiling"},Im=Q;async function Vd(n){throw new Error("Disabled due to CWS Policy requirement.")}function xm(n){}return e.BrowserClient=ea,e.SDK_VERSION=F,e.SEMANTIC_ATTRIBUTE_SENTRY_OP=hs,e.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN=ms,e.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE=ps,e.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE=ds,e.Scope=et,e.WINDOW=Q,e.addBreadcrumb=tt,e.addEventProcessor=Vl,e.addIntegration=Zl,e.breadcrumbsIntegration=fa,e.browserApiErrorsIntegration=da,e.browserTracingIntegration=Af,e.captureEvent=nr,e.captureException=Is,e.captureMessage=$l,e.captureSession=hi,e.captureUserFeedback=Hd,e.chromeStackLineParser=sa,e.close=Ul,e.continueTrace=El,e.createTransport=$s,e.createUserFeedbackEnvelope=Zs,e.dedupeIntegration=Gs,e.defaultStackLineParsers=ua,e.defaultStackParser=ca,e.endSession=vn,e.eventFromException=Xs,e.eventFromMessage=Qs,e.exceptionFromError=or,e.feedbackAsyncIntegration=as,e.feedbackIntegration=as,e.flush=jl,e.forceLoad=$d,e.functionToStringIntegration=Vs,e.geckoStackLineParser=aa,e.getClient=ue,e.getCurrentHub=Tf,e.getCurrentScope=xe,e.getDefaultIntegrations=ba,e.getGlobalScope=fs,e.getIsolationScope=Ce,e.globalHandlersIntegration=ha,e.httpContextIntegration=ya,e.inboundFiltersIntegration=Ws,e.init=Bd,e.isInitialized=Hl,e.lastEventId=Ps,e.lazyLoadIntegration=Vd,e.linkedErrorsIntegration=va,e.makeFetchTransport=oa,e.metrics=Of,e.onLoad=jd,e.opera10StackLineParser=fd,e.opera11StackLineParser=pd,e.parameterize=sf,e.replayIntegration=zc,e.setContext=xs,e.setCurrentClient=Ks,e.setExtra=Ts,e.setExtras=ks,e.setTag=As,e.setTags=Cs,e.setUser=Os,e.showReportDialog=Kd,e.spanToBaggageHeader=yl,e.spanToJSON=gn,e.spanToTraceHeader=fl,e.startSession=rr,e.winjsStackLineParser=cd,e.withIsolationScope=il,e.withScope=tr,e})({});var Si,En,_a,Ea,Sa,Gd,Sn,be,we,_e,Ee,Ii,xi,lr,ki,Ia,xa,nt,fr;nt=function(e,t){var i,o;return i=(e&65535)+(t&65535),o=(e>>16)+(t>>16)+(i>>16),o<<16|i&65535};_a=function(e,t){return e<<t|e>>>32-t};Sn=function(e,t,i,o,s,u){return nt(_a(nt(nt(t,e),nt(o,u)),s),i)};be=function(e,t,i,o,s,u,l){return Sn(t&i|~t&o,e,t,s,u,l)};we=function(e,t,i,o,s,u,l){return Sn(t&o|i&~o,e,t,s,u,l)};_e=function(e,t,i,o,s,u,l){return Sn(t^i^o,e,t,s,u,l)};Ee=function(e,t,i,o,s,u,l){return Sn(i^(t|~o),e,t,s,u,l)};En=function(e,t){var i,o,s,u,l,d,p,m,y;for(e[t>>5]|=128<<t%32,e[(t+64>>>9<<4)+14]=t,l=void 0,d=void 0,p=void 0,m=void 0,y=void 0,i=1732584193,o=-271733879,s=-1732584194,u=271733878,l=0;l<e.length;)d=i,p=o,m=s,y=u,i=be(i,o,s,u,e[l],7,-680876936),u=be(u,i,o,s,e[l+1],12,-389564586),s=be(s,u,i,o,e[l+2],17,606105819),o=be(o,s,u,i,e[l+3],22,-1044525330),i=be(i,o,s,u,e[l+4],7,-176418897),u=be(u,i,o,s,e[l+5],12,1200080426),s=be(s,u,i,o,e[l+6],17,-1473231341),o=be(o,s,u,i,e[l+7],22,-45705983),i=be(i,o,s,u,e[l+8],7,1770035416),u=be(u,i,o,s,e[l+9],12,-1958414417),s=be(s,u,i,o,e[l+10],17,-42063),o=be(o,s,u,i,e[l+11],22,-1990404162),i=be(i,o,s,u,e[l+12],7,1804603682),u=be(u,i,o,s,e[l+13],12,-40341101),s=be(s,u,i,o,e[l+14],17,-1502002290),o=be(o,s,u,i,e[l+15],22,1236535329),i=we(i,o,s,u,e[l+1],5,-165796510),u=we(u,i,o,s,e[l+6],9,-1069501632),s=we(s,u,i,o,e[l+11],14,643717713),o=we(o,s,u,i,e[l],20,-373897302),i=we(i,o,s,u,e[l+5],5,-701558691),u=we(u,i,o,s,e[l+10],9,38016083),s=we(s,u,i,o,e[l+15],14,-660478335),o=we(o,s,u,i,e[l+4],20,-405537848),i=we(i,o,s,u,e[l+9],5,568446438),u=we(u,i,o,s,e[l+14],9,-1019803690),s=we(s,u,i,o,e[l+3],14,-187363961),o=we(o,s,u,i,e[l+8],20,1163531501),i=we(i,o,s,u,e[l+13],5,-1444681467),u=we(u,i,o,s,e[l+2],9,-51403784),s=we(s,u,i,o,e[l+7],14,1735328473),o=we(o,s,u,i,e[l+12],20,-1926607734),i=_e(i,o,s,u,e[l+5],4,-378558),u=_e(u,i,o,s,e[l+8],11,-2022574463),s=_e(s,u,i,o,e[l+11],16,1839030562),o=_e(o,s,u,i,e[l+14],23,-35309556),i=_e(i,o,s,u,e[l+1],4,-1530992060),u=_e(u,i,o,s,e[l+4],11,1272893353),s=_e(s,u,i,o,e[l+7],16,-155497632),o=_e(o,s,u,i,e[l+10],23,-1094730640),i=_e(i,o,s,u,e[l+13],4,681279174),u=_e(u,i,o,s,e[l],11,-358537222),s=_e(s,u,i,o,e[l+3],16,-722521979),o=_e(o,s,u,i,e[l+6],23,76029189),i=_e(i,o,s,u,e[l+9],4,-640364487),u=_e(u,i,o,s,e[l+12],11,-421815835),s=_e(s,u,i,o,e[l+15],16,530742520),o=_e(o,s,u,i,e[l+2],23,-995338651),i=Ee(i,o,s,u,e[l],6,-198630844),u=Ee(u,i,o,s,e[l+7],10,1126891415),s=Ee(s,u,i,o,e[l+14],15,-1416354905),o=Ee(o,s,u,i,e[l+5],21,-57434055),i=Ee(i,o,s,u,e[l+12],6,1700485571),u=Ee(u,i,o,s,e[l+3],10,-1894986606),s=Ee(s,u,i,o,e[l+10],15,-1051523),o=Ee(o,s,u,i,e[l+1],21,-2054922799),i=Ee(i,o,s,u,e[l+8],6,1873313359),u=Ee(u,i,o,s,e[l+15],10,-30611744),s=Ee(s,u,i,o,e[l+6],15,-1560198380),o=Ee(o,s,u,i,e[l+13],21,1309151649),i=Ee(i,o,s,u,e[l+4],6,-145523070),u=Ee(u,i,o,s,e[l+11],10,-1120210379),s=Ee(s,u,i,o,e[l+2],15,718787259),o=Ee(o,s,u,i,e[l+9],21,-343485551),i=nt(i,d),o=nt(o,p),s=nt(s,m),u=nt(u,y),l+=16;return[i,o,s,u]};Si=function(e){var t,i,o;for(t=void 0,o="",i=e.length*32,t=0;t<i;)o+=String.fromCharCode(e[t>>5]>>>t%32&255),t+=8;return o};lr=function(e){var t,i,o;for(t=void 0,o=[],o[(e.length>>2)-1]=void 0,t=0;t<o.length;)o[t]=0,t+=1;for(i=e.length*8,t=0;t<i;)o[t>>5]|=(e.charCodeAt(t/8)&255)<<t%32,t+=8;return o};xa=function(e){return Si(En(lr(e),e.length*8))};Ia=function(e,t){var i,o,s,u,l;for(s=void 0,i=lr(e),u=[],l=[],o=void 0,u[15]=l[15]=void 0,i.length>16&&(i=En(i,e.length*8)),s=0;s<16;)u[s]=i[s]^909522486,l[s]=i[s]^1549556828,s+=1;return o=En(u.concat(lr(t)),512+t.length*8),Si(En(l.concat(o),640))};ki=function(e){var t,i,o,s;for(t="0123456789abcdef",o="",s=void 0,i=void 0,i=0;i<e.length;)s=e.charCodeAt(i),o+=t.charAt(s>>>4&15)+t.charAt(s&15),i+=1;return o};fr=function(e){return unescape(encodeURIComponent(e))};xi=function(e){return xa(fr(e))};Sa=function(e){return ki(xi(e))};Ii=function(e,t){return Ia(fr(e),fr(t))};Ea=function(e,t){return ki(Ii(e,t))};var zd=Gd=function(e,t,i){return t?i?Ii(t,e):Ea(t,e):i?xi(e):Sa(e)},In=zd;var kt=_n,Ti=!1;var Wt=(e,t)=>async(...i)=>{try{return await e(...i)}catch(o){kt.captureException(o),console.error(o),t&&t(o)}};async function xn(e){return(await chrome.storage.local.get(e)||{})[e]}async function qd(){let e=await xn(k.ne);try{if(!e||(e?.lastUpdated||0)+(e?.validity||0)<Date.now()){U("Fetching sentry filter...")();let t=Be().extVersionFull,i=await fetch(k.Ae.replace("%VERSION%",t),{cache:"reload"});if(i.status===200){e=await i.json(),e.lastUpdated=Date.now();let o={};o[k.ne]=e,await chrome.storage.local.set(o)}}}catch{}return e||{}}function Yd(e,t,i){if(e.action==="deny all")return U("Error reporting is 'deny all'")(),!0;if(e.action==="filter"&&e.patterns){se&&(i&&console.log(i),t&&console.log(t));let o=!1;for(let s of e.patterns){if(s.hash&&s.hash===t)U("Sentry filter matched hash: "+t)(),o=!0;else if(s.regex&&i){let[,u,l]=s.regex.match(/^\/(.+)\/(.*)$/)||[];o=u&&i.match(new RegExp(u,l))!==null,o&&U("Sentry filter matched regex: "+s.regex)()}if(o){let u=s.rate||1;if(Math.random()>u)return U("Sentry filter matched a rate-limited pattern with rate: "+u)(),`[x${Math.round(1/(1-u)*10)/10}]`;break}}return o}else return!1}async function Jd(e){let t=await xn(k.k),i=await xn(k.b),o=await xn(k.t)=="true";return e.tags={...e.tags||{}},t&&(e.tags.UUID=t),i&&(e.tags.Serial=i),e.tags.Pro=o,e}function Xd(){let e=chrome.runtime.id;return!["mcbpblocgmgfnpjjppndjkmgjaogfceg","kmmldmlijnljnnhagfldmihaimmholga","pbjmgmedeliohhbaefhlplndokcbmjio","fcbmiimfkmkkkffjlopcpdlgclncnkn","fireshot-beta@getfireshot.com","{0b457cAA-602d-484a-8fe7-c1d894a011ba}","{5e11ab1e-083c-11e5-a6c0-1697f925ec7b}","com.getfireshot.fireshot.extension (83PVANDQL9)"].includes(e)}async function Qd(){return chrome.runtime.id==="fireshot-beta@getfireshot.com"||chrome.runtime.id==="{0b457cAA-602d-484a-8fe7-c1d894a011ba}"?(await browser.permissions.getAll())?.data_collection?.includes("technicalAndInteraction")?"true":"false":xn(k.Se)}function ka(){(self||window).nw={},Ti=!0;function e(t){function i(o){U("Reporting error...")();let s={body:o.body,method:"POST",referrerPolicy:"origin",headers:t.headers,...t.fetchOptions};return fetch(t.url,s).then(u=>({statusCode:u.status,headers:{"x-sentry-rate-limits":u.headers.get("X-Sentry-Rate-Limits"),"retry-after":u.headers.get("Retry-After")}}))}return kt.createTransport(t,i)}kt.init({dsn:"https://a45606e8915fe486ea11781be7653734@o4507590541901824.ingest.us.sentry.io/4507590546096128",release:"head@"+Be().extVersionFull,debug:se,autoSessionTracking:!1,transport:e,integrations:[],beforeSend:t=>Qd().then(i=>i==="false"?(se&&(U(t)(),U("Sentry is disabled")()),null):Xd()?(U("Extension not recognized, skipping error report")(),null):new Promise(o=>{let s=(u,l)=>{t.breadcrumbs=[{level:u,timestamp:Date.now()/1e3,message:l},...t.breadcrumbs||[]]};try{let u,l,d=t?.exception?.values?.slice(-1).pop();if(d){let m=d.stacktrace?.frames;if(m?.length>0){let y=m.map(_=>({filename:_.filename,lineno:_.lineno,colno:_.colno,function:_.function})),g=JSON.stringify(y);u=In(g),s("debug",g),s("info",`FSHASH: ${u}`)}l=d.type.trim()+": "+d.value.trim()}!u&&!l&&o(t);let p=qd().then(m=>{let y=Yd(m,u,l);if(typeof y=="string"){let g=y;t.message&&(t.message=`${g} ${t.message}`),t.exception&&t.exception.values&&t.exception.values.forEach(_=>{_.value&&(_.value=`${g} ${_.value}`)}),y=!1}return y?null:Jd(t)}).catch(m=>(s("debug",m.message+" "+m.stack),t));o(p)}catch(u){s("debug",u.message+" "+u.stack),o(t)}}))})}function kn(e){Ti&&kt.addBreadcrumb({message:e})}function Ta(e,t){Ti&&kt.captureMessage(e,t)}function re(e,t){return rt.getOption(e,t)}function ee(e,t){rt.setOption(e,t+"")}var rt={storage:{},onChanged:{listeners:[],addListener(e){this.listeners.indexOf(e)===-1&&this.listeners.push(e)},removeListener(e){this.listeners=this.listeners.filter(t=>t!==e)},notifyListeners(e){this.listeners.forEach(t=>{try{t(e)}catch{}})}},initPromise:null,inited:!1,onInit:null,assignOptions:function(e){this.storage={...this.storage,...e},chrome.storage.local.set(e)},ensureLoaded:function(){return this.initPromise=this.initPromise||new Promise(e=>{chrome.storage.onChanged.addListener((i,o)=>{if(o==="local"){let s=Object.keys(i);for(let u of s)this.storage[u]=i[u].newValue;this.inited&&this.onChanged.notifyListeners(i)}});let t=i=>{this.inited=!0,i&&(this.storage=i),this.onInit?this.onInit().then(()=>this.onInit=null).finally(e):e()};chrome.storage.local.get(null,i=>{chrome.runtime.lastError&&console.error(chrome.runtime.lastError),i?t(i):(console.log("chrome.storage.local.get failed to obtain preferences"),setTimeout(()=>chrome.storage.local.get(null,s=>{!s&&console.log("chrome.storage.local.get failed to obtain preferences for the second time"),t(s)}),500))})}),this.initPromise},setOption:function(e,t){if(!this.inited)console.error(`Preferences were not initialized yet! (setOption(${e}))`);else{var i={};i[e]=t,chrome.storage.local.set(i),this.storage[e]=t}},getOption:function(e,t){if(!this.inited)console.error(`Preferences were not initialized yet! (getOption(${e}))`);else return typeof this.storage[e]>"u"?t:this.storage[e]}};function zt(){return/^win/i.test(navigator.platform)}function Ca(){return/^mac/i.test(navigator.platform)}function Aa(){return/opr\/\d+\./i.test(navigator.appVersion)||chrome.runtime.id==="pbjmgmedeliohhbaefhlplndokcbmjio"}function dr(){return/edg\/\d+\./i.test(navigator.appVersion)||chrome.runtime.id==="fcbmiimfkmkkkffjlopcpdlgclncnknm"}function Re(){return typeof browser<"u"&&typeof browser.runtime<"u"&&typeof browser.runtime.getBrowserInfo>"u"}function Me(){return typeof browser<"u"&&typeof browser.runtime?.getBrowserInfo=="function"}function Ai(){return Aa()?"op":dr()?"edge":Re()?"safari":Me()?"fx":"ch"}function Zd(){var e=chrome.runtime.id;if(e==="legfpnnmhhnhjgekmmbkilmijnjoehne")return Aa()?"opera":dr()?"edge":"chrome";let t=["pbjmgmedeliohhbaefhlplndokcbmjio"],i=["fireshot@getfireshot.com","fireshot-pro@getfireshot.com","fireshot-beta@getfireshot.com","{0b457cAA-602d-484a-8fe7-c1d894a011ba}","{5e11ab1e-083c-11e5-a6c0-1697f925ec7b}"],o=["fcbmiimfkmkkkffjlopcpdlgclncnknm"];return t.indexOf(e)>-1?"opera":i.indexOf(e)>-1?"firefox":o.indexOf(e)>-1?"edge":"chrome"}var ep=Zd(),Gt={contractId:{chrome:"com.getfireshot.api",opera:"com.getfireshot.api",edge:"com.getfireshot.api",firefox:"com.getfireshot.api.firefox"},nativeFilePath:{chrome:"fireshot-chrome-plugin.dat",opera:"fireshot-chrome-plugin.dat",edge:"fireshot-chrome-plugin.dat",firefox:"fireshot-chrome-plugin.dat"}};for(Ci in Gt)Gt[Ci]=Gt[Ci][ep];var Ci;function tp(){chrome.scripting||(chrome.scripting={}),chrome.scripting.executeScript||(chrome.scripting.executeScript=function(e){return new Promise((t,i)=>{let o=e.target?.tabId,s=(e.target?.frameIds||[void 0])[0],u=e.target?.allFrames,l={};if(s!==void 0&&(l.frameId=s),u!==void 0&&(l.allFrames=u),!o){i(new Error("chrome.scripting.executeScript polyfill: Missing target.tabId"));return}if(e.files&&e.files.length>0){let d=[],p=m=>{if(m>=e.files.length){t(d);return}chrome.tabs.executeScript(o,{file:e.files[m],runAt:"document_start",...l},y=>{d.push(y),p(m+1)})};p(0);return}if(e.func){let d;e.args&&e.args.length>0?d=`(${e.func})(${e.args.map(p=>JSON.stringify(p)).join(",")});`:d=`(${e.func})();`,chrome.tabs.executeScript(o,{code:d}).then(t).catch(i);return}i(new Error("chrome.scripting.executeScript polyfill: No files or func provided"))})}),chrome.scripting.insertCSS||(chrome.scripting.insertCSS=function({target:e,files:t,css:i}){return new Promise((o,s)=>{if(!e||!e.tabId){s(new Error("chrome.scripting.insertCSS: target.tabId is required"));return}if(t&&t.length){let u=t.length;t.forEach(l=>{chrome.tabs.insertCSS(e.tabId,{file:l},()=>{chrome.runtime.lastError&&console.warn(chrome.runtime.lastError),--u===0&&o()})})}else i?chrome.tabs.insertCSS(e.tabId,{code:i},()=>{chrome.runtime.lastError&&console.warn(chrome.runtime.lastError),o()}):s(new Error("chrome.scripting.insertCSS: either files[] or css is required"))})})}function np(){if(!chrome.alarms){let i=function(s){if(t.length){let u={name:s,scheduledTime:Date.now()};t.forEach(l=>l(u))}},e={},t=[],o={create(s,u={}){this.clear(s);let l=Date.now(),d,p;u.when?d=u.when-l:u.delayInMinutes&&(d=u.delayInMinutes*60*1e3),u.periodInMinutes&&(p=u.periodInMinutes*60*1e3),d<0&&(d=0);function m(){i(s),p&&(e[s].id=setTimeout(m,p))}let y=d>0?d:p;y>0?e[s]={id:setTimeout(m,y),period:p}:console.error("Error in setting alarm, none of delay or period specified")},clear(s,u=l=>{}){e[s]?(clearTimeout(e[s].id),delete e[s],u(!0)):u(!1)},clearAll(s=u=>{}){Object.keys(e).forEach(u=>clearTimeout(e[u].id));for(let u in e)delete e[u];s(!0)},get(s,u=l=>{}){e[s]?u({name:s,scheduledTime:Date.now()}):u(void 0)},getAll(s=u=>{}){let u=Object.keys(e).map(l=>({name:l,scheduledTime:Date.now()}));s(u)},onAlarm:{addListener(s){t.push(s)},removeListener(s){let u=t.indexOf(s);u>=0&&t.splice(u,1)}}};chrome.alarms=o}}function rp(){if(!chrome.action){let e={setBadgeBackgroundColor:t=>{browser.browserAction.setBadgeBackgroundColor(t)},setBadgeTextColor:(t,i)=>{Re()?i&&i():browser.browserAction.setBadgeTextColor(t).then(i)},setBadgeText:(t,i)=>{chrome.browserAction.setBadgeText(t,i)},setIcon:(t,i)=>{chrome.browserAction.setIcon(t,i)}};chrome.action=e}}Me()&&(window.chrome=window.browser);tp();np();rp();var ip=0,op=1,Tn={port:void 0,ready:!1,autoReconnect:!1,updating:!1,updated:!1,ignoreResponse:!1,portBusy:!1,callback:void 0,callbackDisconnected:void 0,prevVersion:void 0,updateTrials:0,pendingData:"",firstPacket:!0,onNativeHostUpdated:null,onPluginEvent:null,init:function(e,t,i,o){this.onNativeHostUpdated=t,this.onPluginEvent=e;let s=u=>{if(this.ignoreResponse){U("Ignored response: "+JSON.stringify(u))(),u.topic==="status"&&u.code==op&&(this.updating=!1,this.autoReconnect=!1,e&&e(u));return}this.autoReconnect=!1,!this.processInternally(u)&&e&&e(u)};this.callback=i,this.callbackDisconnected=o,this.ignoreResponse=!1,this.portBusy=!0;try{this.port=chrome.runtime.connectNative(Gt.contractId+"")}catch(u){Tt(u.message),this.portBusy=!1}this.port.onMessage.addListener(u=>{if(u.data!=="")this.pendingData+=u.data;else try{let l=JSON.parse(this.pendingData);se&&U("Original Packet: "+this.pendingData.substring(0,1024))(),this.pendingData="",s(l)}catch(l){U("Raw packet data triggered error:",this.pendingData.substring(0,1024))(),kt.captureException(l),this.pendingData="",Tt(l.message)}}),this.port.onDisconnect.addListener(()=>{chrome.runtime.lastError&&console.log("ERROR: "+chrome.runtime.lastError.message),this.ready=!1,this.portBusy=!1,ee(k.T,"false"),!this.updating&&this.callbackDisconnected&&this.callbackDisconnected(),U("Native port disconnected.")(),this.firstPacket=!0,this.pendingData="",this.autoReconnect&&this.doReconnect()}),U("Native port created successfully. Starting test...")(),this.launchJSON({JSONCommand:"ping",version:Be().extVersionFull,id:Cn})},processInternally:function(e){if(e.topic=="hostVersion"){if(this.hostVersion=e.data,Be().extVersion!=this.hostVersion)return++this.updateTrials>3?(U("Too much of unsuccessful update trials. No updates anymore.")(),this.updating=!1,!1):(this.prevVersion=this.hostVersion,this.doUpdate(),!0)}else if(e.topic=="status")if(e.code==ip){var t=e.data;return this.updateTrials=0,this.ready=!0,ee(k.T,"true"),this.callback&&(this.callback(),this.callback=void 0),this.updating&&(this.updated=!0,this.updating=!1,this.prevVersion!="0"&&this.onNativeHostUpdated(t)),!1}else return this.updating&&(this.updating=!1),!1;else if(e.topic=="getDLL")return this.sendDLL(e.x64),!0;return!1},launchJSON:function(e){this.port.postMessage(e)},getFile:function(e,t){let i=()=>{let o=!0;if(e.search(/sss-x64\.dat|sss\.dat|fireshot-chrome-plugin\.dat/)!==-1){let s=Be().extVersionFull,u=k.Ce+s,l=parseInt(rt.getOption(u,"0"));l<3?(U("Opening helper installer page.")(),o=!1,rt.setOption(u,l+1),Oa("https://getfireshot.com/helper-install.php?ver="+s)):U("Helper installer page cannot be shown more than 3 times, aborting.")()}return o};U("Fetching: "+e)(),fetch(chrome.runtime.getURL(e)).then(o=>{U(`Fetching status = [${o.status}]`)(),o.ok?o.blob().then(s=>{U(`Blob size is ${s.size} bytes`)();let u=new FileReader;u.onload=l=>{U("Fetching complete")();let d="base64,";t(l.target.result.substr(l.target.result.indexOf(d)+d.length,l.target.result.length))},u.onerror=()=>{U("Error in FileReader")()},u.readAsDataURL(s)}).catch(s=>{i()&&reportError(s)}):(U("NativeError-Error retrieving file")(),Ta(`Error retrieving file: ${o.status}`))}).catch(o=>{i()&&reportError(o)})},sendDLL:function(e){this.getFile(`native/${e?"sss-x64.dat":"sss.dat"}`,t=>{t&&this.launchJSON({JSONCommand:"updateDLL",version:Be().extVersionFull,data:t})})},doUpdate:function(){let e=Be().extVersionFull;U("Updating native to the version: "+e)(),this.ignoreResponse=!0,this.getFile("native/"+Gt.nativeFilePath,t=>{this.updating=!0,this.autoReconnect=!0,this.launchJSON({JSONCommand:"updateNative",version:e,data:t})})},doReconnect:function(){setTimeout(()=>{U("Trying to reconnect...")(),this.init(this.onPluginEvent,this.onNativeHostUpdated,this.callback,this.callbackDisconnected)},1e3)},forceDisconnect:function(){this.autoReconnect=!1,this.port&&this.port.disconnect(),this.ready=!1,ee(k.T,"false")}};var Ki=function(e,t){return Ki=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(i[s]=o[s])},Ki(e,t)};function sp(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Ki(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}var J=function(){return J=Object.assign||function(t){for(var i,o=1,s=arguments.length;o<s;o++){i=arguments[o];for(var u in i)Object.prototype.hasOwnProperty.call(i,u)&&(t[u]=i[u])}return t},J.apply(this,arguments)};function kr(e,t,i){if(i||arguments.length===2)for(var o=0,s=t.length,u;o<s;o++)(u||!(o in t))&&(u||(u=Array.prototype.slice.call(t,0,o)),u[o]=t[o]);return e.concat(u||Array.prototype.slice.call(t))}var Se=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,ye=Object.keys,le=Array.isArray;typeof Promise<"u"&&!Se.Promise&&(Se.Promise=Promise);function $e(e,t){return typeof t!="object"||ye(t).forEach(function(i){e[i]=t[i]}),e}var Zt=Object.getPrototypeOf,ap={}.hasOwnProperty;function Fe(e,t){return ap.call(e,t)}function en(e,t){typeof t=="function"&&(t=t(Zt(e))),(typeof Reflect>"u"?ye:Reflect.ownKeys)(t).forEach(function(i){mt(e,i,t[i])})}var qa=Object.defineProperty;function mt(e,t,i,o){qa(e,t,$e(i&&Fe(i,"get")&&typeof i.get=="function"?{get:i.get,set:i.set,configurable:!0}:{value:i,configurable:!0,writable:!0},o))}function nn(e){return{from:function(t){return e.prototype=Object.create(t.prototype),mt(e.prototype,"constructor",e),{extend:en.bind(null,e.prototype)}}}}var up=Object.getOwnPropertyDescriptor;function Ya(e,t){var i=up(e,t),o;return i||(o=Zt(e))&&Ya(o,t)}var cp=[].slice;function Br(e,t,i){return cp.call(e,t,i)}function Ja(e,t){return t(e)}function An(e){if(!e)throw new Error("Assertion Failed")}function Xa(e){Se.setImmediate?setImmediate(e):setTimeout(e,0)}function lp(e,t){return e.reduce(function(i,o,s){var u=t(o,s);return u&&(i[u[0]]=u[1]),i},{})}function st(e,t){if(typeof t=="string"&&Fe(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var i=[],o=0,s=t.length;o<s;++o){var u=st(e,t[o]);i.push(u)}return i}var l=t.indexOf(".");if(l!==-1){var d=e[t.substr(0,l)];return d==null?void 0:st(d,t.substr(l+1))}}function Ne(e,t,i){if(!(!e||t===void 0)&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){An(typeof i!="string"&&"length"in i);for(var o=0,s=t.length;o<s;++o)Ne(e,t[o],i[o])}else{var u=t.indexOf(".");if(u!==-1){var l=t.substr(0,u),d=t.substr(u+1);if(d==="")i===void 0?le(e)&&!isNaN(parseInt(l))?e.splice(l,1):delete e[l]:e[l]=i;else{var p=e[l];(!p||!Fe(e,l))&&(p=e[l]={}),Ne(p,d,i)}}else i===void 0?le(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=i}}function fp(e,t){typeof t=="string"?Ne(e,t,void 0):"length"in t&&[].map.call(t,function(i){Ne(e,i,void 0)})}function Qa(e){var t={};for(var i in e)Fe(e,i)&&(t[i]=e[i]);return t}var dp=[].concat;function Za(e){return dp.apply([],e)}var pp="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Za([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return Se[e]}),eu=new Set(pp.map(function(e){return Se[e]}));function tu(e){var t={};for(var i in e)if(Fe(e,i)){var o=e[i];t[i]=!o||typeof o!="object"||eu.has(o.constructor)?o:tu(o)}return t}function hp(e){for(var t in e)if(Fe(e,t))return!1;return!0}var Pn=null;function Nt(e){Pn=new WeakMap;var t=$i(e);return Pn=null,t}function $i(e){if(!e||typeof e!="object")return e;var t=Pn.get(e);if(t)return t;if(le(e)){t=[],Pn.set(e,t);for(var i=0,o=e.length;i<o;++i)t.push($i(e[i]))}else if(eu.has(e.constructor))t=e;else{var s=Zt(e);t=s===Object.prototype?{}:Object.create(s),Pn.set(e,t);for(var u in e)Fe(e,u)&&(t[u]=$i(e[u]))}return t}var mp={}.toString;function ji(e){return mp.call(e).slice(8,-1)}var Ui=typeof Symbol<"u"?Symbol.iterator:"@@iterator",gp=typeof Ui=="symbol"?function(e){var t;return e!=null&&(t=e[Ui])&&t.apply(e)}:function(){return null};function Ct(e,t){var i=e.indexOf(t);return i>=0&&e.splice(i,1),i>=0}var Jt={};function ot(e){var t,i,o,s;if(arguments.length===1){if(le(e))return e.slice();if(this===Jt&&typeof e=="string")return[e];if(s=gp(e)){for(i=[];o=s.next(),!o.done;)i.push(o.value);return i}if(e==null)return[e];if(t=e.length,typeof t=="number"){for(i=new Array(t);t--;)i[t]=e[t];return i}return[e]}for(t=arguments.length,i=new Array(t);t--;)i[t]=arguments[t];return i}var no=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},yp=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],nu=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],ro=yp.concat(nu),vp={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function rn(e,t){this.name=e,this.message=t}nn(rn).from(Error).extend({toString:function(){return this.name+": "+this.message}});function ru(e,t){return e+". Errors: "+Object.keys(t).map(function(i){return t[i].toString()}).filter(function(i,o,s){return s.indexOf(i)===o}).join(`
`)}function Tr(e,t,i,o){this.failures=t,this.failedKeys=o,this.successCount=i,this.message=ru(e,t)}nn(Tr).from(rn);function Xt(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(i){return t[i]}),this.failuresByPos=t,this.message=ru(e,this.failures)}nn(Xt).from(rn);var io=ro.reduce(function(e,t){return e[t]=t+"Error",e},{}),bp=rn,q=ro.reduce(function(e,t){var i=t+"Error";function o(s,u){this.name=i,s?typeof s=="string"?(this.message="".concat(s).concat(u?`
 `+u:""),this.inner=u||null):typeof s=="object"&&(this.message="".concat(s.name," ").concat(s.message),this.inner=s):(this.message=vp[t]||i,this.inner=null)}return nn(o).from(bp),e[t]=o,e},{});q.Syntax=SyntaxError;q.Type=TypeError;q.Range=RangeError;var Pa=nu.reduce(function(e,t){return e[t+"Error"]=q[t],e},{});function wp(e,t){if(!e||e instanceof rn||e instanceof TypeError||e instanceof SyntaxError||!e.name||!Pa[e.name])return e;var i=new Pa[e.name](t||e.message,e);return"stack"in e&&mt(i,"stack",{get:function(){return this.inner.stack}}),i}var Kr=ro.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=q[t]),e},{});Kr.ModifyError=Tr;Kr.DexieError=rn;Kr.BulkError=Xt;function oe(){}function Bn(e){return e}function _p(e,t){return e==null||e===Bn?t:function(i){return t(e(i))}}function Ft(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function Ep(e,t){return e===oe?t:function(){var i=e.apply(this,arguments);i!==void 0&&(arguments[0]=i);var o=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var u=t.apply(this,arguments);return o&&(this.onsuccess=this.onsuccess?Ft(o,this.onsuccess):o),s&&(this.onerror=this.onerror?Ft(s,this.onerror):s),u!==void 0?u:i}}function Sp(e,t){return e===oe?t:function(){e.apply(this,arguments);var i=this.onsuccess,o=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),i&&(this.onsuccess=this.onsuccess?Ft(i,this.onsuccess):i),o&&(this.onerror=this.onerror?Ft(o,this.onerror):o)}}function Ip(e,t){return e===oe?t:function(i){var o=e.apply(this,arguments);$e(i,o);var s=this.onsuccess,u=this.onerror;this.onsuccess=null,this.onerror=null;var l=t.apply(this,arguments);return s&&(this.onsuccess=this.onsuccess?Ft(s,this.onsuccess):s),u&&(this.onerror=this.onerror?Ft(u,this.onerror):u),o===void 0?l===void 0?void 0:l:$e(o,l)}}function xp(e,t){return e===oe?t:function(){return t.apply(this,arguments)===!1?!1:e.apply(this,arguments)}}function oo(e,t){return e===oe?t:function(){var i=e.apply(this,arguments);if(i&&typeof i.then=="function"){for(var o=this,s=arguments.length,u=new Array(s);s--;)u[s]=arguments[s];return i.then(function(){return t.apply(o,u)})}return t.apply(this,arguments)}}var Je=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function iu(e,t){Je=e}var Rn={},ou=100,so=typeof Promise>"u"?[]:(function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,Zt(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,Zt(t),e]})(),Da=so[0],Ra=so[1],kp=so[2],Tp=Ra&&Ra.then,At=Da&&Da.constructor,ao=!!kp;function Cp(){queueMicrotask(Op)}var Mn=function(e,t){On.push([e,t]),Cr&&(Cp(),Cr=!1)},Hi=!0,Cr=!0,Dt=[],br=[],Vi=Bn,ht={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:oe,pgp:!1,env:{},finalize:oe},W=ht,On=[],Rt=0,wr=[];function B(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=W;if(typeof e!="function"){if(e!==Rn)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Gi(this,this._value);return}this._state=null,this._value=null,++t.ref,au(this,e)}var Wi={get:function(){var e=W,t=Ar;function i(o,s){var u=this,l=!e.global&&(e!==W||t!==Ar),d=l&&!yt(),p=new B(function(m,y){uo(u,new su(Ma(o,e,l,d),Ma(s,e,l,d),m,y,e))});return this._consoleTask&&(p._consoleTask=this._consoleTask),p}return i.prototype=Rn,i},set:function(e){mt(this,"then",e&&e.prototype===Rn?Wi:{get:function(){return e},set:Wi.set})}};en(B.prototype,{then:Wi,_then:function(e,t){uo(this,new su(null,null,e,t,W))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=arguments[0],i=arguments[1];return typeof t=="function"?this.then(null,function(o){return o instanceof t?i(o):_r(o)}):this.then(null,function(o){return o&&o.name===t?i(o):_r(o)})},finally:function(e){return this.then(function(t){return B.resolve(e()).then(function(){return t})},function(t){return B.resolve(e()).then(function(){return _r(t)})})},timeout:function(e,t){var i=this;return e<1/0?new B(function(o,s){var u=setTimeout(function(){return s(new q.Timeout(t))},e);i.then(o,s).finally(clearTimeout.bind(null,u))}):this}});typeof Symbol<"u"&&Symbol.toStringTag&&mt(B.prototype,Symbol.toStringTag,"Dexie.Promise");ht.env=cu();function su(e,t,i,o,s){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=i,this.reject=o,this.psd=s}en(B,{all:function(){var e=ot.apply(null,arguments).map(Or);return new B(function(t,i){e.length===0&&t([]);var o=e.length;e.forEach(function(s,u){return B.resolve(s).then(function(l){e[u]=l,--o||t(e)},i)})})},resolve:function(e){if(e instanceof B)return e;if(e&&typeof e.then=="function")return new B(function(i,o){e.then(i,o)});var t=new B(Rn,!0,e);return t},reject:_r,race:function(){var e=ot.apply(null,arguments).map(Or);return new B(function(t,i){e.map(function(o){return B.resolve(o).then(t,i)})})},PSD:{get:function(){return W},set:function(e){return W=e}},totalEchoes:{get:function(){return Ar}},newPSD:gt,usePSD:Lt,scheduler:{get:function(){return Mn},set:function(e){Mn=e}},rejectionMapper:{get:function(){return Vi},set:function(e){Vi=e}},follow:function(e,t){return new B(function(i,o){return gt(function(s,u){var l=W;l.unhandleds=[],l.onunhandled=u,l.finalize=Ft(function(){var d=this;Pp(function(){d.unhandleds.length===0?s():u(d.unhandleds[0])})},l.finalize),e()},t,i,o)})}});At&&(At.allSettled&&mt(B,"allSettled",function(){var e=ot.apply(null,arguments).map(Or);return new B(function(t){e.length===0&&t([]);var i=e.length,o=new Array(i);e.forEach(function(s,u){return B.resolve(s).then(function(l){return o[u]={status:"fulfilled",value:l}},function(l){return o[u]={status:"rejected",reason:l}}).then(function(){return--i||t(o)})})})}),At.any&&typeof AggregateError<"u"&&mt(B,"any",function(){var e=ot.apply(null,arguments).map(Or);return new B(function(t,i){e.length===0&&i(new AggregateError([]));var o=e.length,s=new Array(o);e.forEach(function(u,l){return B.resolve(u).then(function(d){return t(d)},function(d){s[l]=d,--o||i(new AggregateError(s))})})})}),At.withResolvers&&(B.withResolvers=At.withResolvers));function au(e,t){try{t(function(i){if(e._state===null){if(i===e)throw new TypeError("A promise cannot be resolved with itself.");var o=e._lib&&on();i&&typeof i.then=="function"?au(e,function(s,u){i instanceof B?i._then(s,u):i.then(s,u)}):(e._state=!0,e._value=i,uu(e)),o&&sn()}},Gi.bind(null,e))}catch(i){Gi(e,i)}}function Gi(e,t){if(br.push(t),e._state===null){var i=e._lib&&on();t=Vi(t),e._state=!1,e._value=t,Dp(e),uu(e),i&&sn()}}function uu(e){var t=e._listeners;e._listeners=[];for(var i=0,o=t.length;i<o;++i)uo(e,t[i]);var s=e._PSD;--s.ref||s.finalize(),Rt===0&&(++Rt,Mn(function(){--Rt===0&&co()},[]))}function uo(e,t){if(e._state===null){e._listeners.push(t);return}var i=e._state?t.onFulfilled:t.onRejected;if(i===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Rt,Mn(Ap,[i,e,t])}function Ap(e,t,i){try{var o,s=t._value;!t._state&&br.length&&(br=[]),o=Je&&t._consoleTask?t._consoleTask.run(function(){return e(s)}):e(s),!t._state&&br.indexOf(s)===-1&&Rp(t),i.resolve(o)}catch(u){i.reject(u)}finally{--Rt===0&&co(),--i.psd.ref||i.psd.finalize()}}function Op(){Lt(ht,function(){on()&&sn()})}function on(){var e=Hi;return Hi=!1,Cr=!1,e}function sn(){var e,t,i;do for(;On.length>0;)for(e=On,On=[],i=e.length,t=0;t<i;++t){var o=e[t];o[0].apply(null,o[1])}while(On.length>0);Hi=!0,Cr=!0}function co(){var e=Dt;Dt=[],e.forEach(function(o){o._PSD.onunhandled.call(null,o._value,o)});for(var t=wr.slice(0),i=t.length;i;)t[--i]()}function Pp(e){function t(){e(),wr.splice(wr.indexOf(t),1)}wr.push(t),++Rt,Mn(function(){--Rt===0&&co()},[])}function Dp(e){Dt.some(function(t){return t._value===e._value})||Dt.push(e)}function Rp(e){for(var t=Dt.length;t;)if(Dt[--t]._value===e._value){Dt.splice(t,1);return}}function _r(e){return new B(Rn,!1,e)}function ce(e,t){var i=W;return function(){var o=on(),s=W;try{return vt(i,!0),e.apply(this,arguments)}catch(u){t&&t(u)}finally{vt(s,!1),o&&sn()}}}var ge={awaits:0,echoes:0,id:0},Mp=0,Er=[],Sr=0,Ar=0,Np=0;function gt(e,t,i,o){var s=W,u=Object.create(s);u.parent=s,u.ref=0,u.global=!1,u.id=++Np,ht.env,u.env=ao?{Promise:B,PromiseProp:{value:B,configurable:!0,writable:!0},all:B.all,race:B.race,allSettled:B.allSettled,any:B.any,resolve:B.resolve,reject:B.reject}:{},t&&$e(u,t),++s.ref,u.finalize=function(){--this.parent.ref||this.parent.finalize()};var l=Lt(u,e,i,o);return u.ref===0&&u.finalize(),l}function an(){return ge.id||(ge.id=++Mp),++ge.awaits,ge.echoes+=ou,ge.id}function yt(){return ge.awaits?(--ge.awaits===0&&(ge.id=0),ge.echoes=ge.awaits*ou,!0):!1}(""+Tp).indexOf("[native code]")===-1&&(an=yt=oe);function Or(e){return ge.echoes&&e&&e.constructor===At?(an(),e.then(function(t){return yt(),t},function(t){return yt(),fe(t)})):e}function Fp(e){++Ar,(!ge.echoes||--ge.echoes===0)&&(ge.echoes=ge.awaits=ge.id=0),Er.push(W),vt(e,!0)}function Lp(){var e=Er[Er.length-1];Er.pop(),vt(e,!1)}function vt(e,t){var i=W;if((t?ge.echoes&&(!Sr++||e!==W):Sr&&(!--Sr||e!==W))&&queueMicrotask(t?Fp.bind(null,e):Lp),e!==W&&(W=e,i===ht&&(ht.env=cu()),ao)){var o=ht.env.Promise,s=e.env;(i.global||e.global)&&(Object.defineProperty(Se,"Promise",s.PromiseProp),o.all=s.all,o.race=s.race,o.resolve=s.resolve,o.reject=s.reject,s.allSettled&&(o.allSettled=s.allSettled),s.any&&(o.any=s.any))}}function cu(){var e=Se.Promise;return ao?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(Se,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function Lt(e,t,i,o,s){var u=W;try{return vt(e,!0),t(i,o,s)}finally{vt(u,!1)}}function Ma(e,t,i,o){return typeof e!="function"?e:function(){var s=W;i&&an(),vt(t,!0);try{return e.apply(this,arguments)}finally{vt(s,!1),o&&queueMicrotask(yt)}}}function Oi(e){Promise===At&&ge.echoes===0?Sr===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}var fe=B.reject;function zi(e,t,i,o){if(!e.idbdb||!e._state.openComplete&&!W.letThrough&&!e._vip){if(e._state.openComplete)return fe(new q.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._state.autoOpen)return fe(new q.DatabaseClosed);e.open().catch(oe)}return e._state.dbReadyPromise.then(function(){return zi(e,t,i,o)})}else{var s=e._createTransaction(t,i,e._dbSchema);try{s.create(),e._state.PR1398_maxLoop=3}catch(u){return u.name===io.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then(function(){return zi(e,t,i,o)})):fe(u)}return s._promise(t,function(u,l){return gt(function(){return W.trans=s,o(u,l,s)})}).then(function(u){if(t==="readwrite")try{s.idbtrans.commit()}catch{}return t==="readonly"?u:s._completion.then(function(){return u})})}}var Na="4.2.1",Pt="\uFFFF",qi=-1/0,it="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",lu="String expected.",Qt=[],$r="__dbnames",Pi="readonly",Di="readwrite";function Bt(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var fu={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function pr(e){return typeof e=="string"&&!/\./.test(e)?function(t){return t[e]===void 0&&e in t&&(t=Nt(t),delete t[e]),t}:function(t){return t}}function Bp(){throw q.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Z(e,t){try{var i=Fa(e),o=Fa(t);if(i!==o)return i==="Array"?1:o==="Array"?-1:i==="binary"?1:o==="binary"?-1:i==="string"?1:o==="string"?-1:i==="Date"?1:o!=="Date"?NaN:-1;switch(i){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return $p(La(e),La(t));case"Array":return Kp(e,t)}}catch{}return NaN}function Kp(e,t){for(var i=e.length,o=t.length,s=i<o?i:o,u=0;u<s;++u){var l=Z(e[u],t[u]);if(l!==0)return l}return i===o?0:i<o?-1:1}function $p(e,t){for(var i=e.length,o=t.length,s=i<o?i:o,u=0;u<s;++u)if(e[u]!==t[u])return e[u]<t[u]?-1:1;return i===o?0:i<o?-1:1}function Fa(e){var t=typeof e;if(t!=="object")return t;if(ArrayBuffer.isView(e))return"binary";var i=ji(e);return i==="ArrayBuffer"?"binary":i}function La(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}function Ir(e,t,i){var o=e.schema.yProps;return o?(t&&i.numFailures>0&&(t=t.filter(function(s,u){return!i.failures[u]})),Promise.all(o.map(function(s){var u=s.updatesTable;return t?e.db.table(u).where("k").anyOf(t).delete():e.db.table(u).clear()})).then(function(){return i})):i}var jp=(function(){function e(t){this["@@propmod"]=t}return e.prototype.execute=function(t){var i,o=this["@@propmod"];if(o.add!==void 0){var s=o.add;if(le(s))return kr(kr([],le(t)?t:[],!0),s,!0).sort();if(typeof s=="number")return(Number(t)||0)+s;if(typeof s=="bigint")try{return BigInt(t)+s}catch{return BigInt(0)+s}throw new TypeError("Invalid term ".concat(s))}if(o.remove!==void 0){var u=o.remove;if(le(u))return le(t)?t.filter(function(d){return!u.includes(d)}).sort():[];if(typeof u=="number")return Number(t)-u;if(typeof u=="bigint")try{return BigInt(t)-u}catch{return BigInt(0)-u}throw new TypeError("Invalid subtrahend ".concat(u))}var l=(i=o.replacePrefix)===null||i===void 0?void 0:i[0];return l&&typeof t=="string"&&t.startsWith(l)?o.replacePrefix[1]+t.substring(l.length):t},e})();function du(e,t){for(var i=ye(t),o=i.length,s=!1,u=0;u<o;++u){var l=i[u],d=t[l],p=st(e,l);d instanceof jp?(Ne(e,l,d.execute(p)),s=!0):p!==d&&(Ne(e,l,d),s=!0)}return s}var pu=(function(){function e(){}return e.prototype._trans=function(t,i,o){var s=this._tx||W.trans,u=this.name,l=Je&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(t==="readonly"?"read":"write"," ").concat(this.name));function d(y,g,_){if(!_.schema[u])throw new q.NotFound("Table "+u+" not part of transaction");return i(_.idbtrans,_)}var p=on();try{var m=s&&s.db._novip===this.db._novip?s===W.trans?s._promise(t,d,o):gt(function(){return s._promise(t,d,o)},{trans:s,transless:W.transless||W}):zi(this.db,t,[this.name],d);return l&&(m._consoleTask=l,m=m.catch(function(y){return console.trace(y),fe(y)})),m}finally{p&&sn()}},e.prototype.get=function(t,i){var o=this;return t&&t.constructor===Object?this.where(t).first(i):t==null?fe(new q.Type("Invalid argument to Table.get()")):this._trans("readonly",function(s){return o.core.get({trans:s,key:t}).then(function(u){return o.hook.reading.fire(u)})}).then(i)},e.prototype.where=function(t){if(typeof t=="string")return new this.db.WhereClause(this,t);if(le(t))return new this.db.WhereClause(this,"[".concat(t.join("+"),"]"));var i=ye(t);if(i.length===1)return this.where(i[0]).equals(t[i[0]]);var o=this.schema.indexes.concat(this.schema.primKey).filter(function(y){if(y.compound&&i.every(function(_){return y.keyPath.indexOf(_)>=0})){for(var g=0;g<i.length;++g)if(i.indexOf(y.keyPath[g])===-1)return!1;return!0}return!1}).sort(function(y,g){return y.keyPath.length-g.keyPath.length})[0];if(o&&this.db._maxKey!==Pt){var s=o.keyPath.slice(0,i.length);return this.where(s).equals(s.map(function(y){return t[y]}))}!o&&Je&&console.warn("The query ".concat(JSON.stringify(t)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(i.join("+"),"]"));var u=this.schema.idxByName;function l(y,g){return Z(y,g)===0}var d=i.reduce(function(y,g){var _=y[0],S=y[1],v=u[g],w=t[g];return[_||v,_||!v?Bt(S,v&&v.multi?function(I){var T=st(I,g);return le(T)&&T.some(function(A){return l(w,A)})}:function(I){return l(w,st(I,g))}):S]},[null,null]),p=d[0],m=d[1];return p?this.where(p.name).equals(t[p.keyPath]).filter(m):o?this.filter(m):this.where(i).equals("")},e.prototype.filter=function(t){return this.toCollection().and(t)},e.prototype.count=function(t){return this.toCollection().count(t)},e.prototype.offset=function(t){return this.toCollection().offset(t)},e.prototype.limit=function(t){return this.toCollection().limit(t)},e.prototype.each=function(t){return this.toCollection().each(t)},e.prototype.toArray=function(t){return this.toCollection().toArray(t)},e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},e.prototype.orderBy=function(t){return new this.db.Collection(new this.db.WhereClause(this,le(t)?"[".concat(t.join("+"),"]"):t))},e.prototype.reverse=function(){return this.toCollection().reverse()},e.prototype.mapToClass=function(t){var i=this,o=i.db,s=i.name;this.schema.mappedClass=t,t.prototype instanceof Bp&&(t=(function(p){sp(m,p);function m(){return p!==null&&p.apply(this,arguments)||this}return Object.defineProperty(m.prototype,"db",{get:function(){return o},enumerable:!1,configurable:!0}),m.prototype.table=function(){return s},m})(t));for(var u=new Set,l=t.prototype;l;l=Zt(l))Object.getOwnPropertyNames(l).forEach(function(p){return u.add(p)});var d=function(p){if(!p)return p;var m=Object.create(t.prototype);for(var y in p)if(!u.has(y))try{m[y]=p[y]}catch{}return m};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=d,this.hook("reading",d),t},e.prototype.defineClass=function(){function t(i){$e(this,i)}return this.mapToClass(t)},e.prototype.add=function(t,i){var o=this,s=this.schema.primKey,u=s.auto,l=s.keyPath,d=t;return l&&u&&(d=pr(l)(t)),this._trans("readwrite",function(p){return o.core.mutate({trans:p,type:"add",keys:i!=null?[i]:null,values:[d]})}).then(function(p){return p.numFailures?B.reject(p.failures[0]):p.lastResult}).then(function(p){if(l)try{Ne(t,l,p)}catch{}return p})},e.prototype.upsert=function(t,i){var o=this,s=this.schema.primKey.keyPath;return this._trans("readwrite",function(u){return o.core.get({trans:u,key:t}).then(function(l){var d=l??{};return du(d,i),s&&Ne(d,s,t),o.core.mutate({trans:u,type:"put",values:[d],keys:[t],upsert:!0,updates:{keys:[t],changeSpecs:[i]}}).then(function(p){return p.numFailures?B.reject(p.failures[0]):!!l})})})},e.prototype.update=function(t,i){if(typeof t=="object"&&!le(t)){var o=st(t,this.schema.primKey.keyPath);return o===void 0?fe(new q.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(o).modify(i)}else return this.where(":id").equals(t).modify(i)},e.prototype.put=function(t,i){var o=this,s=this.schema.primKey,u=s.auto,l=s.keyPath,d=t;return l&&u&&(d=pr(l)(t)),this._trans("readwrite",function(p){return o.core.mutate({trans:p,type:"put",values:[d],keys:i!=null?[i]:null})}).then(function(p){return p.numFailures?B.reject(p.failures[0]):p.lastResult}).then(function(p){if(l)try{Ne(t,l,p)}catch{}return p})},e.prototype.delete=function(t){var i=this;return this._trans("readwrite",function(o){return i.core.mutate({trans:o,type:"delete",keys:[t]}).then(function(s){return Ir(i,[t],s)}).then(function(s){return s.numFailures?B.reject(s.failures[0]):void 0})})},e.prototype.clear=function(){var t=this;return this._trans("readwrite",function(i){return t.core.mutate({trans:i,type:"deleteRange",range:fu}).then(function(o){return Ir(t,null,o)})}).then(function(i){return i.numFailures?B.reject(i.failures[0]):void 0})},e.prototype.bulkGet=function(t){var i=this;return this._trans("readonly",function(o){return i.core.getMany({keys:t,trans:o}).then(function(s){return s.map(function(u){return i.hook.reading.fire(u)})})})},e.prototype.bulkAdd=function(t,i,o){var s=this,u=Array.isArray(i)?i:void 0;o=o||(u?void 0:i);var l=o?o.allKeys:void 0;return this._trans("readwrite",function(d){var p=s.schema.primKey,m=p.auto,y=p.keyPath;if(y&&u)throw new q.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(u&&u.length!==t.length)throw new q.InvalidArgument("Arguments objects and keys must have the same length");var g=t.length,_=y&&m?t.map(pr(y)):t;return s.core.mutate({trans:d,type:"add",keys:u,values:_,wantResults:l}).then(function(S){var v=S.numFailures,w=S.results,I=S.lastResult,T=S.failures,A=l?w:I;if(v===0)return A;throw new Xt("".concat(s.name,".bulkAdd(): ").concat(v," of ").concat(g," operations failed"),T)})})},e.prototype.bulkPut=function(t,i,o){var s=this,u=Array.isArray(i)?i:void 0;o=o||(u?void 0:i);var l=o?o.allKeys:void 0;return this._trans("readwrite",function(d){var p=s.schema.primKey,m=p.auto,y=p.keyPath;if(y&&u)throw new q.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(u&&u.length!==t.length)throw new q.InvalidArgument("Arguments objects and keys must have the same length");var g=t.length,_=y&&m?t.map(pr(y)):t;return s.core.mutate({trans:d,type:"put",keys:u,values:_,wantResults:l}).then(function(S){var v=S.numFailures,w=S.results,I=S.lastResult,T=S.failures,A=l?w:I;if(v===0)return A;throw new Xt("".concat(s.name,".bulkPut(): ").concat(v," of ").concat(g," operations failed"),T)})})},e.prototype.bulkUpdate=function(t){var i=this,o=this.core,s=t.map(function(d){return d.key}),u=t.map(function(d){return d.changes}),l=[];return this._trans("readwrite",function(d){return o.getMany({trans:d,keys:s,cache:"clone"}).then(function(p){var m=[],y=[];t.forEach(function(_,S){var v=_.key,w=_.changes,I=p[S];if(I){for(var T=0,A=Object.keys(w);T<A.length;T++){var P=A[T],C=w[P];if(P===i.schema.primKey.keyPath){if(Z(C,v)!==0)throw new q.Constraint("Cannot update primary key in bulkUpdate()")}else Ne(I,P,C)}l.push(S),m.push(v),y.push(I)}});var g=m.length;return o.mutate({trans:d,type:"put",keys:m,values:y,updates:{keys:s,changeSpecs:u}}).then(function(_){var S=_.numFailures,v=_.failures;if(S===0)return g;for(var w=0,I=Object.keys(v);w<I.length;w++){var T=I[w],A=l[Number(T)];if(A!=null){var P=v[T];delete v[T],v[A]=P}}throw new Xt("".concat(i.name,".bulkUpdate(): ").concat(S," of ").concat(g," operations failed"),v)})})})},e.prototype.bulkDelete=function(t){var i=this,o=t.length;return this._trans("readwrite",function(s){return i.core.mutate({trans:s,type:"delete",keys:t}).then(function(u){return Ir(i,t,u)})}).then(function(s){var u=s.numFailures,l=s.lastResult,d=s.failures;if(u===0)return l;throw new Xt("".concat(i.name,".bulkDelete(): ").concat(u," of ").concat(o," operations failed"),d)})},e})();function Kn(e){var t={},i=function(d,p){if(p){for(var m=arguments.length,y=new Array(m-1);--m;)y[m-1]=arguments[m];return t[d].subscribe.apply(null,y),e}else if(typeof d=="string")return t[d]};i.addEventType=u;for(var o=1,s=arguments.length;o<s;++o)u(arguments[o]);return i;function u(d,p,m){if(typeof d=="object")return l(d);p||(p=xp),m||(m=oe);var y={subscribers:[],fire:m,subscribe:function(g){y.subscribers.indexOf(g)===-1&&(y.subscribers.push(g),y.fire=p(y.fire,g))},unsubscribe:function(g){y.subscribers=y.subscribers.filter(function(_){return _!==g}),y.fire=y.subscribers.reduce(p,m)}};return t[d]=i[d]=y,y}function l(d){ye(d).forEach(function(p){var m=d[p];if(le(m))u(p,d[p][0],d[p][1]);else if(m==="asap")var y=u(p,Bn,function(){for(var _=arguments.length,S=new Array(_);_--;)S[_]=arguments[_];y.subscribers.forEach(function(v){Xa(function(){v.apply(null,S)})})});else throw new q.InvalidArgument("Invalid event config")})}}function $n(e,t){return nn(t).from({prototype:e}),t}function Up(e){return $n(pu.prototype,function(i,o,s){this.db=e,this._tx=s,this.name=i,this.schema=o,this.hook=e._allTables[i]?e._allTables[i].hook:Kn(null,{creating:[Ep,oe],reading:[_p,Bn],updating:[Ip,oe],deleting:[Sp,oe]})})}function qt(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Ri(e,t){e.filter=Bt(e.filter,t)}function Mi(e,t,i){var o=e.replayFilter;e.replayFilter=o?function(){return Bt(o(),t())}:t,e.justLimit=i&&!o}function Hp(e,t){e.isMatch=Bt(e.isMatch,t)}function xr(e,t){if(e.isPrimKey)return t.primaryKey;var i=t.getIndexByKeyPath(e.index);if(!i)throw new q.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return i}function Ba(e,t,i){var o=xr(e,t.schema);return t.openCursor({trans:i,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:o,range:e.range}})}function hr(e,t,i,o){var s=e.replayFilter?Bt(e.filter,e.replayFilter()):e.filter;if(e.or){var u={},l=function(d,p,m){if(!s||s(p,m,function(_){return p.stop(_)},function(_){return p.fail(_)})){var y=p.primaryKey,g=""+y;g==="[object ArrayBuffer]"&&(g=""+new Uint8Array(y)),Fe(u,g)||(u[g]=!0,t(d,p,m))}};return Promise.all([e.or._iterate(l,i),Ka(Ba(e,o,i),e.algorithm,l,!e.keysOnly&&e.valueMapper)])}else return Ka(Ba(e,o,i),Bt(e.algorithm,s),t,!e.keysOnly&&e.valueMapper)}function Ka(e,t,i,o){var s=o?function(l,d,p){return i(o(l),d,p)}:i,u=ce(s);return e.then(function(l){if(l)return l.start(function(){var d=function(){return l.continue()};(!t||t(l,function(p){return d=p},function(p){l.stop(p),d=oe},function(p){l.fail(p),d=oe}))&&u(l.value,l,function(p){return d=p}),d()})})}var Vp=(function(){function e(){}return e.prototype._read=function(t,i){var o=this._ctx;return o.error?o.table._trans(null,fe.bind(null,o.error)):o.table._trans("readonly",t).then(i)},e.prototype._write=function(t){var i=this._ctx;return i.error?i.table._trans(null,fe.bind(null,i.error)):i.table._trans("readwrite",t,"locked")},e.prototype._addAlgorithm=function(t){var i=this._ctx;i.algorithm=Bt(i.algorithm,t)},e.prototype._iterate=function(t,i){return hr(this._ctx,t,i,this._ctx.table.core)},e.prototype.clone=function(t){var i=Object.create(this.constructor.prototype),o=Object.create(this._ctx);return t&&$e(o,t),i._ctx=o,i},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(t){var i=this._ctx;return this._read(function(o){return hr(i,t,o,i.table.core)})},e.prototype.count=function(t){var i=this;return this._read(function(o){var s=i._ctx,u=s.table.core;if(qt(s,!0))return u.count({trans:o,query:{index:xr(s,u.schema),range:s.range}}).then(function(d){return Math.min(d,s.limit)});var l=0;return hr(s,function(){return++l,!1},o,u).then(function(){return l})}).then(t)},e.prototype.sortBy=function(t,i){var o=t.split(".").reverse(),s=o[0],u=o.length-1;function l(m,y){return y?l(m[o[y]],y-1):m[s]}var d=this._ctx.dir==="next"?1:-1;function p(m,y){var g=l(m,u),_=l(y,u);return Z(g,_)*d}return this.toArray(function(m){return m.sort(p)}).then(i)},e.prototype.toArray=function(t){var i=this;return this._read(function(o){var s=i._ctx;if(s.dir==="next"&&qt(s,!0)&&s.limit>0){var u=s.valueMapper,l=xr(s,s.table.core.schema);return s.table.core.query({trans:o,limit:s.limit,values:!0,query:{index:l,range:s.range}}).then(function(p){var m=p.result;return u?m.map(u):m})}else{var d=[];return hr(s,function(p){return d.push(p)},o,s.table.core).then(function(){return d})}},t)},e.prototype.offset=function(t){var i=this._ctx;return t<=0?this:(i.offset+=t,qt(i)?Mi(i,function(){var o=t;return function(s,u){return o===0?!0:o===1?(--o,!1):(u(function(){s.advance(o),o=0}),!1)}}):Mi(i,function(){var o=t;return function(){return--o<0}}),this)},e.prototype.limit=function(t){return this._ctx.limit=Math.min(this._ctx.limit,t),Mi(this._ctx,function(){var i=t;return function(o,s,u){return--i<=0&&s(u),i>=0}},!0),this},e.prototype.until=function(t,i){return Ri(this._ctx,function(o,s,u){return t(o.value)?(s(u),i):!0}),this},e.prototype.first=function(t){return this.limit(1).toArray(function(i){return i[0]}).then(t)},e.prototype.last=function(t){return this.reverse().first(t)},e.prototype.filter=function(t){return Ri(this._ctx,function(i){return t(i.value)}),Hp(this._ctx,t),this},e.prototype.and=function(t){return this.filter(t)},e.prototype.or=function(t){return new this.db.WhereClause(this._ctx.table,t,this)},e.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(t){var i=this._ctx;return i.keysOnly=!i.isMatch,this.each(function(o,s){t(s.key,s)})},e.prototype.eachUniqueKey=function(t){return this._ctx.unique="unique",this.eachKey(t)},e.prototype.eachPrimaryKey=function(t){var i=this._ctx;return i.keysOnly=!i.isMatch,this.each(function(o,s){t(s.primaryKey,s)})},e.prototype.keys=function(t){var i=this._ctx;i.keysOnly=!i.isMatch;var o=[];return this.each(function(s,u){o.push(u.key)}).then(function(){return o}).then(t)},e.prototype.primaryKeys=function(t){var i=this._ctx;if(i.dir==="next"&&qt(i,!0)&&i.limit>0)return this._read(function(s){var u=xr(i,i.table.core.schema);return i.table.core.query({trans:s,values:!1,limit:i.limit,query:{index:u,range:i.range}})}).then(function(s){var u=s.result;return u}).then(t);i.keysOnly=!i.isMatch;var o=[];return this.each(function(s,u){o.push(u.primaryKey)}).then(function(){return o}).then(t)},e.prototype.uniqueKeys=function(t){return this._ctx.unique="unique",this.keys(t)},e.prototype.firstKey=function(t){return this.limit(1).keys(function(i){return i[0]}).then(t)},e.prototype.lastKey=function(t){return this.reverse().firstKey(t)},e.prototype.distinct=function(){var t=this._ctx,i=t.index&&t.table.schema.idxByName[t.index];if(!i||!i.multi)return this;var o={};return Ri(this._ctx,function(s){var u=s.primaryKey.toString(),l=Fe(o,u);return o[u]=!0,!l}),this},e.prototype.modify=function(t){var i=this,o=this._ctx;return this._write(function(s){var u;typeof t=="function"?u=t:u=function(T){return du(T,t)};var l=o.table.core,d=l.schema.primaryKey,p=d.outbound,m=d.extractKey,y=200,g=i.db._options.modifyChunkSize;g&&(typeof g=="object"?y=g[l.name]||g["*"]||200:y=g);var _=[],S=0,v=[],w=function(T,A){var P=A.failures,C=A.numFailures;S+=T-C;for(var D=0,M=ye(P);D<M.length;D++){var L=M[D];_.push(P[L])}},I=t===$a;return i.clone().primaryKeys().then(function(T){var A=qt(o)&&o.limit===1/0&&(typeof t!="function"||I)&&{index:o.index,range:o.range},P=function(C){var D=Math.min(y,T.length-C),M=T.slice(C,C+D);return(I?Promise.resolve([]):l.getMany({trans:s,keys:M,cache:"immutable"})).then(function(L){var N=[],H=[],Y=p?[]:null,F=I?M:[];if(!I)for(var K=0;K<D;++K){var G=L[K],X={value:Nt(G),primKey:T[C+K]};u.call(X,X.value,X)!==!1&&(X.value==null?F.push(T[C+K]):!p&&Z(m(G),m(X.value))!==0?(F.push(T[C+K]),N.push(X.value)):(H.push(X.value),p&&Y.push(T[C+K])))}return Promise.resolve(N.length>0&&l.mutate({trans:s,type:"add",values:N}).then(function(V){for(var ae in V.failures)F.splice(parseInt(ae),1);w(N.length,V)})).then(function(){return(H.length>0||A&&typeof t=="object")&&l.mutate({trans:s,type:"put",keys:Y,values:H,criteria:A,changeSpec:typeof t!="function"&&t,isAdditionalChunk:C>0}).then(function(V){return w(H.length,V)})}).then(function(){return(F.length>0||A&&I)&&l.mutate({trans:s,type:"delete",keys:F,criteria:A,isAdditionalChunk:C>0}).then(function(V){return Ir(o.table,F,V)}).then(function(V){return w(F.length,V)})}).then(function(){return T.length>C+D&&P(C+y)})})};return P(0).then(function(){if(_.length>0)throw new Tr("Error modifying one or more objects",_,S,v);return T.length})})})},e.prototype.delete=function(){var t=this._ctx,i=t.range;return qt(t)&&!t.table.schema.yProps&&(t.isPrimKey||i.type===3)?this._write(function(o){var s=t.table.core.schema.primaryKey,u=i;return t.table.core.count({trans:o,query:{index:s,range:u}}).then(function(l){return t.table.core.mutate({trans:o,type:"deleteRange",range:u}).then(function(d){var p=d.failures,m=d.numFailures;if(m)throw new Tr("Could not delete some values",Object.keys(p).map(function(y){return p[y]}),l-m);return l-m})})}):this.modify($a)},e})(),$a=function(e,t){return t.value=null};function Wp(e){return $n(Vp.prototype,function(i,o){this.db=e;var s=fu,u=null;if(o)try{s=o()}catch(m){u=m}var l=i._ctx,d=l.table,p=d.hook.reading.fire;this._ctx={table:d,index:l.index,isPrimKey:!l.index||d.schema.primKey.keyPath&&l.index===d.schema.primKey.name,range:s,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:u,or:l.or,valueMapper:p!==Bn?p:null}})}function Gp(e,t){return e<t?-1:e===t?0:1}function zp(e,t){return e>t?-1:e===t?0:1}function Ke(e,t,i){var o=e instanceof mu?new e.Collection(e):e;return o._ctx.error=i?new i(t):new TypeError(t),o}function Yt(e){return new e.Collection(e,function(){return hu("")}).limit(0)}function qp(e){return e==="next"?function(t){return t.toUpperCase()}:function(t){return t.toLowerCase()}}function Yp(e){return e==="next"?function(t){return t.toLowerCase()}:function(t){return t.toUpperCase()}}function Jp(e,t,i,o,s,u){for(var l=Math.min(e.length,o.length),d=-1,p=0;p<l;++p){var m=t[p];if(m!==o[p])return s(e[p],i[p])<0?e.substr(0,p)+i[p]+i.substr(p+1):s(e[p],o[p])<0?e.substr(0,p)+o[p]+i.substr(p+1):d>=0?e.substr(0,d)+t[d]+i.substr(d+1):null;s(e[p],m)<0&&(d=p)}return l<o.length&&u==="next"?e+i.substr(e.length):l<e.length&&u==="prev"?e.substr(0,i.length):d<0?null:e.substr(0,d)+o[d]+i.substr(d+1)}function mr(e,t,i,o){var s,u,l,d,p,m,y,g=i.length;if(!i.every(function(w){return typeof w=="string"}))return Ke(e,lu);function _(w){s=qp(w),u=Yp(w),l=w==="next"?Gp:zp;var I=i.map(function(T){return{lower:u(T),upper:s(T)}}).sort(function(T,A){return l(T.lower,A.lower)});d=I.map(function(T){return T.upper}),p=I.map(function(T){return T.lower}),m=w,y=w==="next"?"":o}_("next");var S=new e.Collection(e,function(){return ft(d[0],p[g-1]+o)});S._ondirectionchange=function(w){_(w)};var v=0;return S._addAlgorithm(function(w,I,T){var A=w.key;if(typeof A!="string")return!1;var P=u(A);if(t(P,p,v))return!0;for(var C=null,D=v;D<g;++D){var M=Jp(A,P,d[D],p[D],l,m);M===null&&C===null?v=D+1:(C===null||l(C,M)>0)&&(C=M)}return I(C!==null?function(){w.continue(C+y)}:T),!1}),S}function ft(e,t,i,o){return{type:2,lower:e,upper:t,lowerOpen:i,upperOpen:o}}function hu(e){return{type:1,lower:e,upper:e}}var mu=(function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),e.prototype.between=function(t,i,o,s){o=o!==!1,s=s===!0;try{return this._cmp(t,i)>0||this._cmp(t,i)===0&&(o||s)&&!(o&&s)?Yt(this):new this.Collection(this,function(){return ft(t,i,!o,!s)})}catch{return Ke(this,it)}},e.prototype.equals=function(t){return t==null?Ke(this,it):new this.Collection(this,function(){return hu(t)})},e.prototype.above=function(t){return t==null?Ke(this,it):new this.Collection(this,function(){return ft(t,void 0,!0)})},e.prototype.aboveOrEqual=function(t){return t==null?Ke(this,it):new this.Collection(this,function(){return ft(t,void 0,!1)})},e.prototype.below=function(t){return t==null?Ke(this,it):new this.Collection(this,function(){return ft(void 0,t,!1,!0)})},e.prototype.belowOrEqual=function(t){return t==null?Ke(this,it):new this.Collection(this,function(){return ft(void 0,t)})},e.prototype.startsWith=function(t){return typeof t!="string"?Ke(this,lu):this.between(t,t+Pt,!0,!0)},e.prototype.startsWithIgnoreCase=function(t){return t===""?this.startsWith(t):mr(this,function(i,o){return i.indexOf(o[0])===0},[t],Pt)},e.prototype.equalsIgnoreCase=function(t){return mr(this,function(i,o){return i===o[0]},[t],"")},e.prototype.anyOfIgnoreCase=function(){var t=ot.apply(Jt,arguments);return t.length===0?Yt(this):mr(this,function(i,o){return o.indexOf(i)!==-1},t,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var t=ot.apply(Jt,arguments);return t.length===0?Yt(this):mr(this,function(i,o){return o.some(function(s){return i.indexOf(s)===0})},t,Pt)},e.prototype.anyOf=function(){var t=this,i=ot.apply(Jt,arguments),o=this._cmp;try{i.sort(o)}catch{return Ke(this,it)}if(i.length===0)return Yt(this);var s=new this.Collection(this,function(){return ft(i[0],i[i.length-1])});s._ondirectionchange=function(l){o=l==="next"?t._ascending:t._descending,i.sort(o)};var u=0;return s._addAlgorithm(function(l,d,p){for(var m=l.key;o(m,i[u])>0;)if(++u,u===i.length)return d(p),!1;return o(m,i[u])===0?!0:(d(function(){l.continue(i[u])}),!1)}),s},e.prototype.notEqual=function(t){return this.inAnyRange([[qi,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var t=ot.apply(Jt,arguments);if(t.length===0)return new this.Collection(this);try{t.sort(this._ascending)}catch{return Ke(this,it)}var i=t.reduce(function(o,s){return o?o.concat([[o[o.length-1][1],s]]):[[qi,s]]},null);return i.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(i,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(t,i){var o=this,s=this._cmp,u=this._ascending,l=this._descending,d=this._min,p=this._max;if(t.length===0)return Yt(this);if(!t.every(function(D){return D[0]!==void 0&&D[1]!==void 0&&u(D[0],D[1])<=0}))return Ke(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",q.InvalidArgument);var m=!i||i.includeLowers!==!1,y=i&&i.includeUppers===!0;function g(D,M){for(var L=0,N=D.length;L<N;++L){var H=D[L];if(s(M[0],H[1])<0&&s(M[1],H[0])>0){H[0]=d(H[0],M[0]),H[1]=p(H[1],M[1]);break}}return L===N&&D.push(M),D}var _=u;function S(D,M){return _(D[0],M[0])}var v;try{v=t.reduce(g,[]),v.sort(S)}catch{return Ke(this,it)}var w=0,I=y?function(D){return u(D,v[w][1])>0}:function(D){return u(D,v[w][1])>=0},T=m?function(D){return l(D,v[w][0])>0}:function(D){return l(D,v[w][0])>=0};function A(D){return!I(D)&&!T(D)}var P=I,C=new this.Collection(this,function(){return ft(v[0][0],v[v.length-1][1],!m,!y)});return C._ondirectionchange=function(D){D==="next"?(P=I,_=u):(P=T,_=l),v.sort(S)},C._addAlgorithm(function(D,M,L){for(var N=D.key;P(N);)if(++w,w===v.length)return M(L),!1;return A(N)?!0:(o._cmp(N,v[w][1])===0||o._cmp(N,v[w][0])===0||M(function(){_===u?D.continue(v[w][0]):D.continue(v[w][1])}),!1)}),C},e.prototype.startsWithAnyOf=function(){var t=ot.apply(Jt,arguments);return t.every(function(i){return typeof i=="string"})?t.length===0?Yt(this):this.inAnyRange(t.map(function(i){return[i,i+Pt]})):Ke(this,"startsWithAnyOf() only works with strings")},e})();function Xp(e){return $n(mu.prototype,function(i,o,s){if(this.db=e,this._ctx={table:i,index:o===":id"?null:o,or:s},this._cmp=this._ascending=Z,this._descending=function(u,l){return Z(l,u)},this._max=function(u,l){return Z(u,l)>0?u:l},this._min=function(u,l){return Z(u,l)<0?u:l},this._IDBKeyRange=e._deps.IDBKeyRange,!this._IDBKeyRange)throw new q.MissingAPI})}function Ye(e){return ce(function(t){return Nn(t),e(t.target.error),!1})}function Nn(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var jn="storagemutated",Yi="x-storagemutated-1",bt=Kn(null,jn),Qp=(function(){function e(){}return e.prototype._lock=function(){return An(!W.global),++this._reculock,this._reculock===1&&!W.global&&(W.lockOwnerFor=this),this},e.prototype._unlock=function(){if(An(!W.global),--this._reculock===0)for(W.global||(W.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{Lt(t[1],t[0])}catch{}}return this},e.prototype._locked=function(){return this._reculock&&W.lockOwnerFor!==this},e.prototype.create=function(t){var i=this;if(!this.mode)return this;var o=this.db.idbdb,s=this.db._state.dbOpenError;if(An(!this.idbtrans),!t&&!o)switch(s&&s.name){case"DatabaseClosedError":throw new q.DatabaseClosed(s);case"MissingAPIError":throw new q.MissingAPI(s.message,s);default:throw new q.OpenFailed(s)}if(!this.active)throw new q.TransactionInactive;return An(this._completion._state===null),t=this.idbtrans=t||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):o.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),t.onerror=ce(function(u){Nn(u),i._reject(t.error)}),t.onabort=ce(function(u){Nn(u),i.active&&i._reject(new q.Abort(t.error)),i.active=!1,i.on("abort").fire(u)}),t.oncomplete=ce(function(){i.active=!1,i._resolve(),"mutatedParts"in t&&bt.storagemutated.fire(t.mutatedParts)}),this},e.prototype._promise=function(t,i,o){var s=this;if(t==="readwrite"&&this.mode!=="readwrite")return fe(new q.ReadOnly("Transaction is readonly"));if(!this.active)return fe(new q.TransactionInactive);if(this._locked())return new B(function(l,d){s._blockedFuncs.push([function(){s._promise(t,i,o).then(l,d)},W])});if(o)return gt(function(){var l=new B(function(d,p){s._lock();var m=i(d,p,s);m&&m.then&&m.then(d,p)});return l.finally(function(){return s._unlock()}),l._lib=!0,l});var u=new B(function(l,d){var p=i(l,d,s);p&&p.then&&p.then(l,d)});return u._lib=!0,u},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(t){var i=this._root(),o=B.resolve(t);if(i._waitingFor)i._waitingFor=i._waitingFor.then(function(){return o});else{i._waitingFor=o,i._waitingQueue=[];var s=i.idbtrans.objectStore(i.storeNames[0]);(function l(){for(++i._spinCount;i._waitingQueue.length;)i._waitingQueue.shift()();i._waitingFor&&(s.get(-1/0).onsuccess=l)})()}var u=i._waitingFor;return new B(function(l,d){o.then(function(p){return i._waitingQueue.push(ce(l.bind(null,p)))},function(p){return i._waitingQueue.push(ce(d.bind(null,p)))}).finally(function(){i._waitingFor===u&&(i._waitingFor=null)})})},e.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new q.Abort))},e.prototype.table=function(t){var i=this._memoizedTables||(this._memoizedTables={});if(Fe(i,t))return i[t];var o=this.schema[t];if(!o)throw new q.NotFound("Table "+t+" not part of transaction");var s=new this.db.Table(t,o,this);return s.core=this.db.core.table(t),i[t]=s,s},e})();function Zp(e){return $n(Qp.prototype,function(i,o,s,u,l){var d=this;i!=="readonly"&&o.forEach(function(p){var m,y=(m=s[p])===null||m===void 0?void 0:m.yProps;y&&(o=o.concat(y.map(function(g){return g.updatesTable})))}),this.db=e,this.mode=i,this.storeNames=o,this.schema=s,this.chromeTransactionDurability=u,this.idbtrans=null,this.on=Kn(this,"complete","error","abort"),this.parent=l||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new B(function(p,m){d._resolve=p,d._reject=m}),this._completion.then(function(){d.active=!1,d.on.complete.fire()},function(p){var m=d.active;return d.active=!1,d.on.error.fire(p),d.parent?d.parent._reject(p):m&&d.idbtrans&&d.idbtrans.abort(),fe(p)})})}function Ji(e,t,i,o,s,u,l,d){return{name:e,keyPath:t,unique:i,multi:o,auto:s,compound:u,src:(i&&!l?"&":"")+(o?"*":"")+(s?"++":"")+gu(t),type:d}}function gu(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function lo(e,t,i){return{name:e,primKey:t,indexes:i,mappedClass:null,idxByName:lp(i,function(o){return[o.name,o]})}}function eh(e){return e.length===1?e[0]:e}var Fn=function(e){try{return e.only([[]]),Fn=function(){return[[]]},[[]]}catch{return Fn=function(){return Pt},Pt}};function Xi(e){return e==null?function(){}:typeof e=="string"?th(e):function(t){return st(t,e)}}function th(e){var t=e.split(".");return t.length===1?function(i){return i[e]}:function(i){return st(i,e)}}function ja(e){return[].slice.call(e)}var nh=0;function Dn(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function rh(e,t,i){function o(g,_){var S=ja(g.objectStoreNames);return{schema:{name:g.name,tables:S.map(function(v){return _.objectStore(v)}).map(function(v){var w=v.keyPath,I=v.autoIncrement,T=le(w),A=w==null,P={},C={name:v.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:A,compound:T,keyPath:w,autoIncrement:I,unique:!0,extractKey:Xi(w)},indexes:ja(v.indexNames).map(function(D){return v.index(D)}).map(function(D){var M=D.name,L=D.unique,N=D.multiEntry,H=D.keyPath,Y=le(H),F={name:M,compound:Y,keyPath:H,unique:L,multiEntry:N,extractKey:Xi(H)};return P[Dn(H)]=F,F}),getIndexByKeyPath:function(D){return P[Dn(D)]}};return P[":id"]=C.primaryKey,w!=null&&(P[Dn(w)]=C.primaryKey),C})},hasGetAll:S.length>0&&"getAll"in _.objectStore(S[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function s(g){if(g.type===3)return null;if(g.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var _=g.lower,S=g.upper,v=g.lowerOpen,w=g.upperOpen,I=_===void 0?S===void 0?null:t.upperBound(S,!!w):S===void 0?t.lowerBound(_,!!v):t.bound(_,S,!!v,!!w);return I}function u(g){var _=g.name;function S(I){var T=I.trans,A=I.type,P=I.keys,C=I.values,D=I.range;return new Promise(function(M,L){M=ce(M);var N=T.objectStore(_),H=N.keyPath==null,Y=A==="put"||A==="add";if(!Y&&A!=="delete"&&A!=="deleteRange")throw new Error("Invalid operation type: "+A);var F=(P||C||{length:1}).length;if(P&&C&&P.length!==C.length)throw new Error("Given keys array must have same length as given values array.");if(F===0)return M({numFailures:0,failures:{},results:[],lastResult:void 0});var K,G=[],X=[],V=0,ae=function(Te){++V,Nn(Te)};if(A==="deleteRange"){if(D.type===4)return M({numFailures:V,failures:X,results:[],lastResult:void 0});D.type===3?G.push(K=N.clear()):G.push(K=N.delete(s(D)))}else{var me=Y?H?[C,P]:[C,null]:[P,null],je=me[0],Ie=me[1];if(Y)for(var Pe=0;Pe<F;++Pe)G.push(K=Ie&&Ie[Pe]!==void 0?N[A](je[Pe],Ie[Pe]):N[A](je[Pe])),K.onerror=ae;else for(var Pe=0;Pe<F;++Pe)G.push(K=N[A](je[Pe])),K.onerror=ae}var We=function(Te){var De=Te.target.result;G.forEach(function(Le,z){return Le.error!=null&&(X[z]=Le.error)}),M({numFailures:V,failures:X,results:A==="delete"?P:G.map(function(Le){return Le.result}),lastResult:De})};K.onerror=function(Te){ae(Te),We(Te)},K.onsuccess=We})}function v(I){var T=I.trans,A=I.values,P=I.query,C=I.reverse,D=I.unique;return new Promise(function(M,L){M=ce(M);var N=P.index,H=P.range,Y=T.objectStore(_),F=N.isPrimaryKey?Y:Y.index(N.name),K=C?D?"prevunique":"prev":D?"nextunique":"next",G=A||!("openKeyCursor"in F)?F.openCursor(s(H),K):F.openKeyCursor(s(H),K);G.onerror=Ye(L),G.onsuccess=ce(function(X){var V=G.result;if(!V){M(null);return}V.___id=++nh,V.done=!1;var ae=V.continue.bind(V),me=V.continuePrimaryKey;me&&(me=me.bind(V));var je=V.advance.bind(V),Ie=function(){throw new Error("Cursor not started")},Pe=function(){throw new Error("Cursor not stopped")};V.trans=T,V.stop=V.continue=V.continuePrimaryKey=V.advance=Ie,V.fail=ce(L),V.next=function(){var We=this,Te=1;return this.start(function(){return Te--?We.continue():We.stop()}).then(function(){return We})},V.start=function(We){var Te=new Promise(function(Le,z){Le=ce(Le),G.onerror=Ye(z),V.fail=z,V.stop=function(Qr){V.stop=V.continue=V.continuePrimaryKey=V.advance=Pe,Le(Qr)}}),De=function(){if(G.result)try{We()}catch(Le){V.fail(Le)}else V.done=!0,V.start=function(){throw new Error("Cursor behind last entry")},V.stop()};return G.onsuccess=ce(function(Le){G.onsuccess=De,De()}),V.continue=ae,V.continuePrimaryKey=me,V.advance=je,De(),Te},M(V)},L)})}function w(I){return function(T){return new Promise(function(A,P){A=ce(A);var C=T.trans,D=T.values,M=T.limit,L=T.query,N=M===1/0?void 0:M,H=L.index,Y=L.range,F=C.objectStore(_),K=H.isPrimaryKey?F:F.index(H.name),G=s(Y);if(M===0)return A({result:[]});if(I){var X=D?K.getAll(G,N):K.getAllKeys(G,N);X.onsuccess=function(je){return A({result:je.target.result})},X.onerror=Ye(P)}else{var V=0,ae=D||!("openKeyCursor"in K)?K.openCursor(G):K.openKeyCursor(G),me=[];ae.onsuccess=function(je){var Ie=ae.result;if(!Ie)return A({result:me});if(me.push(D?Ie.value:Ie.primaryKey),++V===M)return A({result:me});Ie.continue()},ae.onerror=Ye(P)}})}}return{name:_,schema:g,mutate:S,getMany:function(I){var T=I.trans,A=I.keys;return new Promise(function(P,C){P=ce(P);for(var D=T.objectStore(_),M=A.length,L=new Array(M),N=0,H=0,Y,F=function(V){var ae=V.target;(L[ae._pos]=ae.result)!=null,++H===N&&P(L)},K=Ye(C),G=0;G<M;++G){var X=A[G];X!=null&&(Y=D.get(A[G]),Y._pos=G,Y.onsuccess=F,Y.onerror=K,++N)}N===0&&P(L)})},get:function(I){var T=I.trans,A=I.key;return new Promise(function(P,C){P=ce(P);var D=T.objectStore(_),M=D.get(A);M.onsuccess=function(L){return P(L.target.result)},M.onerror=Ye(C)})},query:w(p),openCursor:v,count:function(I){var T=I.query,A=I.trans,P=T.index,C=T.range;return new Promise(function(D,M){var L=A.objectStore(_),N=P.isPrimaryKey?L:L.index(P.name),H=s(C),Y=H?N.count(H):N.count();Y.onsuccess=ce(function(F){return D(F.target.result)}),Y.onerror=Ye(M)})}}}var l=o(e,i),d=l.schema,p=l.hasGetAll,m=d.tables.map(function(g){return u(g)}),y={};return m.forEach(function(g){return y[g.name]=g}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(g){var _=y[g];if(!_)throw new Error("Table '".concat(g,"' not found"));return y[g]},MIN_KEY:-1/0,MAX_KEY:Fn(t),schema:d}}function ih(e,t){return t.reduce(function(i,o){var s=o.create;return J(J({},i),s(i))},e)}function oh(e,t,i,o){var s=i.IDBKeyRange;i.indexedDB;var u=ih(rh(t,s,o),e.dbcore);return{dbcore:u}}function Pr(e,t){var i=t.db,o=oh(e._middlewares,i,e._deps,t);e.core=o.dbcore,e.tables.forEach(function(s){var u=s.name;e.core.schema.tables.some(function(l){return l.name===u})&&(s.core=e.core.table(u),e[u]instanceof e.Table&&(e[u].core=s.core))})}function Dr(e,t,i,o){i.forEach(function(s){var u=o[s];t.forEach(function(l){var d=Ya(l,s);(!d||"value"in d&&d.value===void 0)&&(l===e.Transaction.prototype||l instanceof e.Transaction?mt(l,s,{get:function(){return this.table(s)},set:function(p){qa(this,s,{value:p,writable:!0,configurable:!0,enumerable:!0})}}):l[s]=new e.Table(s,u))})})}function Qi(e,t){t.forEach(function(i){for(var o in i)i[o]instanceof e.Table&&delete i[o]})}function sh(e,t){return e._cfg.version-t._cfg.version}function ah(e,t,i,o){var s=e._dbSchema;i.objectStoreNames.contains("$meta")&&!s.$meta&&(s.$meta=lo("$meta",vu("")[0],[]),e._storeNames.push("$meta"));var u=e._createTransaction("readwrite",e._storeNames,s);u.create(i),u._completion.catch(o);var l=u._reject.bind(u),d=W.transless||W;gt(function(){if(W.trans=u,W.transless=d,t===0)ye(s).forEach(function(p){po(i,p,s[p].primKey,s[p].indexes)}),Pr(e,i),B.follow(function(){return e.on.populate.fire(u)}).catch(l);else return Pr(e,i),ch(e,u,t).then(function(p){return lh(e,p,u,i)}).catch(l)})}function uh(e,t){yu(e._dbSchema,t),t.db.version%10===0&&!t.objectStoreNames.contains("$meta")&&t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var i=jr(e,e.idbdb,t);Mr(e,e._dbSchema,t);for(var o=fo(i,e._dbSchema),s=function(m){if(m.change.length||m.recreate)return console.warn("Unable to patch indexes of table ".concat(m.name," because it has changes on the type of index or primary key.")),{value:void 0};var y=t.objectStore(m.name);m.add.forEach(function(g){Je&&console.debug("Dexie upgrade patch: Creating missing index ".concat(m.name,".").concat(g.src)),Rr(y,g)})},u=0,l=o.change;u<l.length;u++){var d=l[u],p=s(d);if(typeof p=="object")return p.value}}function ch(e,t,i){return t.storeNames.includes("$meta")?t.table("$meta").get("version").then(function(o){return o??i}):B.resolve(i)}function lh(e,t,i,o){var s=[],u=e._versions,l=e._dbSchema=jr(e,e.idbdb,o),d=u.filter(function(m){return m._cfg.version>=t});if(d.length===0)return B.resolve();d.forEach(function(m){s.push(function(){var y=l,g=m._cfg.dbschema;Mr(e,y,o),Mr(e,g,o),l=e._dbSchema=g;var _=fo(y,g);_.add.forEach(function(A){po(o,A[0],A[1].primKey,A[1].indexes)}),_.change.forEach(function(A){if(A.recreate)throw new q.Upgrade("Not yet support for changing primary key");var P=o.objectStore(A.name);A.add.forEach(function(C){return Rr(P,C)}),A.change.forEach(function(C){P.deleteIndex(C.name),Rr(P,C)}),A.del.forEach(function(C){return P.deleteIndex(C)})});var S=m._cfg.contentUpgrade;if(S&&m._cfg.version>t){Pr(e,o),i._memoizedTables={};var v=Qa(g);_.del.forEach(function(A){v[A]=y[A]}),Qi(e,[e.Transaction.prototype]),Dr(e,[e.Transaction.prototype],ye(v),v),i.schema=v;var w=no(S);w&&an();var I,T=B.follow(function(){if(I=S(i),I&&w){var A=yt.bind(null,null);I.then(A,A)}});return I&&typeof I.then=="function"?B.resolve(I):T.then(function(){return I})}}),s.push(function(y){var g=m._cfg.dbschema;fh(g,y),Qi(e,[e.Transaction.prototype]),Dr(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),i.schema=e._dbSchema}),s.push(function(y){e.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(e.idbdb.version/10)===m._cfg.version?(e.idbdb.deleteObjectStore("$meta"),delete e._dbSchema.$meta,e._storeNames=e._storeNames.filter(function(g){return g!=="$meta"})):y.objectStore("$meta").put(m._cfg.version,"version"))})});function p(){return s.length?B.resolve(s.shift()(i.idbtrans)).then(p):B.resolve()}return p().then(function(){yu(l,o)})}function fo(e,t){var i={del:[],add:[],change:[]},o;for(o in e)t[o]||i.del.push(o);for(o in t){var s=e[o],u=t[o];if(!s)i.add.push([o,u]);else{var l={name:o,def:u,recreate:!1,del:[],add:[],change:[]};if(""+(s.primKey.keyPath||"")!=""+(u.primKey.keyPath||"")||s.primKey.auto!==u.primKey.auto)l.recreate=!0,i.change.push(l);else{var d=s.idxByName,p=u.idxByName,m=void 0;for(m in d)p[m]||l.del.push(m);for(m in p){var y=d[m],g=p[m];y?y.src!==g.src&&l.change.push(g):l.add.push(g)}(l.del.length>0||l.add.length>0||l.change.length>0)&&i.change.push(l)}}}return i}function po(e,t,i,o){var s=e.db.createObjectStore(t,i.keyPath?{keyPath:i.keyPath,autoIncrement:i.auto}:{autoIncrement:i.auto});return o.forEach(function(u){return Rr(s,u)}),s}function yu(e,t){ye(e).forEach(function(i){t.db.objectStoreNames.contains(i)||(Je&&console.debug("Dexie: Creating missing table",i),po(t,i,e[i].primKey,e[i].indexes))})}function fh(e,t){[].slice.call(t.db.objectStoreNames).forEach(function(i){return e[i]==null&&t.db.deleteObjectStore(i)})}function Rr(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function jr(e,t,i){var o={},s=Br(t.objectStoreNames,0);return s.forEach(function(u){for(var l=i.objectStore(u),d=l.keyPath,p=Ji(gu(d),d||"",!0,!1,!!l.autoIncrement,d&&typeof d!="string",!0),m=[],y=0;y<l.indexNames.length;++y){var g=l.index(l.indexNames[y]);d=g.keyPath;var _=Ji(g.name,d,!!g.unique,!!g.multiEntry,!1,d&&typeof d!="string",!1);m.push(_)}o[u]=lo(u,p,m)}),o}function dh(e,t,i){e.verno=t.version/10;var o=e._dbSchema=jr(e,t,i);e._storeNames=Br(t.objectStoreNames,0),Dr(e,[e._allTables],ye(o),o)}function ph(e,t){var i=jr(e,e.idbdb,t),o=fo(i,e._dbSchema);return!(o.add.length||o.change.some(function(s){return s.add.length||s.change.length}))}function Mr(e,t,i){for(var o=i.db.objectStoreNames,s=0;s<o.length;++s){var u=o[s],l=i.objectStore(u);e._hasGetAll="getAll"in l;for(var d=0;d<l.indexNames.length;++d){var p=l.indexNames[d],m=l.index(p).keyPath,y=typeof m=="string"?m:"["+Br(m).join("+")+"]";if(t[u]){var g=t[u].idxByName[y];g&&(g.name=p,delete t[u].idxByName[y],t[u].idxByName[p]=g)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&Se.WorkerGlobalScope&&Se instanceof Se.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function vu(e){return e.split(",").map(function(t,i){var o,s=t.split(":"),u=(o=s[1])===null||o===void 0?void 0:o.trim();t=s[0].trim();var l=t.replace(/([&*]|\+\+)/g,""),d=/^\[/.test(l)?l.match(/^\[(.*)\]$/)[1].split("+"):l;return Ji(l,d||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),le(d),i===0,u)})}var hh=(function(){function e(){}return e.prototype._createTableSchema=function(t,i,o){return lo(t,i,o)},e.prototype._parseIndexSyntax=function(t){return vu(t)},e.prototype._parseStoresSpec=function(t,i){var o=this;ye(t).forEach(function(s){if(t[s]!==null){var u=o._parseIndexSyntax(t[s]),l=u.shift();if(!l)throw new q.Schema("Invalid schema for table "+s+": "+t[s]);if(l.unique=!0,l.multi)throw new q.Schema("Primary key cannot be multiEntry*");u.forEach(function(p){if(p.auto)throw new q.Schema("Only primary key can be marked as autoIncrement (++)");if(!p.keyPath)throw new q.Schema("Index must have a name and cannot be an empty string")});var d=o._createTableSchema(s,l,u);i[s]=d}})},e.prototype.stores=function(t){var i=this.db;this._cfg.storesSource=this._cfg.storesSource?$e(this._cfg.storesSource,t):t;var o=i._versions,s={},u={};return o.forEach(function(l){$e(s,l._cfg.storesSource),u=l._cfg.dbschema={},l._parseStoresSpec(s,u)}),i._dbSchema=u,Qi(i,[i._allTables,i,i.Transaction.prototype]),Dr(i,[i._allTables,i,i.Transaction.prototype,this._cfg.tables],ye(u),u),i._storeNames=ye(u),this},e.prototype.upgrade=function(t){return this._cfg.contentUpgrade=oo(this._cfg.contentUpgrade||oe,t),this},e})();function mh(e){return $n(hh.prototype,function(i){this.db=e,this._cfg={version:i,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function ho(e,t){var i=e._dbNamesDB;return i||(i=e._dbNamesDB=new tn($r,{addons:[],indexedDB:e,IDBKeyRange:t}),i.version(1).stores({dbnames:"name"})),i.table("dbnames")}function mo(e){return e&&typeof e.databases=="function"}function gh(e){var t=e.indexedDB,i=e.IDBKeyRange;return mo(t)?Promise.resolve(t.databases()).then(function(o){return o.map(function(s){return s.name}).filter(function(s){return s!==$r})}):ho(t,i).toCollection().primaryKeys()}function yh(e,t){var i=e.indexedDB,o=e.IDBKeyRange;!mo(i)&&t!==$r&&ho(i,o).put({name:t}).catch(oe)}function vh(e,t){var i=e.indexedDB,o=e.IDBKeyRange;!mo(i)&&t!==$r&&ho(i,o).delete(t).catch(oe)}function Zi(e){return gt(function(){return W.letThrough=!0,e()})}function bh(){var e=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!e||!indexedDB.databases)return Promise.resolve();var t;return new Promise(function(i){var o=function(){return indexedDB.databases().finally(i)};t=setInterval(o,100),o()}).finally(function(){return clearInterval(t)})}var Ni;function go(e){return!("from"in e)}var Oe=function(e,t){if(this)$e(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0});else{var i=new Oe;return e&&"d"in e&&$e(i,e),i}};en(Oe.prototype,(Ni={add:function(e){return Nr(this,e),this},addKey:function(e){return Ln(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(i){return Ln(t,i,i)}),this},hasKey:function(e){var t=Fr(this).next(e).value;return t&&Z(t.from,e)<=0&&Z(t.to,e)>=0}},Ni[Ui]=function(){return Fr(this)},Ni));function Ln(e,t,i){var o=Z(t,i);if(!isNaN(o)){if(o>0)throw RangeError();if(go(e))return $e(e,{from:t,to:i,d:1});var s=e.l,u=e.r;if(Z(i,e.from)<0)return s?Ln(s,t,i):e.l={from:t,to:i,d:1,l:null,r:null},Ua(e);if(Z(t,e.to)>0)return u?Ln(u,t,i):e.r={from:t,to:i,d:1,l:null,r:null},Ua(e);Z(t,e.from)<0&&(e.from=t,e.l=null,e.d=u?u.d+1:1),Z(i,e.to)>0&&(e.to=i,e.r=null,e.d=e.l?e.l.d+1:1);var l=!e.r;s&&!e.l&&Nr(e,s),u&&l&&Nr(e,u)}}function Nr(e,t){function i(o,s){var u=s.from,l=s.to,d=s.l,p=s.r;Ln(o,u,l),d&&i(o,d),p&&i(o,p)}go(t)||i(e,t)}function wh(e,t){var i=Fr(t),o=i.next();if(o.done)return!1;for(var s=o.value,u=Fr(e),l=u.next(s.from),d=l.value;!o.done&&!l.done;){if(Z(d.from,s.to)<=0&&Z(d.to,s.from)>=0)return!0;Z(s.from,d.from)<0?s=(o=i.next(d.from)).value:d=(l=u.next(s.from)).value}return!1}function Fr(e){var t=go(e)?null:{s:0,n:e};return{next:function(i){for(var o=arguments.length>0;t;)switch(t.s){case 0:if(t.s=1,o)for(;t.n.l&&Z(i,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!o||Z(i,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function Ua(e){var t,i,o=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((i=e.l)===null||i===void 0?void 0:i.d)||0),s=o>1?"r":o<-1?"l":"";if(s){var u=s==="r"?"l":"r",l=J({},e),d=e[s];e.from=d.from,e.to=d.to,e[s]=d[s],l[s]=d[u],e[u]=l,l.d=Ha(l)}e.d=Ha(e)}function Ha(e){var t=e.r,i=e.l;return(t?i?Math.max(t.d,i.d):t.d:i?i.d:0)+1}function Ur(e,t){return ye(t).forEach(function(i){e[i]?Nr(e[i],t[i]):e[i]=tu(t[i])}),e}function yo(e,t){return e.all||t.all||Object.keys(e).some(function(i){return t[i]&&wh(t[i],e[i])})}var Mt={},Fi={},Li=!1;function gr(e,t){Ur(Fi,e),Li||(Li=!0,setTimeout(function(){Li=!1;var i=Fi;Fi={},vo(i,!1)},0))}function vo(e,t){t===void 0&&(t=!1);var i=new Set;if(e.all)for(var o=0,s=Object.values(Mt);o<s.length;o++){var u=s[o];Va(u,e,i,t)}else for(var l in e){var d=/^idb\:\/\/(.*)\/(.*)\//.exec(l);if(d){var p=d[1],m=d[2],u=Mt["idb://".concat(p,"/").concat(m)];u&&Va(u,e,i,t)}}i.forEach(function(y){return y()})}function Va(e,t,i,o){for(var s=[],u=0,l=Object.entries(e.queries.query);u<l.length;u++){for(var d=l[u],p=d[0],m=d[1],y=[],g=0,_=m;g<_.length;g++){var S=_[g];yo(t,S.obsSet)?S.subscribers.forEach(function(T){return i.add(T)}):o&&y.push(S)}o&&s.push([p,y])}if(o)for(var v=0,w=s;v<w.length;v++){var I=w[v],p=I[0],y=I[1];e.queries.query[p]=y}}function _h(e){var t=e._state,i=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?fe(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var o=t.openCanceller,s=Math.round(e.verno*10),u=!1;function l(){if(t.openCanceller!==o)throw new q.DatabaseClosed("db.open() was cancelled")}var d=t.dbReadyResolve,p=null,m=!1,y=function(){return new B(function(g,_){if(l(),!i)throw new q.MissingAPI;var S=e.name,v=t.autoSchema||!s?i.open(S):i.open(S,s);if(!v)throw new q.MissingAPI;v.onerror=Ye(_),v.onblocked=ce(e._fireOnBlocked),v.onupgradeneeded=ce(function(w){if(p=v.transaction,t.autoSchema&&!e._options.allowEmptyDB){v.onerror=Nn,p.abort(),v.result.close();var I=i.deleteDatabase(S);I.onsuccess=I.onerror=ce(function(){_(new q.NoSuchDatabase("Database ".concat(S," doesnt exist")))})}else{p.onerror=Ye(_);var T=w.oldVersion>Math.pow(2,62)?0:w.oldVersion;m=T<1,e.idbdb=v.result,u&&uh(e,p),ah(e,T/10,p,_)}},_),v.onsuccess=ce(function(){p=null;var w=e.idbdb=v.result,I=Br(w.objectStoreNames);if(I.length>0)try{var T=w.transaction(eh(I),"readonly");if(t.autoSchema)dh(e,w,T);else if(Mr(e,e._dbSchema,T),!ph(e,T)&&!u)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),w.close(),s=w.version+1,u=!0,g(y());Pr(e,T)}catch{}Qt.push(e),w.onversionchange=ce(function(A){t.vcFired=!0,e.on("versionchange").fire(A)}),w.onclose=ce(function(){e.close({disableAutoOpen:!1})}),m&&yh(e._deps,S),g()},_)}).catch(function(g){switch(g?.name){case"UnknownError":if(t.PR1398_maxLoop>0)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),y();break;case"VersionError":if(s>0)return s=0,y();break}return B.reject(g)})};return B.race([o,(typeof navigator>"u"?B.resolve():bh()).then(y)]).then(function(){return l(),t.onReadyBeingFired=[],B.resolve(Zi(function(){return e.on.ready.fire(e.vip)})).then(function g(){if(t.onReadyBeingFired.length>0){var _=t.onReadyBeingFired.reduce(oo,oe);return t.onReadyBeingFired=[],B.resolve(Zi(function(){return _(e.vip)})).then(g)}})}).finally(function(){t.openCanceller===o&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(g){t.dbOpenError=g;try{p&&p.abort()}catch{}return o===t.openCanceller&&e._close(),fe(g)}).finally(function(){t.openComplete=!0,d()}).then(function(){if(m){var g={};e.tables.forEach(function(_){_.schema.indexes.forEach(function(S){S.name&&(g["idb://".concat(e.name,"/").concat(_.name,"/").concat(S.name)]=new Oe(-1/0,[[[]]]))}),g["idb://".concat(e.name,"/").concat(_.name,"/")]=g["idb://".concat(e.name,"/").concat(_.name,"/:dels")]=new Oe(-1/0,[[[]]])}),bt(jn).fire(g),vo(g,!0)}return e})}function eo(e){var t=function(l){return e.next(l)},i=function(l){return e.throw(l)},o=u(t),s=u(i);function u(l){return function(d){var p=l(d),m=p.value;return p.done?m:!m||typeof m.then!="function"?le(m)?Promise.all(m).then(o,s):o(m):m.then(o,s)}}return u(t)()}function Eh(e,t,i){var o=arguments.length;if(o<2)throw new q.InvalidArgument("Too few arguments");for(var s=new Array(o-1);--o;)s[o-1]=arguments[o];i=s.pop();var u=Za(s);return[e,u,i]}function bu(e,t,i,o,s){return B.resolve().then(function(){var u=W.transless||W,l=e._createTransaction(t,i,e._dbSchema,o);l.explicit=!0;var d={trans:l,transless:u};if(o)l.idbtrans=o.idbtrans;else try{l.create(),l.idbtrans._explicit=!0,e._state.PR1398_maxLoop=3}catch(g){return g.name===io.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then(function(){return bu(e,t,i,null,s)})):fe(g)}var p=no(s);p&&an();var m,y=B.follow(function(){if(m=s.call(l,l),m)if(p){var g=yt.bind(null,null);m.then(g,g)}else typeof m.next=="function"&&typeof m.throw=="function"&&(m=eo(m))},d);return(m&&typeof m.then=="function"?B.resolve(m).then(function(g){return l.active?g:fe(new q.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):y.then(function(){return m})).then(function(g){return o&&l._resolve(),l._completion.then(function(){return g})}).catch(function(g){return l._reject(g),fe(g)})})}function yr(e,t,i){for(var o=le(e)?e.slice():[e],s=0;s<i;++s)o.push(t);return o}function Sh(e){return J(J({},e),{table:function(t){var i=e.table(t),o=i.schema,s={},u=[];function l(w,I,T){var A=Dn(w),P=s[A]=s[A]||[],C=w==null?0:typeof w=="string"?1:w.length,D=I>0,M=J(J({},T),{name:D?"".concat(A,"(virtual-from:").concat(T.name,")"):T.name,lowLevelIndex:T,isVirtual:D,keyTail:I,keyLength:C,extractKey:Xi(w),unique:!D&&T.unique});if(P.push(M),M.isPrimaryKey||u.push(M),C>1){var L=C===2?w[0]:w.slice(0,C-1);l(L,I+1,T)}return P.sort(function(N,H){return N.keyTail-H.keyTail}),M}var d=l(o.primaryKey.keyPath,0,o.primaryKey);s[":id"]=[d];for(var p=0,m=o.indexes;p<m.length;p++){var y=m[p];l(y.keyPath,0,y)}function g(w){var I=s[Dn(w)];return I&&I[0]}function _(w,I){return{type:w.type===1?2:w.type,lower:yr(w.lower,w.lowerOpen?e.MAX_KEY:e.MIN_KEY,I),lowerOpen:!0,upper:yr(w.upper,w.upperOpen?e.MIN_KEY:e.MAX_KEY,I),upperOpen:!0}}function S(w){var I=w.query.index;return I.isVirtual?J(J({},w),{query:{index:I.lowLevelIndex,range:_(w.query.range,I.keyTail)}}):w}var v=J(J({},i),{schema:J(J({},o),{primaryKey:d,indexes:u,getIndexByKeyPath:g}),count:function(w){return i.count(S(w))},query:function(w){return i.query(S(w))},openCursor:function(w){var I=w.query.index,T=I.keyTail,A=I.isVirtual,P=I.keyLength;if(!A)return i.openCursor(w);function C(D){function M(N){N!=null?D.continue(yr(N,w.reverse?e.MAX_KEY:e.MIN_KEY,T)):w.unique?D.continue(D.key.slice(0,P).concat(w.reverse?e.MIN_KEY:e.MAX_KEY,T)):D.continue()}var L=Object.create(D,{continue:{value:M},continuePrimaryKey:{value:function(N,H){D.continuePrimaryKey(yr(N,e.MAX_KEY,T),H)}},primaryKey:{get:function(){return D.primaryKey}},key:{get:function(){var N=D.key;return P===1?N[0]:N.slice(0,P)}},value:{get:function(){return D.value}}});return L}return i.openCursor(S(w)).then(function(D){return D&&C(D)})}});return v}})}var Ih={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:Sh};function bo(e,t,i,o){return i=i||{},o=o||"",ye(e).forEach(function(s){if(!Fe(t,s))i[o+s]=void 0;else{var u=e[s],l=t[s];if(typeof u=="object"&&typeof l=="object"&&u&&l){var d=ji(u),p=ji(l);d!==p?i[o+s]=t[s]:d==="Object"?bo(u,l,i,o+s+"."):u!==l&&(i[o+s]=t[s])}else u!==l&&(i[o+s]=t[s])}}),ye(t).forEach(function(s){Fe(e,s)||(i[o+s]=t[s])}),i}function wo(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var xh={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return J(J({},e),{table:function(t){var i=e.table(t),o=i.schema.primaryKey,s=J(J({},i),{mutate:function(u){var l=W.trans,d=l.table(t).hook,p=d.deleting,m=d.creating,y=d.updating;switch(u.type){case"add":if(m.fire===oe)break;return l._promise("readwrite",function(){return g(u)},!0);case"put":if(m.fire===oe&&y.fire===oe)break;return l._promise("readwrite",function(){return g(u)},!0);case"delete":if(p.fire===oe)break;return l._promise("readwrite",function(){return g(u)},!0);case"deleteRange":if(p.fire===oe)break;return l._promise("readwrite",function(){return _(u)},!0)}return i.mutate(u);function g(v){var w=W.trans,I=v.keys||wo(o,v);if(!I)throw new Error("Keys missing");return v=v.type==="add"||v.type==="put"?J(J({},v),{keys:I}):J({},v),v.type!=="delete"&&(v.values=kr([],v.values,!0)),v.keys&&(v.keys=kr([],v.keys,!0)),kh(i,v,I).then(function(T){var A=I.map(function(P,C){var D=T[C],M={onerror:null,onsuccess:null};if(v.type==="delete")p.fire.call(M,P,D,w);else if(v.type==="add"||D===void 0){var L=m.fire.call(M,P,v.values[C],w);P==null&&L!=null&&(P=L,v.keys[C]=P,o.outbound||Ne(v.values[C],o.keyPath,P))}else{var N=bo(D,v.values[C]),H=y.fire.call(M,N,P,D,w);if(H){var Y=v.values[C];Object.keys(H).forEach(function(F){Fe(Y,F)?Y[F]=H[F]:Ne(Y,F,H[F])})}}return M});return i.mutate(v).then(function(P){for(var C=P.failures,D=P.results,M=P.numFailures,L=P.lastResult,N=0;N<I.length;++N){var H=D?D[N]:I[N],Y=A[N];H==null?Y.onerror&&Y.onerror(C[N]):Y.onsuccess&&Y.onsuccess(v.type==="put"&&T[N]?v.values[N]:H)}return{failures:C,results:D,numFailures:M,lastResult:L}}).catch(function(P){return A.forEach(function(C){return C.onerror&&C.onerror(P)}),Promise.reject(P)})})}function _(v){return S(v.trans,v.range,1e4)}function S(v,w,I){return i.query({trans:v,values:!1,query:{index:o,range:w},limit:I}).then(function(T){var A=T.result;return g({type:"delete",keys:A,trans:v}).then(function(P){return P.numFailures>0?Promise.reject(P.failures[0]):A.length<I?{failures:[],numFailures:0,lastResult:void 0}:S(v,J(J({},w),{lower:A[A.length-1],lowerOpen:!0}),I)})})}}});return s}})}};function kh(e,t,i){return t.type==="add"?Promise.resolve([]):e.getMany({trans:t.trans,keys:i,cache:"immutable"})}function wu(e,t,i){try{if(!t||t.keys.length<e.length)return null;for(var o=[],s=0,u=0;s<t.keys.length&&u<e.length;++s)Z(t.keys[s],e[u])===0&&(o.push(i?Nt(t.values[s]):t.values[s]),++u);return o.length===e.length?o:null}catch{return null}}var Th={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var i=e.table(t);return J(J({},i),{getMany:function(o){if(!o.cache)return i.getMany(o);var s=wu(o.keys,o.trans._cache,o.cache==="clone");return s?B.resolve(s):i.getMany(o).then(function(u){return o.trans._cache={keys:o.keys,values:o.cache==="clone"?Nt(u):u},u})},mutate:function(o){return o.type!=="add"&&(o.trans._cache=null),i.mutate(o)}})}}}};function _u(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function Eu(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":return!1;case"getMany":return!1;case"count":return!1;case"openCursor":return!1}}var Ch={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,i=new Oe(e.MIN_KEY,e.MAX_KEY);return J(J({},e),{transaction:function(o,s,u){if(W.subscr&&s!=="readonly")throw new q.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(W.querier));return e.transaction(o,s,u)},table:function(o){var s=e.table(o),u=s.schema,l=u.primaryKey,d=u.indexes,p=l.extractKey,m=l.outbound,y=l.autoIncrement&&d.filter(function(v){return v.compound&&v.keyPath.includes(l.keyPath)}),g=J(J({},s),{mutate:function(v){var w,I,T=v.trans,A=v.mutatedParts||(v.mutatedParts={}),P=function(G){var X="idb://".concat(t,"/").concat(o,"/").concat(G);return A[X]||(A[X]=new Oe)},C=P(""),D=P(":dels"),M=v.type,L=v.type==="deleteRange"?[v.range]:v.type==="delete"?[v.keys]:v.values.length<50?[wo(l,v).filter(function(G){return G}),v.values]:[],N=L[0],H=L[1],Y=v.trans._cache;if(le(N)){C.addKeys(N);var F=M==="delete"||N.length===H.length?wu(N,Y):null;F||D.addKeys(N),(F||H)&&Ah(P,u,F,H)}else if(N){var K={from:(w=N.lower)!==null&&w!==void 0?w:e.MIN_KEY,to:(I=N.upper)!==null&&I!==void 0?I:e.MAX_KEY};D.add(K),C.add(K)}else C.add(i),D.add(i),u.indexes.forEach(function(G){return P(G.name).add(i)});return s.mutate(v).then(function(G){return N&&(v.type==="add"||v.type==="put")&&(C.addKeys(G.results),y&&y.forEach(function(X){for(var V=v.values.map(function(Ie){return X.extractKey(Ie)}),ae=X.keyPath.findIndex(function(Ie){return Ie===l.keyPath}),me=0,je=G.results.length;me<je;++me)V[me][ae]=G.results[me];P(X.name).addKeys(V)})),T.mutatedParts=Ur(T.mutatedParts||{},A),G})}}),_=function(v){var w,I,T=v.query,A=T.index,P=T.range;return[A,new Oe((w=P.lower)!==null&&w!==void 0?w:e.MIN_KEY,(I=P.upper)!==null&&I!==void 0?I:e.MAX_KEY)]},S={get:function(v){return[l,new Oe(v.key)]},getMany:function(v){return[l,new Oe().addKeys(v.keys)]},count:_,query:_,openCursor:_};return ye(S).forEach(function(v){g[v]=function(w){var I=W.subscr,T=!!I,A=_u(W,s)&&Eu(v,w),P=A?w.obsSet={}:I;if(T){var C=function(F){var K="idb://".concat(t,"/").concat(o,"/").concat(F);return P[K]||(P[K]=new Oe)},D=C(""),M=C(":dels"),L=S[v](w),N=L[0],H=L[1];if(v==="query"&&N.isPrimaryKey&&!w.values?M.add(H):C(N.name||"").add(H),!N.isPrimaryKey)if(v==="count")M.add(i);else{var Y=v==="query"&&m&&w.values&&s.query(J(J({},w),{values:!1}));return s[v].apply(this,arguments).then(function(F){if(v==="query"){if(m&&w.values)return Y.then(function(V){var ae=V.result;return D.addKeys(ae),F});var K=w.values?F.result.map(p):F.result;w.values?D.addKeys(K):M.addKeys(K)}else if(v==="openCursor"){var G=F,X=w.values;return G&&Object.create(G,{key:{get:function(){return M.addKey(G.primaryKey),G.key}},primaryKey:{get:function(){var V=G.primaryKey;return M.addKey(V),V}},value:{get:function(){return X&&D.addKey(G.primaryKey),G.value}}})}return F})}}return s[v].apply(this,arguments)}}),g}})}};function Ah(e,t,i,o){function s(u){var l=e(u.name||"");function d(m){return m!=null?u.extractKey(m):null}var p=function(m){return u.multiEntry&&le(m)?m.forEach(function(y){return l.addKey(y)}):l.addKey(m)};(i||o).forEach(function(m,y){var g=i&&d(i[y]),_=o&&d(o[y]);Z(g,_)!==0&&(g!=null&&p(g),_!=null&&p(_))})}t.indexes.forEach(s)}function Wa(e,t,i){if(i.numFailures===0)return t;if(t.type==="deleteRange")return null;var o=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;if(i.numFailures===o)return null;var s=J({},t);return le(s.keys)&&(s.keys=s.keys.filter(function(u,l){return!(l in i.failures)})),"values"in s&&le(s.values)&&(s.values=s.values.filter(function(u,l){return!(l in i.failures)})),s}function Oh(e,t){return t.lower===void 0?!0:t.lowerOpen?Z(e,t.lower)>0:Z(e,t.lower)>=0}function Ph(e,t){return t.upper===void 0?!0:t.upperOpen?Z(e,t.upper)<0:Z(e,t.upper)<=0}function Bi(e,t){return Oh(e,t)&&Ph(e,t)}function Ga(e,t,i,o,s,u){if(!i||i.length===0)return e;var l=t.query.index,d=l.multiEntry,p=t.query.range,m=o.schema.primaryKey,y=m.extractKey,g=l.extractKey,_=(l.lowLevelIndex||l).extractKey,S=i.reduce(function(v,w){var I=v,T=[];if(w.type==="add"||w.type==="put")for(var A=new Oe,P=w.values.length-1;P>=0;--P){var C=w.values[P],D=y(C);if(!A.hasKey(D)){var M=g(C);(d&&le(M)?M.some(function(F){return Bi(F,p)}):Bi(M,p))&&(A.addKey(D),T.push(C))}}switch(w.type){case"add":{var L=new Oe().addKeys(t.values?v.map(function(F){return y(F)}):v);I=v.concat(t.values?T.filter(function(F){var K=y(F);return L.hasKey(K)?!1:(L.addKey(K),!0)}):T.map(function(F){return y(F)}).filter(function(F){return L.hasKey(F)?!1:(L.addKey(F),!0)}));break}case"put":{var N=new Oe().addKeys(w.values.map(function(F){return y(F)}));I=v.filter(function(F){return!N.hasKey(t.values?y(F):F)}).concat(t.values?T:T.map(function(F){return y(F)}));break}case"delete":var H=new Oe().addKeys(w.keys);I=v.filter(function(F){return!H.hasKey(t.values?y(F):F)});break;case"deleteRange":var Y=w.range;I=v.filter(function(F){return!Bi(y(F),Y)});break}return I},e);return S===e?e:(S.sort(function(v,w){return Z(_(v),_(w))||Z(y(v),y(w))}),t.limit&&t.limit<1/0&&(S.length>t.limit?S.length=t.limit:e.length===t.limit&&S.length<t.limit&&(s.dirty=!0)),u?Object.freeze(S):S)}function za(e,t){return Z(e.lower,t.lower)===0&&Z(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function Dh(e,t,i,o){if(e===void 0)return t!==void 0?-1:0;if(t===void 0)return 1;var s=Z(e,t);if(s===0){if(i&&o)return 0;if(i)return 1;if(o)return-1}return s}function Rh(e,t,i,o){if(e===void 0)return t!==void 0?1:0;if(t===void 0)return-1;var s=Z(e,t);if(s===0){if(i&&o)return 0;if(i)return-1;if(o)return 1}return s}function Mh(e,t){return Dh(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&Rh(e.upper,t.upper,e.upperOpen,t.upperOpen)>=0}function Nh(e,t,i,o){var s=Mt["idb://".concat(e,"/").concat(t)];if(!s)return[];var u=s.queries[i];if(!u)return[null,!1,s,null];var l=o.query?o.query.index.name:null,d=u[l||""];if(!d)return[null,!1,s,null];switch(i){case"query":var p=d.find(function(g){return g.req.limit===o.limit&&g.req.values===o.values&&za(g.req.query.range,o.query.range)});if(p)return[p,!0,s,d];var m=d.find(function(g){var _="limit"in g.req?g.req.limit:1/0;return _>=o.limit&&(o.values?g.req.values:!0)&&Mh(g.req.query.range,o.query.range)});return[m,!1,s,d];case"count":var y=d.find(function(g){return za(g.req.query.range,o.query.range)});return[y,!!y,s,d]}}function Fh(e,t,i,o){e.subscribers.add(i),o.addEventListener("abort",function(){e.subscribers.delete(i),e.subscribers.size===0&&Lh(e,t)})}function Lh(e,t){setTimeout(function(){e.subscribers.size===0&&Ct(t,e)},3e3)}var Bh={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name,i=J(J({},e),{transaction:function(o,s,u){var l=e.transaction(o,s,u);if(s==="readwrite"){var d=new AbortController,p=d.signal,m=function(y){return function(){if(d.abort(),s==="readwrite"){for(var g=new Set,_=0,S=o;_<S.length;_++){var v=S[_],w=Mt["idb://".concat(t,"/").concat(v)];if(w){var I=e.table(v),T=w.optimisticOps.filter(function(X){return X.trans===l});if(l._explicit&&y&&l.mutatedParts)for(var A=0,P=Object.values(w.queries.query);A<P.length;A++)for(var C=P[A],D=0,M=C.slice();D<M.length;D++){var L=M[D];yo(L.obsSet,l.mutatedParts)&&(Ct(C,L),L.subscribers.forEach(function(X){return g.add(X)}))}else if(T.length>0){w.optimisticOps=w.optimisticOps.filter(function(X){return X.trans!==l});for(var N=0,H=Object.values(w.queries.query);N<H.length;N++)for(var C=H[N],Y=0,F=C.slice();Y<F.length;Y++){var L=F[Y];if(L.res!=null&&l.mutatedParts)if(y&&!L.dirty){var K=Object.isFrozen(L.res),G=Ga(L.res,L.req,T,I,L,K);L.dirty?(Ct(C,L),L.subscribers.forEach(function(ae){return g.add(ae)})):G!==L.res&&(L.res=G,L.promise=B.resolve({result:G}))}else L.dirty&&Ct(C,L),L.subscribers.forEach(function(ae){return g.add(ae)})}}}}g.forEach(function(X){return X()})}}};l.addEventListener("abort",m(!1),{signal:p}),l.addEventListener("error",m(!1),{signal:p}),l.addEventListener("complete",m(!0),{signal:p})}return l},table:function(o){var s=e.table(o),u=s.schema.primaryKey,l=J(J({},s),{mutate:function(d){var p=W.trans;if(u.outbound||p.db._options.cache==="disabled"||p.explicit||p.idbtrans.mode!=="readwrite")return s.mutate(d);var m=Mt["idb://".concat(t,"/").concat(o)];if(!m)return s.mutate(d);var y=s.mutate(d);return(d.type==="add"||d.type==="put")&&(d.values.length>=50||wo(u,d).some(function(g){return g==null}))?y.then(function(g){var _=J(J({},d),{values:d.values.map(function(v,w){var I;if(g.failures[w])return v;var T=!((I=u.keyPath)===null||I===void 0)&&I.includes(".")?Nt(v):J({},v);return Ne(T,u.keyPath,g.results[w]),T})}),S=Wa(m,_,g);m.optimisticOps.push(S),queueMicrotask(function(){return d.mutatedParts&&gr(d.mutatedParts)})}):(m.optimisticOps.push(d),d.mutatedParts&&gr(d.mutatedParts),y.then(function(g){if(g.numFailures>0){Ct(m.optimisticOps,d);var _=Wa(m,d,g);_&&m.optimisticOps.push(_),d.mutatedParts&&gr(d.mutatedParts)}}),y.catch(function(){Ct(m.optimisticOps,d),d.mutatedParts&&gr(d.mutatedParts)})),y},query:function(d){var p;if(!_u(W,s)||!Eu("query",d))return s.query(d);var m=((p=W.trans)===null||p===void 0?void 0:p.db._options.cache)==="immutable",y=W,g=y.requery,_=y.signal,S=Nh(t,o,"query",d),v=S[0],w=S[1],I=S[2],T=S[3];if(v&&w)v.obsSet=d.obsSet;else{var A=s.query(d).then(function(P){var C=P.result;if(v&&(v.res=C),m){for(var D=0,M=C.length;D<M;++D)Object.freeze(C[D]);Object.freeze(C)}else P.result=Nt(C);return P}).catch(function(P){return T&&v&&Ct(T,v),Promise.reject(P)});v={obsSet:d.obsSet,promise:A,subscribers:new Set,type:"query",req:d,dirty:!1},T?T.push(v):(T=[v],I||(I=Mt["idb://".concat(t,"/").concat(o)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}}),I.queries.query[d.query.index.name||""]=T)}return Fh(v,T,g,_),v.promise.then(function(P){return{result:Ga(P.result,d,I?.optimisticOps,s,v,m)}})}});return l}});return i}};function vr(e,t){return new Proxy(e,{get:function(i,o,s){return o==="db"?t:Reflect.get(i,o,s)}})}var tn=(function(){function e(t,i){var o=this;this._middlewares={},this.verno=0;var s=e.dependencies;this._options=i=J({addons:e.addons,autoOpen:!0,indexedDB:s.indexedDB,IDBKeyRange:s.IDBKeyRange,cache:"cloned"},i),this._deps={indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange};var u=i.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var l={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:oe,dbReadyPromise:null,cancelOpen:oe,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:i.autoOpen};l.dbReadyPromise=new B(function(p){l.dbReadyResolve=p}),l.openCanceller=new B(function(p,m){l.cancelOpen=m}),this._state=l,this.name=t,this.on=Kn(this,"populate","blocked","versionchange","close",{ready:[oo,oe]}),this.once=function(p,m){var y=function(){for(var g=[],_=0;_<arguments.length;_++)g[_]=arguments[_];o.on(p).unsubscribe(y),m.apply(o,g)};return o.on(p,y)},this.on.ready.subscribe=Ja(this.on.ready.subscribe,function(p){return function(m,y){e.vip(function(){var g=o._state;if(g.openComplete)g.dbOpenError||B.resolve().then(m),y&&p(m);else if(g.onReadyBeingFired)g.onReadyBeingFired.push(m),y&&p(m);else{p(m);var _=o;y||p(function S(){_.on.ready.unsubscribe(m),_.on.ready.unsubscribe(S)})}})}}),this.Collection=Wp(this),this.Table=Up(this),this.Transaction=Zp(this),this.Version=mh(this),this.WhereClause=Xp(this),this.on("versionchange",function(p){p.newVersion>0?console.warn("Another connection wants to upgrade database '".concat(o.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(o.name,"'. Closing db now to resume the delete request.")),o.close({disableAutoOpen:!1})}),this.on("blocked",function(p){!p.newVersion||p.newVersion<p.oldVersion?console.warn("Dexie.delete('".concat(o.name,"') was blocked")):console.warn("Upgrade '".concat(o.name,"' blocked by other connection holding version ").concat(p.oldVersion/10))}),this._maxKey=Fn(i.IDBKeyRange),this._createTransaction=function(p,m,y,g){return new o.Transaction(p,m,y,o._options.chromeTransactionDurability,g)},this._fireOnBlocked=function(p){o.on("blocked").fire(p),Qt.filter(function(m){return m.name===o.name&&m!==o&&!m._state.vcFired}).map(function(m){return m.on("versionchange").fire(p)})},this.use(Th),this.use(Bh),this.use(Ch),this.use(Ih),this.use(xh);var d=new Proxy(this,{get:function(p,m,y){if(m==="_vip")return!0;if(m==="table")return function(_){return vr(o.table(_),d)};var g=Reflect.get(p,m,y);return g instanceof pu?vr(g,d):m==="tables"?g.map(function(_){return vr(_,d)}):m==="_createTransaction"?function(){var _=g.apply(this,arguments);return vr(_,d)}:g}});this.vip=d,u.forEach(function(p){return p(o)})}return e.prototype.version=function(t){if(isNaN(t)||t<.1)throw new q.Type("Given version is not a positive number");if(t=Math.round(t*10)/10,this.idbdb||this._state.isBeingOpened)throw new q.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);var i=this._versions,o=i.filter(function(s){return s._cfg.version===t})[0];return o||(o=new this.Version(t),i.push(o),i.sort(sh),o.stores({}),this._state.autoSchema=!1,o)},e.prototype._whenReady=function(t){var i=this;return this.idbdb&&(this._state.openComplete||W.letThrough||this._vip)?t():new B(function(o,s){if(i._state.openComplete)return s(new q.DatabaseClosed(i._state.dbOpenError));if(!i._state.isBeingOpened){if(!i._state.autoOpen){s(new q.DatabaseClosed);return}i.open().catch(oe)}i._state.dbReadyPromise.then(o,s)}).then(t)},e.prototype.use=function(t){var i=t.stack,o=t.create,s=t.level,u=t.name;u&&this.unuse({stack:i,name:u});var l=this._middlewares[i]||(this._middlewares[i]=[]);return l.push({stack:i,create:o,level:s??10,name:u}),l.sort(function(d,p){return d.level-p.level}),this},e.prototype.unuse=function(t){var i=t.stack,o=t.name,s=t.create;return i&&this._middlewares[i]&&(this._middlewares[i]=this._middlewares[i].filter(function(u){return s?u.create!==s:o?u.name!==o:!1})),this},e.prototype.open=function(){var t=this;return Lt(ht,function(){return _h(t)})},e.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var t=this._state,i=Qt.indexOf(this);if(i>=0&&Qt.splice(i,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}t.isBeingOpened||(t.dbReadyPromise=new B(function(o){t.dbReadyResolve=o}),t.openCanceller=new B(function(o,s){t.cancelOpen=s}))},e.prototype.close=function(t){var i=t===void 0?{disableAutoOpen:!0}:t,o=i.disableAutoOpen,s=this._state;o?(s.isBeingOpened&&s.cancelOpen(new q.DatabaseClosed),this._close(),s.autoOpen=!1,s.dbOpenError=new q.DatabaseClosed):(this._close(),s.autoOpen=this._options.autoOpen||s.isBeingOpened,s.openComplete=!1,s.dbOpenError=null)},e.prototype.delete=function(t){var i=this;t===void 0&&(t={disableAutoOpen:!0});var o=arguments.length>0&&typeof arguments[0]!="object",s=this._state;return new B(function(u,l){var d=function(){i.close(t);var p=i._deps.indexedDB.deleteDatabase(i.name);p.onsuccess=ce(function(){vh(i._deps,i.name),u()}),p.onerror=Ye(l),p.onblocked=i._fireOnBlocked};if(o)throw new q.InvalidArgument("Invalid closeOptions argument to db.delete()");s.isBeingOpened?s.dbReadyPromise.then(d):d()})},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return this.idbdb!==null},e.prototype.hasBeenClosed=function(){var t=this._state.dbOpenError;return t&&t.name==="DatabaseClosed"},e.prototype.hasFailed=function(){return this._state.dbOpenError!==null},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,"tables",{get:function(){var t=this;return ye(this._allTables).map(function(i){return t._allTables[i]})},enumerable:!1,configurable:!0}),e.prototype.transaction=function(){var t=Eh.apply(this,arguments);return this._transaction.apply(this,t)},e.prototype._transaction=function(t,i,o){var s=this,u=W.trans;(!u||u.db!==this||t.indexOf("!")!==-1)&&(u=null);var l=t.indexOf("?")!==-1;t=t.replace("!","").replace("?","");var d,p;try{if(p=i.map(function(y){var g=y instanceof s.Table?y.name:y;if(typeof g!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return g}),t=="r"||t===Pi)d=Pi;else if(t=="rw"||t==Di)d=Di;else throw new q.InvalidArgument("Invalid transaction mode: "+t);if(u){if(u.mode===Pi&&d===Di)if(l)u=null;else throw new q.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");u&&p.forEach(function(y){if(u&&u.storeNames.indexOf(y)===-1)if(l)u=null;else throw new q.SubTransaction("Table "+y+" not included in parent transaction.")}),l&&u&&!u.active&&(u=null)}}catch(y){return u?u._promise(null,function(g,_){_(y)}):fe(y)}var m=bu.bind(null,this,d,p,u,o);return u?u._promise(d,m,"lock"):W.trans?Lt(W.transless,function(){return s._whenReady(m)}):this._whenReady(m)},e.prototype.table=function(t){if(!Fe(this._allTables,t))throw new q.InvalidTable("Table ".concat(t," does not exist"));return this._allTables[t]},e})(),Kh=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",$h=(function(){function e(t){this._subscribe=t}return e.prototype.subscribe=function(t,i,o){return this._subscribe(!t||typeof t=="function"?{next:t,error:i,complete:o}:t)},e.prototype[Kh]=function(){return this},e})(),Lr;try{Lr={indexedDB:Se.indexedDB||Se.mozIndexedDB||Se.webkitIndexedDB||Se.msIndexedDB,IDBKeyRange:Se.IDBKeyRange||Se.webkitIDBKeyRange}}catch{Lr={indexedDB:null,IDBKeyRange:null}}function jh(e){var t=!1,i,o=new $h(function(s){var u=no(e);function l(T){var A=on();try{u&&an();var P=gt(e,T);return u&&(P=P.finally(yt)),P}finally{A&&sn()}}var d=!1,p,m={},y={},g={get closed(){return d},unsubscribe:function(){d||(d=!0,p&&p.abort(),_&&bt.storagemutated.unsubscribe(w))}};s.start&&s.start(g);var _=!1,S=function(){return Oi(I)};function v(){return yo(y,m)}var w=function(T){Ur(m,T),v()&&S()},I=function(){if(!(d||!Lr.indexedDB)){m={};var T={};p&&p.abort(),p=new AbortController;var A={subscr:T,signal:p.signal,requery:S,querier:e,trans:null},P=l(A);Promise.resolve(P).then(function(C){t=!0,i=C,!(d||A.signal.aborted)&&(m={},y=T,!hp(y)&&!_&&(bt(jn,w),_=!0),Oi(function(){return!d&&s.next&&s.next(C)}))},function(C){t=!1,["DatabaseClosedError","AbortError"].includes(C?.name)||d||Oi(function(){d||s.error&&s.error(C)})})}};return setTimeout(S,0),g});return o.hasValue=function(){return t},o.getValue=function(){return i},o}var Ot=tn;en(Ot,J(J({},Kr),{delete:function(e){var t=new Ot(e,{addons:[]});return t.delete()},exists:function(e){return new Ot(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return gh(Ot.dependencies).then(e)}catch{return fe(new q.MissingAPI)}},defineClass:function(){function e(t){$e(this,t)}return e},ignoreTransaction:function(e){return W.trans?Lt(W.transless,e):e()},vip:Zi,async:function(e){return function(){try{var t=eo(e.apply(this,arguments));return!t||typeof t.then!="function"?B.resolve(t):t}catch(i){return fe(i)}}},spawn:function(e,t,i){try{var o=eo(e.apply(i,t||[]));return!o||typeof o.then!="function"?B.resolve(o):o}catch(s){return fe(s)}},currentTransaction:{get:function(){return W.trans||null}},waitFor:function(e,t){var i=B.resolve(typeof e=="function"?Ot.ignoreTransaction(e):e).timeout(t||6e4);return W.trans?W.trans.waitFor(i):i},Promise:B,debug:{get:function(){return Je},set:function(e){iu(e)}},derive:nn,extend:$e,props:en,override:Ja,Events:Kn,on:bt,liveQuery:jh,extendObservabilitySet:Ur,getByKeyPath:st,setByKeyPath:Ne,delByKeyPath:fp,shallowClone:Qa,deepClone:Nt,getObjectDiff:bo,cmp:Z,asap:Xa,minKey:qi,addons:[],connections:Qt,errnames:io,dependencies:Lr,cache:Mt,semVer:Na,version:Na.split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,i){return e+t/Math.pow(10,i*2)})}));Ot.maxKey=Fn(Ot.dependencies.IDBKeyRange);typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(bt(jn,function(e){if(!pt){var t;t=new CustomEvent(Yi,{detail:e}),pt=!0,dispatchEvent(t),pt=!1}}),addEventListener(Yi,function(e){var t=e.detail;pt||_o(t)}));function _o(e){var t=pt;try{pt=!0,bt.storagemutated.fire(e),vo(e,!0)}finally{pt=t}}var pt=!1,dt,to=function(){};typeof BroadcastChannel<"u"&&(to=function(){dt=new BroadcastChannel(Yi),dt.onmessage=function(e){return e.data&&_o(e.data)}},to(),typeof dt.unref=="function"&&dt.unref(),bt(jn,function(e){pt||dt.postMessage(e)}));typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!tn.disableBfCache&&e.persisted){Je&&console.debug("Dexie: handling persisted pagehide"),dt?.close();for(var t=0,i=Qt;t<i.length;t++){var o=i[t];o.close({disableAutoOpen:!1})}}}),addEventListener("pageshow",function(e){!tn.disableBfCache&&e.persisted&&(Je&&console.debug("Dexie: handling persisted pageshow"),to(),_o({all:new Oe(-1/0,[[]])}))}));B.rejectionMapper=wp;iu(Je);var Eo=class{getDB(){let t=new tn("FireShotDB");return t.version(1).stores({captures:`
              ++id,
              time,
              url,
              title`,tiles:"++id, parentId"}),t}async createNewEntry(){return await this.getDB().captures.add({time:0})}async addTile(t,i){await this.getDB().tiles.add({parentId:t,blob:i})}async commitEntry(t,i,o,s,u){await this.getDB().captures.update(t,{time:i,url:o,title:s,metadata:u})}async cleanup(){un()("DB cleanup...");let i=await this.getDB().captures.where("time").equals(0).primaryKeys();await this.deleteCaptures(i)}async deleteCaptures(t){let i=this.getDB();await i.tiles.where("parentId").anyOf(t).delete(),await i.captures.bulkDelete(t)}async deleteOlderThanGivenDays(t){un()("Performing database cleanup...");let i=this.getDB(),o=new Date;o.setDate(o.getDate()-t);let s=await i.captures.where("time").below(o).primaryKeys();s.length>0?(console.log(`Removing ${s.length} items`),await this.deleteCaptures(s)):un()("Nothing to do.")}async getCapture(t){try{let i=this.getDB();return{...await i.captures.get(t),tiles:(await i.tiles.where("parentId").equals(t).sortBy("id")).map(o=>o.blob)}}catch(i){return console.error(i),null}}async getAllCaptures(){return await this.getDB().captures.toArray()}},Un=new Eo;var Su="image/png",Hr=class{#i=0;#e=0;#a=Number.MAX_SAFE_INTEGER;#y=Number.MAX_SAFE_INTEGER;#v=0;#p=0;#h;#c=0;#m=0;#b=0;#l=-1;#n=0;#r=0;#d=[];#t=null;#s=null;#f=null;#o;#u=null;#g=0;dbError=!1;constructor(){}async B(){await Wt(async()=>{await Un.cleanup()})()}#S(){this.#t=new OffscreenCanvas(this.#n,k.Q),this.#t.aTag=1,this.#s=new OffscreenCanvas(this.#n,k.Q),this.#s.aTag=2,this.#f=this.#t.getContext("2d",{alpha:!1,willReadFrequently:!1}),this.#f.aTag=1,this.#u=this.#s.getContext("2d",{alpha:!1,willReadFrequently:!1}),this.#u.aTag=2}async#w(t){await Wt(async()=>{this.#l<0&&(this.#l=await Un.createNewEntry()),this.#m+=t.size,Re()&&(t=await t.arrayBuffer()),await Un.addTile(this.#l,t),++this.#b},()=>this.dbError=!0)()}async#_(){wt("swapActiveContext"),this.#g=0,this.#o+=this.#t.height,await this.#w(await this.#t.convertToBlob({type:Su})),[this.#t,this.#s]=[this.#s,this.#t],[this.#f,this.#u]=[this.#u,this.#f],_t("swapActiveContext")}async#I(t){let i=t.x,o=t.y,s=this.#p===t.y||this.#c===0,u=t.metrics.div,l=t.metrics.left,d=t.metrics.top,p=t.metrics.crop,m=t.metrics.cropLeft||0,y=t.metrics.cropTop||0,g=t.metrics.cropRight||0,_=t.metrics.cropBottom||0,S=t.metrics.stickyHdrHeight,{w:v,h:w}=Iu(t.dataurl),[I,T]=u?[t.metrics.cw,t.metrics.ch]:[v,w];this.#c===0&&(this.#v=t.x,this.#p=t.y),this.#c=this.#c+1,this.#y=Math.min(this.#y,t.y),this.#e=Math.max(this.#e,t.y),this.#n===0&&(this.#n=this.#i+I-this.#a-(p?m:0),p&&(this.#n=Math.min(this.#n,g-m)),this.#S(),this.#o=0);let A=s?0:S,P=i-this.#v-m,C=o-this.#p-y+A,D=u?T-A:T-A-d,M=C+D;this.#r=Math.max(this.#r,M),p&&(this.#r=Math.min(this.#r,Math.floor(_-y))),wt("fetch dataurl");let L=await fetch(t.dataurl);if(!L.ok)throw new Error("failed to preload image chunk");_t("fetch dataurl"),wt("createImageBitmap");let N=await createImageBitmap(await L.blob());_t("createImageBitmap"),C-this.#o>=this.#t.height&&await this.#_();let H=Math.max(I,v)-l,Y=Math.max(T,w)-(d+A);this.#f.drawImage(N,l,d+A,H,Y,P,C-this.#o,H,Y),this.#r-this.#o>=this.#t.height&&(this.#g=this.#r-this.#o-this.#t.height,this.#u.drawImage(N,l,d+A,H,Y,P,C-this.#o-this.#t.height,H,Y))}async#x(t){wt("commitDBRecord");let i=re(k.I,2)-1;await Wt(async()=>{let o={calculatedHeight:Math.floor(this.#r),calculatedWidth:this.#n,blobsSize:this.#m,totalTiles:this.#b,pageUrl:t.url,...t.savedCapParamsForDebugging};await Un.commitEntry(this.#l,new Date(t.created),t.url,t.title,{n:i,size:this.#m,width:this.#n,height:Math.floor(this.#r),cbb:t.canBeBetter,debug:o,links:t.links,words:t.words})},()=>this.dbError=!0)(),_t("commitDBRecord")}async#E(){this.#n===0&&this.#d.forEach(t=>{this.#a=Math.min(this.#a,t.x),this.#i=Math.max(this.#i,t.x)});for(let t of this.#d)await this.#I(t);this.#d.length=0}async pe(t){this.#d.push(t),typeof this.#h>"u"&&(this.#h=t.y),this.#h!==t.y&&await this.#E()}async $e(t){return wt("Finalize"),this.#c===0&&await this.#E(),this.#g>0&&await this.#_(),this.#s.height=this.#r-this.#o,this.#u.drawImage(this.#t,0,0,this.#n,this.#r-this.#o,0,0,this.#n,this.#r-this.#o),await this.#w(await this.#s.convertToBlob({type:Su})),this.#t.width=1,this.#t.height=1,this.#s.width=1,this.#s.height=1,await this.#x(t),U("tiles created")(),_t("Finalize"),this.#l}};function Vr(e){chrome.tabs.create({url:`fsHistory.html${e?"?cleanup=1":""}`})}function xu(e){chrome.tabs.create({url:"fsOptions.html"+(e?"?extras=1":"")})}function ku(){Ve("chrome://extensions/?id="+chrome.runtime.id)}function So(e){Ve(`https://getfireshot.com/buy.php?browser=${Ai()}${e?"&SRC="+e:""}&ver=${Be().extVersionFull}`)}function Tu(){Ve("https://getfireshot.com/demo.php")}function Cu(){Ve("https://getfireshot.com/sup/frm12.htm")}function Au(){Ve("https://getfireshot.com/api.php")}function Ou(){zt()?(Me()?chrome.windows:chrome.tabs).create({url:"fsNativeInstall.html"}):Uh()}function Uh(){new Date>new Date(2026,1,15)?alert("This beta preview period has ended. Please visit the purchase page to get the full version of FireShot Pro."):(ee(k.t,"true"),se||Hh())}function Hh(){Ve("https://getfireshot.com/beta-pro.php?browser="+Ai())}function Vh(){let e=null,t=null,i=null;function o(){ee(k.u,!0),ee(k.t,!0)}async function s(){t=new Hr,await t.B(),i=null}async function u(d){i?i=i.then(()=>t.pe(d)):i=t.pe(d)}async function l(d){try{if(d.rows===0)return;await i;let p=await t.$e(d);if(t.dbError){Vr(!0);return}t=null,i=null,se&&wt("captureDone");let m=[k.E,k.g].indexOf(d.action)!==-1,y;if(m){let _=btoa(JSON.stringify({action:d.action,folder:d.overrideFolder||"",context:d.contextId}));y={url:`fsCaptured.html?id=${p}&params=${_}`,active:!0}}else y={url:`fsCaptured.html?id=${p}`,windowId:d.tab.windowId,index:d.tab.incognito?void 0:d.tab.index+1,openerTabId:d.tab.incognito?void 0:d.tab.id},re(k.Te)!=="true"&&(delete y.index,Me()&&delete y.openerTabId);if(Me()&&d.tab.incognito&&!d.justStore){let _=(await browser.windows.getAll({windowTypes:["normal"]})).filter(v=>!v.incognito),S;if(_.length>0)S=_[0],await browser.windows.update(S.id,{focused:!0});else{S=await browser.windows.create({incognito:!1,focused:!0,allowScriptsToClose:!0});let v=await browser.tabs.query({windowId:S.id});if(v?.length>0){let w=v[0];setTimeout(()=>browser.tabs.remove(w.id),1e3)}}y.windowId=S.id}let g=_=>new Promise(S=>{chrome.tabs.create(_,v=>{chrome.runtime.lastError?(delete _.index,delete _.openerTabId,chrome.tabs.create(_,S)):S(v)})});d.justStore||await g(y),se&&_t("captureDone")}finally{e({topic:"processingFinished"})}}return{init:function(d){e=d},launchJSON:function(d){switch(d.JSONCommand){case"captureInit":return s();case"captureTabPNG":u(d);break;case"captureDone":return l(d);case"activateFireShot":o();break}}}}var Pu=new Vh;function Wh(){return Hn()?Tn:Pu}function Wr(e,t,i){if(typeof Tn>"u"){console.error("This method should be called only from the Service worker.");return}let o;typeof e=="object"?(o=e,e=t,t=i):o=Wh();try{let s=t||{},u=e;if(s.JSONCommand=u,se)if(s.dataurl){let l=s.dataurl;s.dataurl="<cut>",U("plugin command: "+u+" : "+JSON.stringify(s))(),s.dataurl=l}else U("plugin command: "+u+" : "+JSON.stringify(s).substring(0,2e3))();return o.launchJSON(s)}catch(s){return Tt(s.message),!1}}var Io="alarmUpdateToken",zr=360,ko=30,Du="b2s=",pe=Object.freeze({success:0,networkError:1,rejectedByServer:2,invalidResponse:3,noValidExistingToken:4,tokenInactive:5});function Ru(e){for(let t in pe)if(pe[t]===e)return t;return"unknown status"}function Mu(){return Gr(JSON.stringify({UA:navigator.userAgent,rid:new Date().getTime(),hwid:rt.getOption(k.Re,""),extver:chrome.runtime.getManifest().version}))}var xo=class{async Yt(){U("Checking token activation")();let t=re(k.N),i=re(k.b);t&&i&&await this.je(Ao(t,i),i)}async he(t,i,o){await this.V();let s=await this.Ue(t,i,_n);if(s.result)return Wr("setToken",{data:await Kt()}),Vn(),s;if(s?.code==="104"&&!o)try{let[,u]=s.message.match(/\[\d+\]\s*(.+)$/);return ee(k.oe,u),ee(k.se,i),await this.he(u,i,!0)}catch(u){return{result:!1,message:u.message}}else return{result:!1,message:s.message}}async je(t,i){return await this.He(t,i)?await this.he(t,i):(U("Activation is not required")(),{result:!0})}#i=!1;async Ve(t){if(this.#i){U("Token update already in progress.")();return}this.#i=!0,await Wt(async()=>{await this.We(_n),Wr("setToken",{data:await Kt()}),Vn(),t&&t(!0)})(),this.#i=!1}async W(){await chrome.alarms.create(Io,{periodInMinutes:ko})}async Jt(){await Kt()?await chrome.alarms.get(Io)||(U("Scheduling token update alarm")(),await this.W()):(U("No token found, not scheduling update timer")(),this.K())}async K(){U("Disabling token update timer")(),await chrome.alarms.clear(Io)}async V(){U("Removing token from the storage")(),await chrome.storage.local.set({[k.f]:""}),await this.K()}async me(t,i,o){let s=p=>p.user&&p.serial?`${Gr(p.user)}/${Gr(p.serial)}`:p.sid?p.sid:null,u=async p=>{let m;try{m=await fetch(p,{signal:AbortSignal.timeout(1e4),credentials:"include",method:"get",headers:{"X-FS-DATA":Mu()}})}catch(g){return g.message||"Network error occurred while fetching the response"}if(!m.ok)return`Network error: ${m.status} ${m.statusText}`;let y;try{y=await m.json(),U("Received response: "+JSON.stringify(y))()}catch{return"Invalid response from server"}return y},d=await(async()=>{se||(i=void 0),se||(o=void 0);let p=i||await Co(),m=o||chrome.runtime.id,y=s(t);if(!y)return"Invalid credentials";let g=`${To}/activate/${y}/${p}/${btoa(m)}`,_=await u(g);if(typeof _!="object"||!_.status)return JSON.stringify(_);if(btoa(_.status)===Du){let v=await new $t(_.payload).ge();return v===null&&(await chrome.storage.local.set({[k.f]:_.payload}),await this.W()),v}return _.message||"Unknown error"})();return d?{result:!1,code:(/\[(\d+)\]/.exec(d)||[])[1],message:d}:{result:!0}}async Ge(){let t=async u=>{let l=!1;switch(u){case pe.noValidExistingToken:await this.V();break;case pe.networkError:l=!0;break;case pe.invalidResponse:l=!0;break;case pe.success:l=!0;break;case pe.tokenInactive:await this.K();break;case pe.rejectedByServer:await this.V();break}l&&await this.W()},i=async u=>{let l;try{if(l=await fetch(u,{signal:AbortSignal.timeout(1e4),method:"get",headers:{"X-FS-DATA":Mu()}}),!l.ok)return pe.networkError;let d=await l.json();return U("Received response from server: "+JSON.stringify(d))(),d}catch(d){return U("Network error while fetching update: "+d)(),pe.networkError}},s=await(async()=>{let u=await Kt();if(!u)return pe.noValidExistingToken;let l,d=!1;try{l=await at(u),d=l.p()}catch(y){return U("Error while parsing old token: "+y)(),pe.noValidExistingToken}if(!se&&!d)return pe.tokenInactive;let p=await i(await l.ze());if(typeof p=="number")return p;if(typeof p!="object"||!p.status)return pe.invalidResponse;if(btoa(p.status)===Du){U("Received token")();let g=await(await new $t(p.payload)).ge();return g!==null?(U("Error while parsing new token: "+g)(),pe.invalidResponse):(await chrome.storage.local.set({[k.f]:p.payload}),pe.success)}else return pe.rejectedByServer})();return U("update status: "+Ru(s))(),await t(s),s}async qe(t){try{let o=(await at(t)).ye();await fetch(`https://auth.getfireshot.com/deactivate/${o.sid}/${o.guid}/${btoa(o.eid)}`),await this.K(),U("Token successfully deactivated")()}catch{}}async He(t,i){if(!t||!i)return!0;let o=await at();if(o){let s,u;try{s=o.ye(),u=o.p()}catch{return!0}if(u){if(s&&s.user===t&&s.serial===i)return!1}else return!0}return!0}async Ue(t,i,o){let s=await this.me({user:t,serial:i});if(s.result)return s;{let u=s.code,l=s.message;return U(`Failed to activate token with user '${t}' and serial '${i}'. Code: ${u}, Message: ${l}`)(),s}}async We(t){let i=await this.Ge();return i!==pe.success?(i!==pe.networkError&&t?.captureException(`Failed to update token [${Ru(i)}]`),!1):!0}async Xt(){let t=await at();t&&(t.Ye()?(U(`Time since last token update: ${Math.round((new Date-new Date(t.A().c+"Z"))/1e3/6)/10} minutes.`)(),await this.Ve()):U(`Token (${t.Je()} old) does not need update at this time (update period is ${zr} minutes).`)())}async Qt(t){let i;try{i=await new $t(t).B(!0)}catch{return}if(i&&i.p()&&i.j()&&i.ve()&&!i.O()){U("Found previous token, restoring...")();let o=i.be();(await this.me({sid:o})).result&&(Wr("setToken",{data:await Kt()}),U("... successfully restored."))}}};var xg=new xo;var Nu=Object.freeze({active:"YWN0aXZl",past_due:"cGFzdF9kdWU=",canceled:"canceY2FuY2VsZWQled"}),To="https://auth.getfireshot.com",$t=class{#i="";#e=null;constructor(t){this.#i=t}async#a(t){async function i(_){let S="object",v=typeof x,w=await crypto.subtle.digest("SHA-256",new TextEncoder().encode(S)),I=await crypto.subtle.digest("SHA-256",new TextEncoder().encode(v)),T=await crypto.subtle.importKey("raw",w,"AES-CBC",!1,["decrypt"]),A=await crypto.subtle.decrypt({name:"AES-CBC",iv:new Uint8Array(I).subarray(0,16)},T,_);return T=null,new TextDecoder("utf-8").decode(A)}function o(_){return Uint8Array.from(atob(_),S=>S.charCodeAt(0))}function s(_){return Uint8Array.from(_,S=>S.charCodeAt(0))}async function u(_,S){let w=o(`
                MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAv7UA7s/pYDrVCY4kunni                DnmdnwgAxBpfqCOEFQZMGHh6G+/FsDbuyyQntq21W5Qi42P3UrPBJqnZ7wfhVsvj                TT9Kuty1r2mn3BD7zz2owamqtGX0s7JiQ4sdjDcVYwxTXbeq5rvX2Fh4PRQfGCIU                HWK8A4/rJDOwy0PseSnB+MsRh+XorlgMNm6VYpMkW6I2fERH96N97K9rS8HkEdLO                Y6mKYy5m41y1xttGhFxHRJkfbMlK0dqvkOI7RT0dRltnnb1x96HSabUok+A7+2fu                G3Pzb0lbVKKDuRsBIk2VExvMAW49JLy9Qi3y3iOgQQ/fmeLcv5JWe6YQQ3kyZP2O                iY01PF3V3UxH0yI5c6+13VENabHmfE1GAGSRikdZc7w5P3iuTJ+KxPLnrOFm1swl                ga23qG4rnZ1+b768dAUhWA1JRcpEaW4NKigb6x0vveaI09eTdNXHgnYtmMUx7Ubg                xeIdVtWXoJdrJ6tKMTrbaSUmJAur5lFhhdHd2RmJuT8SIIzWyGNroP5KxB+uOaPz                cltBajATKRSzwgSB6HP1rKADTRrNgVZQhIQJqJg2GoQQ0R5ijKdIOm95eraKnEeC                OvTlhVV+NHwo/QsoSBlMmpnFAS+S9AwiqH46xM0We1w9nlpEdb3ZcCVqm1NIK0Ta                3SbTHMwiWFh52R0DpU+AxiECAwEAAQ==`.replace(/\s/g,"")),I={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}},T=await crypto.subtle.importKey("spki",w,I,!0,["verify"]);return await crypto.subtle.verify("RSASSA-PKCS1-v1_5",T,S,_)}let l=o(this.#i),d;try{d=await i(l)}catch(_){throw"Invalid token format: "+_}let p=JSON.parse(d);if(!p||!p.data||!p.signature)throw"Token misses data or signature";let m;try{m=await u(s(p.data),o(p.signature))}catch(_){throw"Error while checking signature: "+_}if(!m)throw"Signature is wrong";let y=JSON.parse(p.data),g=await Co();if(!t&&y.guid!==g)throw"This token belongs to another extension guid.";if(!t&&y.eid!==chrome.runtime.id)throw"This token belongs to another extension.";return y}async B(t){try{return this.#e=await this.#a(t),this}catch{return null}}ze(){return`${To}/update/${this.#e.sid}/${this.#e.guid}/${btoa(this.#e.eid)}`}Xe(){return this.#e.status}Zt(){return this.#e.owner}en(){return this.#e.plan}j(){return typeof this.#e.enabled<"u"?this.#e.enabled:!0}Je(){let t=(new Date-new Date(this.A().c+"Z"))/1e3/60/60;return`${Math.floor(t)}h:${Math.floor((t-Math.floor(t))*60)}m`}Ye(){return this.O()?!0:new Date-new Date(this.A().c+"Z")>zr*60*1e3}we(){let t=new Date-new Date(this.A().c+"Z");return t>(zr+ko*4)*60*1e3?(U(`Token update expired: ${Math.round(t/1e3/60/6)/10} hours ago`)(),!0):!1}O(){let t=new Date-new Date(this.A().e+"Z");return t>0?(U(`Subscription expired: ${Math.round(t/1e3/60/6)/10} hours ago`)(),!0):!1}_e(){return this.j()&&(!this.p()||this.O()&&this.we())}tn(){return this.#e.cap||1}ve(){return this.be().substring(0,4)==="sub_"}be(){return this.#e.sid}p(){let t=this.Xe();if(!t)return!1;let i=btoa(t);return i===Nu.active||i===Nu.past_due}ye(){return this.#e}A(){return{c:this.#e.c,s:this.#e.s,e:this.#e.e}}async ge(){try{return await this.#a(),null}catch(t){return t}}};async function Co(){return(await chrome.storage.local.get(k.k))[k.k]||""}async function Kt(){return(await chrome.storage.local.get(k.f))[k.f]}async function at(e){try{return await new $t(e||await Kt()).B()}catch{return null}}var Cn=chrome.runtime.id,se=chrome.runtime.getManifest()?.version_name==="debug"||["legfpnnmhhnhjgekmmbkilmijnjoehne","fireshot-beta@getfireshot.com","kmmldmlijnljnnhagfldmihaimmholga"].indexOf(Cn)>-1;chrome.storage.local.get([k.te]).then(e=>se=se||e[k.te]);var Gh=console.log.bind(console);U("Extension ID: "+Cn)();function zh(){return re(k.re)==="true"||re(k.re)==="1"}function qh(){return self.constructor.name==="ServiceWorkerGlobalScope"}function Yh(){let e=re(k.T,"false")==="true";return qh()&&e&&!Tn.port?(ee(k.T,"false"),!1):e}function Hn(){return zh()?!1:Yh()}function Fu(){return Hn()&&(re(k.C)!=="true"||re(k.t)==="true")}function Lu(){return re(k.De,"fasle")==="true"}function Be(){let e=chrome.runtime.getManifest();return{extVersion:e.version.split(".",3).join("."),extVersionFull:e.version.split(".",4).join("."),fSilentMode:Cn=="legfpnnmhhnhjgekmmbkilmijnjoehne"}}function Oa(e){U("openURLV2")();let i=(o,s=0)=>{s>0&&U(`trial ${s}`)();let u=()=>{++s<10?setTimeout(()=>i(o,s),150):chrome.windows.create({url:e}).catch(l=>reportError(l))};try{chrome.tabs.create(o).catch(()=>u())}catch{u()}};i({url:e})}function Ve(e,t){if(U("openURL")(),!t)return chrome.tabs.create({url:e});chrome.tabs.create({url:e},i=>{let o=(s,u)=>{if(s===i.id)switch(u.status){case"complete":chrome.tabs.onUpdated.removeListener(o),t(i);break}};chrome.tabs.onUpdated.addListener(o),setTimeout(()=>chrome.tabs.onUpdated.removeListener(o),1e4)})}function un(){return(...e)=>{if(e.length!==0)if(se&&console.log.bind(console,...e)(),e.length>1)kn(JSON.stringify(e).substring(0,512));else{let t=typeof e[0]=="string"?e[0]:JSON.stringify(e);kn(t.substring(0,512))}}}function U(...e){let t=()=>{};if(e.length===0)return t;if(e.length>1)kn(JSON.stringify(e).substring(0,512));else{let i=typeof e[0]=="string"?e[0]:JSON.stringify(e);kn(i.substring(0,512))}return se?Gh.bind(console,...e):t}function wt(e){se&&console.time(e)}function _t(e){se&&console.timeEnd(e)}function Tt(e){console.error("FireShot: "+e)}function Jh(e){return Ca()?e.replace(/Command|Cmd/,"\u2318").replace("Shift","\u21E7").replaceAll("+",""):e}function Bu(){let e=document.createNodeIterator(document.documentElement,NodeFilter.SHOW_ELEMENT,null),t;for(;t=e.nextNode();)[{i18Attr:"data-i18n",originalAttr:"innerText"},{i18Attr:"data-title-i18n",originalAttr:"title"}].forEach(o=>{let s;if(s=t.getAttribute(o.i18Attr)){let u=chrome.i18n.getMessage(s);u?t[o.originalAttr]=u:t[o.originalAttr]=(se?"#":"")+t[o.originalAttr],se||t.removeAttribute(o.i18Attr)}})}function Ku(e){if(!e||!Po()||re(k.Ie,"false")==="true"){ee(k.ie,e),chrome.action.setBadgeBackgroundColor({color:"#c72a1c"});try{chrome.action.setBadgeTextColor({color:"#fff"})}catch{}chrome.action.setBadgeText({text:e?"New":""}),e&&U("Setting badge for url: "+e)()}}function Oo(){let e=parseInt(re(k.Z,k.m)),t=Wn();return Fu()?t===k.a&&e===k.g&&(e=k.P):t===k.a&&e===k.P?e=k.g:(e===k.g||e===k.E)&&(t===k.i||t===k.o||t===k.v)&&(e=k.m),e}function Wn(){return parseInt(re(k.ee,k.i))}function $u(){return Hn()?re(k.t)=="true":(!zt()||re(k.C)==="true")&&re(k.t)=="true"}async function Vn(){let e=()=>{if(new Date>new Date(2026,1,15)&&!Hn()){let t,i=re(k.N,""),o=re(k.b,"");i!==""&&o!==""&&(i=Ao(i,o),t=Xh(i,o)),ee(k.t,t?"true":""),ee(k.u,t?"true":"")}};try{let t=await at();if(t.j())if(ee(k.C,"true"),t.ve()){let i=t.p(),o=t.O(),s=t.we();U(`Token is active: ${i}, expired: ${o}, update expired: ${s}, blocked: ${o&&s}`)();let l=!t._e();ee(k.t,l.toString()),ee(k.u,l.toString())}else ee(k.t,t.p().toString()),ee(k.u,t.p().toString());else e()}catch{re(k.C)==="true"?(ee(k.C,""),ee(k.t,""),ee(k.u,""),ee(k.N,""),ee(k.b,"")):e()}}function Po(){return re(k.u)==="true"}function Gn(e,t,i){chrome.commands.getAll(function(o){Re()&&(!(o instanceof Array&&o.length>0)||o.length>0&&!o[0].name)&&(o=[{name:e,shortcut:t}]),o.forEach(function(s){s.name===e&&i(Jh(s.shortcut))})})}function ju(e){var t=["accounts-static.cdn.mozilla.net","accounts.firefox.com","addons.cdn.mozilla.net","addons.mozilla.org","api.accounts.firefox.com","content.cdn.mozilla.net","discovery.addons.mozilla.org","install.mozilla.org","oauth.accounts.firefox.com","profile.accounts.firefox.com","support.mozilla.org","sync.services.mozilla.com"];return!t.some(i=>new RegExp("^https?://"+i+"/.*$").test(e))}async function Uu(){async function e(){let t=()=>{let i=(l,d)=>{let p=[...l.querySelectorAll(d)],m=document.createNodeIterator(l,Node.ELEMENT_NODE),y;for(;y=m.nextNode();)y.shadowRoot&&p.push(...i(y.shadowRoot,d));return p},o=!0,s=4,u=(document?.scrollingElement?.scrollHeight||0)*(document?.scrollingElement?.scrollWidth||0);return i(document,"frame,iframe").forEach(l=>{try{o=o&&(document.location.origin===new URL(l.src).origin||l.clientWidth*l.clientHeight===0||u/(l.clientWidth*l.clientHeight)>=s)}catch{}}),!o};try{let[i]=await chrome.tabs.query({currentWindow:!0,active:!0}),[o]=await chrome.scripting.executeScript({target:{tabId:i.id},injectImmediately:!0,func:t});return o.result}catch(i){return U(i)(),!1}}return Re()||await chrome.permissions.contains({permissions:["tabs"],origins:["<all_urls>"]})?!1:await e()}function Iu(e){let t=e.match(/,(.{100})/);if(t&&t.length>0){let i=Uint8Array.from(atob(t[1]),o=>o.charCodeAt(0));return{w:i[18]<<8|i[19],h:i[22]<<8|i[23]}}else return{w:0,h:0}}function Do(){function e(){let t=parseInt(re(k.F,0));return{reset:()=>{U("reset state")(),t=k.ue,ee(k.F,t)},add:i=>{U("add state")(),t|=i,ee(k.F,t)},remove:i=>{U("remove state")(),t&=~i>>>0,ee(k.F,t)},contains:i=>(t&i)===i,isIdle:()=>t===k.ue}}return new e}function Hu(){function e(u){switch(u){case k.E:return"action_save";case k.g:return"action_save_pdf";case k.G:return"action_copy";case k.z:return"action_email";case k.q:return"action_external";case k.X:return"action_onenote";case k.Y:return"action_upload";case k.J:return"action_print";case k.P:return"action_save_pdf_single";default:return"action_edit"}}let t,i=e(Oo()),o=!Fu(),s=Wn();switch(s){case k.v:t=o?"action_capture_visible_lite":"action_capture_visible";break;case k.o:t=o?"action_capture_selection_lite":"action_capture_selection";break;case k.U:t="action_capture_browser";break;case k.a:t="action_capture_tabs";break;default:t=o?"action_capture_entire_lite":"action_capture_entire"}return o&&s!==k.a?chrome.i18n.getMessage(t):chrome.i18n.getMessage(t)+" "+chrome.i18n.getMessage(i)}function qr(){return In(re(k.b))==="4d592f5edbb6328882e83d6de50fdf7c"?k.L:0}function Ao(e,t){let i=re(k.se,""),o=re(k.oe,"");return i&&o&&i===t&&(e=o),e}function Gr(e){return btoa(String.fromCharCode(...new TextEncoder().encode(e)))}function Xh(e,t){let i=p=>{for(var m="",y=0;y<p.length;y++){var g=p[y].toString(16);g.length<2&&(g="0"+g),m+=g}return m},o=p=>{if(!p||p.length<1)return new Uint8Array(0);let m=[],y=p.length,g="0123456789abcdefghijklmnopqrstuvwxyz";p[0]!=="2"&&(g="23456789abcdefghjklmnpqrstuvwxyz");let _=[];for(let P=0;P<y;P++){let C=p[P].toLowerCase();for(let D=0;D<g.length;D++)if(g[D]===C){_[P]=D;break}}let S=0,v,w,I=0,T=0;for(;I<y;){v=0;let P=0;for(;v<8&&I<y;){let C=_[I];w=Math.min(5-S,8-v),S<=v?C=C<<v:C=C>>S,P=P|C,v+=w,S+=w,S>=5&&(I++,S=0)}m[T++]=P}let A=Math.floor(y*5/8);return new Uint8Array(m.slice(0,A))},s=(p,m,y,g)=>{let _=m.length;if(g===1)for(let S=0;S<y;S++){let v=S%_;p[S]=p[S]^m.charCodeAt(v)}else if(g===2){let S=0,v=0;for(let w=0;w<Math.max(y,_);w++)p[S]=p[S]^m.charCodeAt(v),S++,v++,S===y&&(S=0),v===_&&(v=0)}return p};t=t.replace(/-/g,"");let u=o(t),l=u[0]&15,d=!1;if(l===2){if((u[0]&240)>>5===1){let m=s(u.slice(1),e,u.length-1,2),y=i(m.slice(0,5));d=y===i([0,26,26,51,84])||y===i([5,27,26,57,74])}}else if(l===4&&(u[0]&240)>>5===1){let m="FS";for(let v=13;v>=10;--v)m+=i(u.slice(v,v+1));m=m.toUpperCase();let y=In(m),g=s(u.slice(1),y,u.length-1,2),_=s(g,e,g.length,2);d=i(_.slice(0,5))===i([0,26,26,51,84])}return d}function Vu(){return new Proxy({},{get:(e,t)=>(...i)=>{let o=null;return typeof i[i.length-1]=="function"&&(o=i.pop()),new Promise(s=>{chrome.runtime.sendMessage({message:"callExtensionMethodMsg",method:t,params:i,async:o!==null},u=>{chrome.runtime.lastError,o&&typeof u<"u"&&o(u),s(u)})})}})}ka();var he,Ro,Jr,Xr,Yr,Gu,ln,zu,Xe=Vu();function zn(){let e=he===k.a,t=e?"block":"none",i=e?"none":"block";document.getElementById("divWarningFreeMode").style.display=e&&!Jr&&!ln?"block":"none",Xr?qr()===k.L?(document.getElementById("mnuSave").style.display="block",document.getElementById("mnuSaveSinglePDF").style.display="block",document.getElementById("mnuSaveImage").style.display="none",document.getElementById("mnuSavePDF").style.display="none",document.getElementById("mnuClipboard").style.display="none",document.getElementById("mnuPrint").style.display="none",document.getElementById("mnuEmail").style.display="none",document.getElementById("mnuEdit").style.display="none",document.getElementById("mnuUpload").style.display="none",document.getElementById("mnuExtEdit").style.display="none",document.getElementById("mnuSendOneNote").style.display="none"):ln?(document.getElementById("mnuSaveImage").style.display="block",document.getElementById("mnuSavePDF").style.display="block",["mnuClipboard","mnuClipboard","mnuSave","mnuPrint","mnuEmail","mnuSaveSinglePDF","mnuEdit","mnuUpload","mnuExtEdit","mnuSendOneNote"].forEach(o=>document.getElementById(o).style.display="none")):(document.getElementById("mnuSaveImage").style.display="none",document.getElementById("mnuSaveSinglePDF").style.display=t,document.getElementById("mnuSavePDF").style.display=i):(document.getElementById("mnuSaveImage").style.display="block",document.getElementById("mnuSavePDF").style.display="block",document.getElementById("mnuClipboard").style.display="none",document.getElementById("mnuSave").style.display="none",document.getElementById("mnuPrint").style.display="none",document.getElementById("mnuEmail").style.display="none",document.getElementById("mnuSaveSinglePDF").style.display="none",document.getElementById("mnuEdit").style.display="none",document.getElementById("mnuUpload").style.display="none",document.getElementById("mnuExtEdit").style.display="none",document.getElementById("mnuSendOneNote").style.display="none")}function cn(e,t){let i=document.getElementById(t);i.style.display="block",i.style.left=Math.min(document.body.clientWidth-i.clientWidth-5,e.pageX)+"px",i.style.top=Math.min(document.body.clientHeight-i.clientHeight-5,e.pageY)+"px"}function Wu(e){let t=document.getElementById(e);t.style.display="none"}function Qh(){let e=Hu();document.getElementById("spnLastAction").textContent=e,document.getElementById("spnLastAction").title=e,document.getElementById("spnShortcut").textContent="",chrome.commands.getAll(()=>{Gn("last-used-action","Cmd+Shift+S",t=>{document.getElementById("spnLastAction").title=e+" ("+t+")",document.getElementById("spnShortcut").textContent=t,document.getElementById("spnShortcutStop").textContent=t}),Gn("capture-entire-page-action","Cmd+Shift+1",t=>document.getElementById("spnShortcutEntire").textContent=t),Gn("capture-visible-page-action","Cmd+Shift+2",t=>document.getElementById("spnShortcutVisible").textContent=t),Gn("capture-selection-action","Cmd+Shift+6",t=>document.getElementById("spnShortcutSelection").textContent=t)})}function Zh(){let e=function(s){return s.preventDefault(),em(this,s),!0},t=function(){nm(this)},i=document.createNodeIterator(document.documentElement,NodeFilter.SHOW_ELEMENT,null);for(var o;o=i.nextNode();)o.nodeName==="LI"?(o.onclick=e,o.onmouseover=t):o.getAttribute("rel")==="command"&&(o.onclick=e)}async function em(e,t){async function i(p,m){if(qr()===k.L&&(p=k.E),m===k.a&&!Me()&&!Re()){let y={permissions:["tabs"],origins:["<all_urls>"]};Xr||y.permissions.push("downloads"),await Xe.addTaskOnPermissionGranted(y,{method:"executeGrabber",args:[p,m]}),chrome.permissions.request(y),window.close()}else if(d&&Jr&&!Me()&&!Re()&&await Uu())window.location.href=`fsTabsPermissionPopup.html?mode=${m}&action=${p}`;else{let y=t.altKey&&(m===k.i||m===k.v||m===k.U);await Xe.executeGrabber(p,m,{delayed:y,altKey:t.altKey}),m===k.i&&!y?qu(!0):window.close()}}async function o(){window.location.href="fsLicensingInfoPopup.html"}if(e.className=="disabled")return;let s=["mnuEdit","mnuSave","mnuSaveImage","mnuSavePDF","mnuUpload","mnuPrint","mnuClipboard","mnuEmail","mnuExtEdit","mnuSendOneNote"],u=["mnuTest","mnuCaptureEntire","mnuCaptureVisible","mnuCaptureSelection","mnuCaptureBrowser","mnuCaptureTabs","mnuMiscellaneousFolder","mnuLicenseInfo","mnuCaptureList"];Ro=e;let l=he===k.a&&e.parentElement&&e.parentElement.getAttribute("rel")==="mnuTools",d=!Me()&&!Re()&&(he===k.i||he===k.o)&&s.includes(e.id)||e.id==="mnuCaptureEntireLite"||e.id==="mnuCaptureSelectionLite"||e.id==="mnuQuickLaunch"&&(Yr===k.i||Yr===k.o);switch(e.id){case"mnuTest":tm();break;case"mnuHistory":Vr();break;case"mnuResume":Xe.resumeEditing();break;case"mnuPreferences":case"mnuPreferencesLite":xu(!1);break;case"mnuQuickLaunch":await i(Gu,Yr);break;case"mnuCaptureEntire":he=k.i,zn(),cn(t,"mnuTools");break;case"mnuCaptureVisible":he=k.v,zn(),cn(t,"mnuTools");break;case"mnuCaptureSelection":he=k.o,zn(),cn(t,"mnuTools");break;case"mnuCaptureBrowser":he=k.U,zn(),cn(t,"mnuTools");break;case"mnuCaptureTabs":he=k.a,zn(),cn(t,"mnuTools");break;case"mnuCaptureList":window.location.href="fsCaptureList.html";break;case"mnuMiscellaneousFolder":cn(t,"mnuMiscellaneous");break;case"mnuViewDemo":Tu();break;case"mnuSupport":Cu();break;case"mnuAPI":Au();break;case"mnuUpgrade":await Xe.doTrial();break;case"mnuRegister":So("extMainMenu");break;case"mnuUpgradePlan":So("extMainMenu");break;case"mnuEnterLicense":Xe.enterLicense();break;case"mnuCaptureEntireLite":await i(k.m,k.i);break;case"mnuCaptureVisibleLite":await i(k.m,k.v);break;case"mnuCaptureSelectionLite":await i(k.m,k.o);break;case"mnuEdit":await i(k.m,he);break;case"mnuSaveImage":case"mnuSave":await i(k.E,he);break;case"mnuSavePDF":await i(k.g,he);break;case"mnuSaveSinglePDF":await i(k.P,he);break;case"mnuUpload":await i(k.Y,he);break;case"mnuPrint":await i(k.J,he);break;case"mnuClipboard":await i(k.G,he);break;case"mnuEmail":await i(k.z,he);break;case"mnuExtEdit":await i(k.q,he);break;case"mnuSendOneNote":await i(k.X,he);break;case"mnuOpenFile":await Xe.openFile();break;case"mnuOpenClipboard":await Xe.openClipboard();break;case"mnuLicenseInfo":o();break;case"mnuAbout":await Xe.showAbout();break;case"mnuStopFireShot":Xe.onStopCapturingClicked();break;case"mnuFireShotNative":case"lnkTryPro":Ou();break;case"lnkTryAnotherPage":Ve("https://www.google.com/search?q=kitties");break;case"lnkAllowFileAccess":Ve("https://getfireshot.com/enable-file-access.php?browser=ch");break;case"lnkExtensionSettings":ku();break}!d&&!l&&!u.includes(e.id)&&window.close()}async function tm(){Ve("fsTests.html")}function nm(e){e!=Ro&&(!e.parentNode||e.parentNode.getAttribute("rel")!="mnuTools")&&(document.getElementById("mnuTools").style.display="none"),e!=Ro&&(!e.parentNode||e.parentNode.getAttribute("rel")!="mnuMiscellaneous")&&(document.getElementById("mnuMiscellaneous").style.display="none")}async function rm(){try{Bu()}catch(e){Tt(e.message)}Zh(),Qh(),im(om)}function im(e){cm(!1,i=>{for(let o in i){let s=document.getElementById(o);if(s===null)alert("Element "+o+" not found");else{let u=i[o];s.style.display=u==="hidden"?"none":"block",u==="disabled"?s.classList.add("disabled"):s.classList.remove("disabled")}}ln?document.getElementById("mnuLicenseInfo").classList.add("warning-suspended"):zu&&document.getElementById("mnuLicenseInfo").classList.add("warning-expired"),document.body.style.display="block",e()})}function om(){function e(S){let v=function(){return{next:null,prev:null,getPrev:function(){for(var C=this.prev;C&&C.node.style.display==="none";)C=C.prev;return C},getNext:function(){for(var C=this.next;C&&C.node.style.display==="none";)C=C.next;return C}}},w=document.createNodeIterator(S,NodeFilter.SHOW_ELEMENT,{acceptNode(C){return C.nodeName.toLowerCase()==="li"&&!C.classList.contains("disabled")&&C.style.display!=="none"&&C.parentNode.parentNode.style.display!=="none"?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}});for(var I=new v,T=null,A=I,P;P=w.nextNode();)A.node=P,A.prev=T,T&&(T.next=A),T=A,A=new v;return I}function t(S){S.node.classList.add("hoverstyle")}function i(){let S=new Event("click");S.pageX=1e3,S.pageY=g.node.getClientRects()[0].top,g.node.dispatchEvent(S)}function o(S){g&&g.node.classList.remove("hoverstyle"),g=S,S.node.classList.add("mouseactive")}function s(S,v){let w=v.node;g&&g.node.classList.remove("hoverstyle"),w.id==="mnuCaptureEntire"||w.id==="mnuCaptureVisible"||w.id==="mnuCaptureSelection"||w.id==="mnuCaptureBrowser"||w.id==="mnuCaptureTabs"?(_=g,g=p.node.style.display==="none"?p.getNext():p):w.id==="mnuMiscellaneousFolder"&&(_=g,g=m.node.style.display==="none"?m.getNext():m),S.isTrusted||t(g)}function u(S){if(!g.node)return;let v=!g.node.classList.contains("hoverstyle")&&!g.node.classList.contains("mouseactive");if(y.forEach(I=>I.node.classList.remove("mouseactive")),S.key==="ArrowDown"&&v)t(g);else if(S.key==="ArrowDown"&&g.getNext())g.node.classList.remove("hoverstyle"),g=g.getNext(),t(g);else if(S.key==="ArrowUp"&&g.getPrev())g.node.classList.remove("hoverstyle"),g=g.getPrev(),t(g);else if(S.key==="Enter")i();else if(S.key==="ArrowRight"){var w=g.node;(w.id==="mnuMiscellaneousFolder"||w.id==="mnuCaptureEntire"||w.id==="mnuCaptureVisible"||w.id==="mnuCaptureSelection"||w.id==="mnuCaptureBrowser"||w.id==="mnuCaptureTabs")&&i()}else S.key==="ArrowLeft"&&_&&(g.node.classList.remove("hoverstyle"),g=_,_=null,t(g),Wu("mnuTools"),Wu("mnuMiscellaneous"))}let l=(S,v)=>(v.node&&S.push(v),v.next&&[v.next].reduce(l,S),S);var d=e(document.getElementById("mnuMain")),p=e(document.getElementById("mnuTools")),m=e(document.getElementById("mnuMiscellaneous")),y=[d,p,m].reduce((S,v)=>S.concat([v].reduce(l,[])),[]),g=d,_=null;y.forEach(S=>{S.node.addEventListener("mouseover",()=>{o(S)}),S.node.addEventListener("click",v=>{s(v,S)})}),document.addEventListener("keydown",u)}function qu(e){e&&ee(k.Oe,0),window.location.href="fsProgress.html"}async function sm(){try{let[e]=await chrome.tabs.query({currentWindow:!0,active:!0});if(/https:\/\/copilot\.microsoft\.com/.test(e.url))try{return await chrome.scripting.executeScript({target:{tabId:e.id},func:()=>{}}),!1}catch{return!0}}catch{return!1}}async function am(){if(Me()||Re())return!1;try{let[e]=await chrome.tabs.query({currentWindow:!0,active:!0});if(/https:\/\/(dbg\.)?getfireshot\.com\/activate[1]*\.php/.test(e.url))return un()("activation page"),await chrome.scripting.executeScript({target:{tabId:e.id},injectImmediately:!0,files:["scripts/page/fsActivation.js"]}),!0}catch(e){return console.error(e),!1}}function um(){let e=re(k.ie,"");return e?(Ku(""),Ve(e),ee(k.xe,Be().extVersion),!0):!1}function cm(e,t){function i(o){var s=o==="capturing-prohibited",u=o==="safari-extension-page",l=o==="file-not-allowed",d=o==="capturing-executescript-disabled",p=!Xr||ln,m=Jr,y=Po(),g=Wn(),_=zt(),S=m&&y||ln;qr()===k.L&&(p=!0);let v={sepMain1:"visible",sepMain2:"visible",sepSupport1:p?"hidden":"visible",sepSupport2:p?"hidden":"visible",sepAdvanced:_?"visible":m?"hidden":"visible",mnuCaptureTabs:"visible",mnuCaptureList:"visible",mnuFeaturesUnavailable:s?"visible":"hidden",mnuEnableFileSupport:l?"visible":"hidden",mnuQuickLaunch:s&&(g==k.i||g==k.o||g==k.v)||d&&(g==k.i||g==k.o)?"disabled":"enabled",mnuCaptureVisible:s?"disabled":"visible",mnuCaptureEntire:s||d?"disabled":"visible",mnuCaptureSelection:s||d?"disabled":"visible",mnuCaptureBrowser:m&&!p?"visible":"hidden",mnuCaptureVisibleLite:s?"disabled":"visible",mnuCaptureEntireLite:s||d?"disabled":"visible",mnuCaptureSelectionLite:s||d?"disabled":"visible",mnuPreferencesLite:p?"visible":"hidden",mnuViewDemo:p?"hidden":"visible",mnuSupport:p?"hidden":"visible",mnuAbout:p?"hidden":"visible",mnuMiscellaneousFolder:p?"hidden":"visible",mnuResume:p?"hidden":Lu()?"enabled":"disabled",mnuUpgrade:p||m?"hidden":"visible",mnuRegister:p?"hidden":m&&!y?"visible":"hidden",mnuUpgradePlan:"hidden",mnuEnterLicense:p?"hidden":m&&!y?"visible":"hidden",mnuOpenFile:p?"hidden":m?"enabled":"disabled",mnuOpenClipboard:p?"hidden":m?"enabled":"disabled",mnuLicenseInfo:S?"visible":"hidden",divCaptureToolsLite:p?"visible":"hidden",divCaptureTools:p?"hidden":"visible",mnuFireShotNative:!m&&p&&!S?"visible":"hidden",mnuStopFireShot:"hidden",mnuHistory:"visible",mnuTest:se?"visible":"hidden"};for(var w in v){let I=Do();if(I.contains(k.ce)||I.contains(k.le)||I.contains(k.fe))v[w]=w==="mnuStopFireShot"?"visible":"hidden";else if(s)v[w]=w==="mnuFeaturesUnavailable"?"visible":"hidden";else if(u){let T=["mnuCaptureVisibleLite","sepMain2","mnuPreferencesLite","mnuCaptureTabs","mnuCaptureList"];v[w]=T.includes(w)?"visible":"hidden"}else l&&(v[w]=w==="mnuEnableFileSupport"?"visible":"hidden")}t(v)}chrome.tabs.query({currentWindow:!0,active:!0},function(o){try{if(o.length===0||!o[0].url){i("capturing-prohibited");return}let s=o[0],u=Me();if(/^(chrome-extension|moz-extension).*/.test(s.url))i("capturing-executescript-disabled");else if(/^safari-web-extension.*/.test(s.url))i("capturing-executescript-disabled");else if(!u&&/^file:\/\/.*/.test(s.url)){chrome.extension.isAllowedFileSchemeAccess(l=>{i(l?"capturing-allowed":"file-not-allowed")});return}else!u&&/^(http|https|ftp|ftps):\/\/.*/.test(s.url)&&!/^https?:\/\/chromewebstore.google.com\/.*$/.test(s.url)||u&&/^(http|https|ftp|ftps|file):\/\/.*/.test(s.url)&&ju(s.url)?i("capturing-allowed"):i("capturing-executescript-disabled")}catch{i("capturing-prohibited")}})}document.addEventListener("DOMContentLoaded",()=>rt.ensureLoaded().then(async()=>{if(dr()&&await sm()){window.location.href="fsCopilotLimited.html";return}if(await am()){setTimeout(window.close,5);return}Xr=await Xe.isNativeSupported();let e=Do();if(e.contains(k.de)){e.remove(k.de),setTimeout(window.close,5);return}if(e.contains(k.ce)||e.contains(k.le)||e.contains(k.fe)){qu();return}await Vn();let t=await at();if(zu=t?.j()&&t.O(),ln=t?._e(),Re()&&(document.getElementById("mnuStopFireShot").style["margin-top"]="6px",document.getElementById("mnuMain").style.margin="2px",document.body.style.setProperty("min-height","40px")),Jr=$u(),Yr=Wn(),Gu=Oo(),um())if(Re()){let i=document.createElement("p");i.textContent="FireShot has been updated",document.body.replaceChild(i,document.getElementById("mnuMain")),document.body.style.display="block"}else window.close();else rm()}));})();
//# sourceMappingURL=fsPopup.js.map

//# debugId=b75f1eaf-338c-5a7b-8313-b1f2b9e144eb
