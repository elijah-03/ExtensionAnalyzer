class Relax{constructor(){this.storage={state:!0,range:15,color:"#fac563"},this.init(),this.onStorageChanged(),this.relaxerListener()}init(){chrome.storage.local.get(this.storage,(e=>{this.storage=e,this.start()}))}saveStorage(){chrome.storage.local.set(this.storage)}start(){this.injectRelaxer(),this.checkTime()}relaxerListener(){chrome.runtime.onMessage.addListener((e=>{"disable_light"===e.message&&(this.storage.state=!1,this.saveStorage())}))}checkTime(){const e=this.checkTimeOnValid("22","7");this.storage.state!==e&&(this.storage.state=e,this.saveStorage())}checkTimeOnValid(e,t){const o=new Date;return o.getHours()>=e||o.getHours()<t}injectRelaxer(){const e=document.createElement("div");e.id="relaxer",e.setAttribute("style",this.styles),document.getElementById("relaxer")||document.documentElement.appendChild(e)}get styles(){return`\n            transition: opacity 0.1s ease 0s; \n            z-index: 2147483647;\n            margin: 0; \n            border-radius: 0; \n            padding: 0; \n            background: ${this.storage.color}; \n            pointer-events: none; \n            position: fixed; \n            top: -10%; \n            right: -10%; \n            width: 120%; \n            height: 120%; \n            opacity: ${(.008*this.storage.range+.2).toFixed(4)};\n            mix-blend-mode: multiply; \n            display: ${this.storage.state?"block":"none"};\n        `}onStorageChanged(){chrome.storage.onChanged.addListener((e=>{for(const t in e)this.storage[t]=e[t].newValue;document.getElementById("relaxer").setAttribute("style",this.styles)}))}}const hostname=function(e){const t=(e=e.replace("www.","")).indexOf("//")+2;if(t>1){let o=e.indexOf("/",t);return o>0?e.substring(t,o):(o=e.indexOf("?",t),o>0?e.substring(t,o):e.substring(t))}return e};if(document.addEventListener("DOMContentLoaded",(()=>{chrome.storage.local.get("status",(e=>{1==e.status&&chrome.storage.local.get(["blacklist"],(e=>{void 0!==e.blacklist?(blacklist=e.blacklist,blacklist.indexOf("facebook.com")<=-1&&(document.body.classList.contains("__fb-dark-mode")||document.body.classList.add("__fb-dark-mode"))):document.body.classList.contains("__fb-dark-mode")||document.body.classList.add("__fb-dark-mode")}))}))})),!document.getElementById("dark-style-link")){const e=document.documentElement||document.head||document.querySelector("head"),t=document.createElement("link");t.setAttribute("type","text/css"),t.setAttribute("id","dark-style-link"),t.setAttribute("rel","stylesheet");const o=document.createElement("style");o.type="text/css";const s={ebay:"ebay.com",yahoo:"yahoo.",twitch:"twitch.tv",github:"github.com",docs:"docs.google.",bing:"bing.com",amazon:"amazon.",messenger:"messenger.com",gmail_mail:"mail.google.com",translate:"translate.google",calendar:"calendar.google",picker:"docs.google.com/picker",embed:"tasks.google.com/embed/",contacts:"contacts.google.com/",gmail:"mail.google.com",tumblr:"tumblr.",twitter:"twitter.com",inbox:"inbox.google.",drive:"drive.google.",sites:"sites.google.",youtube:"youtube.",dropbox:"dropbox.",reddit:"reddit.com",maps:"google.com/maps/",wikipedia:"wikipedia.org",instagram:"instagram.com",duckduckgo:"duckduckgo.com",stackoverflow:"stackoverflow.com",classroom:"classroom.google.com",notifications:"notifications.google.com",google:"google.com",thesaurus:"thesaurus.com",whatsapp:"web.whatsapp.com",evernote:"evernote.com",quora:"quora.com",coursera:"coursera.org",udemy:"udemy.com",medium:"medium.com"},a=hostname(document.location.href);function setStyles(){if(-1==a.indexOf("/chrome/newtab")){for(const e in s)if(a.indexOf(s[e])>-1)return void fetch(chrome.runtime.getURL(`/css/${e}.css`)).then((e=>e.text())).then((e=>{o.appendChild(document.createTextNode(e))}));const e=new Relax}}chrome.storage.local.get("status",(t=>{1==t.status&&chrome.storage.local.get(["blacklist"],(t=>{void 0!==t.blacklist?(blacklist=t.blacklist,blacklist.indexOf(a)<=-1&&(setStyles(),e&&e.appendChild(o))):(setStyles(),e&&e.appendChild(o))}))}))}