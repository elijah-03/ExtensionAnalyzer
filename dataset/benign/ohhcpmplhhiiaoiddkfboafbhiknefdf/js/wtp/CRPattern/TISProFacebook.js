function GetRealURL(e){var t=new RegExp("^https?://(.*)\\.facebook\\.com/l\\.php\\?u=(.*)&h=","i"),n=e.match(t);return n?decodeURIComponent(n[2]):e}function filterbyHref(e){for(var t=["^#$","^/","^mailto","^https?\\:\\/\\/.*\\.fbcdn\\.net","^https?\\:\\/\\/.*\\.facebook\\.com","^https?\\:\\/\\/facebook\\.interviewstreet\\.com"],n=0;n<t.length;n++)if(ptn=new RegExp(t[n],"i"),ptn.test(e))return!0;return!1}function filterByNode(e){return!(!e||void 0===e.innerHTML||""!=e.innerHTML)}function TBParseMessagesContent(e){var t,n=new CreateTSRLocatedObject(null,null,"A",null),l=new CreateTSRLocatedObject(null,n,"DIV",null),r=new CreateTSRLocatedObject(null,l,"DIV",null),a=new CreateTSRLocatedObject(null,r,"DIV",null),o=new CreateTSRLocatedObject(e,a,"DIV","gb_content_and_toolbar");if(l.appendAttribute("class","GBThreadMessageRow_Body"),a.appendAttribute("class","message_pane"),r.appendAttribute("class","GBThreadMessageRow clearfix"),r.multiMatches=!0,l.multiMatches=!0,n.multiMatches=!0,t=o.findElement())for(var c=GetAllTSRLocatedNodes(t),d=0;d<c.length;d++){var i=GetRealURL(c[d].href);filterbyHref(i)||filterByNode(c[d])||CreateTSRResultObject(c[d],i)}}function TBParseEvent(e){var t,n=new CreateTSRLocatedObject(null,null,"A",null),l=new CreateTSRLocatedObject(e,n,"DIV","event_info_pagelet");if(n.multiMatches=!0,t=l.findElement())for(var r=GetAllTSRLocatedNodes(t),a=0;a<r.length;a++){var o=GetRealURL(r[a].href);filterbyHref(o)||filterByNode(r[a])||CreateTSRResultObject(r[a],o)}}function TBParseWall(e){var t,n=new CreateTSRLocatedObject(null,null,"A",null),l=new CreateTSRLocatedObject(null,n,"DIV",null),r=new CreateTSRLocatedObject(null,l,"LI",null),a=new CreateTSRLocatedObject(e,r,"UL","profile_minifeed");if(r.multiMatches=!0,l.appendAttribute("class","^storyInnerContent"),n.multiMatches=!0,t=a.findElement())for(var o=GetAllTSRLocatedNodes(t),c=0;c<o.length;c++){var d=GetRealURL(o[c].href);filterbyHref(d)||filterByNode(o[c])||CreateTSRResultObject(o[c],d)}}function TBParseNewsFeed(e){var t,n=new CreateTSRLocatedObject(null,null,"A",null),l=new CreateTSRLocatedObject(null,n,"DIV",null),r=new CreateTSRLocatedObject(null,l,"LI",null),a=new CreateTSRLocatedObject(e,r,"DIV","home_stream");if(r.multiMatches=!0,l.appendAttribute("class","^storyInnerContent"),n.multiMatches=!0,t=a.findElement())for(var o=GetAllTSRLocatedNodes(t),c=0;c<o.length;c++){var d=GetRealURL(o[c].href);filterbyHref(d)||filterByNode(o[c])||CreateTSRResultObject(o[c],d)}}function TBParseNotes(e){if(!e.getElementById("pagelet_roosters")){var t,n=new CreateTSRLocatedObject(null,null,"A",null),l=new CreateTSRLocatedObject(e,n,"DIV","contentArea");if(n.multiMatches=!0,t=l.findElement())for(var r=GetAllTSRLocatedNodes(t),a=0;a<r.length;a++){var o=GetRealURL(r[a].href);filterbyHref(o)||filterByNode(r[a])||CreateTSRResultObject(r[a],o)}}}function TBParsePhoto(e){var t,n=new CreateTSRLocatedObject(null,null,"A",null),l=new CreateTSRLocatedObject(e,n,"DIV","photos_snowlift");if(n.multiMatches=!0,t=l.findElement())for(var r=GetAllTSRLocatedNodes(t),a=0;a<r.length;a++){var o=GetRealURL(r[a].href);filterbyHref(o)||filterByNode(r[a])||CreateTSRResultObject(r[a],o)}}function TBParsePhotoFromHome(e){var t,n=new CreateTSRLocatedObject(null,null,"A",null),l=new CreateTSRLocatedObject(e,n,"DIV","content");if(n.multiMatches=!0,t=l.findElement())for(var r=GetAllTSRLocatedNodes(t),a=0;a<r.length;a++){var o=GetRealURL(r[a].href);filterbyHref(o)||filterByNode(r[a])||"#text"==r[a].firstChild.nodeName&&CreateTSRResultObject(r[a],o)}}function TBParsePhotoFromHomeNew(e){for(var t=document.querySelectorAll("[role=main] a"),n=0;n<t.length;n++){var l=GetRealURL(t[n].href);filterbyHref(l)||filterByNode(t[n])||"#text"==t[n].firstChild.nodeName&&CreateTSRResultObject(t[n],l)}}function TBParsePhotoShowBox(e){var t,n=new CreateTSRLocatedObject(null,null,"A",null),l=new CreateTSRLocatedObject(e,n,"DIV","fbxPhotoContentContainer");if(n.multiMatches=!0,t=l.findElement())for(var r=GetAllTSRLocatedNodes(t),a=0;a<r.length;a++){var o=GetRealURL(r[a].href);filterbyHref(o)||filterByNode(r[a])||CreateTSRResultObject(r[a],o)}}function TBAdjustAdinfoStyle(e){e.style.display="inline"}function GetAdUrl(e){var t=new RegExp("^https?://(.*)\\.facebook\\.com/a\\.php\\?u=(.*)&__tn__"),n=e.match(t);return n&&n.length>2?decodeURIComponent(n[2]):e}function TBParseAds(e){var t,n=new CreateTSRLocatedObject(null,null,"A",null),l=new CreateTSRLocatedObject(null,n,"DIV",null),r=new CreateTSRLocatedObject(e,l,"DIV",null);if(r.multiMatches=!0,r.appendAttribute("class","^ego_column"),l.multiMatches=!0,l.appendAttribute("class","^ego_unit"),t=r.findElement())for(var a=GetAllTSRLocatedNodes(t),o=0;o<a.length;o++){var c=a[o].getElementsByTagName("strong");if(c.length>0){var d=GetAdUrl(a[o].href);CreateTSRResultObject(c[0],d)}}}function AdjustNodeStyle(e){if(e){var t=e.previousSibling||null;if(t&&"TSRSpan"==t.className){var n=t.childNodes[0];n&&"TSRWebRatingIcon"==n.className&&(n.style.margin="0px",n.style.padding="0px",n.style.border="0px")}}}function TBParseSiderUIStream(e){var t,n=new CreateTSRLocatedObject(null,null,"A",null),l=new CreateTSRLocatedObject(null,n,"H6",null),r=new CreateTSRLocatedObject(null,l,"DIV",null),a=new CreateTSRLocatedObject(e,r,"DIV",null);if(a.appendAttribute("class","^ego_column"),r.multiMatches=!0,r.appendAttribute("class","^fbAdUnit"),l.multiMatches=!0,l.appendAttribute("class","uiStreamMessage"),t=a.findElement())for(var o=GetAllTSRLocatedNodes(t),c=0;c<o.length;c++){var d=GetRealURL(o[c].href);filterbyHref(d)||filterByNode(o[c])||CreateTSRResultObject(o[c],d)}}function TBParseAnswerText(e){var t,n=new CreateTSRLocatedObject(null,null,"A",null),l=new CreateTSRLocatedObject(e,n,"DIV",null);if(l.appendAttribute("class","answerText"),l.multiMatches=!0,t=l.findElement())for(var r=GetAllTSRLocatedNodes(t),a=0;a<r.length;a++){var o=GetRealURL(r[a].href);filterbyHref(o)||filterByNode(r[a])||CreateTSRResultObject(r[a],o)}}function TBParseCommentBody(e){var t,n=new CreateTSRLocatedObject(null,null,"A",null),l=new CreateTSRLocatedObject(e,n,"SPAN",null);if(l.appendAttribute("class","commentBody"),l.multiMatches=!0,t=l.findElement())for(var r=GetAllTSRLocatedNodes(t),a=0;a<r.length;a++){var o=GetRealURL(r[a].href);filterbyHref(o)||filterByNode(r[a])||CreateTSRResultObject(r[a],o)}}function TSRParse(){var e=g_oEnv.Parser.iResultNumber;return TrendMicro.TB.DOMIdExist("gb_content_and_toolbar")&&TBParseMessagesContent(document),TrendMicro.TB.DOMIdExist("profile_minifeed")&&TBParseWall(document),TrendMicro.TB.DOMIdExist("home_stream")&&TBParseNewsFeed(document),TrendMicro.TB.DOMIdExist("event_info_pagelet")&&TBParseEvent(document),TBParseNotes(document),TrendMicro.TB.DOMIdExist("photos_snowlift")&&TBParsePhoto(document),TrendMicro.TB.DOMIdExist("fbxPhotoContentContainer")&&TBParsePhotoShowBox(document),TBParseSiderUIStream(document),TBParseAnswerText(document),TBParseCommentBody(document),TBParseAds(document),TrendMicro.TB.DOMIdExist("content")?TBParsePhotoFromHome(document):TBParsePhotoFromHomeNew(document),TrendMicro.TB.ReduceNewNode(e+1),g_oEnv.Parser.rgobjSearchResult}TSRTagFlowID(),g_bIsNeedCheckSPan=!0;