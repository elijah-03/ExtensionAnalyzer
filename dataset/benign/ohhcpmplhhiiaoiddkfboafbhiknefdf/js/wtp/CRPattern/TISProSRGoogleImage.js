var SS_Util=TrendMicro.TB.SAFESEARCHING;function getRealUrl(e){try{return decodeURIComponent(SS_Util.getParamFromURL(e,"imgrefurl"))}catch(t){return e}}function getRealUrlBasic(e){try{var t=SS_Util.getParamFromURL(e,"url")||SS_Util.getParamFromURL(e,"q");return decodeURIComponent(t)}catch(t){return e}}var isResizeCallbackReged=!1;function foundImageCallback(e){isResizeCallbackReged||(TMExt_$(window).resize(function(){SS_Util.refreshBlockImages(function(e){var t=e,i=e.find("img").eq(0);t.removeAttr("class"),t.css("display","inline-block"),t.css("height","100%"),t.css("text-decoration","none"),t.css("width","100%"),i.css("visibility","hidden")})}),isResizeCallbackReged=!0),TMExt_debug(e);var t=TMExt_$(e.FindInsertNode()).parent(),i=t.find("a").eq(0),l=i.find("img").eq(0),a=i.find("div").eq(0);i.attr("link_level",e.level),SS_Util.isNeedToBlock(e.level)?(TMExt_debug("==========================BLOCK THE ABOVE ONE==================================="),t.addClass("imgBlock"),SS_Util.checkImageBlockPopupExist(),i.removeAttr("class"),i.css("display","inline-block"),i.css("height","100%"),i.css("text-decoration","none"),i.css("width","100%"),l.css("visibility","hidden"),SS_Util.setBlockImage(i),a.removeAttr("style"),SS_Util.bindMouseEnterEvent(i)):TMExt_debug("the image level is "+e.level+", no need to block (level 8 is parent control category)")}function TSSRParseResult_Image(e){var t,i=new CreateTSRLocatedObject(null,null,"a",null),l=new CreateTSRLocatedObject(null,i,"div",null),a=new CreateTSRLocatedObject(e,l,"div","islmp");if(i.multiMatches=!0,i.appendAttribute("class","VFACy kGQAp"),t=a.findElement())for(var n=GetAllTSRLocatedNodes(t),r=0;r<n.length;r++){var o=n[r].href;o&&CreateTSRResultObject(n[r],o,null,null,null,null,foundImageCallback,isImageNeedReRating)}}function isImageNeedReRating(e){TMExt_debug("isImageNeedReRating"),TMExt_debug(e);var t=TMExt_$(e.FindInsertNode());if(!SS_Util.isNeedToBlock(e.level))return TMExt_debug("the image level is "+e.level+", no need to re-evalute (level 8 is parent control category)"),!1;var i=t.css("background-image");return void 0===i?(TMExt_debug("No css background-image"),!0):(TMExt_debug("bgimg="+i),!(i.indexOf("img_image_block")>=0||(TMExt_debug("No img_image_block"),0)))}function isImageNeedReRatingBasic(e){TMExt_debug("isImageNeedReRating"),TMExt_debug(e);var t=TMExt_$(e.FindInsertNode()).parent();if(!SS_Util.isNeedToBlock(e.level))return TMExt_debug("the image level is "+e.level+", no need to re-evalute (level 8 is parent control category)"),!1;var i=t.css("background-image");return void 0===i?(TMExt_debug("No css background-image"),!0):(TMExt_debug("bgimg="+i),!(i.indexOf("img_image_block")>=0||(TMExt_debug("No img_image_block"),0)))}var TIMEOUT_WAITING_GET_WIDTH_HEIGHT=500;function foundImageCallbackBasic(e){TMExt_debug(e);var t=TMExt_$(e.FindInsertNode()).parent(),i=t.find("a").eq(0),l=i.find("img").eq(0);function a(){t.attr("link_level",e.level),SS_Util.isNeedToBlock(e.level)?(TMExt_debug("==========================BLOCK THE ABOVE ONE==================================="),t.addClass("imgBlock"),SS_Util.checkImageBlockPopupExist(),l.css("visibility","hidden"),SS_Util.setBlockImage(t),t.css("border","0px"),t.empty(),t.append(i),SS_Util.bindMouseEnterEvent(t)):TMExt_debug("the image level is "+e.level+", no need to block (level 8 is parent control category)")}0===t.width()||0===t.height()?setTimeout(a,TIMEOUT_WAITING_GET_WIDTH_HEIGHT):a()}function TSSRParseResult_Image_Basic(e){var t,i=new CreateTSRLocatedObject(null,null,"a",null),l=new CreateTSRLocatedObject(e,i,"TABLE",null);if(l.appendAttribute("class","images_table"),t=l.findElement())for(var a=GetAllTSRLocatedNodes(t),n=0;n<a.length;n++){var r=getRealUrlBasic(a[n].href);r&&CreateTSRResultObject(a[n],r,null,null,null,null,foundImageCallbackBasic,isImageNeedReRatingBasic)}}function getDefaultPreviewImg(){var e=new URL(window.location.href).hash.replace("#imgrc=","");return""!==e&&TMExt_$(`[data-id=${e}]`).hasClass("imgBlock")}function previewImageBlock(){var e=TMExt_$("#islsp");getDefaultPreviewImg()?(TMExt_$("#Sva75c").css("visibility","hidden"),e.css("background-color","rgba(0,0,0,0.03)"),SS_Util.setBlockImage(e),SS_Util.bindMouseEnterEvent(e)):(TMExt_$("#Sva75c").css("visibility","initial"),e.css("background-color","none"),e.unbind("mouseenter"))}function TSRParse(){var e=g_oEnv.Parser.iResultNumber;return TSSRParseResult_Image(document),TSSRParseResult_Image_Basic(document),previewImageBlock(document),document.addEventListener("click",function(){var e=getDefaultPreviewImg();previewImageBlock(document,e)}),document.addEventListener("keydown",e=>{var t=e.key;"ArrowRight"!==t&&"ArrowLeft"!==t||previewImageBlock(document)},!1),TrendMicro.TB.ReduceImageNewNode(e+1),g_oEnv.Parser.rgobjSearchResult}TSRTagFlowID(),TMExt_debug("URL matched, start safe searching function");