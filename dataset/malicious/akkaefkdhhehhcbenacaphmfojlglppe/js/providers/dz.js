const DZProvider=class{constructor(a){this.c=a,this.code="dz",this.trackHtmlElements=[],this.runTrackWatcher(),chrome.runtime.onMessage.addListener(a=>{"pageUpdated"===a.action&&(this.trackHtmlElements=[],this.runTrackWatcher())})}registerMediaUpdateListener(a){this.mediaUpdateListener=a}runTrackWatcher(){this.intervalId&&clearInterval(this.intervalId),this.setSongsCount(),this.intervalId=setInterval(()=>this.setSongsCount(),1e3)}getItems(a){chrome.runtime.sendMessage({action:"setBadge",value:0});const b=$(".datagrid-row.song"),c=this.getPageType(),d=[];if("playlist"===c||"profile"===c||"search"===c||"smarttracklist"===c)b.each((a,b)=>{const c=$(b),e=c.find(".title span").text().xTrim(),f=c.find(".cell-artist").text().xTrim(),g=c.attr("data-key");d.push({id:g,name:f+" - "+e,artist:f,title:e})});else if("artist"===c)b.each((a,b)=>{const c=$(b),e=c.find(".title span").text().xTrim(),f=$(".heading-1").text().xTrim(),g=c.attr("data-key");d.push({id:g,name:f+" - "+e,artist:f,title:e})});else if("album"===c){const a=$(".heading-3").text().xTrim();b.each((b,c)=>{const e=$(c),f=e.find(".title span").text().xTrim(),g=e.attr("data-key");d.push({id:g,name:a+" - "+f,artist:a,title:f})})}this.trackHtmlElements=this.trackHtmlElements.concat(d);const e=Array.from(new Set(this.trackHtmlElements.map(a=>a.id))).map(a=>({id:a,name:this.trackHtmlElements.find(b=>b.id===a).name,artist:this.trackHtmlElements.find(b=>b.id===a).artist,title:this.trackHtmlElements.find(b=>b.id===a).title}));chrome.runtime.sendMessage({action:"setBadge",value:e.length}),a(e)}getPageType(){const a=location.href;if(a.includes("/playlist/"))return"playlist";return a.includes("/profile/")?"profile":a.includes("/album/")?"album":a.includes("/artist/")?"artist":a.includes("/channels/")?"channels":a.includes("/search/")?"search":a.includes("/smarttracklist/")?"smarttracklist":null}setSongsCount(){this.getItems(a=>{"function"==typeof this.mediaUpdateListener&&this.mediaUpdateListener({tracks:a});const b=a.length;chrome.runtime.sendMessage({action:"setBadge",value:b})})}};