"use strict";(()=>{var g0=Object.create;var uf=Object.defineProperty;var u0=Object.getOwnPropertyDescriptor;var f0=Object.getOwnPropertyNames;var I0=Object.getPrototypeOf,p0=Object.prototype.hasOwnProperty;var m=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var h0=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of f0(t))!p0.call(e,n)&&n!==r&&uf(e,n,{get:()=>t[n],enumerable:!(i=u0(t,n))||i.enumerable});return e};var G=(e,t,r)=>(r=e!=null?g0(I0(e)):{},h0(t||!e||!e.__esModule?uf(r,"default",{value:e,enumerable:!0}):r,e));var Be=m((FA,ff)=>{"use strict";var Rn=function(e){return e&&e.Math===Math&&e};ff.exports=Rn(typeof globalThis=="object"&&globalThis)||Rn(typeof window=="object"&&window)||Rn(typeof self=="object"&&self)||Rn(typeof global=="object"&&global)||Rn(typeof FA=="object"&&FA)||(function(){return this})()||Function("return this")()});var ke=m((Cz,If)=>{"use strict";If.exports=function(e){try{return!!e()}catch{return!0}}});var Qt=m((Bz,pf)=>{"use strict";var m0=ke();pf.exports=!m0(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})});var Tn=m((yz,hf)=>{"use strict";var C0=ke();hf.exports=!C0(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")})});var Nt=m((Ez,mf)=>{"use strict";var B0=Tn(),ts=Function.prototype.call;mf.exports=B0?ts.bind(ts):function(){return ts.apply(ts,arguments)}});var Ef=m(yf=>{"use strict";var Cf={}.propertyIsEnumerable,Bf=Object.getOwnPropertyDescriptor,y0=Bf&&!Cf.call({1:2},1);yf.f=y0?function(t){var r=Bf(this,t);return!!r&&r.enumerable}:Cf});var _n=m((wz,Qf)=>{"use strict";Qf.exports=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}}});var be=m((bz,Sf)=>{"use strict";var wf=Tn(),bf=Function.prototype,RA=bf.call,E0=wf&&bf.bind.bind(RA,RA);Sf.exports=wf?E0:function(e){return function(){return RA.apply(e,arguments)}}});var Mn=m((Sz,kf)=>{"use strict";var xf=be(),Q0=xf({}.toString),w0=xf("".slice);kf.exports=function(e){return w0(Q0(e),8,-1)}});var vf=m((xz,Df)=>{"use strict";var b0=be(),S0=ke(),x0=Mn(),TA=Object,k0=b0("".split);Df.exports=S0(function(){return!TA("z").propertyIsEnumerable(0)})?function(e){return x0(e)==="String"?k0(e,""):TA(e)}:TA});var Nn=m((kz,Ff)=>{"use strict";Ff.exports=function(e){return e==null}});var _A=m((Dz,Rf)=>{"use strict";var D0=Nn(),v0=TypeError;Rf.exports=function(e){if(D0(e))throw new v0("Can't call method on "+e);return e}});var Xt=m((vz,Tf)=>{"use strict";var F0=vf(),R0=_A();Tf.exports=function(e){return F0(R0(e))}});var ot=m((Fz,_f)=>{"use strict";var MA=typeof document=="object"&&document.all;_f.exports=typeof MA>"u"&&MA!==void 0?function(e){return typeof e=="function"||e===MA}:function(e){return typeof e=="function"}});var Vr=m((Rz,Mf)=>{"use strict";var T0=ot();Mf.exports=function(e){return typeof e=="object"?e!==null:T0(e)}});var Zt=m((Tz,Nf)=>{"use strict";var NA=Be(),_0=ot(),M0=function(e){return _0(e)?e:void 0};Nf.exports=function(e,t){return arguments.length<2?M0(NA[e]):NA[e]&&NA[e][t]}});var rs=m((_z,Pf)=>{"use strict";var N0=be();Pf.exports=N0({}.isPrototypeOf)});var PA=m((Mz,qf)=>{"use strict";var P0=Be(),Uf=P0.navigator,Of=Uf&&Uf.userAgent;qf.exports=Of?String(Of):""});var OA=m((Nz,zf)=>{"use strict";var Jf=Be(),UA=PA(),Gf=Jf.process,Hf=Jf.Deno,Lf=Gf&&Gf.versions||Hf&&Hf.version,Kf=Lf&&Lf.v8,wt,is;Kf&&(wt=Kf.split("."),is=wt[0]>0&&wt[0]<4?1:+(wt[0]+wt[1]));!is&&UA&&(wt=UA.match(/Edge\/(\d+)/),(!wt||wt[1]>=74)&&(wt=UA.match(/Chrome\/(\d+)/),wt&&(is=+wt[1])));zf.exports=is});var qA=m((Pz,Yf)=>{"use strict";var Vf=OA(),U0=ke(),O0=Be(),q0=O0.String;Yf.exports=!!Object.getOwnPropertySymbols&&!U0(function(){var e=Symbol("symbol detection");return!q0(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&Vf&&Vf<41})});var GA=m((Uz,Wf)=>{"use strict";var G0=qA();Wf.exports=G0&&!Symbol.sham&&typeof Symbol.iterator=="symbol"});var ns=m((Oz,jf)=>{"use strict";var H0=Zt(),L0=ot(),K0=rs(),J0=GA(),z0=Object;jf.exports=J0?function(e){return typeof e=="symbol"}:function(e){var t=H0("Symbol");return L0(t)&&K0(t.prototype,z0(e))}});var os=m((qz,Xf)=>{"use strict";var V0=String;Xf.exports=function(e){try{return V0(e)}catch{return"Object"}}});var $t=m((Gz,Zf)=>{"use strict";var Y0=ot(),W0=os(),j0=TypeError;Zf.exports=function(e){if(Y0(e))return e;throw new j0(W0(e)+" is not a function")}});var ss=m((Hz,$f)=>{"use strict";var X0=$t(),Z0=Nn();$f.exports=function(e,t){var r=e[t];return Z0(r)?void 0:X0(r)}});var tI=m((Lz,eI)=>{"use strict";var HA=Nt(),LA=ot(),KA=Vr(),$0=TypeError;eI.exports=function(e,t){var r,i;if(t==="string"&&LA(r=e.toString)&&!KA(i=HA(r,e))||LA(r=e.valueOf)&&!KA(i=HA(r,e))||t!=="string"&&LA(r=e.toString)&&!KA(i=HA(r,e)))return i;throw new $0("Can't convert object to primitive value")}});var as=m((Kz,rI)=>{"use strict";rI.exports=!1});var cs=m((Jz,nI)=>{"use strict";var iI=Be(),ev=Object.defineProperty;nI.exports=function(e,t){try{ev(iI,e,{value:t,configurable:!0,writable:!0})}catch{iI[e]=t}return t}});var As=m((zz,aI)=>{"use strict";var tv=as(),rv=Be(),iv=cs(),oI="__core-js_shared__",sI=aI.exports=rv[oI]||iv(oI,{});(sI.versions||(sI.versions=[])).push({version:"3.45.1",mode:tv?"pure":"global",copyright:"\xA9 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.45.1/LICENSE",source:"https://github.com/zloirock/core-js"})});var JA=m((Vz,AI)=>{"use strict";var cI=As();AI.exports=function(e,t){return cI[e]||(cI[e]=t||{})}});var zA=m((Yz,lI)=>{"use strict";var nv=_A(),ov=Object;lI.exports=function(e){return ov(nv(e))}});var Pt=m((Wz,dI)=>{"use strict";var sv=be(),av=zA(),cv=sv({}.hasOwnProperty);dI.exports=Object.hasOwn||function(t,r){return cv(av(t),r)}});var ls=m((jz,gI)=>{"use strict";var Av=be(),lv=0,dv=Math.random(),gv=Av(1.1.toString);gI.exports=function(e){return"Symbol("+(e===void 0?"":e)+")_"+gv(++lv+dv,36)}});var hr=m((Xz,fI)=>{"use strict";var uv=Be(),fv=JA(),uI=Pt(),Iv=ls(),pv=qA(),hv=GA(),xi=uv.Symbol,VA=fv("wks"),mv=hv?xi.for||xi:xi&&xi.withoutSetter||Iv;fI.exports=function(e){return uI(VA,e)||(VA[e]=pv&&uI(xi,e)?xi[e]:mv("Symbol."+e)),VA[e]}});var mI=m((Zz,hI)=>{"use strict";var Cv=Nt(),II=Vr(),pI=ns(),Bv=ss(),yv=tI(),Ev=hr(),Qv=TypeError,wv=Ev("toPrimitive");hI.exports=function(e,t){if(!II(e)||pI(e))return e;var r=Bv(e,wv),i;if(r){if(t===void 0&&(t="default"),i=Cv(r,e,t),!II(i)||pI(i))return i;throw new Qv("Can't convert object to primitive value")}return t===void 0&&(t="number"),yv(e,t)}});var YA=m(($z,CI)=>{"use strict";var bv=mI(),Sv=ns();CI.exports=function(e){var t=bv(e,"string");return Sv(t)?t:t+""}});var jA=m((eV,yI)=>{"use strict";var xv=Be(),BI=Vr(),WA=xv.document,kv=BI(WA)&&BI(WA.createElement);yI.exports=function(e){return kv?WA.createElement(e):{}}});var XA=m((tV,EI)=>{"use strict";var Dv=Qt(),vv=ke(),Fv=jA();EI.exports=!Dv&&!vv(function(){return Object.defineProperty(Fv("div"),"a",{get:function(){return 7}}).a!==7})});var ZA=m(wI=>{"use strict";var Rv=Qt(),Tv=Nt(),_v=Ef(),Mv=_n(),Nv=Xt(),Pv=YA(),Uv=Pt(),Ov=XA(),QI=Object.getOwnPropertyDescriptor;wI.f=Rv?QI:function(t,r){if(t=Nv(t),r=Pv(r),Ov)try{return QI(t,r)}catch{}if(Uv(t,r))return Mv(!Tv(_v.f,t,r),t[r])}});var $A=m((iV,bI)=>{"use strict";var qv=Qt(),Gv=ke();bI.exports=qv&&Gv(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})});var bt=m((nV,SI)=>{"use strict";var Hv=Vr(),Lv=String,Kv=TypeError;SI.exports=function(e){if(Hv(e))return e;throw new Kv(Lv(e)+" is not an object")}});var Yr=m(kI=>{"use strict";var Jv=Qt(),zv=XA(),Vv=$A(),ds=bt(),xI=YA(),Yv=TypeError,el=Object.defineProperty,Wv=Object.getOwnPropertyDescriptor,tl="enumerable",rl="configurable",il="writable";kI.f=Jv?Vv?function(t,r,i){if(ds(t),r=xI(r),ds(i),typeof t=="function"&&r==="prototype"&&"value"in i&&il in i&&!i[il]){var n=Wv(t,r);n&&n[il]&&(t[r]=i.value,i={configurable:rl in i?i[rl]:n[rl],enumerable:tl in i?i[tl]:n[tl],writable:!1})}return el(t,r,i)}:el:function(t,r,i){if(ds(t),r=xI(r),ds(i),zv)try{return el(t,r,i)}catch{}if("get"in i||"set"in i)throw new Yv("Accessors not supported");return"value"in i&&(t[r]=i.value),t}});var gs=m((sV,DI)=>{"use strict";var jv=Qt(),Xv=Yr(),Zv=_n();DI.exports=jv?function(e,t,r){return Xv.f(e,t,Zv(1,r))}:function(e,t,r){return e[t]=r,e}});var RI=m((aV,FI)=>{"use strict";var nl=Qt(),$v=Pt(),vI=Function.prototype,eF=nl&&Object.getOwnPropertyDescriptor,ol=$v(vI,"name"),tF=ol&&(function(){}).name==="something",rF=ol&&(!nl||nl&&eF(vI,"name").configurable);FI.exports={EXISTS:ol,PROPER:tF,CONFIGURABLE:rF}});var al=m((cV,TI)=>{"use strict";var iF=be(),nF=ot(),sl=As(),oF=iF(Function.toString);nF(sl.inspectSource)||(sl.inspectSource=function(e){return oF(e)});TI.exports=sl.inspectSource});var NI=m((AV,MI)=>{"use strict";var sF=Be(),aF=ot(),_I=sF.WeakMap;MI.exports=aF(_I)&&/native code/.test(String(_I))});var cl=m((lV,UI)=>{"use strict";var cF=JA(),AF=ls(),PI=cF("keys");UI.exports=function(e){return PI[e]||(PI[e]=AF(e))}});var us=m((dV,OI)=>{"use strict";OI.exports={}});var LI=m((gV,HI)=>{"use strict";var lF=NI(),GI=Be(),dF=Vr(),gF=gs(),Al=Pt(),ll=As(),uF=cl(),fF=us(),qI="Object already initialized",dl=GI.TypeError,IF=GI.WeakMap,fs,Pn,Is,pF=function(e){return Is(e)?Pn(e):fs(e,{})},hF=function(e){return function(t){var r;if(!dF(t)||(r=Pn(t)).type!==e)throw new dl("Incompatible receiver, "+e+" required");return r}};lF||ll.state?(St=ll.state||(ll.state=new IF),St.get=St.get,St.has=St.has,St.set=St.set,fs=function(e,t){if(St.has(e))throw new dl(qI);return t.facade=e,St.set(e,t),t},Pn=function(e){return St.get(e)||{}},Is=function(e){return St.has(e)}):(Wr=uF("state"),fF[Wr]=!0,fs=function(e,t){if(Al(e,Wr))throw new dl(qI);return t.facade=e,gF(e,Wr,t),t},Pn=function(e){return Al(e,Wr)?e[Wr]:{}},Is=function(e){return Al(e,Wr)});var St,Wr;HI.exports={set:fs,get:Pn,has:Is,enforce:pF,getterFor:hF}});var VI=m((uV,zI)=>{"use strict";var ul=be(),mF=ke(),CF=ot(),ps=Pt(),gl=Qt(),BF=RI().CONFIGURABLE,yF=al(),JI=LI(),EF=JI.enforce,QF=JI.get,KI=String,hs=Object.defineProperty,wF=ul("".slice),bF=ul("".replace),SF=ul([].join),xF=gl&&!mF(function(){return hs(function(){},"length",{value:8}).length!==8}),kF=String(String).split("String"),DF=zI.exports=function(e,t,r){wF(KI(t),0,7)==="Symbol("&&(t="["+bF(KI(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!ps(e,"name")||BF&&e.name!==t)&&(gl?hs(e,"name",{value:t,configurable:!0}):e.name=t),xF&&r&&ps(r,"arity")&&e.length!==r.arity&&hs(e,"length",{value:r.arity});try{r&&ps(r,"constructor")&&r.constructor?gl&&hs(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var i=EF(e);return ps(i,"source")||(i.source=SF(kF,typeof t=="string"?t:"")),e};Function.prototype.toString=DF(function(){return CF(this)&&QF(this).source||yF(this)},"toString")});var WI=m((fV,YI)=>{"use strict";var vF=ot(),FF=Yr(),RF=VI(),TF=cs();YI.exports=function(e,t,r,i){i||(i={});var n=i.enumerable,o=i.name!==void 0?i.name:t;if(vF(r)&&RF(r,o,i),i.global)n?e[t]=r:TF(t,r);else{try{i.unsafe?e[t]&&(n=!0):delete e[t]}catch{}n?e[t]=r:FF.f(e,t,{value:r,enumerable:!1,configurable:!i.nonConfigurable,writable:!i.nonWritable})}return e}});var XI=m((IV,jI)=>{"use strict";var _F=Math.ceil,MF=Math.floor;jI.exports=Math.trunc||function(t){var r=+t;return(r>0?MF:_F)(r)}});var jr=m((pV,ZI)=>{"use strict";var NF=XI();ZI.exports=function(e){var t=+e;return t!==t||t===0?0:NF(t)}});var fl=m((hV,$I)=>{"use strict";var PF=jr(),UF=Math.max,OF=Math.min;$I.exports=function(e,t){var r=PF(e);return r<0?UF(r+t,0):OF(r,t)}});var tp=m((mV,ep)=>{"use strict";var qF=jr(),GF=Math.min;ep.exports=function(e){var t=qF(e);return t>0?GF(t,9007199254740991):0}});var er=m((CV,rp)=>{"use strict";var HF=tp();rp.exports=function(e){return HF(e.length)}});var op=m((BV,np)=>{"use strict";var LF=Xt(),KF=fl(),JF=er(),ip=function(e){return function(t,r,i){var n=LF(t),o=JF(n);if(o===0)return!e&&-1;var a=KF(i,o),s;if(e&&r!==r){for(;o>a;)if(s=n[a++],s!==s)return!0}else for(;o>a;a++)if((e||a in n)&&n[a]===r)return e||a||0;return!e&&-1}};np.exports={includes:ip(!0),indexOf:ip(!1)}});var pl=m((yV,ap)=>{"use strict";var zF=be(),Il=Pt(),VF=Xt(),YF=op().indexOf,WF=us(),sp=zF([].push);ap.exports=function(e,t){var r=VF(e),i=0,n=[],o;for(o in r)!Il(WF,o)&&Il(r,o)&&sp(n,o);for(;t.length>i;)Il(r,o=t[i++])&&(~YF(n,o)||sp(n,o));return n}});var ms=m((EV,cp)=>{"use strict";cp.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]});var lp=m(Ap=>{"use strict";var jF=pl(),XF=ms(),ZF=XF.concat("length","prototype");Ap.f=Object.getOwnPropertyNames||function(t){return jF(t,ZF)}});var gp=m(dp=>{"use strict";dp.f=Object.getOwnPropertySymbols});var fp=m((bV,up)=>{"use strict";var $F=Zt(),eR=be(),tR=lp(),rR=gp(),iR=bt(),nR=eR([].concat);up.exports=$F("Reflect","ownKeys")||function(t){var r=tR.f(iR(t)),i=rR.f;return i?nR(r,i(t)):r}});var hp=m((SV,pp)=>{"use strict";var Ip=Pt(),oR=fp(),sR=ZA(),aR=Yr();pp.exports=function(e,t,r){for(var i=oR(t),n=aR.f,o=sR.f,a=0;a<i.length;a++){var s=i[a];!Ip(e,s)&&!(r&&Ip(r,s))&&n(e,s,o(t,s))}}});var Cp=m((xV,mp)=>{"use strict";var cR=ke(),AR=ot(),lR=/#|\.prototype\./,Un=function(e,t){var r=gR[dR(e)];return r===fR?!0:r===uR?!1:AR(t)?cR(t):!!t},dR=Un.normalize=function(e){return String(e).replace(lR,".").toLowerCase()},gR=Un.data={},uR=Un.NATIVE="N",fR=Un.POLYFILL="P";mp.exports=Un});var De=m((kV,Bp)=>{"use strict";var Cs=Be(),IR=ZA().f,pR=gs(),hR=WI(),mR=cs(),CR=hp(),BR=Cp();Bp.exports=function(e,t){var r=e.target,i=e.global,n=e.stat,o,a,s,c,A,l;if(i?a=Cs:n?a=Cs[r]||mR(r,{}):a=Cs[r]&&Cs[r].prototype,a)for(s in t){if(A=t[s],e.dontCallGetSet?(l=IR(a,s),c=l&&l.value):c=a[s],o=BR(i?s:r+(n?".":"#")+s,e.forced),!o&&c!==void 0){if(typeof A==typeof c)continue;CR(A,c)}(e.sham||c&&c.sham)&&pR(A,"sham",!0),hR(a,s,A,e)}}});var Ep=m((DV,yp)=>{"use strict";var yR=pl(),ER=ms();yp.exports=Object.keys||function(t){return yR(t,ER)}});var wp=m(Qp=>{"use strict";var QR=Qt(),wR=$A(),bR=Yr(),SR=bt(),xR=Xt(),kR=Ep();Qp.f=QR&&!wR?Object.defineProperties:function(t,r){SR(t);for(var i=xR(r),n=kR(r),o=n.length,a=0,s;o>a;)bR.f(t,s=n[a++],i[s]);return t}});var Sp=m((FV,bp)=>{"use strict";var DR=Zt();bp.exports=DR("document","documentElement")});var _p=m((RV,Tp)=>{"use strict";var vR=bt(),FR=wp(),xp=ms(),RR=us(),TR=Sp(),_R=jA(),MR=cl(),kp=">",Dp="<",ml="prototype",Cl="script",Fp=MR("IE_PROTO"),hl=function(){},Rp=function(e){return Dp+Cl+kp+e+Dp+"/"+Cl+kp},vp=function(e){e.write(Rp("")),e.close();var t=e.parentWindow.Object;return e=null,t},NR=function(){var e=_R("iframe"),t="java"+Cl+":",r;return e.style.display="none",TR.appendChild(e),e.src=String(t),r=e.contentWindow.document,r.open(),r.write(Rp("document.F=Object")),r.close(),r.F},Bs,ys=function(){try{Bs=new ActiveXObject("htmlfile")}catch{}ys=typeof document<"u"?document.domain&&Bs?vp(Bs):NR():vp(Bs);for(var e=xp.length;e--;)delete ys[ml][xp[e]];return ys()};RR[Fp]=!0;Tp.exports=Object.create||function(t,r){var i;return t!==null?(hl[ml]=vR(t),i=new hl,hl[ml]=null,i[Fp]=t):i=ys(),r===void 0?i:FR.f(i,r)}});var On=m((TV,Mp)=>{"use strict";var PR=hr(),UR=_p(),OR=Yr().f,Bl=PR("unscopables"),yl=Array.prototype;yl[Bl]===void 0&&OR(yl,Bl,{configurable:!0,value:UR(null)});Mp.exports=function(e){yl[Bl][e]=!0}});var Np=m(()=>{"use strict";var qR=De(),GR=zA(),HR=er(),LR=jr(),KR=On();qR({target:"Array",proto:!0},{at:function(t){var r=GR(this),i=HR(r),n=LR(t),o=n>=0?n:i+n;return o<0||o>=i?void 0:r[o]}});KR("at")});var Up=m((NV,Pp)=>{"use strict";var JR=er();Pp.exports=function(e,t){for(var r=JR(e),i=new t(r),n=0;n<r;n++)i[n]=e[r-n-1];return i}});var Op=m(()=>{"use strict";var zR=De(),VR=Up(),YR=Xt(),WR=On(),jR=Array;zR({target:"Array",proto:!0},{toReversed:function(){return VR(YR(this),jR)}});WR("toReversed")});var Gp=m((OV,qp)=>{"use strict";var XR=er();qp.exports=function(e,t,r){for(var i=0,n=arguments.length>2?r:XR(t),o=new e(n);n>i;)o[i]=t[i++];return o}});var Lp=m((qV,Hp)=>{"use strict";var ZR=Be();Hp.exports=function(e,t){var r=ZR[e],i=r&&r.prototype;return i&&i[t]}});var Kp=m(()=>{"use strict";var $R=De(),eT=be(),tT=$t(),rT=Xt(),iT=Gp(),nT=Lp(),oT=On(),sT=Array,aT=eT(nT("Array","sort"));$R({target:"Array",proto:!0},{toSorted:function(t){t!==void 0&&tT(t);var r=rT(this),i=iT(sT,r);return aT(i,t)}});oT("toSorted")});var zp=m((LV,Jp)=>{"use strict";var cT=TypeError,AT=9007199254740991;Jp.exports=function(e){if(e>AT)throw cT("Maximum allowed index exceeded");return e}});var Vp=m(()=>{"use strict";var lT=De(),dT=On(),gT=zp(),uT=er(),fT=fl(),IT=Xt(),pT=jr(),hT=Array,mT=Math.max,CT=Math.min;lT({target:"Array",proto:!0},{toSpliced:function(t,r){var i=IT(this),n=uT(i),o=fT(t,n),a=arguments.length,s=0,c,A,l,d;for(a===0?c=A=0:a===1?(c=0,A=n-o):(c=a-2,A=CT(mT(pT(r),0),n-o)),l=gT(n+c-A),d=hT(l);s<o;s++)d[s]=i[s];for(;s<o+c;s++)d[s]=arguments[s-o+2];for(;s<l;s++)d[s]=i[s+A-c];return d}});dT("toSpliced")});var Wp=m((zV,Yp)=>{"use strict";var BT=er(),yT=jr(),ET=RangeError;Yp.exports=function(e,t,r,i){var n=BT(e),o=yT(r),a=o<0?n+o:o;if(a>=n||a<0)throw new ET("Incorrect index");for(var s=new t(n),c=0;c<n;c++)s[c]=c===a?i:e[c];return s}});var jp=m(()=>{"use strict";var QT=De(),wT=Wp(),bT=Xt(),ST=Array,xT=(function(){try{[].with({valueOf:function(){throw 4}},null)}catch(e){return e!==4}})();QT({target:"Array",proto:!0,forced:xT},{with:function(e,t){return wT(bT(this),ST,e,t)}})});var th=m((WV,eh)=>{"use strict";var kT=Tn(),$p=Function.prototype,Xp=$p.apply,Zp=$p.call;eh.exports=typeof Reflect=="object"&&Reflect.apply||(kT?Zp.bind(Xp):function(){return Zp.apply(Xp,arguments)})});var ih=m((jV,rh)=>{"use strict";var DT=be();rh.exports=DT([].slice)});var El=m((XV,oh)=>{"use strict";var nh=$t(),vT=TypeError,FT=function(e){var t,r;this.promise=new e(function(i,n){if(t!==void 0||r!==void 0)throw new vT("Bad Promise constructor");t=i,r=n}),this.resolve=nh(t),this.reject=nh(r)};oh.exports.f=function(e){return new FT(e)}});var ah=m((ZV,sh)=>{"use strict";sh.exports=function(e){try{return{error:!1,value:e()}}catch(t){return{error:!0,value:t}}}});var lh=m(()=>{"use strict";var RT=De(),TT=Be(),_T=th(),MT=ih(),NT=El(),PT=$t(),Ah=ah(),Ql=TT.Promise,ch=!1,UT=!Ql||!Ql.try||Ah(function(){Ql.try(function(e){ch=e===8},8)}).error||!ch;RT({target:"Promise",stat:!0,forced:UT},{try:function(e){var t=arguments.length>1?MT(arguments,1):[],r=NT.f(this),i=Ah(function(){return _T(PT(e),void 0,t)});return(i.error?r.reject:r.resolve)(i.value),r.promise}})});var dh=m(()=>{"use strict";var OT=De(),qT=El();OT({target:"Promise",stat:!0},{withResolvers:function(){var t=qT.f(this);return{promise:t.promise,resolve:t.resolve,reject:t.reject}}})});var fh=m((iY,uh)=>{"use strict";var GT=hr(),HT=GT("toStringTag"),gh={};gh[HT]="z";uh.exports=String(gh)==="[object z]"});var qn=m((nY,Ih)=>{"use strict";var LT=fh(),KT=ot(),Es=Mn(),JT=hr(),zT=JT("toStringTag"),VT=Object,YT=Es((function(){return arguments})())==="Arguments",WT=function(e,t){try{return e[t]}catch{}};Ih.exports=LT?Es:function(e){var t,r,i;return e===void 0?"Undefined":e===null?"Null":typeof(r=WT(t=VT(e),zT))=="string"?r:YT?Es(t):(i=Es(t))==="Object"&&KT(t.callee)?"Arguments":i}});var yh=m((oY,Bh)=>{"use strict";var jT=be(),XT=ke(),ph=ot(),ZT=qn(),$T=Zt(),e_=al(),hh=function(){},mh=$T("Reflect","construct"),wl=/^\s*(?:class|function)\b/,t_=jT(wl.exec),r_=!wl.test(hh),Gn=function(t){if(!ph(t))return!1;try{return mh(hh,[],t),!0}catch{return!1}},Ch=function(t){if(!ph(t))return!1;switch(ZT(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return r_||!!t_(wl,e_(t))}catch{return!0}};Ch.sham=!0;Bh.exports=!mh||XT(function(){var e;return Gn(Gn.call)||!Gn(Object)||!Gn(function(){e=!0})||e})?Ch:Gn});var Qh=m((sY,Eh)=>{"use strict";var i_=Mn(),n_=be();Eh.exports=function(e){if(i_(e)==="Function")return n_(e)}});var Sh=m((aY,bh)=>{"use strict";var wh=Qh(),o_=$t(),s_=Tn(),a_=wh(wh.bind);bh.exports=function(e,t){return o_(e),t===void 0?e:s_?a_(e,t):function(){return e.apply(t,arguments)}}});var bl=m((cY,xh)=>{"use strict";xh.exports={}});var Dh=m((AY,kh)=>{"use strict";var c_=hr(),A_=bl(),l_=c_("iterator"),d_=Array.prototype;kh.exports=function(e){return e!==void 0&&(A_.Array===e||d_[l_]===e)}});var Sl=m((lY,Fh)=>{"use strict";var g_=qn(),vh=ss(),u_=Nn(),f_=bl(),I_=hr(),p_=I_("iterator");Fh.exports=function(e){if(!u_(e))return vh(e,p_)||vh(e,"@@iterator")||f_[g_(e)]}});var Th=m((dY,Rh)=>{"use strict";var h_=Nt(),m_=$t(),C_=bt(),B_=os(),y_=Sl(),E_=TypeError;Rh.exports=function(e,t){var r=arguments.length<2?y_(e):t;if(m_(r))return C_(h_(r,e));throw new E_(B_(e)+" is not iterable")}});var Qs=m((gY,Mh)=>{"use strict";var Q_=Nt(),_h=bt(),w_=ss();Mh.exports=function(e,t,r){var i,n;_h(e);try{if(i=w_(e,"return"),!i){if(t==="throw")throw r;return r}i=Q_(i,e)}catch(o){n=!0,i=o}if(t==="throw")throw r;if(n)throw i;return _h(i),r}});var qh=m((uY,Oh)=>{"use strict";var b_=Sh(),S_=Nt(),x_=bt(),k_=os(),D_=Dh(),v_=er(),Nh=rs(),F_=Th(),R_=Sl(),Ph=Qs(),T_=TypeError,ws=function(e,t){this.stopped=e,this.result=t},Uh=ws.prototype;Oh.exports=function(e,t,r){var i=r&&r.that,n=!!(r&&r.AS_ENTRIES),o=!!(r&&r.IS_RECORD),a=!!(r&&r.IS_ITERATOR),s=!!(r&&r.INTERRUPTED),c=b_(t,i),A,l,d,g,u,I,C,B=function(Q){return A&&Ph(A,"normal"),new ws(!0,Q)},h=function(Q){return n?(x_(Q),s?c(Q[0],Q[1],B):c(Q[0],Q[1])):s?c(Q,B):c(Q)};if(o)A=e.iterator;else if(a)A=e;else{if(l=R_(e),!l)throw new T_(k_(e)+" is not iterable");if(D_(l)){for(d=0,g=v_(e);g>d;d++)if(u=h(e[d]),u&&Nh(Uh,u))return u;return new ws(!1)}A=F_(e,l)}for(I=o?e.next:A.next;!(C=S_(I,A)).done;){try{u=h(C.value)}catch(Q){Ph(A,"throw",Q)}if(typeof u=="object"&&u&&Nh(Uh,u))return u}return new ws(!1)}});var Hh=m((fY,Gh)=>{"use strict";var __=Qt(),M_=Yr(),N_=_n();Gh.exports=function(e,t,r){__?M_.f(e,t,N_(0,r)):e[t]=r}});var bs=m((IY,Lh)=>{"use strict";var P_=TypeError;Lh.exports=function(e,t){if(e<t)throw new P_("Not enough arguments");return e}});var zh=m((pY,Jh)=>{"use strict";var U_=Be(),O_=ke(),Kh=U_.RegExp,q_=!O_(function(){var e=!0;try{Kh(".","d")}catch{e=!1}var t={},r="",i=e?"dgimsy":"gimsy",n=function(c,A){Object.defineProperty(t,c,{get:function(){return r+=A,!0}})},o={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};e&&(o.hasIndices="d");for(var a in o)n(a,o[a]);var s=Object.getOwnPropertyDescriptor(Kh.prototype,"flags").get.call(t);return s!==i||r!==i});Jh.exports={correct:q_}});var Yh=m((hY,Vh)=>{"use strict";var G_=bt();Vh.exports=function(){var e=G_(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t}});var Xh=m((mY,jh)=>{"use strict";var H_=Nt(),L_=Pt(),K_=rs(),Wh=zh(),J_=Yh(),z_=RegExp.prototype;jh.exports=Wh.correct?function(e){return e.flags}:function(e){return!Wh.correct&&K_(z_,e)&&!L_(e,"flags")?H_(J_,e):e.flags}});var $h=m((CY,Zh)=>{"use strict";var Ss=be(),Hn=Map.prototype;Zh.exports={Map,set:Ss(Hn.set),get:Ss(Hn.get),has:Ss(Hn.has),remove:Ss(Hn.delete),proto:Hn}});var mt=m((BY,em)=>{"use strict";var xl=be(),xs=Set.prototype;em.exports={Set,add:xl(xs.add),has:xl(xs.has),remove:xl(xs.delete),proto:xs}});var mr=m((yY,tm)=>{"use strict";var V_=Nt();tm.exports=function(e,t,r){for(var i=r?e:e.iterator,n=e.next,o,a;!(o=V_(n,i)).done;)if(a=t(o.value),a!==void 0)return a}});var Xr=m((EY,sm)=>{"use strict";var rm=be(),Y_=mr(),im=mt(),W_=im.Set,nm=im.proto,j_=rm(nm.forEach),om=rm(nm.keys),X_=om(new W_).next;sm.exports=function(e,t,r){return r?Y_({iterator:om(e),next:X_},t):j_(e,t)}});var kl=m((QY,am)=>{"use strict";var Ln=Be(),Z_=PA(),$_=Mn(),ks=function(e){return Z_.slice(0,e.length)===e};am.exports=(function(){return ks("Bun/")?"BUN":ks("Cloudflare-Workers")?"CLOUDFLARE":ks("Deno/")?"DENO":ks("Node.js/")?"NODE":Ln.Bun&&typeof Bun.version=="string"?"BUN":Ln.Deno&&typeof Deno.version=="object"?"DENO":$_(Ln.process)==="process"?"NODE":Ln.window&&Ln.document?"BROWSER":"REST"})()});var Am=m((wY,cm)=>{"use strict";var eM=kl();cm.exports=eM==="NODE"});var dm=m((bY,lm)=>{"use strict";var tM=Be(),rM=Am();lm.exports=function(e){if(rM){try{return tM.process.getBuiltinModule(e)}catch{}try{return Function('return require("'+e+'")')()}catch{}}}});var Fl=m((SY,um)=>{"use strict";var iM=Be(),nM=ke(),Dl=OA(),vl=kl(),gm=iM.structuredClone;um.exports=!!gm&&!nM(function(){if(vl==="DENO"&&Dl>92||vl==="NODE"&&Dl>94||vl==="BROWSER"&&Dl>97)return!1;var e=new ArrayBuffer(8),t=gm(e,{transfer:[e]});return e.byteLength!==0||t.byteLength!==8})});var hm=m((xY,pm)=>{"use strict";var Ml=Be(),oM=dm(),sM=Fl(),aM=Ml.structuredClone,fm=Ml.ArrayBuffer,Ds=Ml.MessageChannel,_l=!1,Rl,Im,vs,Tl;if(sM)_l=function(e){aM(e,{transfer:[e]})};else if(fm)try{Ds||(Rl=oM("worker_threads"),Rl&&(Ds=Rl.MessageChannel)),Ds&&(Im=new Ds,vs=new fm(2),Tl=function(e){Im.port1.postMessage(null,[e])},vs.byteLength===2&&(Tl(vs),vs.byteLength===0&&(_l=Tl)))}catch{}pm.exports=_l});var Cm=m((kY,mm)=>{"use strict";var cM=ke(),AM=_n();mm.exports=!cM(function(){var e=new Error("a");return"stack"in e?(Object.defineProperty(e,"stack",AM(1,7)),e.stack!==7):!0})});var vm=m(()=>{"use strict";var lM=as(),dM=De(),Pe=Be(),Jn=Zt(),Vn=be(),Gl=ke(),gM=ls(),Di=ot(),uM=yh(),fM=Nn(),Ms=Vr(),IM=ns(),pM=qh(),Em=bt(),Ts=qn(),hM=Pt(),mM=Hh(),Nl=gs(),Fs=er(),CM=bs(),BM=Xh(),Ns=$h(),Hl=mt(),yM=Xr(),Bm=hm(),EM=Cm(),Ll=Fl(),Kn=Pe.Object,QM=Pe.Array,Qm=Pe.Date,wm=Pe.Error,wM=Pe.TypeError,bM=Pe.PerformanceMark,Zr=Jn("DOMException"),Ol=Ns.Map,Kl=Ns.has,bm=Ns.get,_s=Ns.set,Sm=Hl.Set,xm=Hl.add,SM=Hl.has,xM=Jn("Object","keys"),kM=Vn([].push),DM=Vn((!0).valueOf),vM=Vn(1.1.valueOf),FM=Vn("".valueOf),RM=Vn(Qm.prototype.getTime),ql=gM("structuredClone"),zn="DataCloneError",Rs="Transferring",km=function(e){return!Gl(function(){var t=new Pe.Set([7]),r=e(t),i=e(Kn(7));return r===t||!r.has(7)||!Ms(i)||+i!=7})&&e},ym=function(e,t){return!Gl(function(){var r=new t,i=e({a:r,b:r});return!(i&&i.a===i.b&&i.a instanceof t&&i.a.stack===r.stack)})},TM=function(e){return!Gl(function(){var t=e(new Pe.AggregateError([1],ql,{cause:3}));return t.name!=="AggregateError"||t.errors[0]!==1||t.message!==ql||t.cause!==3})},ki=Pe.structuredClone,_M=lM||!ym(ki,wm)||!ym(ki,Zr)||!TM(ki),MM=!ki&&km(function(e){return new bM(ql,{detail:e}).detail}),tr=km(ki)||MM,Pl=function(e){throw new Zr("Uncloneable type: "+e,zn)},st=function(e,t){throw new Zr((t||"Cloning")+" of "+e+" cannot be properly polyfilled in this engine",zn)},Ul=function(e,t){return tr||st(t),tr(e)},NM=function(){var e;try{e=new Pe.DataTransfer}catch{try{e=new Pe.ClipboardEvent("").clipboardData}catch{}}return e&&e.items&&e.files?e:null},Dm=function(e,t,r){if(Kl(t,e))return bm(t,e);var i=r||Ts(e),n,o,a,s,c,A;if(i==="SharedArrayBuffer")tr?n=tr(e):n=e;else{var l=Pe.DataView;!l&&!Di(e.slice)&&st("ArrayBuffer");try{if(Di(e.slice)&&!e.resizable)n=e.slice(0);else for(o=e.byteLength,a=("maxByteLength"in e)?{maxByteLength:e.maxByteLength}:void 0,n=new ArrayBuffer(o,a),s=new l(e),c=new l(n),A=0;A<o;A++)c.setUint8(A,s.getUint8(A))}catch{throw new Zr("ArrayBuffer is detached",zn)}}return _s(t,e,n),n},PM=function(e,t,r,i,n){var o=Pe[t];return Ms(o)||st(t),new o(Dm(e.buffer,n),r,i)},Ne=function(e,t){if(IM(e)&&Pl("Symbol"),!Ms(e))return e;if(t){if(Kl(t,e))return bm(t,e)}else t=new Ol;var r=Ts(e),i,n,o,a,s,c,A,l;switch(r){case"Array":o=QM(Fs(e));break;case"Object":o={};break;case"Map":o=new Ol;break;case"Set":o=new Sm;break;case"RegExp":o=new RegExp(e.source,BM(e));break;case"Error":switch(n=e.name,n){case"AggregateError":o=new(Jn(n))([]);break;case"EvalError":case"RangeError":case"ReferenceError":case"SuppressedError":case"SyntaxError":case"TypeError":case"URIError":o=new(Jn(n));break;case"CompileError":case"LinkError":case"RuntimeError":o=new(Jn("WebAssembly",n));break;default:o=new wm}break;case"DOMException":o=new Zr(e.message,e.name);break;case"ArrayBuffer":case"SharedArrayBuffer":o=Dm(e,t,r);break;case"DataView":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float16Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":c=r==="DataView"?e.byteLength:e.length,o=PM(e,r,e.byteOffset,c,t);break;case"DOMQuad":try{o=new DOMQuad(Ne(e.p1,t),Ne(e.p2,t),Ne(e.p3,t),Ne(e.p4,t))}catch{o=Ul(e,r)}break;case"File":if(tr)try{o=tr(e),Ts(o)!==r&&(o=void 0)}catch{}if(!o)try{o=new File([e],e.name,e)}catch{}o||st(r);break;case"FileList":if(a=NM(),a){for(s=0,c=Fs(e);s<c;s++)a.items.add(Ne(e[s],t));o=a.files}else o=Ul(e,r);break;case"ImageData":try{o=new ImageData(Ne(e.data,t),e.width,e.height,{colorSpace:e.colorSpace})}catch{o=Ul(e,r)}break;default:if(tr)o=tr(e);else switch(r){case"BigInt":o=Kn(e.valueOf());break;case"Boolean":o=Kn(DM(e));break;case"Number":o=Kn(vM(e));break;case"String":o=Kn(FM(e));break;case"Date":o=new Qm(RM(e));break;case"Blob":try{o=e.slice(0,e.size,e.type)}catch{st(r)}break;case"DOMPoint":case"DOMPointReadOnly":i=Pe[r];try{o=i.fromPoint?i.fromPoint(e):new i(e.x,e.y,e.z,e.w)}catch{st(r)}break;case"DOMRect":case"DOMRectReadOnly":i=Pe[r];try{o=i.fromRect?i.fromRect(e):new i(e.x,e.y,e.width,e.height)}catch{st(r)}break;case"DOMMatrix":case"DOMMatrixReadOnly":i=Pe[r];try{o=i.fromMatrix?i.fromMatrix(e):new i(e)}catch{st(r)}break;case"AudioData":case"VideoFrame":Di(e.clone)||st(r);try{o=e.clone()}catch{Pl(r)}break;case"CropTarget":case"CryptoKey":case"FileSystemDirectoryHandle":case"FileSystemFileHandle":case"FileSystemHandle":case"GPUCompilationInfo":case"GPUCompilationMessage":case"ImageBitmap":case"RTCCertificate":case"WebAssembly.Module":st(r);default:Pl(r)}}switch(_s(t,e,o),r){case"Array":case"Object":for(A=xM(e),s=0,c=Fs(A);s<c;s++)l=A[s],mM(o,l,Ne(e[l],t));break;case"Map":e.forEach(function(d,g){_s(o,Ne(g,t),Ne(d,t))});break;case"Set":e.forEach(function(d){xm(o,Ne(d,t))});break;case"Error":Nl(o,"message",Ne(e.message,t)),hM(e,"cause")&&Nl(o,"cause",Ne(e.cause,t)),n==="AggregateError"?o.errors=Ne(e.errors,t):n==="SuppressedError"&&(o.error=Ne(e.error,t),o.suppressed=Ne(e.suppressed,t));case"DOMException":EM&&Nl(o,"stack",Ne(e.stack,t))}return o},UM=function(e,t){if(!Ms(e))throw new wM("Transfer option cannot be converted to a sequence");var r=[];pM(e,function(g){kM(r,Em(g))});for(var i=0,n=Fs(r),o=new Sm,a,s,c,A,l,d;i<n;){if(a=r[i++],s=Ts(a),s==="ArrayBuffer"?SM(o,a):Kl(t,a))throw new Zr("Duplicate transferable",zn);if(s==="ArrayBuffer"){xm(o,a);continue}if(Ll)A=ki(a,{transfer:[a]});else switch(s){case"ImageBitmap":c=Pe.OffscreenCanvas,uM(c)||st(s,Rs);try{l=new c(a.width,a.height),d=l.getContext("bitmaprenderer"),d.transferFromImageBitmap(a),A=l.transferToImageBitmap()}catch{}break;case"AudioData":case"VideoFrame":(!Di(a.clone)||!Di(a.close))&&st(s,Rs);try{A=a.clone(),a.close()}catch{}break;case"MediaSourceHandle":case"MessagePort":case"MIDIAccess":case"OffscreenCanvas":case"ReadableStream":case"RTCDataChannel":case"TransformStream":case"WebTransportReceiveStream":case"WebTransportSendStream":case"WritableStream":st(s,Rs)}if(A===void 0)throw new Zr("This object cannot be transferred: "+s,zn);_s(t,a,A)}return o},OM=function(e){yM(e,function(t){Ll?tr(t,{transfer:[t]}):Di(t.transfer)?t.transfer():Bm?Bm(t):st("ArrayBuffer",Rs)})};dM({global:!0,enumerable:!0,sham:!Ll,forced:_M},{structuredClone:function(t){var r=CM(arguments.length,1)>1&&!fM(arguments[1])?Em(arguments[1]):void 0,i=r?r.transfer:void 0,n,o;i!==void 0&&(n=new Ol,o=UM(i,n));var a=Ne(t,n);return o&&OM(o),a}})});var Jl=m((FY,Fm)=>{"use strict";var qM=qn(),GM=String;Fm.exports=function(e){if(qM(e)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return GM(e)}});var zl=m((RY,Tm)=>{"use strict";var HM=ke(),LM=hr(),KM=Qt(),Rm=as(),JM=LM("iterator");Tm.exports=!HM(function(){var e=new URL("b?a=1&b=2&c=3","https://a"),t=e.searchParams,r=new URLSearchParams("a=1&a=2&b=3"),i="";return e.pathname="c%20d",t.forEach(function(n,o){t.delete("b"),i+=o+n}),r.delete("a",2),r.delete("b",void 0),Rm&&(!e.toJSON||!r.has("a",1)||r.has("a",2)||!r.has("a",void 0)||r.has("b"))||!t.size&&(Rm||!KM)||!t.sort||e.href!=="https://a/c%20d?a=1&c=3"||t.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!t[JM]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("https://\u0442\u0435\u0441\u0442").host!=="xn--e1aybc"||new URL("https://a#\u0431").hash!=="#%D0%B1"||i!=="a1c3"||new URL("https://x",void 0).host!=="x"})});var Nm=m(()=>{"use strict";var zM=De(),VM=Zt(),Mm=ke(),YM=bs(),_m=Jl(),WM=zl(),Vl=VM("URL"),jM=WM&&Mm(function(){Vl.canParse()}),XM=Mm(function(){return Vl.canParse.length!==1});zM({target:"URL",stat:!0,forced:!jM||XM},{canParse:function(t){var r=YM(arguments.length,1),i=_m(t),n=r<2||arguments[1]===void 0?void 0:_m(arguments[1]);try{return!!new Vl(i,n)}catch{return!1}}})});var Um=m(()=>{"use strict";var ZM=De(),$M=Zt(),eN=bs(),Pm=Jl(),tN=zl(),rN=$M("URL");ZM({target:"URL",stat:!0,forced:!tN},{parse:function(t){var r=eN(arguments.length,1),i=Pm(t),n=r<2||arguments[1]===void 0?void 0:Pm(arguments[1]);try{return new rN(i,n)}catch{return null}}})});var Cr=m((PY,Om)=>{"use strict";var iN=mt().has;Om.exports=function(e){return iN(e),e}});var Ps=m((UY,Gm)=>{"use strict";var qm=mt(),nN=Xr(),oN=qm.Set,sN=qm.add;Gm.exports=function(e){var t=new oN;return nN(e,function(r){sN(t,r)}),t}});var Lm=m((OY,Hm)=>{"use strict";var aN=be(),cN=$t();Hm.exports=function(e,t,r){try{return aN(cN(Object.getOwnPropertyDescriptor(e,t)[r]))}catch{}}});var vi=m((qY,Km)=>{"use strict";var AN=Lm(),lN=mt();Km.exports=AN(lN.proto,"size","get")||function(e){return e.size}});var zm=m((GY,Jm)=>{"use strict";Jm.exports=function(e){return{iterator:e,next:e.next,done:!1}}});var Br=m((HY,Zm)=>{"use strict";var Vm=$t(),jm=bt(),Ym=Nt(),dN=jr(),gN=zm(),Wm="Invalid size",uN=RangeError,fN=TypeError,IN=Math.max,Xm=function(e,t){this.set=e,this.size=IN(t,0),this.has=Vm(e.has),this.keys=Vm(e.keys)};Xm.prototype={getIterator:function(){return gN(jm(Ym(this.keys,this.set)))},includes:function(e){return Ym(this.has,this.set,e)}};Zm.exports=function(e){jm(e);var t=+e.size;if(t!==t)throw new fN(Wm);var r=dN(t);if(r<0)throw new uN(Wm);return new Xm(e,r)}});var rC=m((LY,tC)=>{"use strict";var pN=Cr(),eC=mt(),hN=Ps(),mN=vi(),CN=Br(),BN=Xr(),yN=mr(),EN=eC.has,$m=eC.remove;tC.exports=function(t){var r=pN(this),i=CN(t),n=hN(r);return mN(r)<=i.size?BN(r,function(o){i.includes(o)&&$m(n,o)}):yN(i.getIterator(),function(o){EN(n,o)&&$m(n,o)}),n}});var yr=m((KY,oC)=>{"use strict";var QN=Zt(),iC=function(e){return{size:e,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},nC=function(e){return{size:e,has:function(){return!0},keys:function(){throw new Error("e")}}};oC.exports=function(e,t){var r=QN("Set");try{new r()[e](iC(0));try{return new r()[e](iC(-1)),!1}catch{if(!t)return!0;try{return new r()[e](nC(-1/0)),!1}catch{var i=new r;return i.add(1),i.add(2),t(i[e](nC(1/0)))}}}catch{return!1}}});var sC=m(()=>{"use strict";var wN=De(),bN=rC(),SN=ke(),xN=yr(),kN=!xN("difference",function(e){return e.size===0}),DN=kN||SN(function(){var e={size:1,has:function(){return!0},keys:function(){var r=0;return{next:function(){var i=r++>1;return t.has(1)&&t.clear(),{done:i,value:2}}}}},t=new Set([1,2,3,4]);return t.difference(e).size!==3});wN({target:"Set",proto:!0,real:!0,forced:DN},{difference:bN})});var aC=m(()=>{"use strict";sC()});var lC=m((WY,AC)=>{"use strict";var vN=Cr(),Yl=mt(),FN=vi(),RN=Br(),TN=Xr(),_N=mr(),MN=Yl.Set,cC=Yl.add,NN=Yl.has;AC.exports=function(t){var r=vN(this),i=RN(t),n=new MN;return FN(r)>i.size?_N(i.getIterator(),function(o){NN(r,o)&&cC(n,o)}):TN(r,function(o){i.includes(o)&&cC(n,o)}),n}});var dC=m(()=>{"use strict";var PN=De(),UN=ke(),ON=lC(),qN=yr(),GN=!qN("intersection",function(e){return e.size===2&&e.has(1)&&e.has(2)})||UN(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});PN({target:"Set",proto:!0,real:!0,forced:GN},{intersection:ON})});var gC=m(()=>{"use strict";dC()});var fC=m((eW,uC)=>{"use strict";var HN=Cr(),LN=mt().has,KN=vi(),JN=Br(),zN=Xr(),VN=mr(),YN=Qs();uC.exports=function(t){var r=HN(this),i=JN(t);if(KN(r)<=i.size)return zN(r,function(o){if(i.includes(o))return!1},!0)!==!1;var n=i.getIterator();return VN(n,function(o){if(LN(r,o))return YN(n,"normal",!1)})!==!1}});var IC=m(()=>{"use strict";var WN=De(),jN=fC(),XN=yr(),ZN=!XN("isDisjointFrom",function(e){return!e});WN({target:"Set",proto:!0,real:!0,forced:ZN},{isDisjointFrom:jN})});var pC=m(()=>{"use strict";IC()});var mC=m((oW,hC)=>{"use strict";var $N=Cr(),eP=vi(),tP=Xr(),rP=Br();hC.exports=function(t){var r=$N(this),i=rP(t);return eP(r)>i.size?!1:tP(r,function(n){if(!i.includes(n))return!1},!0)!==!1}});var CC=m(()=>{"use strict";var iP=De(),nP=mC(),oP=yr(),sP=!oP("isSubsetOf",function(e){return e});iP({target:"Set",proto:!0,real:!0,forced:sP},{isSubsetOf:nP})});var BC=m(()=>{"use strict";CC()});var EC=m((lW,yC)=>{"use strict";var aP=Cr(),cP=mt().has,AP=vi(),lP=Br(),dP=mr(),gP=Qs();yC.exports=function(t){var r=aP(this),i=lP(t);if(AP(r)<i.size)return!1;var n=i.getIterator();return dP(n,function(o){if(!cP(r,o))return gP(n,"normal",!1)})!==!1}});var QC=m(()=>{"use strict";var uP=De(),fP=EC(),IP=yr(),pP=!IP("isSupersetOf",function(e){return!e});uP({target:"Set",proto:!0,real:!0,forced:pP},{isSupersetOf:fP})});var wC=m(()=>{"use strict";QC()});var SC=m((IW,bC)=>{"use strict";var hP=Cr(),mP=mt().add,CP=Ps(),BP=Br(),yP=mr();bC.exports=function(t){var r=hP(this),i=BP(t).getIterator(),n=CP(r);return yP(i,function(o){mP(n,o)}),n}});var Wl=m((pW,xC)=>{"use strict";xC.exports=function(e){try{var t=new Set,r={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return t.clear(),t.add(4),function(){return{done:!0}}}})}},i=t[e](r);return i.size===1&&i.values().next().value===4}catch{return!1}}});var kC=m(()=>{"use strict";var EP=De(),QP=SC(),wP=Wl(),bP=yr(),SP=!bP("union")||!wP("union");EP({target:"Set",proto:!0,real:!0,forced:SP},{union:QP})});var DC=m(()=>{"use strict";kC()});var FC=m((yW,vC)=>{"use strict";var xP=Cr(),jl=mt(),kP=Ps(),DP=Br(),vP=mr(),FP=jl.add,RP=jl.has,TP=jl.remove;vC.exports=function(t){var r=xP(this),i=DP(t).getIterator(),n=kP(r);return vP(i,function(o){RP(r,o)?TP(n,o):FP(n,o)}),n}});var RC=m(()=>{"use strict";var _P=De(),MP=FC(),NP=Wl(),PP=yr(),UP=!PP("symmetricDifference")||!NP("symmetricDifference");_P({target:"Set",proto:!0,real:!0,forced:UP},{symmetricDifference:MP})});var TC=m(()=>{"use strict";RC()});var _C=m(()=>{"use strict";aC();gC();pC();BC();wC();DC();TC()});var Ae=m((Xl,PC)=>{(function(e,t){if(typeof define=="function"&&define.amd)define("webextension-polyfill",["module"],t);else if(typeof Xl<"u")t(PC);else{var r={exports:{}};t(r),e.browser=r.exports}})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:Xl,function(e){"use strict";if(!(globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.id))throw new Error("This script should only be loaded in a browser extension.");if(globalThis.browser&&globalThis.browser.runtime&&globalThis.browser.runtime.id)e.exports=globalThis.browser;else{let t="The message port closed before a response was received.",r=i=>{let n={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(n).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class o extends WeakMap{constructor(x,w=void 0){super(w),this.createItem=x}get(x){return this.has(x)||this.set(x,this.createItem(x)),super.get(x)}}let a=E=>E&&typeof E=="object"&&typeof E.then=="function",s=(E,x)=>(...w)=>{i.runtime.lastError?E.reject(new Error(i.runtime.lastError.message)):x.singleCallbackArg||w.length<=1&&x.singleCallbackArg!==!1?E.resolve(w[0]):E.resolve(w)},c=E=>E==1?"argument":"arguments",A=(E,x)=>function(k,...N){if(N.length<x.minArgs)throw new Error(`Expected at least ${x.minArgs} ${c(x.minArgs)} for ${E}(), got ${N.length}`);if(N.length>x.maxArgs)throw new Error(`Expected at most ${x.maxArgs} ${c(x.maxArgs)} for ${E}(), got ${N.length}`);return new Promise((J,X)=>{if(x.fallbackToNoCallback)try{k[E](...N,s({resolve:J,reject:X},x))}catch{k[E](...N),x.fallbackToNoCallback=!1,x.noCallback=!0,J()}else x.noCallback?(k[E](...N),J()):k[E](...N,s({resolve:J,reject:X},x))})},l=(E,x,w)=>new Proxy(x,{apply(k,N,J){return w.call(N,E,...J)}}),d=Function.call.bind(Object.prototype.hasOwnProperty),g=(E,x={},w={})=>{let k=Object.create(null),N={has(X,K){return K in E||K in k},get(X,K,Ze){if(K in k)return k[K];if(!(K in E))return;let fe=E[K];if(typeof fe=="function")if(typeof x[K]=="function")fe=l(E,E[K],x[K]);else if(d(w,K)){let Si=A(K,w[K]);fe=l(E,E[K],Si)}else fe=fe.bind(E);else if(typeof fe=="object"&&fe!==null&&(d(x,K)||d(w,K)))fe=g(fe,x[K],w[K]);else if(d(w,"*"))fe=g(fe,x[K],w["*"]);else return Object.defineProperty(k,K,{configurable:!0,enumerable:!0,get(){return E[K]},set(Si){E[K]=Si}}),fe;return k[K]=fe,fe},set(X,K,Ze,fe){return K in k?k[K]=Ze:E[K]=Ze,!0},defineProperty(X,K,Ze){return Reflect.defineProperty(k,K,Ze)},deleteProperty(X,K){return Reflect.deleteProperty(k,K)}},J=Object.create(E);return new Proxy(J,N)},u=E=>({addListener(x,w,...k){x.addListener(E.get(w),...k)},hasListener(x,w){return x.hasListener(E.get(w))},removeListener(x,w){x.removeListener(E.get(w))}}),I=new o(E=>typeof E!="function"?E:function(w){let k=g(w,{},{getContent:{minArgs:0,maxArgs:0}});E(k)}),C=new o(E=>typeof E!="function"?E:function(w,k,N){let J=!1,X,K=new Promise(Fn=>{X=function(jt){J=!0,Fn(jt)}}),Ze;try{Ze=E(w,k,X)}catch(Fn){Ze=Promise.reject(Fn)}let fe=Ze!==!0&&a(Ze);if(Ze!==!0&&!fe&&!J)return!1;let Si=Fn=>{Fn.then(jt=>{N(jt)},jt=>{let vA;jt&&(jt instanceof Error||typeof jt.message=="string")?vA=jt.message:vA="An unexpected error occurred",N({__mozWebExtensionPolyfillReject__:!0,message:vA})}).catch(jt=>{})};return Si(fe?Ze:K),!0}),B=({reject:E,resolve:x},w)=>{i.runtime.lastError?i.runtime.lastError.message===t?x():E(new Error(i.runtime.lastError.message)):w&&w.__mozWebExtensionPolyfillReject__?E(new Error(w.message)):x(w)},h=(E,x,w,...k)=>{if(k.length<x.minArgs)throw new Error(`Expected at least ${x.minArgs} ${c(x.minArgs)} for ${E}(), got ${k.length}`);if(k.length>x.maxArgs)throw new Error(`Expected at most ${x.maxArgs} ${c(x.maxArgs)} for ${E}(), got ${k.length}`);return new Promise((N,J)=>{let X=B.bind(null,{resolve:N,reject:J});k.push(X),w.sendMessage(...k)})},Q={devtools:{network:{onRequestFinished:u(I)}},runtime:{onMessage:u(C),onMessageExternal:u(C),sendMessage:h.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:h.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},D={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return n.privacy={network:{"*":D},services:{"*":D},websites:{"*":D}},g(i,Q,n)};e.exports=r(chrome)}})});var CE=m((Fte,ga)=>{(function(){"use strict";var e={}.hasOwnProperty;function t(){for(var n="",o=0;o<arguments.length;o++){var a=arguments[o];a&&(n=i(n,r(a)))}return n}function r(n){if(typeof n=="string"||typeof n=="number")return n;if(typeof n!="object")return"";if(Array.isArray(n))return t.apply(null,n);if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]"))return n.toString();var o="";for(var a in n)e.call(n,a)&&n[a]&&(o=i(o,a));return o}function i(n,o){return o?n?n+" "+o:n+o:n}typeof ga<"u"&&ga.exports?(t.default=t,ga.exports=t):typeof define=="function"&&typeof define.amd=="object"&&define.amd?define("classnames",[],function(){return t}):window.classNames=t})()});var Ua=m(ur=>{"use strict";var aw=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",SK=aw+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",cw="["+aw+"]["+SK+"]*",xK=new RegExp("^"+cw+"$"),kK=function(e,t){let r=[],i=t.exec(e);for(;i;){let n=[];n.startIndex=t.lastIndex-i[0].length;let o=i.length;for(let a=0;a<o;a++)n.push(i[a]);r.push(n),i=t.exec(e)}return r},DK=function(e){let t=xK.exec(e);return!(t===null||typeof t>"u")};ur.isExist=function(e){return typeof e<"u"};ur.isEmptyObject=function(e){return Object.keys(e).length===0};ur.merge=function(e,t,r){if(t){let i=Object.keys(t),n=i.length;for(let o=0;o<n;o++)r==="strict"?e[i[o]]=[t[i[o]]]:e[i[o]]=t[i[o]]}};ur.getValue=function(e){return ur.isExist(e)?e:""};ur.isName=DK;ur.getAllMatches=kK;ur.nameRegexp=cw});var cg=m(uw=>{"use strict";var ag=Ua(),vK={allowBooleanAttributes:!1,unpairedTags:[]};uw.validate=function(e,t){t=Object.assign({},vK,t);let r=[],i=!1,n=!1;e[0]==="\uFEFF"&&(e=e.substr(1));for(let o=0;o<e.length;o++)if(e[o]==="<"&&e[o+1]==="?"){if(o+=2,o=lw(e,o),o.err)return o}else if(e[o]==="<"){let a=o;if(o++,e[o]==="!"){o=dw(e,o);continue}else{let s=!1;e[o]==="/"&&(s=!0,o++);let c="";for(;o<e.length&&e[o]!==">"&&e[o]!==" "&&e[o]!=="	"&&e[o]!==`
`&&e[o]!=="\r";o++)c+=e[o];if(c=c.trim(),c[c.length-1]==="/"&&(c=c.substring(0,c.length-1),o--),!UK(c)){let d;return c.trim().length===0?d="Invalid space after '<'.":d="Tag '"+c+"' is an invalid name.",he("InvalidTag",d,rt(e,o))}let A=TK(e,o);if(A===!1)return he("InvalidAttr","Attributes for '"+c+"' have open quote.",rt(e,o));let l=A.value;if(o=A.index,l[l.length-1]==="/"){let d=o-l.length;l=l.substring(0,l.length-1);let g=gw(l,t);if(g===!0)i=!0;else return he(g.err.code,g.err.msg,rt(e,d+g.err.line))}else if(s)if(A.tagClosed){if(l.trim().length>0)return he("InvalidTag","Closing tag '"+c+"' can't have attributes or invalid starting.",rt(e,a));if(r.length===0)return he("InvalidTag","Closing tag '"+c+"' has not been opened.",rt(e,a));{let d=r.pop();if(c!==d.tagName){let g=rt(e,d.tagStartPos);return he("InvalidTag","Expected closing tag '"+d.tagName+"' (opened in line "+g.line+", col "+g.col+") instead of closing tag '"+c+"'.",rt(e,a))}r.length==0&&(n=!0)}}else return he("InvalidTag","Closing tag '"+c+"' doesn't have proper closing.",rt(e,o));else{let d=gw(l,t);if(d!==!0)return he(d.err.code,d.err.msg,rt(e,o-l.length+d.err.line));if(n===!0)return he("InvalidXml","Multiple possible root nodes found.",rt(e,o));t.unpairedTags.indexOf(c)!==-1||r.push({tagName:c,tagStartPos:a}),i=!0}for(o++;o<e.length;o++)if(e[o]==="<")if(e[o+1]==="!"){o++,o=dw(e,o);continue}else if(e[o+1]==="?"){if(o=lw(e,++o),o.err)return o}else break;else if(e[o]==="&"){let d=NK(e,o);if(d==-1)return he("InvalidChar","char '&' is not expected.",rt(e,o));o=d}else if(n===!0&&!Aw(e[o]))return he("InvalidXml","Extra text at the end",rt(e,o));e[o]==="<"&&o--}}else{if(Aw(e[o]))continue;return he("InvalidChar","char '"+e[o]+"' is not expected.",rt(e,o))}if(i){if(r.length==1)return he("InvalidTag","Unclosed tag '"+r[0].tagName+"'.",rt(e,r[0].tagStartPos));if(r.length>0)return he("InvalidXml","Invalid '"+JSON.stringify(r.map(o=>o.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return he("InvalidXml","Start tag expected.",1);return!0};function Aw(e){return e===" "||e==="	"||e===`
`||e==="\r"}function lw(e,t){let r=t;for(;t<e.length;t++)if(e[t]=="?"||e[t]==" "){let i=e.substr(r,t-r);if(t>5&&i==="xml")return he("InvalidXml","XML declaration allowed only at the start of the document.",rt(e,t));if(e[t]=="?"&&e[t+1]==">"){t++;break}else continue}return t}function dw(e,t){if(e.length>t+5&&e[t+1]==="-"&&e[t+2]==="-"){for(t+=3;t<e.length;t++)if(e[t]==="-"&&e[t+1]==="-"&&e[t+2]===">"){t+=2;break}}else if(e.length>t+8&&e[t+1]==="D"&&e[t+2]==="O"&&e[t+3]==="C"&&e[t+4]==="T"&&e[t+5]==="Y"&&e[t+6]==="P"&&e[t+7]==="E"){let r=1;for(t+=8;t<e.length;t++)if(e[t]==="<")r++;else if(e[t]===">"&&(r--,r===0))break}else if(e.length>t+9&&e[t+1]==="["&&e[t+2]==="C"&&e[t+3]==="D"&&e[t+4]==="A"&&e[t+5]==="T"&&e[t+6]==="A"&&e[t+7]==="["){for(t+=8;t<e.length;t++)if(e[t]==="]"&&e[t+1]==="]"&&e[t+2]===">"){t+=2;break}}return t}var FK='"',RK="'";function TK(e,t){let r="",i="",n=!1;for(;t<e.length;t++){if(e[t]===FK||e[t]===RK)i===""?i=e[t]:i!==e[t]||(i="");else if(e[t]===">"&&i===""){n=!0;break}r+=e[t]}return i!==""?!1:{value:r,index:t,tagClosed:n}}var _K=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function gw(e,t){let r=ag.getAllMatches(e,_K),i={};for(let n=0;n<r.length;n++){if(r[n][1].length===0)return he("InvalidAttr","Attribute '"+r[n][2]+"' has no space in starting.",mo(r[n]));if(r[n][3]!==void 0&&r[n][4]===void 0)return he("InvalidAttr","Attribute '"+r[n][2]+"' is without value.",mo(r[n]));if(r[n][3]===void 0&&!t.allowBooleanAttributes)return he("InvalidAttr","boolean attribute '"+r[n][2]+"' is not allowed.",mo(r[n]));let o=r[n][2];if(!PK(o))return he("InvalidAttr","Attribute '"+o+"' is an invalid name.",mo(r[n]));if(!i.hasOwnProperty(o))i[o]=1;else return he("InvalidAttr","Attribute '"+o+"' is repeated.",mo(r[n]))}return!0}function MK(e,t){let r=/\d/;for(e[t]==="x"&&(t++,r=/[\da-fA-F]/);t<e.length;t++){if(e[t]===";")return t;if(!e[t].match(r))break}return-1}function NK(e,t){if(t++,e[t]===";")return-1;if(e[t]==="#")return t++,MK(e,t);let r=0;for(;t<e.length;t++,r++)if(!(e[t].match(/\w/)&&r<20)){if(e[t]===";")break;return-1}return t}function he(e,t,r){return{err:{code:e,msg:t,line:r.line||r,col:r.col}}}function PK(e){return ag.isName(e)}function UK(e){return ag.isName(e)}function rt(e,t){let r=e.substring(0,t).split(/\r?\n/);return{line:r.length,col:r[r.length-1].length+1}}function mo(e){return e.startIndex+e[1].length}});var Iw=m(Ag=>{var fw={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(e,t){return t},attributeValueProcessor:function(e,t){return t},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(e,t,r){return e}},OK=function(e){return Object.assign({},fw,e)};Ag.buildOptions=OK;Ag.defaultOptions=fw});var hw=m((xue,pw)=>{"use strict";var lg=class{constructor(t){this.tagname=t,this.child=[],this[":@"]={}}add(t,r){t==="__proto__"&&(t="#__proto__"),this.child.push({[t]:r})}addChild(t){t.tagname==="__proto__"&&(t.tagname="#__proto__"),t[":@"]&&Object.keys(t[":@"]).length>0?this.child.push({[t.tagname]:t.child,":@":t[":@"]}):this.child.push({[t.tagname]:t.child})}};pw.exports=lg});var Cw=m((kue,mw)=>{var qK=Ua();function GK(e,t){let r={};if(e[t+3]==="O"&&e[t+4]==="C"&&e[t+5]==="T"&&e[t+6]==="Y"&&e[t+7]==="P"&&e[t+8]==="E"){t=t+9;let i=1,n=!1,o=!1,a="";for(;t<e.length;t++)if(e[t]==="<"&&!o){if(n&&KK(e,t))t+=7,[entityName,val,t]=HK(e,t+1),val.indexOf("&")===-1&&(r[YK(entityName)]={regx:RegExp(`&${entityName};`,"g"),val});else if(n&&JK(e,t))t+=8;else if(n&&zK(e,t))t+=8;else if(n&&VK(e,t))t+=9;else if(LK)o=!0;else throw new Error("Invalid DOCTYPE");i++,a=""}else if(e[t]===">"){if(o?e[t-1]==="-"&&e[t-2]==="-"&&(o=!1,i--):i--,i===0)break}else e[t]==="["?n=!0:a+=e[t];if(i!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:r,i:t}}function HK(e,t){let r="";for(;t<e.length&&e[t]!=="'"&&e[t]!=='"';t++)r+=e[t];if(r=r.trim(),r.indexOf(" ")!==-1)throw new Error("External entites are not supported");let i=e[t++],n="";for(;t<e.length&&e[t]!==i;t++)n+=e[t];return[r,n,t]}function LK(e,t){return e[t+1]==="!"&&e[t+2]==="-"&&e[t+3]==="-"}function KK(e,t){return e[t+1]==="!"&&e[t+2]==="E"&&e[t+3]==="N"&&e[t+4]==="T"&&e[t+5]==="I"&&e[t+6]==="T"&&e[t+7]==="Y"}function JK(e,t){return e[t+1]==="!"&&e[t+2]==="E"&&e[t+3]==="L"&&e[t+4]==="E"&&e[t+5]==="M"&&e[t+6]==="E"&&e[t+7]==="N"&&e[t+8]==="T"}function zK(e,t){return e[t+1]==="!"&&e[t+2]==="A"&&e[t+3]==="T"&&e[t+4]==="T"&&e[t+5]==="L"&&e[t+6]==="I"&&e[t+7]==="S"&&e[t+8]==="T"}function VK(e,t){return e[t+1]==="!"&&e[t+2]==="N"&&e[t+3]==="O"&&e[t+4]==="T"&&e[t+5]==="A"&&e[t+6]==="T"&&e[t+7]==="I"&&e[t+8]==="O"&&e[t+9]==="N"}function YK(e){if(qK.isName(e))return e;throw new Error(`Invalid entity name ${e}`)}mw.exports=GK});var yw=m((Due,Bw)=>{var WK=/^[-+]?0x[a-fA-F0-9]+$/,jK=/^([\-\+])?(0*)([0-9]*(\.[0-9]*)?)$/,XK={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function ZK(e,t={}){if(t=Object.assign({},XK,t),!e||typeof e!="string")return e;let r=e.trim();if(t.skipLike!==void 0&&t.skipLike.test(r))return e;if(e==="0")return 0;if(t.hex&&WK.test(r))return e2(r,16);if(r.search(/[eE]/)!==-1){let i=r.match(/^([-\+])?(0*)([0-9]*(\.[0-9]*)?[eE][-\+]?[0-9]+)$/);if(i){if(t.leadingZeros)r=(i[1]||"")+i[3];else if(!(i[2]==="0"&&i[3][0]==="."))return e;return t.eNotation?Number(r):e}else return e}else{let i=jK.exec(r);if(i){let n=i[1],o=i[2],a=$K(i[3]);if(!t.leadingZeros&&o.length>0&&n&&r[2]!==".")return e;if(!t.leadingZeros&&o.length>0&&!n&&r[1]!==".")return e;if(t.leadingZeros&&o===e)return 0;{let s=Number(r),c=""+s;return c.search(/[eE]/)!==-1?t.eNotation?s:e:r.indexOf(".")!==-1?c==="0"&&a===""||c===a||n&&c==="-"+a?s:e:o?a===c||n+a===c?s:e:r===c||r===n+c?s:e}}else return e}}function $K(e){return e&&e.indexOf(".")!==-1&&(e=e.replace(/0+$/,""),e==="."?e="0":e[0]==="."?e="0"+e:e[e.length-1]==="."&&(e=e.substr(0,e.length-1))),e}function e2(e,t){if(parseInt)return parseInt(e,t);if(Number.parseInt)return Number.parseInt(e,t);if(window&&window.parseInt)return window.parseInt(e,t);throw new Error("parseInt, Number.parseInt, window.parseInt are not supported")}Bw.exports=ZK});var ww=m((vue,Qw)=>{"use strict";var Ew=Ua(),Co=hw(),t2=Cw(),r2=yw(),dg=class{constructor(t){this.options=t,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"\xA2"},pound:{regex:/&(pound|#163);/g,val:"\xA3"},yen:{regex:/&(yen|#165);/g,val:"\xA5"},euro:{regex:/&(euro|#8364);/g,val:"\u20AC"},copyright:{regex:/&(copy|#169);/g,val:"\xA9"},reg:{regex:/&(reg|#174);/g,val:"\xAE"},inr:{regex:/&(inr|#8377);/g,val:"\u20B9"},num_dec:{regex:/&#([0-9]{1,7});/g,val:(r,i)=>String.fromCharCode(Number.parseInt(i,10))},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(r,i)=>String.fromCharCode(Number.parseInt(i,16))}},this.addExternalEntities=i2,this.parseXml=c2,this.parseTextData=n2,this.resolveNameSpace=o2,this.buildAttributesMap=a2,this.isItStopNode=g2,this.replaceEntitiesValue=l2,this.readStopNodeData=f2,this.saveTextToParentTag=d2,this.addChild=A2}};function i2(e){let t=Object.keys(e);for(let r=0;r<t.length;r++){let i=t[r];this.lastEntities[i]={regex:new RegExp("&"+i+";","g"),val:e[i]}}}function n2(e,t,r,i,n,o,a){if(e!==void 0&&(this.options.trimValues&&!i&&(e=e.trim()),e.length>0)){a||(e=this.replaceEntitiesValue(e));let s=this.options.tagValueProcessor(t,e,r,n,o);return s==null?e:typeof s!=typeof e||s!==e?s:this.options.trimValues?ug(e,this.options.parseTagValue,this.options.numberParseOptions):e.trim()===e?ug(e,this.options.parseTagValue,this.options.numberParseOptions):e}}function o2(e){if(this.options.removeNSPrefix){let t=e.split(":"),r=e.charAt(0)==="/"?"/":"";if(t[0]==="xmlns")return"";t.length===2&&(e=r+t[1])}return e}var s2=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");function a2(e,t,r){if(!this.options.ignoreAttributes&&typeof e=="string"){let i=Ew.getAllMatches(e,s2),n=i.length,o={};for(let a=0;a<n;a++){let s=this.resolveNameSpace(i[a][1]),c=i[a][4],A=this.options.attributeNamePrefix+s;if(s.length)if(this.options.transformAttributeName&&(A=this.options.transformAttributeName(A)),A==="__proto__"&&(A="#__proto__"),c!==void 0){this.options.trimValues&&(c=c.trim()),c=this.replaceEntitiesValue(c);let l=this.options.attributeValueProcessor(s,c,t);l==null?o[A]=c:typeof l!=typeof c||l!==c?o[A]=l:o[A]=ug(c,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(o[A]=!0)}if(!Object.keys(o).length)return;if(this.options.attributesGroupName){let a={};return a[this.options.attributesGroupName]=o,a}return o}}var c2=function(e){e=e.replace(/\r\n?/g,`
`);let t=new Co("!xml"),r=t,i="",n="";for(let o=0;o<e.length;o++)if(e[o]==="<")if(e[o+1]==="/"){let s=li(e,">",o,"Closing Tag is not closed."),c=e.substring(o+2,s).trim();if(this.options.removeNSPrefix){let d=c.indexOf(":");d!==-1&&(c=c.substr(d+1))}this.options.transformTagName&&(c=this.options.transformTagName(c)),r&&(i=this.saveTextToParentTag(i,r,n));let A=n.substring(n.lastIndexOf(".")+1);if(c&&this.options.unpairedTags.indexOf(c)!==-1)throw new Error(`Unpaired tag can not be used as closing tag: </${c}>`);let l=0;A&&this.options.unpairedTags.indexOf(A)!==-1?(l=n.lastIndexOf(".",n.lastIndexOf(".")-1),this.tagsNodeStack.pop()):l=n.lastIndexOf("."),n=n.substring(0,l),r=this.tagsNodeStack.pop(),i="",o=s}else if(e[o+1]==="?"){let s=gg(e,o,!1,"?>");if(!s)throw new Error("Pi Tag is not closed.");if(i=this.saveTextToParentTag(i,r,n),!(this.options.ignoreDeclaration&&s.tagName==="?xml"||this.options.ignorePiTags)){let c=new Co(s.tagName);c.add(this.options.textNodeName,""),s.tagName!==s.tagExp&&s.attrExpPresent&&(c[":@"]=this.buildAttributesMap(s.tagExp,n,s.tagName)),this.addChild(r,c,n)}o=s.closeIndex+1}else if(e.substr(o+1,3)==="!--"){let s=li(e,"-->",o+4,"Comment is not closed.");if(this.options.commentPropName){let c=e.substring(o+4,s-2);i=this.saveTextToParentTag(i,r,n),r.add(this.options.commentPropName,[{[this.options.textNodeName]:c}])}o=s}else if(e.substr(o+1,2)==="!D"){let s=t2(e,o);this.docTypeEntities=s.entities,o=s.i}else if(e.substr(o+1,2)==="!["){let s=li(e,"]]>",o,"CDATA is not closed.")-2,c=e.substring(o+9,s);i=this.saveTextToParentTag(i,r,n);let A=this.parseTextData(c,r.tagname,n,!0,!1,!0,!0);A==null&&(A=""),this.options.cdataPropName?r.add(this.options.cdataPropName,[{[this.options.textNodeName]:c}]):r.add(this.options.textNodeName,A),o=s+2}else{let s=gg(e,o,this.options.removeNSPrefix),c=s.tagName,A=s.rawTagName,l=s.tagExp,d=s.attrExpPresent,g=s.closeIndex;this.options.transformTagName&&(c=this.options.transformTagName(c)),r&&i&&r.tagname!=="!xml"&&(i=this.saveTextToParentTag(i,r,n,!1));let u=r;if(u&&this.options.unpairedTags.indexOf(u.tagname)!==-1&&(r=this.tagsNodeStack.pop(),n=n.substring(0,n.lastIndexOf("."))),c!==t.tagname&&(n+=n?"."+c:c),this.isItStopNode(this.options.stopNodes,n,c)){let I="";if(l.length>0&&l.lastIndexOf("/")===l.length-1)c[c.length-1]==="/"?(c=c.substr(0,c.length-1),n=n.substr(0,n.length-1),l=c):l=l.substr(0,l.length-1),o=s.closeIndex;else if(this.options.unpairedTags.indexOf(c)!==-1)o=s.closeIndex;else{let B=this.readStopNodeData(e,A,g+1);if(!B)throw new Error(`Unexpected end of ${A}`);o=B.i,I=B.tagContent}let C=new Co(c);c!==l&&d&&(C[":@"]=this.buildAttributesMap(l,n,c)),I&&(I=this.parseTextData(I,c,n,!0,d,!0,!0)),n=n.substr(0,n.lastIndexOf(".")),C.add(this.options.textNodeName,I),this.addChild(r,C,n)}else{if(l.length>0&&l.lastIndexOf("/")===l.length-1){c[c.length-1]==="/"?(c=c.substr(0,c.length-1),n=n.substr(0,n.length-1),l=c):l=l.substr(0,l.length-1),this.options.transformTagName&&(c=this.options.transformTagName(c));let I=new Co(c);c!==l&&d&&(I[":@"]=this.buildAttributesMap(l,n,c)),this.addChild(r,I,n),n=n.substr(0,n.lastIndexOf("."))}else{let I=new Co(c);this.tagsNodeStack.push(r),c!==l&&d&&(I[":@"]=this.buildAttributesMap(l,n,c)),this.addChild(r,I,n),r=I}i="",o=g}}else i+=e[o];return t.child};function A2(e,t,r){let i=this.options.updateTag(t.tagname,r,t[":@"]);i===!1||(typeof i=="string"&&(t.tagname=i),e.addChild(t))}var l2=function(e){if(this.options.processEntities){for(let t in this.docTypeEntities){let r=this.docTypeEntities[t];e=e.replace(r.regx,r.val)}for(let t in this.lastEntities){let r=this.lastEntities[t];e=e.replace(r.regex,r.val)}if(this.options.htmlEntities)for(let t in this.htmlEntities){let r=this.htmlEntities[t];e=e.replace(r.regex,r.val)}e=e.replace(this.ampEntity.regex,this.ampEntity.val)}return e};function d2(e,t,r,i){return e&&(i===void 0&&(i=Object.keys(t.child).length===0),e=this.parseTextData(e,t.tagname,r,!1,t[":@"]?Object.keys(t[":@"]).length!==0:!1,i),e!==void 0&&e!==""&&t.add(this.options.textNodeName,e),e=""),e}function g2(e,t,r){let i="*."+r;for(let n in e){let o=e[n];if(i===o||t===o)return!0}return!1}function u2(e,t,r=">"){let i,n="";for(let o=t;o<e.length;o++){let a=e[o];if(i)a===i&&(i="");else if(a==='"'||a==="'")i=a;else if(a===r[0])if(r[1]){if(e[o+1]===r[1])return{data:n,index:o}}else return{data:n,index:o};else a==="	"&&(a=" ");n+=a}}function li(e,t,r,i){let n=e.indexOf(t,r);if(n===-1)throw new Error(i);return n+t.length-1}function gg(e,t,r,i=">"){let n=u2(e,t+1,i);if(!n)return;let o=n.data,a=n.index,s=o.search(/\s/),c=o,A=!0;s!==-1&&(c=o.substring(0,s),o=o.substring(s+1).trimStart());let l=c;if(r){let d=c.indexOf(":");d!==-1&&(c=c.substr(d+1),A=c!==n.data.substr(d+1))}return{tagName:c,tagExp:o,closeIndex:a,attrExpPresent:A,rawTagName:l}}function f2(e,t,r){let i=r,n=1;for(;r<e.length;r++)if(e[r]==="<")if(e[r+1]==="/"){let o=li(e,">",r,`${t} is not closed`);if(e.substring(r+2,o).trim()===t&&(n--,n===0))return{tagContent:e.substring(i,r),i:o};r=o}else if(e[r+1]==="?")r=li(e,"?>",r+1,"StopNode is not closed.");else if(e.substr(r+1,3)==="!--")r=li(e,"-->",r+3,"StopNode is not closed.");else if(e.substr(r+1,2)==="![")r=li(e,"]]>",r,"StopNode is not closed.")-2;else{let o=gg(e,r,">");o&&((o&&o.tagName)===t&&o.tagExp[o.tagExp.length-1]!=="/"&&n++,r=o.closeIndex)}}function ug(e,t,r){if(t&&typeof e=="string"){let i=e.trim();return i==="true"?!0:i==="false"?!1:r2(e,r)}else return Ew.isExist(e)?e:""}Qw.exports=dg});var xw=m(Sw=>{"use strict";function I2(e,t){return bw(e,t)}function bw(e,t,r){let i,n={};for(let o=0;o<e.length;o++){let a=e[o],s=p2(a),c="";if(r===void 0?c=s:c=r+"."+s,s===t.textNodeName)i===void 0?i=a[s]:i+=""+a[s];else{if(s===void 0)continue;if(a[s]){let A=bw(a[s],t,c),l=m2(A,t);a[":@"]?h2(A,a[":@"],c,t):Object.keys(A).length===1&&A[t.textNodeName]!==void 0&&!t.alwaysCreateTextNode?A=A[t.textNodeName]:Object.keys(A).length===0&&(t.alwaysCreateTextNode?A[t.textNodeName]="":A=""),n[s]!==void 0&&n.hasOwnProperty(s)?(Array.isArray(n[s])||(n[s]=[n[s]]),n[s].push(A)):t.isArray(s,c,l)?n[s]=[A]:n[s]=A}}}return typeof i=="string"?i.length>0&&(n[t.textNodeName]=i):i!==void 0&&(n[t.textNodeName]=i),n}function p2(e){let t=Object.keys(e);for(let r=0;r<t.length;r++){let i=t[r];if(i!==":@")return i}}function h2(e,t,r,i){if(t){let n=Object.keys(t),o=n.length;for(let a=0;a<o;a++){let s=n[a];i.isArray(s,r+"."+s,!0,!0)?e[s]=[t[s]]:e[s]=t[s]}}}function m2(e,t){let{textNodeName:r}=t,i=Object.keys(e).length;return!!(i===0||i===1&&(e[r]||typeof e[r]=="boolean"||e[r]===0))}Sw.prettify=I2});var Dw=m((Rue,kw)=>{var{buildOptions:C2}=Iw(),B2=ww(),{prettify:y2}=xw(),E2=cg(),fg=class{constructor(t){this.externalEntities={},this.options=C2(t)}parse(t,r){if(typeof t!="string")if(t.toString)t=t.toString();else throw new Error("XML data is accepted in String or Bytes[] form.");if(r){r===!0&&(r={});let o=E2.validate(t,r);if(o!==!0)throw Error(`${o.err.msg}:${o.err.line}:${o.err.col}`)}let i=new B2(this.options);i.addExternalEntities(this.externalEntities);let n=i.parseXml(t);return this.options.preserveOrder||n===void 0?n:y2(n,this.options)}addEntity(t,r){if(r.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(t.indexOf("&")!==-1||t.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(r==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[t]=r}};kw.exports=fg});var _w=m((Tue,Tw)=>{function Q2(e,t){let r="";return t.format&&t.indentBy.length>0&&(r=`
`),Fw(e,t,"",r)}function Fw(e,t,r,i){let n="",o=!1;for(let a=0;a<e.length;a++){let s=e[a],c=w2(s);if(c===void 0)continue;let A="";if(r.length===0?A=c:A=`${r}.${c}`,c===t.textNodeName){let I=s[c];b2(A,t)||(I=t.tagValueProcessor(c,I),I=Rw(I,t)),o&&(n+=i),n+=I,o=!1;continue}else if(c===t.cdataPropName){o&&(n+=i),n+=`<![CDATA[${s[c][0][t.textNodeName]}]]>`,o=!1;continue}else if(c===t.commentPropName){n+=i+`<!--${s[c][0][t.textNodeName]}-->`,o=!0;continue}else if(c[0]==="?"){let I=vw(s[":@"],t),C=c==="?xml"?"":i,B=s[c][0][t.textNodeName];B=B.length!==0?" "+B:"",n+=C+`<${c}${B}${I}?>`,o=!0;continue}let l=i;l!==""&&(l+=t.indentBy);let d=vw(s[":@"],t),g=i+`<${c}${d}`,u=Fw(s[c],t,A,l);t.unpairedTags.indexOf(c)!==-1?t.suppressUnpairedNode?n+=g+">":n+=g+"/>":(!u||u.length===0)&&t.suppressEmptyNode?n+=g+"/>":u&&u.endsWith(">")?n+=g+`>${u}${i}</${c}>`:(n+=g+">",u&&i!==""&&(u.includes("/>")||u.includes("</"))?n+=i+t.indentBy+u+i:n+=u,n+=`</${c}>`),o=!0}return n}function w2(e){let t=Object.keys(e);for(let r=0;r<t.length;r++){let i=t[r];if(e.hasOwnProperty(i)&&i!==":@")return i}}function vw(e,t){let r="";if(e&&!t.ignoreAttributes)for(let i in e){if(!e.hasOwnProperty(i))continue;let n=t.attributeValueProcessor(i,e[i]);n=Rw(n,t),n===!0&&t.suppressBooleanAttributes?r+=` ${i.substr(t.attributeNamePrefix.length)}`:r+=` ${i.substr(t.attributeNamePrefix.length)}="${n}"`}return r}function b2(e,t){e=e.substr(0,e.length-t.textNodeName.length-1);let r=e.substr(e.lastIndexOf(".")+1);for(let i in t.stopNodes)if(t.stopNodes[i]===e||t.stopNodes[i]==="*."+r)return!0;return!1}function Rw(e,t){if(e&&e.length>0&&t.processEntities)for(let r=0;r<t.entities.length;r++){let i=t.entities[r];e=e.replace(i.regex,i.val)}return e}Tw.exports=Q2});var Nw=m((_ue,Mw)=>{"use strict";var S2=_w(),x2={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(e,t){return t},attributeValueProcessor:function(e,t){return t},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],oneListGroup:!1};function Pr(e){this.options=Object.assign({},x2,e),this.options.ignoreAttributes||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=v2),this.processTextOrObjNode=k2,this.options.format?(this.indentate=D2,this.tagEndChar=`>
`,this.newLine=`
`):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}Pr.prototype.build=function(e){return this.options.preserveOrder?S2(e,this.options):(Array.isArray(e)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(e={[this.options.arrayNodeName]:e}),this.j2x(e,0).val)};Pr.prototype.j2x=function(e,t){let r="",i="";for(let n in e)if(Object.prototype.hasOwnProperty.call(e,n))if(typeof e[n]>"u")this.isAttribute(n)&&(i+="");else if(e[n]===null)this.isAttribute(n)?i+="":n[0]==="?"?i+=this.indentate(t)+"<"+n+"?"+this.tagEndChar:i+=this.indentate(t)+"<"+n+"/"+this.tagEndChar;else if(e[n]instanceof Date)i+=this.buildTextValNode(e[n],n,"",t);else if(typeof e[n]!="object"){let o=this.isAttribute(n);if(o)r+=this.buildAttrPairStr(o,""+e[n]);else if(n===this.options.textNodeName){let a=this.options.tagValueProcessor(n,""+e[n]);i+=this.replaceEntitiesValue(a)}else i+=this.buildTextValNode(e[n],n,"",t)}else if(Array.isArray(e[n])){let o=e[n].length,a="",s="";for(let c=0;c<o;c++){let A=e[n][c];if(!(typeof A>"u"))if(A===null)n[0]==="?"?i+=this.indentate(t)+"<"+n+"?"+this.tagEndChar:i+=this.indentate(t)+"<"+n+"/"+this.tagEndChar;else if(typeof A=="object")if(this.options.oneListGroup){let l=this.j2x(A,t+1);a+=l.val,this.options.attributesGroupName&&A.hasOwnProperty(this.options.attributesGroupName)&&(s+=l.attrStr)}else a+=this.processTextOrObjNode(A,n,t);else if(this.options.oneListGroup){let l=this.options.tagValueProcessor(n,A);l=this.replaceEntitiesValue(l),a+=l}else a+=this.buildTextValNode(A,n,"",t)}this.options.oneListGroup&&(a=this.buildObjectNode(a,n,s,t)),i+=a}else if(this.options.attributesGroupName&&n===this.options.attributesGroupName){let o=Object.keys(e[n]),a=o.length;for(let s=0;s<a;s++)r+=this.buildAttrPairStr(o[s],""+e[n][o[s]])}else i+=this.processTextOrObjNode(e[n],n,t);return{attrStr:r,val:i}};Pr.prototype.buildAttrPairStr=function(e,t){return t=this.options.attributeValueProcessor(e,""+t),t=this.replaceEntitiesValue(t),this.options.suppressBooleanAttributes&&t==="true"?" "+e:" "+e+'="'+t+'"'};function k2(e,t,r){let i=this.j2x(e,r+1);return e[this.options.textNodeName]!==void 0&&Object.keys(e).length===1?this.buildTextValNode(e[this.options.textNodeName],t,i.attrStr,r):this.buildObjectNode(i.val,t,i.attrStr,r)}Pr.prototype.buildObjectNode=function(e,t,r,i){if(e==="")return t[0]==="?"?this.indentate(i)+"<"+t+r+"?"+this.tagEndChar:this.indentate(i)+"<"+t+r+this.closeTag(t)+this.tagEndChar;{let n="</"+t+this.tagEndChar,o="";return t[0]==="?"&&(o="?",n=""),(r||r==="")&&e.indexOf("<")===-1?this.indentate(i)+"<"+t+r+o+">"+e+n:this.options.commentPropName!==!1&&t===this.options.commentPropName&&o.length===0?this.indentate(i)+`<!--${e}-->`+this.newLine:this.indentate(i)+"<"+t+r+o+this.tagEndChar+e+this.indentate(i)+n}};Pr.prototype.closeTag=function(e){let t="";return this.options.unpairedTags.indexOf(e)!==-1?this.options.suppressUnpairedNode||(t="/"):this.options.suppressEmptyNode?t="/":t=`></${e}`,t};Pr.prototype.buildTextValNode=function(e,t,r,i){if(this.options.cdataPropName!==!1&&t===this.options.cdataPropName)return this.indentate(i)+`<![CDATA[${e}]]>`+this.newLine;if(this.options.commentPropName!==!1&&t===this.options.commentPropName)return this.indentate(i)+`<!--${e}-->`+this.newLine;if(t[0]==="?")return this.indentate(i)+"<"+t+r+"?"+this.tagEndChar;{let n=this.options.tagValueProcessor(t,e);return n=this.replaceEntitiesValue(n),n===""?this.indentate(i)+"<"+t+r+this.closeTag(t)+this.tagEndChar:this.indentate(i)+"<"+t+r+">"+n+"</"+t+this.tagEndChar}};Pr.prototype.replaceEntitiesValue=function(e){if(e&&e.length>0&&this.options.processEntities)for(let t=0;t<this.options.entities.length;t++){let r=this.options.entities[t];e=e.replace(r.regex,r.val)}return e};function D2(e){return this.options.indentBy.repeat(e)}function v2(e){return e.startsWith(this.options.attributeNamePrefix)&&e!==this.options.textNodeName?e.substr(this.attrPrefixLen):!1}Mw.exports=Pr});var Uw=m((Mue,Pw)=>{"use strict";var F2=cg(),R2=Dw(),T2=Nw();Pw.exports={XMLParser:R2,XMLValidator:F2,XMLBuilder:T2}});var Tu=m((Go,Ru)=>{(function(e,t){typeof Go=="object"&&typeof Ru=="object"?Ru.exports=t():typeof define=="function"&&define.amd?define([],t):typeof Go=="object"?Go.bowser=t():e.bowser=t()})(Go,(function(){return(function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(i,n,o){r.o(i,n)||Object.defineProperty(i,n,{enumerable:!0,get:o})},r.r=function(i){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},r.t=function(i,n){if(1&n&&(i=r(i)),8&n||4&n&&typeof i=="object"&&i&&i.__esModule)return i;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:i}),2&n&&typeof i!="string")for(var a in i)r.d(o,a,function(s){return i[s]}.bind(null,a));return o},r.n=function(i){var n=i&&i.__esModule?function(){return i.default}:function(){return i};return r.d(n,"a",n),n},r.o=function(i,n){return Object.prototype.hasOwnProperty.call(i,n)},r.p="",r(r.s=90)})({17:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var i=r(18),n=(function(){function o(){}return o.getFirstMatch=function(a,s){var c=s.match(a);return c&&c.length>0&&c[1]||""},o.getSecondMatch=function(a,s){var c=s.match(a);return c&&c.length>1&&c[2]||""},o.matchAndReturnConst=function(a,s,c){if(a.test(s))return c},o.getWindowsVersionName=function(a){switch(a){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},o.getMacOSVersionName=function(a){var s=a.split(".").splice(0,2).map((function(c){return parseInt(c,10)||0}));if(s.push(0),s[0]===10)switch(s[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},o.getAndroidVersionName=function(a){var s=a.split(".").splice(0,2).map((function(c){return parseInt(c,10)||0}));if(s.push(0),!(s[0]===1&&s[1]<5))return s[0]===1&&s[1]<6?"Cupcake":s[0]===1&&s[1]>=6?"Donut":s[0]===2&&s[1]<2?"Eclair":s[0]===2&&s[1]===2?"Froyo":s[0]===2&&s[1]>2?"Gingerbread":s[0]===3?"Honeycomb":s[0]===4&&s[1]<1?"Ice Cream Sandwich":s[0]===4&&s[1]<4?"Jelly Bean":s[0]===4&&s[1]>=4?"KitKat":s[0]===5?"Lollipop":s[0]===6?"Marshmallow":s[0]===7?"Nougat":s[0]===8?"Oreo":s[0]===9?"Pie":void 0},o.getVersionPrecision=function(a){return a.split(".").length},o.compareVersions=function(a,s,c){c===void 0&&(c=!1);var A=o.getVersionPrecision(a),l=o.getVersionPrecision(s),d=Math.max(A,l),g=0,u=o.map([a,s],(function(I){var C=d-o.getVersionPrecision(I),B=I+new Array(C+1).join(".0");return o.map(B.split("."),(function(h){return new Array(20-h.length).join("0")+h})).reverse()}));for(c&&(g=d-Math.min(A,l)),d-=1;d>=g;){if(u[0][d]>u[1][d])return 1;if(u[0][d]===u[1][d]){if(d===g)return 0;d-=1}else if(u[0][d]<u[1][d])return-1}},o.map=function(a,s){var c,A=[];if(Array.prototype.map)return Array.prototype.map.call(a,s);for(c=0;c<a.length;c+=1)A.push(s(a[c]));return A},o.find=function(a,s){var c,A;if(Array.prototype.find)return Array.prototype.find.call(a,s);for(c=0,A=a.length;c<A;c+=1){var l=a[c];if(s(l,c))return l}},o.assign=function(a){for(var s,c,A=a,l=arguments.length,d=new Array(l>1?l-1:0),g=1;g<l;g++)d[g-1]=arguments[g];if(Object.assign)return Object.assign.apply(Object,[a].concat(d));var u=function(){var I=d[s];typeof I=="object"&&I!==null&&Object.keys(I).forEach((function(C){A[C]=I[C]}))};for(s=0,c=d.length;s<c;s+=1)u();return a},o.getBrowserAlias=function(a){return i.BROWSER_ALIASES_MAP[a]},o.getBrowserTypeByAlias=function(a){return i.BROWSER_MAP[a]||""},o})();t.default=n,e.exports=t.default},18:function(e,t,r){"use strict";t.__esModule=!0,t.ENGINE_MAP=t.OS_MAP=t.PLATFORMS_MAP=t.BROWSER_MAP=t.BROWSER_ALIASES_MAP=void 0,t.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},t.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},t.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},t.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},t.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var i,n=(i=r(91))&&i.__esModule?i:{default:i},o=r(18);function a(c,A){for(var l=0;l<A.length;l++){var d=A[l];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(c,d.key,d)}}var s=(function(){function c(){}var A,l,d;return c.getParser=function(g,u){if(u===void 0&&(u=!1),typeof g!="string")throw new Error("UserAgent should be a string");return new n.default(g,u)},c.parse=function(g){return new n.default(g).getResult()},A=c,d=[{key:"BROWSER_MAP",get:function(){return o.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return o.ENGINE_MAP}},{key:"OS_MAP",get:function(){return o.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return o.PLATFORMS_MAP}}],(l=null)&&a(A.prototype,l),d&&a(A,d),c})();t.default=s,e.exports=t.default},91:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var i=c(r(92)),n=c(r(93)),o=c(r(94)),a=c(r(95)),s=c(r(17));function c(l){return l&&l.__esModule?l:{default:l}}var A=(function(){function l(g,u){if(u===void 0&&(u=!1),g==null||g==="")throw new Error("UserAgent parameter can't be empty");this._ua=g,this.parsedResult={},u!==!0&&this.parse()}var d=l.prototype;return d.getUA=function(){return this._ua},d.test=function(g){return g.test(this._ua)},d.parseBrowser=function(){var g=this;this.parsedResult.browser={};var u=s.default.find(i.default,(function(I){if(typeof I.test=="function")return I.test(g);if(I.test instanceof Array)return I.test.some((function(C){return g.test(C)}));throw new Error("Browser's test function is not valid")}));return u&&(this.parsedResult.browser=u.describe(this.getUA())),this.parsedResult.browser},d.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},d.getBrowserName=function(g){return g?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},d.getBrowserVersion=function(){return this.getBrowser().version},d.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},d.parseOS=function(){var g=this;this.parsedResult.os={};var u=s.default.find(n.default,(function(I){if(typeof I.test=="function")return I.test(g);if(I.test instanceof Array)return I.test.some((function(C){return g.test(C)}));throw new Error("Browser's test function is not valid")}));return u&&(this.parsedResult.os=u.describe(this.getUA())),this.parsedResult.os},d.getOSName=function(g){var u=this.getOS().name;return g?String(u).toLowerCase()||"":u||""},d.getOSVersion=function(){return this.getOS().version},d.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},d.getPlatformType=function(g){g===void 0&&(g=!1);var u=this.getPlatform().type;return g?String(u).toLowerCase()||"":u||""},d.parsePlatform=function(){var g=this;this.parsedResult.platform={};var u=s.default.find(o.default,(function(I){if(typeof I.test=="function")return I.test(g);if(I.test instanceof Array)return I.test.some((function(C){return g.test(C)}));throw new Error("Browser's test function is not valid")}));return u&&(this.parsedResult.platform=u.describe(this.getUA())),this.parsedResult.platform},d.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},d.getEngineName=function(g){return g?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},d.parseEngine=function(){var g=this;this.parsedResult.engine={};var u=s.default.find(a.default,(function(I){if(typeof I.test=="function")return I.test(g);if(I.test instanceof Array)return I.test.some((function(C){return g.test(C)}));throw new Error("Browser's test function is not valid")}));return u&&(this.parsedResult.engine=u.describe(this.getUA())),this.parsedResult.engine},d.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},d.getResult=function(){return s.default.assign({},this.parsedResult)},d.satisfies=function(g){var u=this,I={},C=0,B={},h=0;if(Object.keys(g).forEach((function(J){var X=g[J];typeof X=="string"?(B[J]=X,h+=1):typeof X=="object"&&(I[J]=X,C+=1)})),C>0){var Q=Object.keys(I),D=s.default.find(Q,(function(J){return u.isOS(J)}));if(D){var E=this.satisfies(I[D]);if(E!==void 0)return E}var x=s.default.find(Q,(function(J){return u.isPlatform(J)}));if(x){var w=this.satisfies(I[x]);if(w!==void 0)return w}}if(h>0){var k=Object.keys(B),N=s.default.find(k,(function(J){return u.isBrowser(J,!0)}));if(N!==void 0)return this.compareVersion(B[N])}},d.isBrowser=function(g,u){u===void 0&&(u=!1);var I=this.getBrowserName().toLowerCase(),C=g.toLowerCase(),B=s.default.getBrowserTypeByAlias(C);return u&&B&&(C=B.toLowerCase()),C===I},d.compareVersion=function(g){var u=[0],I=g,C=!1,B=this.getBrowserVersion();if(typeof B=="string")return g[0]===">"||g[0]==="<"?(I=g.substr(1),g[1]==="="?(C=!0,I=g.substr(2)):u=[],g[0]===">"?u.push(1):u.push(-1)):g[0]==="="?I=g.substr(1):g[0]==="~"&&(C=!0,I=g.substr(1)),u.indexOf(s.default.compareVersions(B,I,C))>-1},d.isOS=function(g){return this.getOSName(!0)===String(g).toLowerCase()},d.isPlatform=function(g){return this.getPlatformType(!0)===String(g).toLowerCase()},d.isEngine=function(g){return this.getEngineName(!0)===String(g).toLowerCase()},d.is=function(g,u){return u===void 0&&(u=!1),this.isBrowser(g,u)||this.isOS(g)||this.isPlatform(g)},d.some=function(g){var u=this;return g===void 0&&(g=[]),g.some((function(I){return u.is(I)}))},l})();t.default=A,e.exports=t.default},92:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var i,n=(i=r(17))&&i.__esModule?i:{default:i},o=/version\/(\d+(\.?_?\d+)+)/i,a=[{test:[/googlebot/i],describe:function(s){var c={name:"Googlebot"},A=n.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,s)||n.default.getFirstMatch(o,s);return A&&(c.version=A),c}},{test:[/opera/i],describe:function(s){var c={name:"Opera"},A=n.default.getFirstMatch(o,s)||n.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,s);return A&&(c.version=A),c}},{test:[/opr\/|opios/i],describe:function(s){var c={name:"Opera"},A=n.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,s)||n.default.getFirstMatch(o,s);return A&&(c.version=A),c}},{test:[/SamsungBrowser/i],describe:function(s){var c={name:"Samsung Internet for Android"},A=n.default.getFirstMatch(o,s)||n.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,s);return A&&(c.version=A),c}},{test:[/Whale/i],describe:function(s){var c={name:"NAVER Whale Browser"},A=n.default.getFirstMatch(o,s)||n.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,s);return A&&(c.version=A),c}},{test:[/MZBrowser/i],describe:function(s){var c={name:"MZ Browser"},A=n.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,s)||n.default.getFirstMatch(o,s);return A&&(c.version=A),c}},{test:[/focus/i],describe:function(s){var c={name:"Focus"},A=n.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,s)||n.default.getFirstMatch(o,s);return A&&(c.version=A),c}},{test:[/swing/i],describe:function(s){var c={name:"Swing"},A=n.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,s)||n.default.getFirstMatch(o,s);return A&&(c.version=A),c}},{test:[/coast/i],describe:function(s){var c={name:"Opera Coast"},A=n.default.getFirstMatch(o,s)||n.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,s);return A&&(c.version=A),c}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(s){var c={name:"Opera Touch"},A=n.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,s)||n.default.getFirstMatch(o,s);return A&&(c.version=A),c}},{test:[/yabrowser/i],describe:function(s){var c={name:"Yandex Browser"},A=n.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,s)||n.default.getFirstMatch(o,s);return A&&(c.version=A),c}},{test:[/ucbrowser/i],describe:function(s){var c={name:"UC Browser"},A=n.default.getFirstMatch(o,s)||n.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,s);return A&&(c.version=A),c}},{test:[/Maxthon|mxios/i],describe:function(s){var c={name:"Maxthon"},A=n.default.getFirstMatch(o,s)||n.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,s);return A&&(c.version=A),c}},{test:[/epiphany/i],describe:function(s){var c={name:"Epiphany"},A=n.default.getFirstMatch(o,s)||n.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,s);return A&&(c.version=A),c}},{test:[/puffin/i],describe:function(s){var c={name:"Puffin"},A=n.default.getFirstMatch(o,s)||n.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,s);return A&&(c.version=A),c}},{test:[/sleipnir/i],describe:function(s){var c={name:"Sleipnir"},A=n.default.getFirstMatch(o,s)||n.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,s);return A&&(c.version=A),c}},{test:[/k-meleon/i],describe:function(s){var c={name:"K-Meleon"},A=n.default.getFirstMatch(o,s)||n.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,s);return A&&(c.version=A),c}},{test:[/micromessenger/i],describe:function(s){var c={name:"WeChat"},A=n.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,s)||n.default.getFirstMatch(o,s);return A&&(c.version=A),c}},{test:[/qqbrowser/i],describe:function(s){var c={name:/qqbrowserlite/i.test(s)?"QQ Browser Lite":"QQ Browser"},A=n.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,s)||n.default.getFirstMatch(o,s);return A&&(c.version=A),c}},{test:[/msie|trident/i],describe:function(s){var c={name:"Internet Explorer"},A=n.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,s);return A&&(c.version=A),c}},{test:[/\sedg\//i],describe:function(s){var c={name:"Microsoft Edge"},A=n.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,s);return A&&(c.version=A),c}},{test:[/edg([ea]|ios)/i],describe:function(s){var c={name:"Microsoft Edge"},A=n.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,s);return A&&(c.version=A),c}},{test:[/vivaldi/i],describe:function(s){var c={name:"Vivaldi"},A=n.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,s);return A&&(c.version=A),c}},{test:[/seamonkey/i],describe:function(s){var c={name:"SeaMonkey"},A=n.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,s);return A&&(c.version=A),c}},{test:[/sailfish/i],describe:function(s){var c={name:"Sailfish"},A=n.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,s);return A&&(c.version=A),c}},{test:[/silk/i],describe:function(s){var c={name:"Amazon Silk"},A=n.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,s);return A&&(c.version=A),c}},{test:[/phantom/i],describe:function(s){var c={name:"PhantomJS"},A=n.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,s);return A&&(c.version=A),c}},{test:[/slimerjs/i],describe:function(s){var c={name:"SlimerJS"},A=n.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,s);return A&&(c.version=A),c}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(s){var c={name:"BlackBerry"},A=n.default.getFirstMatch(o,s)||n.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,s);return A&&(c.version=A),c}},{test:[/(web|hpw)[o0]s/i],describe:function(s){var c={name:"WebOS Browser"},A=n.default.getFirstMatch(o,s)||n.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,s);return A&&(c.version=A),c}},{test:[/bada/i],describe:function(s){var c={name:"Bada"},A=n.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,s);return A&&(c.version=A),c}},{test:[/tizen/i],describe:function(s){var c={name:"Tizen"},A=n.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,s)||n.default.getFirstMatch(o,s);return A&&(c.version=A),c}},{test:[/qupzilla/i],describe:function(s){var c={name:"QupZilla"},A=n.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,s)||n.default.getFirstMatch(o,s);return A&&(c.version=A),c}},{test:[/firefox|iceweasel|fxios/i],describe:function(s){var c={name:"Firefox"},A=n.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,s);return A&&(c.version=A),c}},{test:[/electron/i],describe:function(s){var c={name:"Electron"},A=n.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,s);return A&&(c.version=A),c}},{test:[/MiuiBrowser/i],describe:function(s){var c={name:"Miui"},A=n.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,s);return A&&(c.version=A),c}},{test:[/chromium/i],describe:function(s){var c={name:"Chromium"},A=n.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,s)||n.default.getFirstMatch(o,s);return A&&(c.version=A),c}},{test:[/chrome|crios|crmo/i],describe:function(s){var c={name:"Chrome"},A=n.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,s);return A&&(c.version=A),c}},{test:[/GSA/i],describe:function(s){var c={name:"Google Search"},A=n.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,s);return A&&(c.version=A),c}},{test:function(s){var c=!s.test(/like android/i),A=s.test(/android/i);return c&&A},describe:function(s){var c={name:"Android Browser"},A=n.default.getFirstMatch(o,s);return A&&(c.version=A),c}},{test:[/playstation 4/i],describe:function(s){var c={name:"PlayStation 4"},A=n.default.getFirstMatch(o,s);return A&&(c.version=A),c}},{test:[/safari|applewebkit/i],describe:function(s){var c={name:"Safari"},A=n.default.getFirstMatch(o,s);return A&&(c.version=A),c}},{test:[/.*/i],describe:function(s){var c=s.search("\\(")!==-1?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:n.default.getFirstMatch(c,s),version:n.default.getSecondMatch(c,s)}}}];t.default=a,e.exports=t.default},93:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var i,n=(i=r(17))&&i.__esModule?i:{default:i},o=r(18),a=[{test:[/Roku\/DVP/],describe:function(s){var c=n.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,s);return{name:o.OS_MAP.Roku,version:c}}},{test:[/windows phone/i],describe:function(s){var c=n.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,s);return{name:o.OS_MAP.WindowsPhone,version:c}}},{test:[/windows /i],describe:function(s){var c=n.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,s),A=n.default.getWindowsVersionName(c);return{name:o.OS_MAP.Windows,version:c,versionName:A}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(s){var c={name:o.OS_MAP.iOS},A=n.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,s);return A&&(c.version=A),c}},{test:[/macintosh/i],describe:function(s){var c=n.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,s).replace(/[_\s]/g,"."),A=n.default.getMacOSVersionName(c),l={name:o.OS_MAP.MacOS,version:c};return A&&(l.versionName=A),l}},{test:[/(ipod|iphone|ipad)/i],describe:function(s){var c=n.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,s).replace(/[_\s]/g,".");return{name:o.OS_MAP.iOS,version:c}}},{test:function(s){var c=!s.test(/like android/i),A=s.test(/android/i);return c&&A},describe:function(s){var c=n.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,s),A=n.default.getAndroidVersionName(c),l={name:o.OS_MAP.Android,version:c};return A&&(l.versionName=A),l}},{test:[/(web|hpw)[o0]s/i],describe:function(s){var c=n.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,s),A={name:o.OS_MAP.WebOS};return c&&c.length&&(A.version=c),A}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(s){var c=n.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,s)||n.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,s)||n.default.getFirstMatch(/\bbb(\d+)/i,s);return{name:o.OS_MAP.BlackBerry,version:c}}},{test:[/bada/i],describe:function(s){var c=n.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,s);return{name:o.OS_MAP.Bada,version:c}}},{test:[/tizen/i],describe:function(s){var c=n.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,s);return{name:o.OS_MAP.Tizen,version:c}}},{test:[/linux/i],describe:function(){return{name:o.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:o.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(s){var c=n.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,s);return{name:o.OS_MAP.PlayStation4,version:c}}}];t.default=a,e.exports=t.default},94:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var i,n=(i=r(17))&&i.__esModule?i:{default:i},o=r(18),a=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(s){var c=n.default.getFirstMatch(/(can-l01)/i,s)&&"Nova",A={type:o.PLATFORMS_MAP.mobile,vendor:"Huawei"};return c&&(A.model=c),A}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(s){var c=s.test(/ipod|iphone/i),A=s.test(/like (ipod|iphone)/i);return c&&!A},describe:function(s){var c=n.default.getFirstMatch(/(ipod|iphone)/i,s);return{type:o.PLATFORMS_MAP.mobile,vendor:"Apple",model:c}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(s){return s.getBrowserName(!0)==="blackberry"},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(s){return s.getBrowserName(!0)==="bada"},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(s){return s.getBrowserName()==="windows phone"},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(s){var c=Number(String(s.getOSVersion()).split(".")[0]);return s.getOSName(!0)==="android"&&c>=3},describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(s){return s.getOSName(!0)==="android"},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(s){return s.getOSName(!0)==="macos"},describe:function(){return{type:o.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(s){return s.getOSName(!0)==="windows"},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(s){return s.getOSName(!0)==="linux"},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(s){return s.getOSName(!0)==="playstation 4"},describe:function(){return{type:o.PLATFORMS_MAP.tv}}},{test:function(s){return s.getOSName(!0)==="roku"},describe:function(){return{type:o.PLATFORMS_MAP.tv}}}];t.default=a,e.exports=t.default},95:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var i,n=(i=r(17))&&i.__esModule?i:{default:i},o=r(18),a=[{test:function(s){return s.getBrowserName(!0)==="microsoft edge"},describe:function(s){if(/\sedg\//i.test(s))return{name:o.ENGINE_MAP.Blink};var c=n.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,s);return{name:o.ENGINE_MAP.EdgeHTML,version:c}}},{test:[/trident/i],describe:function(s){var c={name:o.ENGINE_MAP.Trident},A=n.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,s);return A&&(c.version=A),c}},{test:function(s){return s.test(/presto/i)},describe:function(s){var c={name:o.ENGINE_MAP.Presto},A=n.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,s);return A&&(c.version=A),c}},{test:function(s){var c=s.test(/gecko/i),A=s.test(/like gecko/i);return c&&!A},describe:function(s){var c={name:o.ENGINE_MAP.Gecko},A=n.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,s);return A&&(c.version=A),c}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:o.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(s){var c={name:o.ENGINE_MAP.WebKit},A=n.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,s);return A&&(c.version=A),c}}];t.default=a,e.exports=t.default}})}))});var bD=m((nDe,wD)=>{"use strict";wD.exports=()=>{let e={};return e.promise=new Promise((t,r)=>{e.resolve=t,e.reject=r}),e}});var xD=m((oDe,SD)=>{"use strict";var e4=bD();function t4(e,t="maxAge"){let r,i,n,o=async()=>{if(r!==void 0)return;let c=async A=>{n=e4();let l=A[1][t]-Date.now();if(l<=0){e.delete(A[0]),n.resolve();return}return r=A[0],i=setTimeout(()=>{e.delete(A[0]),n&&n.resolve()},l),typeof i.unref=="function"&&i.unref(),n.promise};try{for(let A of e)await c(A)}catch{}r=void 0},a=()=>{r=void 0,i!==void 0&&(clearTimeout(i),i=void 0),n!==void 0&&(n.reject(void 0),n=void 0)},s=e.set.bind(e);return e.set=(c,A)=>{e.has(c)&&e.delete(c);let l=s(c,A);return r&&r===c&&a(),o(),l},o(),e}SD.exports=t4});var Ku=m((sDe,kD)=>{"use strict";var r4=xD(),Lu=class{constructor(t,r){if(this.maxAge=t,this[Symbol.toStringTag]="Map",this.data=new Map,r4(this.data),r)for(let[i,n]of r)this.set(i,n)}get size(){return this.data.size}clear(){this.data.clear()}delete(t){return this.data.delete(t)}has(t){return this.data.has(t)}get(t){let r=this.data.get(t);if(r)return r.data}set(t,r){return this.data.set(t,{maxAge:Date.now()+this.maxAge,data:r}),this}values(){return this.createIterator(t=>t[1].data)}keys(){return this.data.keys()}entries(){return this.createIterator(t=>[t[0],t[1].data])}forEach(t,r){for(let[i,n]of this.entries())t.apply(r,[n,i,this])}[Symbol.iterator](){return this.entries()}*createIterator(t){for(let r of this.data.entries())yield t(r)}};kD.exports=Lu});var kW=G(Np(),1),DW=G(Op(),1),vW=G(Kp(),1),FW=G(Vp(),1),RW=G(jp(),1),TW=G(lh(),1),_W=G(dh(),1),MW=G(vm(),1),NW=G(Nm(),1),PW=G(Um(),1),UW=G(_C(),1),MC=AbortSignal.any||function(t){let r=new AbortController;if(t.length===0)return r.signal;let i=t.find(o=>o.aborted);if(i)return r.abort(i.reason),r.signal;let n=function(){r.abort(this.reason)};for(let o of t)o.addEventListener("abort",n,{once:!0,signal:r.signal});return r.signal},NC=AbortSignal.timeout||function(t){let r=new AbortController;return setTimeout(()=>{r.abort(new DOMException("Timeout","TimeoutError"))},t),r.signal};var Me=G(Ae(),1);var Us=class{supportedKinds=["audioinput","audiooutput","videoinput"];constructor(){this.checkSupport=this.checkSupport.bind(this),this.getAllDevices=this.getAllDevices.bind(this)}checkSupport(){let t=!!(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices),r=!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia),i=!!(window.MediaStreamTrack&&window.MediaStreamTrack.getSources);return{modern:t,legacy:i,getUserMedia:r,supported:t||i}}async requestPermissions(t={audio:!0,video:!0}){try{if(!navigator.mediaDevices?.getUserMedia)throw new Error("getUserMedia is not supported");return await navigator.mediaDevices.getUserMedia(t)}catch(r){let i=r instanceof Error?r.message:"Unknown permission error";throw new Error(`Permission denied: ${i}`)}}normalizeDevice(t){return{deviceId:t.deviceId||t.id||"",groupId:t.groupId||"",kind:t.kind||"audioinput",label:t.label||`${t.kind||"Unknown"} Device`}}shouldFilterDevice(t){if(!t.deviceId||!this.supportedKinds.includes(t.kind))return!0;if(t.kind.includes("audio")){let r=t.label.toLowerCase();return r.startsWith("as")||r.includes("virtual")||r.includes("loopback")}return!1}categorizeDevices(t){let r={audioInputDevices:[],audioOutputDevices:[],videoInputDevices:[],allAudioDevices:[],allVideoDevices:[],allMediaDevices:[]},i=new Map;return t.forEach(n=>{let o=this.normalizeDevice(n);if(!this.shouldFilterDevice(o)&&!i.has(o.deviceId)){switch(i.set(o.deviceId,o),o.kind){case"audioinput":r.audioInputDevices.push(o),r.allAudioDevices.push(o);break;case"audiooutput":r.audioOutputDevices.push(o),r.allAudioDevices.push(o);break;case"videoinput":r.videoInputDevices.push(o),r.allVideoDevices.push(o);break}r.allMediaDevices.push(o)}}),r}getLegacyDevices(){return new Promise((t,r)=>{if(!window.MediaStreamTrack?.getSources){r(new Error("Legacy getSources API is not available"));return}try{window.MediaStreamTrack.getSources(i=>{t(i||[])})}catch(i){r(i)}})}async getAllDevices(t={}){let{requestPermission:r=!1,constraints:i={audio:!0,video:!0}}=t;try{let n=this.checkSupport();if(!n.supported)throw new Error("Device enumeration is not supported in this browser");let o=null,a=!1;if(r)try{o=await this.requestPermissions(i),a=!0}catch{}let s;try{if(n.modern)s=await navigator.mediaDevices.enumerateDevices();else if(n.legacy)s=await this.getLegacyDevices();else throw new Error("No supported device enumeration method available")}catch(l){throw o&&o.getTracks().forEach(d=>d.stop()),l}o&&o.getTracks().forEach(l=>l.stop());let c=this.categorizeDevices(s);return{...c,metadata:{total:c.allMediaDevices.length,hasAudioInput:c.audioInputDevices.length>0,hasAudioOutput:c.audioOutputDevices.length>0,hasVideoInput:c.videoInputDevices.length>0,permissionGranted:a,browserSupport:n}}}catch(n){let o=n instanceof Error?n.message:"Unknown error";throw new Error(`Failed to enumerate devices: ${o}`)}}async getDevicesByKind(t){if(!this.supportedKinds.includes(t))throw new Error(`Unsupported device kind: ${t}. Supported kinds: ${this.supportedKinds.join(", ")}`);let r=await this.getAllDevices();switch(t){case"audioinput":return r.audioInputDevices;case"audiooutput":return r.audioOutputDevices;case"videoinput":return r.videoInputDevices;default:return[]}}async getDefaultDevice(t){let r=await this.getDevicesByKind(t);return r.find(n=>n.deviceId==="default"||n.label.toLowerCase().includes("default"))||(r.length>0?r[0]:null)}async isDeviceAvailable(t){try{return(await this.getAllDevices()).allMediaDevices.some(i=>i.deviceId===t)}catch{return!1}}watchDeviceChange(t){if(!navigator.mediaDevices?.addEventListener)return()=>{};let r=async()=>{try{let i=await this.getAllDevices();t(i)}catch(i){let n=i instanceof Error?i:new Error("Unknown device change error");t(null,n)}};return navigator.mediaDevices.addEventListener("devicechange",r),()=>{navigator.mediaDevices.removeEventListener("devicechange",r)}}async getDeviceDetails(t){return(await this.getAllDevices({requestPermission:!0})).allMediaDevices.find(i=>i.deviceId===t)||null}};var OP=typeof global=="object"&&global&&global.Object===Object&&global,Os=OP;var qP=typeof self=="object"&&self&&self.Object===Object&&self,GP=Os||qP||Function("return this")(),ge=GP;var HP=ge.Symbol,$e=HP;var UC=Object.prototype,LP=UC.hasOwnProperty,KP=UC.toString,Yn=$e?$e.toStringTag:void 0;function JP(e){var t=LP.call(e,Yn),r=e[Yn];try{e[Yn]=void 0;var i=!0}catch{}var n=KP.call(e);return i&&(t?e[Yn]=r:delete e[Yn]),n}var OC=JP;var zP=Object.prototype,VP=zP.toString;function YP(e){return VP.call(e)}var qC=YP;var WP="[object Null]",jP="[object Undefined]",GC=$e?$e.toStringTag:void 0;function XP(e){return e==null?e===void 0?jP:WP:GC&&GC in Object(e)?OC(e):qC(e)}var et=XP;function ZP(e){return e!=null&&typeof e=="object"}var Ie=ZP;var $P="[object Symbol]";function eU(e){return typeof e=="symbol"||Ie(e)&&et(e)==$P}var Er=eU;function tU(e,t){for(var r=-1,i=e==null?0:e.length,n=Array(i);++r<i;)n[r]=t(e[r],r,e);return n}var qs=tU;var rU=Array.isArray,le=rU;var iU=1/0,HC=$e?$e.prototype:void 0,LC=HC?HC.toString:void 0;function KC(e){if(typeof e=="string")return e;if(le(e))return qs(e,KC)+"";if(Er(e))return LC?LC.call(e):"";var t=e+"";return t=="0"&&1/e==-iU?"-0":t}var JC=KC;var nU=/\s/;function oU(e){for(var t=e.length;t--&&nU.test(e.charAt(t)););return t}var zC=oU;var sU=/^\s+/;function aU(e){return e&&e.slice(0,zC(e)+1).replace(sU,"")}var VC=aU;function cU(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var ee=cU;var YC=NaN,AU=/^[-+]0x[0-9a-f]+$/i,lU=/^0b[01]+$/i,dU=/^0o[0-7]+$/i,gU=parseInt;function uU(e){if(typeof e=="number")return e;if(Er(e))return YC;if(ee(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=ee(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=VC(e);var r=lU.test(e);return r||dU.test(e)?gU(e.slice(2),r?2:8):AU.test(e)?YC:+e}var Zl=uU;function fU(e){return e}var Fi=fU;var IU="[object AsyncFunction]",pU="[object Function]",hU="[object GeneratorFunction]",mU="[object Proxy]";function CU(e){if(!ee(e))return!1;var t=et(e);return t==pU||t==hU||t==IU||t==mU}var Ri=CU;var BU=ge["__core-js_shared__"],Gs=BU;var WC=(function(){var e=/[^.]+$/.exec(Gs&&Gs.keys&&Gs.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""})();function yU(e){return!!WC&&WC in e}var jC=yU;var EU=Function.prototype,QU=EU.toString;function wU(e){if(e!=null){try{return QU.call(e)}catch{}try{return e+""}catch{}}return""}var rr=wU;var bU=/[\\^$.*+?()[\]{}|]/g,SU=/^\[object .+?Constructor\]$/,xU=Function.prototype,kU=Object.prototype,DU=xU.toString,vU=kU.hasOwnProperty,FU=RegExp("^"+DU.call(vU).replace(bU,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function RU(e){if(!ee(e)||jC(e))return!1;var t=Ri(e)?FU:SU;return t.test(rr(e))}var XC=RU;function TU(e,t){return e?.[t]}var ZC=TU;function _U(e,t){var r=ZC(e,t);return XC(r)?r:void 0}var at=_U;var MU=at(ge,"WeakMap"),Hs=MU;var $C=Object.create,NU=(function(){function e(){}return function(t){if(!ee(t))return{};if($C)return $C(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}})(),eB=NU;function PU(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var tB=PU;function UU(){}var Wn=UU;function OU(e,t){var r=-1,i=e.length;for(t||(t=Array(i));++r<i;)t[r]=e[r];return t}var Ls=OU;var qU=800,GU=16,HU=Date.now;function LU(e){var t=0,r=0;return function(){var i=HU(),n=GU-(i-r);if(r=i,n>0){if(++t>=qU)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var rB=LU;function KU(e){return function(){return e}}var iB=KU;var JU=(function(){try{var e=at(Object,"defineProperty");return e({},"",{}),e}catch{}})(),Ti=JU;var zU=Ti?function(e,t){return Ti(e,"toString",{configurable:!0,enumerable:!1,value:iB(t),writable:!0})}:Fi,nB=zU;var VU=rB(nB),oB=VU;function YU(e,t){for(var r=-1,i=e==null?0:e.length;++r<i&&t(e[r],r,e)!==!1;);return e}var sB=YU;var WU=9007199254740991,jU=/^(?:0|[1-9]\d*)$/;function XU(e,t){var r=typeof e;return t=t??WU,!!t&&(r=="number"||r!="symbol"&&jU.test(e))&&e>-1&&e%1==0&&e<t}var Qr=XU;function ZU(e,t,r){t=="__proto__"&&Ti?Ti(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var _i=ZU;function $U(e,t){return e===t||e!==e&&t!==t}var Ut=$U;var e3=Object.prototype,t3=e3.hasOwnProperty;function r3(e,t,r){var i=e[t];(!(t3.call(e,t)&&Ut(i,r))||r===void 0&&!(t in e))&&_i(e,t,r)}var Mi=r3;function i3(e,t,r,i){var n=!r;r||(r={});for(var o=-1,a=t.length;++o<a;){var s=t[o],c=i?i(r[s],e[s],s,r,e):void 0;c===void 0&&(c=e[s]),n?_i(r,s,c):Mi(r,s,c)}return r}var Ot=i3;var aB=Math.max;function n3(e,t,r){return t=aB(t===void 0?e.length-1:t,0),function(){for(var i=arguments,n=-1,o=aB(i.length-t,0),a=Array(o);++n<o;)a[n]=i[t+n];n=-1;for(var s=Array(t+1);++n<t;)s[n]=i[n];return s[t]=r(a),tB(e,this,s)}}var cB=n3;function o3(e,t){return oB(cB(e,t,Fi),e+"")}var AB=o3;var s3=9007199254740991;function a3(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=s3}var Ni=a3;function c3(e){return e!=null&&Ni(e.length)&&!Ri(e)}var qt=c3;function A3(e,t,r){if(!ee(r))return!1;var i=typeof t;return(i=="number"?qt(r)&&Qr(t,r.length):i=="string"&&t in r)?Ut(r[t],e):!1}var lB=A3;function l3(e){return AB(function(t,r){var i=-1,n=r.length,o=n>1?r[n-1]:void 0,a=n>2?r[2]:void 0;for(o=e.length>3&&typeof o=="function"?(n--,o):void 0,a&&lB(r[0],r[1],a)&&(o=n<3?void 0:o,n=1),t=Object(t);++i<n;){var s=r[i];s&&e(t,s,i,o)}return t})}var dB=l3;var d3=Object.prototype;function g3(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||d3;return e===r}var wr=g3;function u3(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}var gB=u3;var f3="[object Arguments]";function I3(e){return Ie(e)&&et(e)==f3}var $l=I3;var uB=Object.prototype,p3=uB.hasOwnProperty,h3=uB.propertyIsEnumerable,m3=$l((function(){return arguments})())?$l:function(e){return Ie(e)&&p3.call(e,"callee")&&!h3.call(e,"callee")},ir=m3;function C3(){return!1}var fB=C3;var hB=typeof exports=="object"&&exports&&!exports.nodeType&&exports,IB=hB&&typeof module=="object"&&module&&!module.nodeType&&module,B3=IB&&IB.exports===hB,pB=B3?ge.Buffer:void 0,y3=pB?pB.isBuffer:void 0,E3=y3||fB,xt=E3;var Q3="[object Arguments]",w3="[object Array]",b3="[object Boolean]",S3="[object Date]",x3="[object Error]",k3="[object Function]",D3="[object Map]",v3="[object Number]",F3="[object Object]",R3="[object RegExp]",T3="[object Set]",_3="[object String]",M3="[object WeakMap]",N3="[object ArrayBuffer]",P3="[object DataView]",U3="[object Float32Array]",O3="[object Float64Array]",q3="[object Int8Array]",G3="[object Int16Array]",H3="[object Int32Array]",L3="[object Uint8Array]",K3="[object Uint8ClampedArray]",J3="[object Uint16Array]",z3="[object Uint32Array]",ae={};ae[U3]=ae[O3]=ae[q3]=ae[G3]=ae[H3]=ae[L3]=ae[K3]=ae[J3]=ae[z3]=!0;ae[Q3]=ae[w3]=ae[N3]=ae[b3]=ae[P3]=ae[S3]=ae[x3]=ae[k3]=ae[D3]=ae[v3]=ae[F3]=ae[R3]=ae[T3]=ae[_3]=ae[M3]=!1;function V3(e){return Ie(e)&&Ni(e.length)&&!!ae[et(e)]}var mB=V3;function Y3(e){return function(t){return e(t)}}var Pi=Y3;var CB=typeof exports=="object"&&exports&&!exports.nodeType&&exports,jn=CB&&typeof module=="object"&&module&&!module.nodeType&&module,W3=jn&&jn.exports===CB,ed=W3&&Os.process,j3=(function(){try{var e=jn&&jn.require&&jn.require("util").types;return e||ed&&ed.binding&&ed.binding("util")}catch{}})(),nr=j3;var BB=nr&&nr.isTypedArray,X3=BB?Pi(BB):mB,br=X3;var Z3=Object.prototype,$3=Z3.hasOwnProperty;function eO(e,t){var r=le(e),i=!r&&ir(e),n=!r&&!i&&xt(e),o=!r&&!i&&!n&&br(e),a=r||i||n||o,s=a?gB(e.length,String):[],c=s.length;for(var A in e)(t||$3.call(e,A))&&!(a&&(A=="length"||n&&(A=="offset"||A=="parent")||o&&(A=="buffer"||A=="byteLength"||A=="byteOffset")||Qr(A,c)))&&s.push(A);return s}var Ks=eO;function tO(e,t){return function(r){return e(t(r))}}var Js=tO;var rO=Js(Object.keys,Object),yB=rO;var iO=Object.prototype,nO=iO.hasOwnProperty;function oO(e){if(!wr(e))return yB(e);var t=[];for(var r in Object(e))nO.call(e,r)&&r!="constructor"&&t.push(r);return t}var zs=oO;function sO(e){return qt(e)?Ks(e):zs(e)}var Sr=sO;function aO(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var EB=aO;var cO=Object.prototype,AO=cO.hasOwnProperty;function lO(e){if(!ee(e))return EB(e);var t=wr(e),r=[];for(var i in e)i=="constructor"&&(t||!AO.call(e,i))||r.push(i);return r}var QB=lO;function dO(e){return qt(e)?Ks(e,!0):QB(e)}var Gt=dO;var gO=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,uO=/^\w*$/;function fO(e,t){if(le(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||Er(e)?!0:uO.test(e)||!gO.test(e)||t!=null&&e in Object(t)}var Ui=fO;var IO=at(Object,"create"),or=IO;function pO(){this.__data__=or?or(null):{},this.size=0}var wB=pO;function hO(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var bB=hO;var mO="__lodash_hash_undefined__",CO=Object.prototype,BO=CO.hasOwnProperty;function yO(e){var t=this.__data__;if(or){var r=t[e];return r===mO?void 0:r}return BO.call(t,e)?t[e]:void 0}var SB=yO;var EO=Object.prototype,QO=EO.hasOwnProperty;function wO(e){var t=this.__data__;return or?t[e]!==void 0:QO.call(t,e)}var xB=wO;var bO="__lodash_hash_undefined__";function SO(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=or&&t===void 0?bO:t,this}var kB=SO;function Oi(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}Oi.prototype.clear=wB;Oi.prototype.delete=bB;Oi.prototype.get=SB;Oi.prototype.has=xB;Oi.prototype.set=kB;var td=Oi;function xO(){this.__data__=[],this.size=0}var DB=xO;function kO(e,t){for(var r=e.length;r--;)if(Ut(e[r][0],t))return r;return-1}var xr=kO;var DO=Array.prototype,vO=DO.splice;function FO(e){var t=this.__data__,r=xr(t,e);if(r<0)return!1;var i=t.length-1;return r==i?t.pop():vO.call(t,r,1),--this.size,!0}var vB=FO;function RO(e){var t=this.__data__,r=xr(t,e);return r<0?void 0:t[r][1]}var FB=RO;function TO(e){return xr(this.__data__,e)>-1}var RB=TO;function _O(e,t){var r=this.__data__,i=xr(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this}var TB=_O;function qi(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}qi.prototype.clear=DB;qi.prototype.delete=vB;qi.prototype.get=FB;qi.prototype.has=RB;qi.prototype.set=TB;var kr=qi;var MO=at(ge,"Map"),Dr=MO;function NO(){this.size=0,this.__data__={hash:new td,map:new(Dr||kr),string:new td}}var _B=NO;function PO(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var MB=PO;function UO(e,t){var r=e.__data__;return MB(t)?r[typeof t=="string"?"string":"hash"]:r.map}var vr=UO;function OO(e){var t=vr(this,e).delete(e);return this.size-=t?1:0,t}var NB=OO;function qO(e){return vr(this,e).get(e)}var PB=qO;function GO(e){return vr(this,e).has(e)}var UB=GO;function HO(e,t){var r=vr(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this}var OB=HO;function Gi(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}Gi.prototype.clear=_B;Gi.prototype.delete=NB;Gi.prototype.get=PB;Gi.prototype.has=UB;Gi.prototype.set=OB;var $r=Gi;var LO="Expected a function";function rd(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(LO);var r=function(){var i=arguments,n=t?t.apply(this,i):i[0],o=r.cache;if(o.has(n))return o.get(n);var a=e.apply(this,i);return r.cache=o.set(n,a)||o,a};return r.cache=new(rd.Cache||$r),r}rd.Cache=$r;var qB=rd;var KO=500;function JO(e){var t=qB(e,function(i){return r.size===KO&&r.clear(),i}),r=t.cache;return t}var GB=JO;var zO=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,VO=/\\(\\)?/g,YO=GB(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(zO,function(r,i,n,o){t.push(n?o.replace(VO,"$1"):i||r)}),t}),HB=YO;function WO(e){return e==null?"":JC(e)}var LB=WO;function jO(e,t){return le(e)?e:Ui(e,t)?[e]:HB(LB(e))}var Fr=jO;var XO=1/0;function ZO(e){if(typeof e=="string"||Er(e))return e;var t=e+"";return t=="0"&&1/e==-XO?"-0":t}var Ht=ZO;function $O(e,t){t=Fr(t,e);for(var r=0,i=t.length;e!=null&&r<i;)e=e[Ht(t[r++])];return r&&r==i?e:void 0}var Hi=$O;function eq(e,t,r){var i=e==null?void 0:Hi(e,t);return i===void 0?r:i}var KB=eq;function tq(e,t){for(var r=-1,i=t.length,n=e.length;++r<i;)e[n+r]=t[r];return e}var Vs=tq;var rq=Js(Object.getPrototypeOf,Object),Li=rq;var iq="[object Object]",nq=Function.prototype,oq=Object.prototype,JB=nq.toString,sq=oq.hasOwnProperty,aq=JB.call(Object);function cq(e){if(!Ie(e)||et(e)!=iq)return!1;var t=Li(e);if(t===null)return!0;var r=sq.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&JB.call(r)==aq}var Ki=cq;function Aq(){this.__data__=new kr,this.size=0}var zB=Aq;function lq(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var VB=lq;function dq(e){return this.__data__.get(e)}var YB=dq;function gq(e){return this.__data__.has(e)}var WB=gq;var uq=200;function fq(e,t){var r=this.__data__;if(r instanceof kr){var i=r.__data__;if(!Dr||i.length<uq-1)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new $r(i)}return r.set(e,t),this.size=r.size,this}var jB=fq;function Ji(e){var t=this.__data__=new kr(e);this.size=t.size}Ji.prototype.clear=zB;Ji.prototype.delete=VB;Ji.prototype.get=YB;Ji.prototype.has=WB;Ji.prototype.set=jB;var Lt=Ji;function Iq(e,t){return e&&Ot(t,Sr(t),e)}var XB=Iq;function pq(e,t){return e&&Ot(t,Gt(t),e)}var ZB=pq;var ry=typeof exports=="object"&&exports&&!exports.nodeType&&exports,$B=ry&&typeof module=="object"&&module&&!module.nodeType&&module,hq=$B&&$B.exports===ry,ey=hq?ge.Buffer:void 0,ty=ey?ey.allocUnsafe:void 0;function mq(e,t){if(t)return e.slice();var r=e.length,i=ty?ty(r):new e.constructor(r);return e.copy(i),i}var Ys=mq;function Cq(e,t){for(var r=-1,i=e==null?0:e.length,n=0,o=[];++r<i;){var a=e[r];t(a,r,e)&&(o[n++]=a)}return o}var iy=Cq;function Bq(){return[]}var Ws=Bq;var yq=Object.prototype,Eq=yq.propertyIsEnumerable,ny=Object.getOwnPropertySymbols,Qq=ny?function(e){return e==null?[]:(e=Object(e),iy(ny(e),function(t){return Eq.call(e,t)}))}:Ws,zi=Qq;function wq(e,t){return Ot(e,zi(e),t)}var oy=wq;var bq=Object.getOwnPropertySymbols,Sq=bq?function(e){for(var t=[];e;)Vs(t,zi(e)),e=Li(e);return t}:Ws,js=Sq;function xq(e,t){return Ot(e,js(e),t)}var sy=xq;function kq(e,t,r){var i=t(e);return le(e)?i:Vs(i,r(e))}var Xs=kq;function Dq(e){return Xs(e,Sr,zi)}var Xn=Dq;function vq(e){return Xs(e,Gt,js)}var Zs=vq;var Fq=at(ge,"DataView"),$s=Fq;var Rq=at(ge,"Promise"),ea=Rq;var Tq=at(ge,"Set"),ta=Tq;var ay="[object Map]",_q="[object Object]",cy="[object Promise]",Ay="[object Set]",ly="[object WeakMap]",dy="[object DataView]",Mq=rr($s),Nq=rr(Dr),Pq=rr(ea),Uq=rr(ta),Oq=rr(Hs),ei=et;($s&&ei(new $s(new ArrayBuffer(1)))!=dy||Dr&&ei(new Dr)!=ay||ea&&ei(ea.resolve())!=cy||ta&&ei(new ta)!=Ay||Hs&&ei(new Hs)!=ly)&&(ei=function(e){var t=et(e),r=t==_q?e.constructor:void 0,i=r?rr(r):"";if(i)switch(i){case Mq:return dy;case Nq:return ay;case Pq:return cy;case Uq:return Ay;case Oq:return ly}return t});var kt=ei;var qq=Object.prototype,Gq=qq.hasOwnProperty;function Hq(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&Gq.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var gy=Hq;var Lq=ge.Uint8Array,Vi=Lq;function Kq(e){var t=new e.constructor(e.byteLength);return new Vi(t).set(new Vi(e)),t}var Yi=Kq;function Jq(e,t){var r=t?Yi(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var uy=Jq;var zq=/\w*$/;function Vq(e){var t=new e.constructor(e.source,zq.exec(e));return t.lastIndex=e.lastIndex,t}var fy=Vq;var Iy=$e?$e.prototype:void 0,py=Iy?Iy.valueOf:void 0;function Yq(e){return py?Object(py.call(e)):{}}var hy=Yq;function Wq(e,t){var r=t?Yi(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var ra=Wq;var jq="[object Boolean]",Xq="[object Date]",Zq="[object Map]",$q="[object Number]",eG="[object RegExp]",tG="[object Set]",rG="[object String]",iG="[object Symbol]",nG="[object ArrayBuffer]",oG="[object DataView]",sG="[object Float32Array]",aG="[object Float64Array]",cG="[object Int8Array]",AG="[object Int16Array]",lG="[object Int32Array]",dG="[object Uint8Array]",gG="[object Uint8ClampedArray]",uG="[object Uint16Array]",fG="[object Uint32Array]";function IG(e,t,r){var i=e.constructor;switch(t){case nG:return Yi(e);case jq:case Xq:return new i(+e);case oG:return uy(e,r);case sG:case aG:case cG:case AG:case lG:case dG:case gG:case uG:case fG:return ra(e,r);case Zq:return new i;case $q:case rG:return new i(e);case eG:return fy(e);case tG:return new i;case iG:return hy(e)}}var my=IG;function pG(e){return typeof e.constructor=="function"&&!wr(e)?eB(Li(e)):{}}var ia=pG;var hG="[object Map]";function mG(e){return Ie(e)&&kt(e)==hG}var Cy=mG;var By=nr&&nr.isMap,CG=By?Pi(By):Cy,yy=CG;var BG="[object Set]";function yG(e){return Ie(e)&&kt(e)==BG}var Ey=yG;var Qy=nr&&nr.isSet,EG=Qy?Pi(Qy):Ey,wy=EG;var QG=1,wG=2,bG=4,by="[object Arguments]",SG="[object Array]",xG="[object Boolean]",kG="[object Date]",DG="[object Error]",Sy="[object Function]",vG="[object GeneratorFunction]",FG="[object Map]",RG="[object Number]",xy="[object Object]",TG="[object RegExp]",_G="[object Set]",MG="[object String]",NG="[object Symbol]",PG="[object WeakMap]",UG="[object ArrayBuffer]",OG="[object DataView]",qG="[object Float32Array]",GG="[object Float64Array]",HG="[object Int8Array]",LG="[object Int16Array]",KG="[object Int32Array]",JG="[object Uint8Array]",zG="[object Uint8ClampedArray]",VG="[object Uint16Array]",YG="[object Uint32Array]",te={};te[by]=te[SG]=te[UG]=te[OG]=te[xG]=te[kG]=te[qG]=te[GG]=te[HG]=te[LG]=te[KG]=te[FG]=te[RG]=te[xy]=te[TG]=te[_G]=te[MG]=te[NG]=te[JG]=te[zG]=te[VG]=te[YG]=!0;te[DG]=te[Sy]=te[PG]=!1;function na(e,t,r,i,n,o){var a,s=t&QG,c=t&wG,A=t&bG;if(r&&(a=n?r(e,i,n,o):r(e)),a!==void 0)return a;if(!ee(e))return e;var l=le(e);if(l){if(a=gy(e),!s)return Ls(e,a)}else{var d=kt(e),g=d==Sy||d==vG;if(xt(e))return Ys(e,s);if(d==xy||d==by||g&&!n){if(a=c||g?{}:ia(e),!s)return c?sy(e,ZB(a,e)):oy(e,XB(a,e))}else{if(!te[d])return n?e:{};a=my(e,d,s)}}o||(o=new Lt);var u=o.get(e);if(u)return u;o.set(e,a),wy(e)?e.forEach(function(B){a.add(na(B,t,r,B,e,o))}):yy(e)&&e.forEach(function(B,h){a.set(h,na(B,t,r,h,e,o))});var I=A?c?Zs:Xn:c?Gt:Sr,C=l?void 0:I(e);return sB(C||e,function(B,h){C&&(h=B,B=e[h]),Mi(a,h,na(B,t,r,h,e,o))}),a}var ky=na;var WG=4;function jG(e){return ky(e,WG)}var id=jG;var XG="__lodash_hash_undefined__";function ZG(e){return this.__data__.set(e,XG),this}var Dy=ZG;function $G(e){return this.__data__.has(e)}var vy=$G;function oa(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new $r;++t<r;)this.add(e[t])}oa.prototype.add=oa.prototype.push=Dy;oa.prototype.has=vy;var Fy=oa;function eH(e,t){for(var r=-1,i=e==null?0:e.length;++r<i;)if(t(e[r],r,e))return!0;return!1}var Ry=eH;function tH(e,t){return e.has(t)}var Ty=tH;var rH=1,iH=2;function nH(e,t,r,i,n,o){var a=r&rH,s=e.length,c=t.length;if(s!=c&&!(a&&c>s))return!1;var A=o.get(e),l=o.get(t);if(A&&l)return A==t&&l==e;var d=-1,g=!0,u=r&iH?new Fy:void 0;for(o.set(e,t),o.set(t,e);++d<s;){var I=e[d],C=t[d];if(i)var B=a?i(C,I,d,t,e,o):i(I,C,d,e,t,o);if(B!==void 0){if(B)continue;g=!1;break}if(u){if(!Ry(t,function(h,Q){if(!Ty(u,Q)&&(I===h||n(I,h,r,i,o)))return u.push(Q)})){g=!1;break}}else if(!(I===C||n(I,C,r,i,o))){g=!1;break}}return o.delete(e),o.delete(t),g}var sa=nH;function oH(e){var t=-1,r=Array(e.size);return e.forEach(function(i,n){r[++t]=[n,i]}),r}var _y=oH;function sH(e){var t=-1,r=Array(e.size);return e.forEach(function(i){r[++t]=i}),r}var My=sH;var aH=1,cH=2,AH="[object Boolean]",lH="[object Date]",dH="[object Error]",gH="[object Map]",uH="[object Number]",fH="[object RegExp]",IH="[object Set]",pH="[object String]",hH="[object Symbol]",mH="[object ArrayBuffer]",CH="[object DataView]",Ny=$e?$e.prototype:void 0,nd=Ny?Ny.valueOf:void 0;function BH(e,t,r,i,n,o,a){switch(r){case CH:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case mH:return!(e.byteLength!=t.byteLength||!o(new Vi(e),new Vi(t)));case AH:case lH:case uH:return Ut(+e,+t);case dH:return e.name==t.name&&e.message==t.message;case fH:case pH:return e==t+"";case gH:var s=_y;case IH:var c=i&aH;if(s||(s=My),e.size!=t.size&&!c)return!1;var A=a.get(e);if(A)return A==t;i|=cH,a.set(e,t);var l=sa(s(e),s(t),i,n,o,a);return a.delete(e),l;case hH:if(nd)return nd.call(e)==nd.call(t)}return!1}var Py=BH;var yH=1,EH=Object.prototype,QH=EH.hasOwnProperty;function wH(e,t,r,i,n,o){var a=r&yH,s=Xn(e),c=s.length,A=Xn(t),l=A.length;if(c!=l&&!a)return!1;for(var d=c;d--;){var g=s[d];if(!(a?g in t:QH.call(t,g)))return!1}var u=o.get(e),I=o.get(t);if(u&&I)return u==t&&I==e;var C=!0;o.set(e,t),o.set(t,e);for(var B=a;++d<c;){g=s[d];var h=e[g],Q=t[g];if(i)var D=a?i(Q,h,g,t,e,o):i(h,Q,g,e,t,o);if(!(D===void 0?h===Q||n(h,Q,r,i,o):D)){C=!1;break}B||(B=g=="constructor")}if(C&&!B){var E=e.constructor,x=t.constructor;E!=x&&"constructor"in e&&"constructor"in t&&!(typeof E=="function"&&E instanceof E&&typeof x=="function"&&x instanceof x)&&(C=!1)}return o.delete(e),o.delete(t),C}var Uy=wH;var bH=1,Oy="[object Arguments]",qy="[object Array]",aa="[object Object]",SH=Object.prototype,Gy=SH.hasOwnProperty;function xH(e,t,r,i,n,o){var a=le(e),s=le(t),c=a?qy:kt(e),A=s?qy:kt(t);c=c==Oy?aa:c,A=A==Oy?aa:A;var l=c==aa,d=A==aa,g=c==A;if(g&&xt(e)){if(!xt(t))return!1;a=!0,l=!1}if(g&&!l)return o||(o=new Lt),a||br(e)?sa(e,t,r,i,n,o):Py(e,t,c,r,i,n,o);if(!(r&bH)){var u=l&&Gy.call(e,"__wrapped__"),I=d&&Gy.call(t,"__wrapped__");if(u||I){var C=u?e.value():e,B=I?t.value():t;return o||(o=new Lt),n(C,B,r,i,o)}}return g?(o||(o=new Lt),Uy(e,t,r,i,n,o)):!1}var Hy=xH;function Ly(e,t,r,i,n){return e===t?!0:e==null||t==null||!Ie(e)&&!Ie(t)?e!==e&&t!==t:Hy(e,t,r,i,Ly,n)}var ca=Ly;var kH=1,DH=2;function vH(e,t,r,i){var n=r.length,o=n,a=!i;if(e==null)return!o;for(e=Object(e);n--;){var s=r[n];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++n<o;){s=r[n];var c=s[0],A=e[c],l=s[1];if(a&&s[2]){if(A===void 0&&!(c in e))return!1}else{var d=new Lt;if(i)var g=i(A,l,c,e,t,d);if(!(g===void 0?ca(l,A,kH|DH,i,d):g))return!1}}return!0}var Ky=vH;function FH(e){return e===e&&!ee(e)}var Aa=FH;function RH(e){for(var t=Sr(e),r=t.length;r--;){var i=t[r],n=e[i];t[r]=[i,n,Aa(n)]}return t}var Jy=RH;function TH(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var la=TH;function _H(e){var t=Jy(e);return t.length==1&&t[0][2]?la(t[0][0],t[0][1]):function(r){return r===e||Ky(r,e,t)}}var zy=_H;function MH(e,t){return e!=null&&t in Object(e)}var Vy=MH;function NH(e,t,r){t=Fr(t,e);for(var i=-1,n=t.length,o=!1;++i<n;){var a=Ht(t[i]);if(!(o=e!=null&&r(e,a)))break;e=e[a]}return o||++i!=n?o:(n=e==null?0:e.length,!!n&&Ni(n)&&Qr(a,n)&&(le(e)||ir(e)))}var Yy=NH;function PH(e,t){return e!=null&&Yy(e,t,Vy)}var Wy=PH;var UH=1,OH=2;function qH(e,t){return Ui(e)&&Aa(t)?la(Ht(e),t):function(r){var i=KB(r,e);return i===void 0&&i===t?Wy(r,e):ca(t,i,UH|OH)}}var jy=qH;function GH(e){return function(t){return t?.[e]}}var Xy=GH;function HH(e){return function(t){return Hi(t,e)}}var Zy=HH;function LH(e){return Ui(e)?Xy(Ht(e)):Zy(e)}var $y=LH;function KH(e){return typeof e=="function"?e:e==null?Fi:typeof e=="object"?le(e)?jy(e[0],e[1]):zy(e):$y(e)}var eE=KH;function JH(e){return function(t,r,i){for(var n=-1,o=Object(t),a=i(t),s=a.length;s--;){var c=a[e?s:++n];if(r(o[c],c,o)===!1)break}return t}}var tE=JH;var zH=tE(),rE=zH;var VH=function(){return ge.Date.now()},da=VH;var YH="Expected a function",WH=Math.max,jH=Math.min;function XH(e,t,r){var i,n,o,a,s,c,A=0,l=!1,d=!1,g=!0;if(typeof e!="function")throw new TypeError(YH);t=Zl(t)||0,ee(r)&&(l=!!r.leading,d="maxWait"in r,o=d?WH(Zl(r.maxWait)||0,t):o,g="trailing"in r?!!r.trailing:g);function u(w){var k=i,N=n;return i=n=void 0,A=w,a=e.apply(N,k),a}function I(w){return A=w,s=setTimeout(h,t),l?u(w):a}function C(w){var k=w-c,N=w-A,J=t-k;return d?jH(J,o-N):J}function B(w){var k=w-c,N=w-A;return c===void 0||k>=t||k<0||d&&N>=o}function h(){var w=da();if(B(w))return Q(w);s=setTimeout(h,C(w))}function Q(w){return s=void 0,g&&i?u(w):(i=n=void 0,a)}function D(){s!==void 0&&clearTimeout(s),A=0,i=c=n=s=void 0}function E(){return s===void 0?a:Q(da())}function x(){var w=da(),k=B(w);if(i=arguments,n=this,c=w,k){if(s===void 0)return I(c);if(d)return clearTimeout(s),s=setTimeout(h,t),u(c)}return s===void 0&&(s=setTimeout(h,t)),a}return x.cancel=D,x.flush=E,x}var Zn=XH;function ZH(e,t,r){(r!==void 0&&!Ut(e[t],r)||r===void 0&&!(t in e))&&_i(e,t,r)}var $n=ZH;function $H(e){return Ie(e)&&qt(e)}var iE=$H;function eL(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var eo=eL;function tL(e){return Ot(e,Gt(e))}var nE=tL;function rL(e,t,r,i,n,o,a){var s=eo(e,r),c=eo(t,r),A=a.get(c);if(A){$n(e,r,A);return}var l=o?o(s,c,r+"",e,t,a):void 0,d=l===void 0;if(d){var g=le(c),u=!g&&xt(c),I=!g&&!u&&br(c);l=c,g||u||I?le(s)?l=s:iE(s)?l=Ls(s):u?(d=!1,l=Ys(c,!0)):I?(d=!1,l=ra(c,!0)):l=[]:Ki(c)||ir(c)?(l=s,ir(s)?l=nE(s):(!ee(s)||Ri(s))&&(l=ia(c))):d=!1}d&&(a.set(c,l),n(l,c,i,o,a),a.delete(c)),$n(e,r,l)}var oE=rL;function sE(e,t,r,i,n){e!==t&&rE(t,function(o,a){if(n||(n=new Lt),ee(o))oE(e,t,a,r,sE,i,n);else{var s=i?i(eo(e,a),o,a+"",e,t,n):void 0;s===void 0&&(s=o),$n(e,a,s)}},Gt)}var aE=sE;var iL=dB(function(e,t,r,i){aE(e,t,r,i)}),od=iL;var nL="[object Boolean]";function oL(e){return e===!0||e===!1||Ie(e)&&et(e)==nL}var sd=oL;var sL="[object Map]",aL="[object Set]",cL=Object.prototype,AL=cL.hasOwnProperty;function lL(e){if(e==null)return!0;if(qt(e)&&(le(e)||typeof e=="string"||typeof e.splice=="function"||xt(e)||br(e)||ir(e)))return!e.length;var t=kt(e);if(t==sL||t==aL)return!e.size;if(wr(e))return!zs(e).length;for(var r in e)if(AL.call(e,r))return!1;return!0}var ad=lL;function dL(e,t,r,i){if(!ee(e))return e;t=Fr(t,e);for(var n=-1,o=t.length,a=o-1,s=e;s!=null&&++n<o;){var c=Ht(t[n]),A=r;if(c==="__proto__"||c==="constructor"||c==="prototype")return e;if(n!=a){var l=s[c];A=i?i(l,c,s):void 0,A===void 0&&(A=ee(l)?l:Qr(t[n+1])?[]:{})}Mi(s,c,A),s=s[c]}return e}var cE=dL;function gL(e,t,r){for(var i=-1,n=t.length,o={};++i<n;){var a=t[i],s=Hi(e,a);r(s,a)&&cE(o,Fr(a,e),s)}return o}var AE=gL;function uL(e,t){if(e==null)return{};var r=qs(Zs(e),function(i){return[i]});return t=eE(t),AE(e,r,function(i,n){return t(i,n[0])})}var cd=uL;var re=G(Ae(),1);var dE=G(Ae(),1),to=(()=>{try{let e=dE.default.runtime.getManifest();return e.version_name===e.version+"-e"}catch{return navigator.userAgent.includes("Edg/")}})();var gE=`ChitChat_${to?"Edge":"Chrome"}_Ext`,Kt="5.21.0";var uE={name:"Robot",avatar:"",gender:"unknown",platform:"system",requireVIP:!1};var fL={dev:"",test:"",preview:"https://preview.sider.ai",prod:"https://sider.ai"},IL={dev:"",test:"",preview:"sider.ai",prod:"sider.ai"},lE=fL.prod,He={origin:lE,api:`${lE}/api`,domain:IL.prod},fE="https://www.google-analytics.com/mp/collect",IE="G-0PRFKME4HP";var pE="6FX_tIISST2SsnSx29yQRg";var hE="provider:siderApi",xte=`${hE}:SelectedModels`;var Ad={login:`${He.origin}/login`,openaiChat:"https://chatgpt.com",openaiLogin:"https://platform.openai.com/login",openaiSignup:"https://platform.openai.com/signup",openaiApiKey:"https://platform.openai.com/account/api-keys",openaiApiSession:"https://chatgpt.com/api/auth/session",edgeStore:"https://microsoftedge.microsoft.com/addons/detail/sider-ai-sidebar/dhoenijjpgpeimemopealfcbiecgceod",chromeStore:"https://chromewebstore.google.com/detail/sider-chatgpt-sidebar-+-v/difoiogjjojoaoomphldepapgpbgkhkb",chromeStoreReview:"https://chromewebstore.google.com/detail/sider-chatgpt-sidebar-+-v/difoiogjjojoaoomphldepapgpbgkhkb/reviews",weChatQrCode:"https://sider.ai/resource/weixin/qrcode.jpeg",producthuntPromoteApi:"https://sider.ai/resource/promotion/extension-promote.json",promoteConfigApi:"https://sider.ai/resource/promotion/promote-config.json"};var kte=1024*1024*10,Dte=1024*1024*100;var mE=[{name:"artifacts",isExperimental:!1,isPro:!0,autoOn:!0},{name:"search",isExperimental:!1,isPro:!0,autoOn:!0},{name:"create_image",isExperimental:!1,isPro:!0,autoOn:!0},{name:"data_analysis",isExperimental:!1,isPro:!0,autoOn:!0},{name:"thinking_mode",isExperimental:!1,isPro:!0,autoOn:!1}];var CL=G(CE(),1);var BL=G(Ae(),1);var pL=G(Ae(),1);var hL=Object.hasOwn;var mL=Array.isArray;function ld(e){return[...new Set(e)]}function ro(...e){return e.join("/").replace(/([^:])\/{2,}/g,"$1/")}function ti(e=1e3,t){return new Promise((r,i)=>{let n=setTimeout(r,e);t&&t.addEventListener("abort",()=>{clearTimeout(n),i(new DOMException("Aborted","AbortError"))},{once:!0})})}function dd(e){return e!=null}async function Wi(e,t=1e3,r=2){let i=0;for(;;){try{return await e()}catch(n){if(r>=0&&i++>=r)throw n}await ti(t)}}function ji(e,t=0){let r=!1,i;return function(...n){return r||(r=!0,i=new Promise((o,a)=>{e(...n).then(o).catch(a).finally(async()=>{t&&await ti(t),r=!1})})),i}}function ua(e){return new Promise((t,r)=>{let i=new FileReader;i.readAsDataURL(e),i.onload=()=>{t(i.result)},i.onerror=r})}var EL=G(Ae(),1);var gd="crop-area-select",yL=`${gd}-done`,jte=`${gd}-close`;function wL(e){return re.default.storage.local.get(e)}var ye=re.default.storage?wL:e=>re.default.runtime.sendMessage({type:"GET_STORAGE_LOCAL",data:e});function bL(e){return re.default.storage.local.set(e)}var H=re.default.storage?bL:e=>re.default.runtime.sendMessage({type:"SET_STORAGE_LOCAL",data:e});async function SL(e){return re.default.storage.local.remove(e)}var gt=re.default.storage?SL:e=>re.default.runtime.sendMessage({type:"REMOVE_STORAGE_LOCAL",data:e});async function ud(e){if(re.default.cookies){let t=await re.default.cookies.get(e);return t?.value?decodeURIComponent(t.value):""}return re.default.runtime.sendMessage({type:"GET_COOKIE",data:e})}async function BE(e){return re.default?.cookies?await re.default.cookies.set(e):re.default.runtime.sendMessage({type:"SET_COOKIE",data:e})}function yE(e){return ud({name:e,url:He.origin})}function fd(e){return re.default.tabs?re.default.tabs.create(e):re.default.runtime.sendMessage({type:"OPEN_URL_IN_NEW_TAB",details:e})}function EE(e,t,r={}){let i=r.signal;if(i?.aborted)return Wn;e.addListener(t);let n=()=>e.removeListener(t);return i?(i.addEventListener("abort",n,{once:!0}),()=>{n(),i.removeEventListener("abort",n)}):n}async function QE(){let[e]=await re.default.tabs.query({active:!0,currentWindow:!0});if(!e||e.id===void 0)throw new Error("No active tab");return e.id}function wE(){try{let t=re.default.runtime.getManifest().side_panel.default_path,r=new URL(re.default.runtime.getURL(t)),i=new URL(window.location.href);return i.pathname===r.pathname&&i.origin===r.origin}catch{return!1}}function bE(){if(!("serviceWorker"in navigator)&&!re.default.extension.getViews)return!0;try{return browser.runtime.getManifest().background.scripts.some(t=>{let r=new URL(re.default.runtime.getURL(t));return location.pathname===r.pathname&&location.origin===r.origin})}catch{return!1}}async function Id(e,t){let{fileTextStatus:r}=await re.default.storage.local.get({fileTextStatus:{}});return e.forEach(i=>{r[i]=t}),re.default.storage.local.set({fileTextStatus:r})}var xL={zh_CN:"zh-Hans",zh_TW:"zh-Hant","zh-CN":"zh-Hans","zh-TW":"zh-Hant"};function SE(e){return(xL[e]??e).replaceAll("_","-")}var kL=[Error,EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError,AggregateError,globalThis.DOMException,globalThis.AssertionError,globalThis.SystemError].filter(Boolean).map(e=>[e.name,e]),xE=new Map(kL);var DL=[{property:"name",enumerable:!1},{property:"message",enumerable:!1},{property:"stack",enumerable:!1},{property:"code",enumerable:!0},{property:"cause",enumerable:!1},{property:"errors",enumerable:!1}],pd=new WeakSet,vL=e=>{pd.add(e);let t=e.toJSON();return pd.delete(e),t},FL=e=>{let t=xE.get(e)??Error;return t===AggregateError?new t([]):new t},DE=({from:e,seen:t,to:r,forceEnumerable:i,maxDepth:n,depth:o,useToJSON:a,serialize:s})=>{if(r||(Array.isArray(e)?r=[]:!s&&kE(e)?r=FL(e.name):r={}),t.push(e),o>=n)return r;if(a&&typeof e.toJSON=="function"&&!pd.has(e))return vL(e);let c=A=>DE({from:A,seen:[...t],forceEnumerable:i,maxDepth:n,depth:o,useToJSON:a,serialize:s});for(let[A,l]of Object.entries(e)){if(l&&l instanceof Uint8Array&&l.constructor.name==="Buffer"){r[A]="[object Buffer]";continue}if(l!==null&&typeof l=="object"&&typeof l.pipe=="function"){r[A]="[object Stream]";continue}if(typeof l!="function"){if(!l||typeof l!="object"){try{r[A]=l}catch{}continue}if(!t.includes(e[A])){o++,r[A]=c(e[A]);continue}r[A]="[Circular]"}}if(s||r instanceof Error)for(let{property:A,enumerable:l}of DL)e[A]!==void 0&&e[A]!==null&&Object.defineProperty(r,A,{value:kE(e[A])||Array.isArray(e[A])?c(e[A]):e[A],enumerable:i?!0:l,configurable:!0,writable:!0});return r};function vE(e,t={}){let{maxDepth:r=Number.POSITIVE_INFINITY,useToJSON:i=!0}=t;return typeof e=="object"&&e!==null?DE({from:e,seen:[],forceEnumerable:!0,maxDepth:r,depth:0,useToJSON:i,serialize:!0}):typeof e=="function"?`[Function: ${e.name||"anonymous"}]`:e}function kE(e){return!!e&&typeof e=="object"&&typeof e.name=="string"&&typeof e.message=="string"&&typeof e.stack=="string"}var RE=G(Ae(),1);var RL="__webext_forward_tabs_message__",fa=new Map,TL=bE(),_L=wE();function hd(e,t){if(TL){let n=ML(e,t);if(n)return n}if(e.view==="sidebar"&&!_L)return;let r=e.type,i=fa.get(r);if(i)return Promise.try(i,{sender:t,data:e.data,id:r,originalSender:e.sender}).then(n=>({data:n})).catch(n=>({error:vE(n)}))}function ML(e,t){if(e.type===RL)return new Promise(async(r,i)=>{let{tabId:n,frameId:o,type:a,data:s,view:c}=e.data,A;try{A=n==="sender"?t.tab.id:n==="active"?await QE():n}catch(d){return i(d)}let l=o==="sender"?t.frameId:o;r(RE.default.tabs.sendMessage(A,{type:a,data:s,sender:t,view:c},l===void 0?void 0:{frameId:l}))})}function FE(e,t,r={}){let i=r.signal;if(i?.aborted)return Wn;if(fa.get(e))throw new Error(`Message ID "${e}" already has a listener.`);fa.set(e,t);let o=()=>fa.delete(e);return i?(i.addEventListener("abort",o,{once:!0}),()=>{o(),i.removeEventListener("abort",o)}):o}var md=new Proxy(FE,{get:(e,t)=>FE.bind(null,t)});function Xi(e,t,r,i){function n(o){return o instanceof r?o:new r(function(a){a(o)})}return new(r||(r=Promise))(function(o,a){function s(l){try{A(i.next(l))}catch(d){a(d)}}function c(l){try{A(i.throw(l))}catch(d){a(d)}}function A(l){l.done?o(l.value):n(l.value).then(s,c)}A((i=i.apply(e,t||[])).next())})}function Zi(e,t){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},i,n,o,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(A){return function(l){return c([A,l])}}function c(A){if(i)throw new TypeError("Generator is already executing.");for(;a&&(a=0,A[0]&&(r=0)),r;)try{if(i=1,n&&(o=A[0]&2?n.return:A[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,A[1])).done)return o;switch(n=0,o&&(A=[A[0]&2,o.value]),A[0]){case 0:case 1:o=A;break;case 4:return r.label++,{value:A[1],done:!1};case 5:r.label++,n=A[1],A=[0];continue;case 7:A=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(A[0]===6||A[0]===2)){r=0;continue}if(A[0]===3&&(!o||A[1]>o[0]&&A[1]<o[3])){r.label=A[1];break}if(A[0]===6&&r.label<o[1]){r.label=o[1],o=A;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(A);break}o[2]&&r.ops.pop(),r.trys.pop();continue}A=t.call(e,r)}catch(l){A=[6,l],n=0}finally{i=o=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}}function Ia(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}var Jt=G(Ae(),1);async function pe(e,t){let r=await(Jt.default.storage?Jt.default.storage.local.get(e):Jt.default.runtime.sendMessage({type:"GET_STORAGE_LOCAL",data:e}));return typeof e=="string"?Object.hasOwn(r,e)?r[e]:t:r}async function $i(e,t){return typeof e=="string"?Jt.default.storage?Jt.default.storage.local.set({[e]:t}):Jt.default.runtime.sendMessage({type:"SET_STORAGE_LOCAL",data:{[e]:t}}):Jt.default.storage?Jt.default.storage.local.set(e):Jt.default.runtime.sendMessage({type:"SET_STORAGE_LOCAL",data:e})}var NL=G(Ae(),1);var Bd=class{DBName;DBVersion;detailStoreName;fmp4StoreName;webmStoreName;openPromise;db;detail;currentSliceStore;sliceKeyStart;currentSliceKey;currentSize;getSliceKey;getSliceDetail;isOpen;constructor(){this.DBName="videos",this.DBVersion=1,this.detailStoreName="detail",this.fmp4StoreName="fmp4",this.webmStoreName="webm",this.handleUpgradeNeeded=this.handleUpgradeNeeded.bind(this)}async openDb(){if(this.openPromise)return this.openPromise;let t=indexedDB.open(this.DBName,this.DBVersion);return this.openPromise=new Promise((r,i)=>{t.onupgradeneeded=this.handleUpgradeNeeded,t.onsuccess=()=>{r(t.result)},t.onerror=n=>{i()}}),this.db=await this.openPromise,this.db}async handleUpgradeNeeded(t){let r=t.target.result;t.oldVersion<this.DBVersion&&(r.createObjectStore(this.detailStoreName,{autoIncrement:!0}),r.createObjectStore(this.fmp4StoreName,{keyPath:"key"}),r.createObjectStore(this.webmStoreName,{keyPath:"key"}))}async create(t){let r=t?.mimeType||"video/webm",i=r.match(/video\/webm/)?this.webmStoreName:r.match(/video\/mp4/)?this.fmp4StoreName:this.webmStoreName;t={mimeType:r,storeName:i,...t,status:"created",createAt:Date.now()},this.currentSliceStore=t.storeName,this.db||await this.openDb();let n=this.db.transaction([this.detailStoreName,this.currentSliceStore],"readwrite"),o=n.objectStore(this.currentSliceStore),a=o.getAllKeys(),s=await new Promise((d,g)=>{a.onsuccess=()=>{let u=a.result;if(u.length==0)return d(0);d(Math.max(...u))},a.onerror=()=>g()});this.sliceKeyStart=s?s+2e5-s%2e5:1,this.currentSliceKey=this.sliceKeyStart,this.currentSize=0,o.put({key:this.sliceKeyStart,data:new Blob([])}),this.detail={...t,sliceStart:this.sliceKeyStart};let A=n.objectStore(this.detailStoreName).add(this.detail),l=await new Promise((d,g)=>{A.onsuccess=()=>d(A.result),A.onerror=()=>g()});return this.detail={key:l,...this.detail},this.update(this.detail,void 0,!0),this.isOpen=!0,this.detail}async push(t,r){if(!t||!t.size||!this.isOpen||this.currentSliceKey-this.sliceKeyStart>=2e5)return;let i=this.currentSliceKey++,a=this.db.transaction(this.currentSliceStore,"readwrite").objectStore(this.currentSliceStore).put({key:i,uploaded:!1,data:t,offset:i-this.sliceKeyStart,sizeOffset:this.currentSize}),s=new Promise((c,A)=>{a.onsuccess=()=>c(),a.onerror=()=>A()});return this.currentSize+=t.size,this.detail={...this.detail,...r,status:"started",sliceEnd:this.currentSliceKey,size:this.currentSize},this.update(this.detail),s}async update(t,r,i){if((r===void 0||!isFinite(r))&&(r=this.detail.key),r===void 0||!isFinite(r)||t.processStatus=="failed"&&r&&!await this.getDetail(r))return;this.detail={...this.detail,...t,updateAt:Date.now(),key:r};let a=this.db.transaction(this.detailStoreName,"readwrite").objectStore(this.detailStoreName).put(this.detail,this.detail.key);return await new Promise((s,c)=>{a.onsuccess=()=>s(),a.onerror=()=>c()}),this.detail}async close(t){this.detail={...this.detail,status:"closed",sliceEnd:this.currentSliceKey,closeAt:Date.now(),...isFinite(t)?{duration:t}:{}},this.update(this.detail),this.isOpen=!1}async remove(t){this.db||await this.openDb(),this.isOpen&&(this.isOpen=!1),!t&&this.detail&&this.detail.key&&(t=this.detail.key);try{let r=this.db.transaction([this.detailStoreName,this.fmp4StoreName,this.webmStoreName],"readwrite"),i=r.objectStore(this.detailStoreName),n=i.get(t),o=await new Promise((d,g)=>{n.onsuccess=()=>d(n.result),n.onerror=()=>g()}),a=r.objectStore(o.storeName),s=isFinite(o.sliceEnd)?o.sliceEnd:o.sliceStart+2e5,c=IDBKeyRange.bound(o.sliceStart,s,!1,s>o.sliceStart),A=a.delete(c);await new Promise((d,g)=>{A.onsuccess=()=>d(),A.onerror=()=>g()});let l=i.delete(o.key);await new Promise((d,g)=>{l.onsuccess=()=>d(),l.onerror=()=>g()})}catch{}}async cleanup(){this.db||await this.openDb();let i=this.db.transaction(this.detailStoreName,"readonly").objectStore(this.detailStoreName).getAllKeys(),n=await new Promise((o,a)=>{i.onsuccess=()=>o(i.result),i.onerror=()=>a()});for(let o of n)await this.remove(o)}getCurrentDetail(){return this.detail}async getDetail(t){this.db||await this.openDb();let n=this.db.transaction(this.detailStoreName,"readonly").objectStore(this.detailStoreName).get(t),o=await new Promise((a,s)=>{n.onsuccess=()=>a(n.result),n.onerror=()=>s()});return this.detail=o,o}async getAllDetail(){this.db||await this.openDb();let i=this.db.transaction(this.detailStoreName,"readonly").objectStore(this.detailStoreName).getAll();return await new Promise((o,a)=>{i.onsuccess=()=>o(i.result),i.onerror=()=>a()})}async getVideo(t){this.db||await this.openDb();let r=await this.getDetail(t),n=this.db.transaction(r.storeName,"readonly").objectStore(r.storeName),o=isFinite(r.sliceEnd)?r.sliceEnd:r.sliceStart+2e5;if(o===r.sliceStart)return new Blob([],{type:r.mimeType});let a=IDBKeyRange.bound(r.sliceStart,o,!1,!0),s=n.getAll(a),A=(await new Promise((l,d)=>{s.onsuccess=()=>l(s.result),s.onerror=()=>d()})).map(l=>l.data);return new Blob(A,{type:r.mimeType})}async getAllSlices(t){this.db||await this.openDb();let r=await this.getDetail(t),n=this.db.transaction(r.storeName,"readonly").objectStore(r.storeName),o=isFinite(r.sliceEnd)?r.sliceEnd:r.sliceStart+2e5;if(o===r.sliceStart)return[];let a=IDBKeyRange.bound(r.sliceStart,o,!1,!0),s=n.getAll(a);return await new Promise((A,l)=>{s.onsuccess=()=>A(s.result),s.onerror=()=>l()})}async getSlice(t,r){this.db||await this.openDb(),t!==this.getSliceKey&&(this.getSliceKey=t,this.getSliceDetail=await this.getDetail(t));let i=this.getSliceDetail,n=i.sliceStart+r,s=this.db.transaction(i.storeName,"readonly").objectStore(i.storeName).get(n);return await new Promise((A,l)=>{s.onsuccess=()=>{s.result?A(s.result):A(null)},s.onerror=()=>l()})}async deleteSlice(t,r){this.db||await this.openDb(),t!==this.getSliceKey&&(this.getSliceKey=t,this.getSliceDetail=await this.getDetail(t));let i=this.getSliceDetail,n=i.sliceStart+r,o=IDBKeyRange.bound(i.sliceStart,n,!1,n>i.sliceStart),c=this.db.transaction(i.storeName,"readwrite").objectStore(i.storeName).delete(o);await new Promise((A,l)=>{c.onsuccess=()=>A(),c.onerror=()=>l()})}async updateSlice(t,r,i){this.db||await this.openDb(),(i!==this.getSliceKey||!this.getSliceDetail)&&(this.getSliceKey=i,this.getSliceDetail=i?await this.getDetail(i):{...this.detail});let n=this.getSliceDetail,o=n.sliceStart+t,s=this.db.transaction(n.storeName,"readwrite").objectStore(n.storeName),c=s.get(o),l={...await new Promise((g,u)=>{c.onsuccess=()=>{c.result?g(c.result):g(null)},c.onerror=()=>u()}),...r},d=s.put(l);await new Promise((g,u)=>{d.onsuccess=I=>g(I.target),d.onerror=()=>u()})}},ct=Bd;var ri=class{queue;onError;onSuccess;constructor(){this.queue=[]}async ready(){return""}start(){return{vid:"0",title:"Download"}}pause(){}resume(){}send(){}sendAll(){}async connect(){return!0}async tryConnect(){return!0}disconnect(){}isConnected(){return!0}push(t){t instanceof Blob&&this.queue.push(t)}async stop(){setTimeout(()=>{let t=new Blob(this.queue,{type:"video/mp4"}),r=URL.createObjectURL(t),i=document.createElement("a");i.href=r,i.download="Record"+Date.now()+".mp4",i.click(),URL.revokeObjectURL(r)},1e3)}async cancel(){this.stop()}getData(){return{vid:"0",title:"Download"}}getQueueProgress(){return{finished:this.queue.length,current:this.queue.length,total:this.queue.length}}refreshProgress(){}};var io=class{id;count;onError;onSuccess;constructor(){}async ready(){return this.id="pipe-"+Date.now(),this.id}start(){return{vid:this.id,title:""}}pause(){}resume(){}push(t){this.count+=1}async stop(){this.onSuccess&&this.onSuccess(this.id,{vid:this.id,title:""})}async cancel(){}getQueueProgress(){return{finished:this.count,current:this.count,total:this.count}}};var yd=class{DBName;DBVersion;objectStoreName;db;constructor(t){this.DBName=t?.name||"Storage_Index",this.DBVersion=t?.version||1,this.objectStoreName=t?.indexStoreName||"index",this.handleUpgrade=this.handleUpgrade.bind(this),this.initDB()}initDB(){if(this.db)return this.db;let t=indexedDB.open(this.DBName,this.DBVersion);return new Promise((r,i)=>{t.onerror=function(n){i()},t.onupgradeneeded=this.handleUpgrade,t.onsuccess=function(){r(t.result)}}).then(r=>{this.db=r,r.onerror=console.error}).catch(console.error)}async getObjectStore(t){return await this.initDB(),this.db.transaction([this.objectStoreName],t).objectStore(this.objectStoreName)}handleUpgrade(t){let i=t.target.result.createObjectStore(this.objectStoreName,{autoIncrement:!0})}async createIndex(t){let r={...t},n=(await this.getObjectStore("readwrite")).add(r);return new Promise((o,a)=>{n.onsuccess=()=>{let s=n.result;o(s)},n.onerror=s=>{a()}})}async updateIndex(t,r){let i=await this.getObjectStore("readwrite"),n=i.get(t);new Promise((o,a)=>{n.onsuccess=()=>{o(n.result)},n.onerror=s=>{a()}}).then(o=>{let a={...o,...r},s=i.put(a,t);return new Promise((c,A)=>{s.onsuccess=c,s.onerror=l=>{A()}})})}async removeIndex(t){let i=(await this.getObjectStore("readwrite")).delete(t);return new Promise((n,o)=>{i.onsuccess=n,i.onerror=a=>{o()}})}async getIndex(t){let r=await this.getObjectStore("readonly");if(isFinite(t)){let n=r.get(t);return new Promise((o,a)=>{n.onsuccess=()=>{o(n.result)},n.onerror=s=>{a()}})}let i=r.getAll();return new Promise((n,o)=>{i.onsuccess=()=>{n(i.result)},i.onerror=a=>{o()}})}async digest(t){if(window){let r=document.createElement("video"),i=document.createElement("canvas"),n=i.getContext("2d");if(r.muted=!0,r.src=URL.createObjectURL(t),await r.play(),isNaN(r.duration))return!1;r.currentTime=Math.min(r.duration/2,1),i.width=Math.min(r.videoWidth,420),i.height=Math.min(r.videoHeight,420*r.videoHeight/r.videoWidth),n.drawImage(r,0,0,i.width,i.height);let a={thumbnail:i.toDataURL(),resolution:r.videoWidth+"*"+r.videoHeight,size:t.size,duration:r.duration*1e3};return URL.revokeObjectURL(r.src),r.src="",a}return!1}},Ed=yd;var Qd=class extends Ed{dirName;fs;queue;indexKey;fileEntry;fileWriter;writerPromise;isWriting;isPushDone;stopPromiseResolve;autoGenerateThumbnail;DEBUG_sliceId;constructor(t){super(),this.queue=[],this.isPushDone=!1,this.dirName=t?.videosDirName||"videos",this.autoGenerateThumbnail=t?.autoGenerateThumbnail!==!1,this.DEBUG_sliceId=0}async initFS(){if(this.fs)return;let t=window.requestFileSystem||window.webkitRequestFileSystem,r=await new Promise(function(i,n){t(window.PERSISTENT,1024*1024*50,o=>{i(o)},o=>{n()})});this.fs=r}async ready(t){await this.initFS();let r=await this.createIndex({createAt:Date.now(),title:t.title,status:"ready",statusTimestamp:Date.now()});this.indexKey=r;let i=await new Promise((a,s)=>{this.fs.root.getDirectory(this.dirName,{create:!0},c=>{a(c)},c=>{s(c)})}),n=await new Promise((a,s)=>{i.getFile(""+this.indexKey,{create:!0},c=>{a(c)},c=>{s(c)})});this.fileEntry=n;let o=await new Promise((a,s)=>{n.createWriter(c=>{a(c)},c=>{s()})});return this.fileWriter=o,this.queue=[],this.isPushDone=!1,r+""}async push(t){typeof t!="string"&&(this.queue.push(t),this.isWriting||this.write())}async write(){for(this.isWriting=!0;this.queue.length>0;){let t=this.queue.shift(),r=this.DEBUG_sliceId++;this.writerPromise=new Promise((i,n)=>{this.fileWriter.write(t),this.fileWriter.onerror=function(o){n()},this.fileWriter.onwriteend=function(){i()}}),await this.writerPromise}this.isWriting=!1,this.isPushDone&&this.handleSuccess()}start(t){return this.updateIndex(this.indexKey,{key:this.indexKey,mimeType:t||"",status:"started",statusTimestamp:Date.now(),isFS:!0,fullPath:"/"+this.dirName+"/"+this.indexKey}),{vid:""+this.indexKey,title:""}}pause(){this.updateIndex(this.indexKey,{status:"paused",statusTimestamp:Date.now()})}resume(){this.updateIndex(this.indexKey,{status:"resumed",statusTimestamp:Date.now()})}async stop({duration:t,size:r}){return this.isPushDone=!0,await this.updateIndex(this.indexKey,{duration:t||0,size:r||0}),new Promise(i=>{this.stopPromiseResolve=i})}async cancel(){return new Promise((t,r)=>{if(!this.fileEntry)return t();this.fileEntry.remove(()=>{t()},i=>{r()})}).then(()=>this.removeIndex(this.indexKey)).then(()=>{this.clear()})}regenerateThumbnail(){}handleSuccess(){this.updateIndex(this.indexKey,{status:"stopped",statusTimestamp:Date.now()}).then(()=>{if(this.autoGenerateThumbnail)return this.generateThumbnail()}).then(t=>{if(t)return this.updateIndex(this.indexKey,t)}).then(()=>{this.clear()}).then(()=>{this.stopPromiseResolve&&this.stopPromiseResolve()})}async generateThumbnail(){let t=await new Promise((r,i)=>{this.fileEntry.file(n=>{r(n)},n=>{i()})});return this.digest(t)}clear(){this.fileWriter=null,this.fileEntry=null}},no=Qd;var zt=class e{static instance=null;queryRegisterKey;registerKeyPool;handleStorage;storageListener;setTimeout;clearTimeout;queryWaitingTime;constructor(t){this.registerKeyPool=new Set,this.queryRegisterKey=t?.storageQueryKey||"query_single_line",this.queryWaitingTime=isFinite(t?.queryWaitingTime)?t.queryWaitingTime:300,this.handleStorage=r=>{if(r.key===this.queryRegisterKey)try{let i=JSON.parse(r.newValue);this.responseQueryEvent(i)}catch{}},this.storageListener=!1,this.setTimeout=t?.setTimeout||window.setTimeout,this.clearTimeout=t?.clearTimeout||window.clearTimeout,this.setTimeout=this.setTimeout.bind(null),this.clearTimeout=this.clearTimeout.bind(null)}static getInstance(t){return e.instance||(e.instance=new e(t)),e.instance}static resetInstance(){e.instance&&(e.instance.cleanup(),e.instance=null)}prepareListener(){this.registerKeyPool.size>0&&!this.storageListener&&(window.addEventListener("storage",this.handleStorage),window.addEventListener("storage-self",this.handleStorage),this.storageListener=!0),this.registerKeyPool.size==0&&this.storageListener&&(window.removeEventListener("storage",this.handleStorage),window.removeEventListener("storage-self",this.handleStorage),this.storageListener=!1)}register(t){return this.registerKeyPool.add(t),this.prepareListener(),()=>{this.unregister(t)}}unregister(t){this.registerKeyPool.delete(t),this.prepareListener()}async queryOutageKeys(t){this.dispatchQuery(t),await new Promise(i=>{this.setTimeout(i,this.queryWaitingTime)});let r=this.getResponse();return t.filter(i=>r[i]<=0)}dispatchQuery(t){let r=localStorage.getItem(this.queryRegisterKey),i={};try{let a=JSON.parse(r);i=Object.assign(i,a)}catch{}let n=Date.now();i=Object.fromEntries(Object.entries(i).filter(([a,s])=>n-Math.abs(s)<1e3*60)),i=Object.assign(i,t.reduce((a,s)=>({...a,[s]:-Date.now()}),{})),localStorage.setItem(this.queryRegisterKey,JSON.stringify(i));let o=new StorageEvent("storage-self",{key:this.queryRegisterKey,newValue:JSON.stringify(i)});window.dispatchEvent(o)}responseQueryEvent(t){let r=Object.assign({},t),i=!1;Object.keys(t).forEach(n=>{this.registerKeyPool.has(n)&&(r[n]=Date.now(),i=!0)}),i&&localStorage.setItem(this.queryRegisterKey,JSON.stringify(r))}getResponse(){let t=localStorage.getItem(this.queryRegisterKey),r={};try{let i=JSON.parse(t);r=Object.assign(r,i)}catch{}return r}};var oo=e=>typeof e=="function",wd=e=>e instanceof Blob,TE=(...e)=>e.join("/").replace(/([^:])\/{2,}/g,"$1/"),pa=5*1024*1024,ha=(e,t=window.setTimeout)=>new Promise(r=>{t(()=>{r()},e)});function PL(){let e=async(r,i,n={})=>{let{retry:o=!1,timeout:a=0}=n;i=i||{};let s=e.beforeRequest(r,i);r=s.info,i=s.init;let c;if(a>0){let l=new AbortController;i.signal=l.signal,c=setTimeout(()=>{l.abort()},a)}let A;if(o){let l,d;sd(o)||(l=o.wait,d=o.times),await ma(async g=>{let u;try{c&&clearTimeout(c),u=await fetch(r,i),A=e.beforeResponse(u)}catch(I){if(c&&clearTimeout(c),g===0)throw I;return!1}return!0},l,d)}else{let l=await fetch(r,i);c&&clearTimeout(c),A=e.beforeResponse(l)}return A};e.beforeRequest=(r,i)=>({info:r,init:i}),e.beforeResponse=r=>{if(!r.ok)throw new Error("Network response was not OK");return r.json()},e.meta={token:""};let t=r=>(i,n,o)=>(n=n||{},n.method=r.toUpperCase(),e(i,n,o));return e.get=t("get"),e.post=t("post"),e.put=t("put"),e.delete=t("delete"),e.update=t("update"),e}var Ct=PL();Ct.beforeRequest=(e,t)=>(Ct.meta.token&&(t.headers={Authorization:Ct.meta.token,...t.headers||{}}),{info:e,init:t});function bd(e,t,r){let i=e[t];Object.defineProperty(e,t,{get(){return i},set(n){let o=i;i=n,o!==n&&r(n,o)}})}async function ma(e,t=1e3,r=-1){let i=0,n=0,o=0;for(;;){if(await e(r-i)||(i++,o=oo(t)?t(n,i):t,n=o,o<0||r>=0&&i>r))return;await ha(o)}}var _E=e=>{let t=Math.floor(e/36e5),r=Math.floor(e%36e5/6e4),i=Math.floor(e%6e4/1e3);return t>0?`${t}:${("00"+r).slice(-2)}:${("00"+i).slice(-2)}`:`${("00"+r).slice(-2)}:${("00"+i).slice(-2)}`},qre=2**31-1;var en=class{processing=!1;apiOrigin;vid;title;payload;backupKey;backup;dataSize=0;dataCount=0;confirmedDataCount=0;jobQueue=new Sd;status="uploading";reUploading=!1;reUploadFirstSlice=!0;hasError=!1;onConnected;constructor(t){Ct.meta.token=t.token,this.apiOrigin=t.apiPath,t.backupKey&&(this.backupKey=t.backupKey,this.backup=new ct),bd(this,"confirmedDataCount",()=>this.refreshProgress()),bd(this,"dataCount",()=>this.refreshProgress())}async ready(t){return this.title=t.title,this.payload=this.parsePayload(t.payload||{}),this.vid=await this.init(),this.onConnected&&this.onConnected(this.vid,{vid:this.vid}),this.vid}async init(){this.processing=!0;let t=await Ct.post(this.getUrl("v2/record/init"),{body:JSON.stringify({video_title:this.title,scope:this.payload.scope,extra:this.payload.extra})});return this.processing=!1,t.data.status===3&&this.callHook("onError",this.vid,{type:"quotaExceeded"}),t.data.vid}push(t){this.hasError||(this.status==="uploading"||this.status==="paused")&&wd(t)&&t.size&&(this.dataSize||this.reportFirstSlice(t),this.pushUploadJob(t,this.dataSize,this.dataCount),this.dataSize+=t.size,this.dataCount+=1)}pushUploadJob(t,r,i){this.backup&&this.jobQueue.length>250?this.jobQueue.push(async()=>{let{data:n}=await this.backup.getSlice(this.backupKey,i);n&&await this.upload(n,r,i)}):this.jobQueue.push(async()=>{await this.upload(t,r,i)})}async uploadSlice(t,r,i){if(this.hasError||this.status==="uploading"&&wd(t)&&t.size&&(this.reUploadFirstSlice?(this.reUploadFirstSlice=!1,await this.upload(t,r,i)):await this.jobQueue.push(async()=>{await this.upload(t,r,i)}),this.hasError))return!0}async upload(t,r,i){let n=new FormData;if(n.append("video_id",this.vid),n.append("file",t),n.append("offset",String(r)),(await Ct.post(this.getUrl(`v2/record/file_upload?vid=${this.vid}&idx=${i}&offset=${r}`),{body:n},{retry:!0})).code===-400){this.hasError||(this.hasError=!0,this.status="stopped",this.callHook("onError",this.vid,{}));return}this.status!=="canceled"&&(oo(this.onSliceUploaded)&&this.onSliceUploaded(this.vid,i),this.confirmedDataCount+=1)}startReUpload(t,r,i,n){this.vid=t,this.reUploading=!0,this.dataSize=n||0,this.dataCount=r,this.confirmedDataCount=i}start(){return{vid:this.vid,title:this.title}}pause(){this.status="paused"}resume(){this.status="uploading"}async stop({duration:t,size:r,keepalive:i=!1,onStop:n=()=>{}}={}){this.status!=="stopped"&&(this.status="stopped",this.hasError||(this.processing=!0,ma(async()=>this.done?(await Ct.put(this.getUrl(`/record/complete/${this.vid}?type=${this.reUploading?"backup":"default"}`),{keepalive:i},{retry:!0}),this.processing=!1,this.callHook("onSuccess",this.vid,{vid:this.vid,title:this.title}),oo(n)&&n(),!0):!1,1e3)))}async cancel(t=!1){if(this.status!=="canceled")return this.status="canceled",this.processing=!0,ma(async()=>{if(this.vid){let r=this.getUrl(`/record/${this.dataSize?"discard":"cancel"}/${this.vid}`);return await Ct.delete(r,{keepalive:t},{retry:!0}),this.processing=!1,!0}return!1},1e3)}reportFirstSlice(t){Ct.post(this.getUrl("/record/buffer/first"),{body:JSON.stringify({id:this.vid,size:t.size,extra:this.payload.extra})})}parsePayload(t){let r=t,i={};r.locationType&&r.locationId&&(i.scope={type:r.locationType,id:r.locationId});let n=i.extra={};return r.tabUrl&&(n.source_url=r.tabUrl),r.appVersion&&(n.client_version=r.appVersion),r.recordType&&(n.record_type=r.recordType),r.recorderVersion&&(n.recorder_version=r.recorderVersion),r.screenSize&&(n.screen_size=r.screenSize),r.appAndPlatform&&(n.client=r.appAndPlatform),i}getUrl(t){return TE(this.apiOrigin,t)}get progress(){return{finished:this.confirmedDataCount,current:this.confirmedDataCount,total:this.dataCount,more:{binarySlice:this.confirmedDataCount}}}get done(){return this.status==="stopped"&&this.confirmedDataCount===this.dataCount}refreshProgress(){let{progress:t}=this;this.callHook("onProgress",this.vid,t.finished/t.total,{binarySlice:t.more.binarySlice,finished:t.finished,total:t.total,current:t.current})}onProgress(t,r){}onError(){}onSuccess(){}async onSliceUploaded(t,r){}callHook(t,...r){oo(this[t])&&this[t].call(this,...r)}},UL=5,Sd=class{runningCount=0;jobs=[];resolveHook=()=>{};constructor(){}get busy(){return this.runningCount>=UL}get length(){return this.jobs.length}push(t){let r=new Promise(i=>{this.resolveHook=i});return this.jobs.push(t),this.startNextJob(),r}async startNextJob(){if(this.busy)return;this.resolveHook(this.runningCount),this.runningCount++;let t=this.jobs.shift();try{t&&await t(),this.runningCount--,this.jobs.length>0&&this.startNextJob()}catch{this.runningCount--,t&&this.push(t)}}};var ME=e=>({setHttpHandler(t){e.httpHandler=t},httpHandler(){return e.httpHandler},updateHttpClientConfig(t,r){e.httpHandler?.updateHttpClientConfig(t,r)},httpHandlerConfigs(){return e.httpHandler.httpHandlerConfigs()}}),NE=e=>({httpHandler:e.httpHandler()});var PE;(function(e){e.HEADER="header",e.QUERY="query"})(PE||(PE={}));var xd;(function(e){e.HEADER="header",e.QUERY="query"})(xd||(xd={}));var tn;(function(e){e.HTTP="http",e.HTTPS="https"})(tn||(tn={}));var rn;(function(e){e.MD5="md5",e.CRC32="crc32",e.CRC32C="crc32c",e.SHA1="sha1",e.SHA256="sha256"})(rn||(rn={}));var kd;(function(e){e[e.HEADER=0]="HEADER",e[e.TRAILER=1]="TRAILER"})(kd||(kd={}));var nn="__smithy_context";var UE;(function(e){e.PROFILE="profile",e.SSO_SESSION="sso-session",e.SERVICES="services"})(UE||(UE={}));var OE;(function(e){e.HTTP_0_9="http/0.9",e.HTTP_1_0="http/1.0",e.TDS_8_0="tds/8.0"})(OE||(OE={}));var O=class e{constructor(t){this.method=t.method||"GET",this.hostname=t.hostname||"localhost",this.port=t.port,this.query=t.query||{},this.headers=t.headers||{},this.body=t.body,this.protocol=t.protocol?t.protocol.slice(-1)!==":"?`${t.protocol}:`:t.protocol:"https:",this.path=t.path?t.path.charAt(0)!=="/"?`/${t.path}`:t.path:"/",this.username=t.username,this.password=t.password,this.fragment=t.fragment}static clone(t){let r=new e({...t,headers:{...t.headers}});return r.query&&(r.query=OL(r.query)),r}static isInstance(t){if(!t)return!1;let r=t;return"method"in r&&"protocol"in r&&"hostname"in r&&"path"in r&&typeof r.query=="object"&&typeof r.headers=="object"}clone(){return e.clone(this)}};function OL(e){return Object.keys(e).reduce((t,r)=>{let i=e[r];return{...t,[r]:Array.isArray(i)?[...i]:i}},{})}var Ue=class{constructor(t){this.statusCode=t.statusCode,this.reason=t.reason,this.headers=t.headers||{},this.body=t.body}static isInstance(t){if(!t)return!1;let r=t;return typeof r.statusCode=="number"&&typeof r.headers=="object"}};function qL(e){return t=>async r=>{let{request:i}=r;return O.isInstance(i)&&i.body&&e.runtime==="node"&&e.requestHandler?.constructor?.name!=="FetchHttpHandler"&&(i.headers={...i.headers,Expect:"100-continue"}),t({...r,request:i})}}var GL={step:"build",tags:["SET_EXPECT_HEADER","EXPECT_HEADER"],name:"addExpectContinueMiddleware",override:!0},qE=e=>({applyToStack:t=>{t.add(qL(e),GL)}});var Dd={WHEN_SUPPORTED:"WHEN_SUPPORTED",WHEN_REQUIRED:"WHEN_REQUIRED"},vd=Dd.WHEN_SUPPORTED;var Fd=Dd.WHEN_SUPPORTED,ie;(function(e){e.MD5="MD5",e.CRC32="CRC32",e.CRC32C="CRC32C",e.SHA1="SHA1",e.SHA256="SHA256"})(ie||(ie={}));var GE;(function(e){e.HEADER="header",e.TRAILER="trailer"})(GE||(GE={}));var HE=ie.MD5,LE=ie.CRC32;var Ca;(function(e){e.ENV="env",e.CONFIG="shared config entry"})(Ca||(Ca={}));function KE(e,t,r){return e.$source||(e.$source={}),e.$source[t]=r,e}function ve(e,t,r){e.__aws_sdk_context?e.__aws_sdk_context.features||(e.__aws_sdk_context.features={}):e.__aws_sdk_context={features:{}},e.__aws_sdk_context.features[t]=r}var Rd=e=>Ue.isInstance(e)?e.headers?.date??e.headers?.Date:void 0;var on=e=>new Date(Date.now()+e);var JE=(e,t)=>Math.abs(on(t).getTime()-e)>=3e5;var Td=(e,t)=>{let r=Date.parse(e);return JE(r,t)?r-Date.now():t};var so=(e,t)=>{if(!t)throw new Error(`Property \`${e}\` is not resolved for AWS SDK SigV4Auth`);return t},Ba=async e=>{let t=so("context",e.context),r=so("config",e.config),i=t.endpointV2?.properties?.authSchemes?.[0],o=await so("signer",r.signer)(i),a=e?.signingRegion,s=e?.signingRegionSet,c=e?.signingName;return{config:r,signer:o,signingRegion:a,signingRegionSet:s,signingName:c}},ii=class{async sign(t,r,i){if(!O.isInstance(t))throw new Error("The request is not an instance of `HttpRequest` and cannot be signed");let n=await Ba(i),{config:o,signer:a}=n,{signingRegion:s,signingName:c}=n,A=i.context;if(A?.authSchemes?.length??!1){let[d,g]=A.authSchemes;d?.name==="sigv4a"&&g?.name==="sigv4"&&(s=g?.signingRegion??s,c=g?.signingName??c)}return await a.sign(t,{signingDate:on(o.systemClockOffset),signingRegion:s,signingService:c})}errorHandler(t){return r=>{let i=r.ServerTime??Rd(r.$response);if(i){let n=so("config",t.config),o=n.systemClockOffset;n.systemClockOffset=Td(i,n.systemClockOffset),n.systemClockOffset!==o&&r.$metadata&&(r.$metadata.clockSkewCorrected=!0)}throw r}}successHandler(t,r){let i=Rd(t);if(i){let n=so("config",r.config);n.systemClockOffset=Td(i,n.systemClockOffset)}}};var ao=class extends ii{async sign(t,r,i){if(!O.isInstance(t))throw new Error("The request is not an instance of `HttpRequest` and cannot be signed");let{config:n,signer:o,signingRegion:a,signingRegionSet:s,signingName:c}=await Ba(i),l=(await n.sigv4aSigningRegionSet?.()??s??[a]).join(",");return await o.sign(t,{signingDate:on(n.systemClockOffset),signingRegion:l,signingService:c})}};var ut=e=>e[nn]||(e[nn]={});var Oe=e=>{if(typeof e=="function")return e;let t=Promise.resolve(e);return()=>t};var zE=(e,t)=>{if(!t||t.length===0)return e;let r=[];for(let i of t)for(let n of e)n.schemeId.split("#")[1]===i&&r.push(n);for(let i of e)r.find(({schemeId:n})=>n===i.schemeId)||r.push(i);return r};function LL(e){let t=new Map;for(let r of e)t.set(r.schemeId,r);return t}var _d=(e,t)=>(r,i)=>async n=>{let o=e.httpAuthSchemeProvider(await t.httpAuthSchemeParametersProvider(e,i,n.input)),a=e.authSchemePreference?await e.authSchemePreference():[],s=zE(o,a),c=LL(e.httpAuthSchemes),A=ut(i),l=[];for(let d of s){let g=c.get(d.schemeId);if(!g){l.push(`HttpAuthScheme \`${d.schemeId}\` was not enabled for this service.`);continue}let u=g.identityProvider(await t.identityProviderConfigProvider(e));if(!u){l.push(`HttpAuthScheme \`${d.schemeId}\` did not have an IdentityProvider configured.`);continue}let{identityProperties:I={},signingProperties:C={}}=d.propertiesExtractor?.(e,i)||{};d.identityProperties=Object.assign(d.identityProperties||{},I),d.signingProperties=Object.assign(d.signingProperties||{},C),A.selectedHttpAuthScheme={httpAuthOption:d,identity:await u(d.identityProperties),signer:g.signer};break}if(!A.selectedHttpAuthScheme)throw new Error(l.join(`
`));return r(n)};var KL={step:"serialize",tags:["HTTP_AUTH_SCHEME"],name:"httpAuthSchemeMiddleware",override:!0,relation:"before",toMiddleware:"endpointV2Middleware"},VE=(e,{httpAuthSchemeParametersProvider:t,identityProviderConfigProvider:r})=>({applyToStack:i=>{i.addRelativeTo(_d(e,{httpAuthSchemeParametersProvider:t,identityProviderConfigProvider:r}),KL)}});var YE=(e,t)=>(r,i)=>async n=>{let{response:o}=await r(n);try{let a=await t(o,e);return{response:o,output:a}}catch(a){if(Object.defineProperty(a,"$response",{value:o}),!("$metadata"in a)){let s="Deserialization error: to see the raw response, inspect the hidden field {error}.$response on this object.";try{a.message+=`
  `+s}catch{!i.logger||i.logger?.constructor?.name==="NoOpLogger"||i.logger?.warn?.(s)}typeof a.$responseBodyText<"u"&&a.$response&&(a.$response.body=a.$responseBodyText);try{if(Ue.isInstance(o)){let{headers:c={}}=o,A=Object.entries(c);a.$metadata={httpStatusCode:o.statusCode,requestId:Md(/^x-[\w-]+-request-?id$/,A),extendedRequestId:Md(/^x-[\w-]+-id-2$/,A),cfId:Md(/^x-[\w-]+-cf-id$/,A)}}}catch{}}throw a}},Md=(e,t)=>(t.find(([r])=>r.match(e))||[void 0,void 0])[1];var WE=(e,t)=>(r,i)=>async n=>{let o=e,a=i.endpointV2?.url&&o.urlParser?async()=>o.urlParser(i.endpointV2.url):o.endpoint;if(!a)throw new Error("No valid endpoint provider available.");let s=await t(n.input,{...e,endpoint:a});return r({...n,request:s})};var JL={name:"deserializerMiddleware",step:"deserialize",tags:["DESERIALIZER"],override:!0},co={name:"serializerMiddleware",step:"serialize",tags:["SERIALIZER"],override:!0};function sn(e,t,r){return{applyToStack:i=>{i.add(YE(e,r),JL),i.add(WE(e,t),co)}}}var zoe={step:"serialize",tags:["HTTP_AUTH_SCHEME"],name:"httpAuthSchemeMiddleware",override:!0,relation:"before",toMiddleware:co.name};var zL=e=>t=>{throw t},VL=(e,t)=>{},jE=e=>(t,r)=>async i=>{if(!O.isInstance(i.request))return t(i);let o=ut(r).selectedHttpAuthScheme;if(!o)throw new Error("No HttpAuthScheme was selected: unable to sign request");let{httpAuthOption:{signingProperties:a={}},identity:s,signer:c}=o,A=await t({...i,request:await c.sign(i.request,s,a)}).catch((c.errorHandler||zL)(a));return(c.successHandler||VL)(A.response,a),A};var Nd={step:"finalizeRequest",tags:["HTTP_SIGNING"],name:"httpSigningMiddleware",aliases:["apiKeyMiddleware","tokenMiddleware","awsAuthMiddleware"],override:!0,relation:"after",toMiddleware:"retryMiddleware"},XE=e=>({applyToStack:t=>{t.addRelativeTo(jE(e),Nd)}});var sr=e=>{if(typeof e=="function")return e;let t=Promise.resolve(e);return()=>t};var ar={},ni=new Array(64);for(let e=0,t=65,r=90;e+t<=r;e++){let i=String.fromCharCode(e+t);ar[i]=e,ni[e]=i}for(let e=0,t=97,r=122;e+t<=r;e++){let i=String.fromCharCode(e+t),n=e+26;ar[i]=n,ni[n]=i}for(let e=0;e<10;e++){ar[e.toString(10)]=e+52;let t=e.toString(10),r=e+52;ar[t]=r,ni[r]=t}ar["+"]=62;ni[62]="+";ar["/"]=63;ni[63]="/";var Rr=6,oi=8,ZE=63;var si=e=>{let t=e.length/4*3;e.slice(-2)==="=="?t-=2:e.slice(-1)==="="&&t--;let r=new ArrayBuffer(t),i=new DataView(r);for(let n=0;n<e.length;n+=4){let o=0,a=0;for(let A=n,l=n+3;A<=l;A++)if(e[A]!=="="){if(!(e[A]in ar))throw new TypeError(`Invalid character ${e[A]} in base64 string.`);o|=ar[e[A]]<<(l-A)*Rr,a+=Rr}else o>>=Rr;let s=n/4*3;o>>=a%oi;let c=Math.floor(a/oi);for(let A=0;A<c;A++){let l=(c-A-1)*oi;i.setUint8(s+A,(o&255<<l)>>l)}}return new Uint8Array(r)};var At=e=>new TextEncoder().encode(e);var Dt=e=>typeof e=="string"?At(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e);var Tr=e=>{if(typeof e=="string")return e;if(typeof e!="object"||typeof e.byteOffset!="number"||typeof e.byteLength!="number")throw new Error("@smithy/util-utf8: toUtf8 encoder function only accepts string | Uint8Array.");return new TextDecoder("utf-8").decode(e)};function cr(e){let t;typeof e=="string"?t=At(e):t=e;let r=typeof t=="object"&&typeof t.length=="number",i=typeof t=="object"&&typeof t.byteOffset=="number"&&typeof t.byteLength=="number";if(!r&&!i)throw new Error("@smithy/util-base64: toBase64 encoder function only accepts string | Uint8Array.");let n="";for(let o=0;o<t.length;o+=3){let a=0,s=0;for(let A=o,l=Math.min(o+3,t.length);A<l;A++)a|=t[A]<<(l-A-1)*oi,s+=oi;let c=Math.ceil(s/Rr);a<<=c*Rr-s;for(let A=1;A<=c;A++){let l=(c-A)*Rr;n+=ni[(a&ZE<<l)>>l]}n+="==".slice(0,4-c)}return n}function $E(e,t="utf-8"){return t==="base64"?cr(e):Tr(e)}function eQ(e,t){return t==="base64"?Ar.mutate(si(e)):Ar.mutate(At(e))}var Ar=class e extends Uint8Array{static fromString(t,r="utf-8"){switch(typeof t){case"string":return eQ(t,r);default:throw new Error(`Unsupported conversion from ${typeof t} to Uint8ArrayBlobAdapter.`)}}static mutate(t){return Object.setPrototypeOf(t,e.prototype),t}transformToString(t="utf-8"){return $E(this,t)}};var YL=typeof ReadableStream=="function"?ReadableStream:function(){},ya=class extends YL{};var Ao=e=>typeof ReadableStream=="function"&&(e?.constructor?.name===ReadableStream.name||e instanceof ReadableStream);var tQ=({expectedChecksum:e,checksum:t,source:r,checksumSourceLocation:i,base64Encoder:n})=>{if(!Ao(r))throw new Error(`@smithy/util-stream: unsupported source type ${r?.constructor?.name??r} in ChecksumStream.`);let o=n??cr;if(typeof TransformStream!="function")throw new Error("@smithy/util-stream: unable to instantiate ChecksumStream because API unavailable: ReadableStream/TransformStream.");let a=new TransformStream({start(){},async transform(c,A){t.update(c),A.enqueue(c)},async flush(c){let A=await t.digest(),l=o(A);if(e!==l){let d=new Error(`Checksum mismatch: expected "${e}" but received "${l}" in response header "${i}".`);c.error(d)}else c.terminate()}});r.pipeThrough(a);let s=a.readable;return Object.setPrototypeOf(s,ya.prototype),s};var rQ=(e,t)=>{let{base64Encoder:r,bodyLengthChecker:i,checksumAlgorithmFn:n,checksumLocationName:o,streamHasher:a}=t,s=r!==void 0&&i!==void 0&&n!==void 0&&o!==void 0&&a!==void 0,c=s?a(n,e):void 0,A=e.getReader();return new ReadableStream({async pull(l){let{value:d,done:g}=await A.read();if(g){if(l.enqueue(`0\r
`),s){let u=r(await c);l.enqueue(`${o}:${u}\r
`),l.enqueue(`\r
`)}l.close()}else l.enqueue(`${(i(d)||0).toString(16)}\r
${d}\r
`)}})};async function iQ(e,t){let r=0,i=[],n=e.getReader(),o=!1;for(;!o;){let{done:c,value:A}=await n.read();if(A&&(i.push(A),r+=A?.byteLength??0),r>=t)break;o=c}n.releaseLock();let a=new Uint8Array(Math.min(t,r)),s=0;for(let c of i){if(c.byteLength>a.byteLength-s){a.set(c.subarray(0,a.byteLength-s),s);break}else a.set(c,s);s+=c.length}return a}var vt=e=>encodeURIComponent(e).replace(/[!'()*]/g,WL),WL=e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`;function nQ(e){let t=[];for(let r of Object.keys(e).sort()){let i=e[r];if(r=vt(r),Array.isArray(i))for(let n=0,o=i.length;n<o;n++)t.push(`${r}=${vt(i[n])}`);else{let n=r;(i||typeof i=="string")&&(n+=`=${vt(i)}`),t.push(n)}}return t.join("&")}function Pd(e,t){return new Request(e,t)}function oQ(e=0){return new Promise((t,r)=>{e&&setTimeout(()=>{let i=new Error(`Request did not complete within ${e} ms`);i.name="TimeoutError",r(i)},e)})}var Ud={supported:void 0},Ea=class e{static create(t){return typeof t?.handle=="function"?t:new e(t)}constructor(t){typeof t=="function"?this.configProvider=t().then(r=>r||{}):(this.config=t??{},this.configProvider=Promise.resolve(this.config)),Ud.supported===void 0&&(Ud.supported=typeof Request<"u"&&"keepalive"in Pd("https://[::1]"))}destroy(){}async handle(t,{abortSignal:r}={}){this.config||(this.config=await this.configProvider);let i=this.config.requestTimeout,n=this.config.keepAlive===!0,o=this.config.credentials;if(r?.aborted){let h=new Error("Request aborted");return h.name="AbortError",Promise.reject(h)}let a=t.path,s=nQ(t.query||{});s&&(a+=`?${s}`),t.fragment&&(a+=`#${t.fragment}`);let c="";if(t.username!=null||t.password!=null){let h=t.username??"",Q=t.password??"";c=`${h}:${Q}@`}let{port:A,method:l}=t,d=`${t.protocol}//${c}${t.hostname}${A?`:${A}`:""}${a}`,g=l==="GET"||l==="HEAD"?void 0:t.body,u={body:g,headers:new Headers(t.headers),method:l,credentials:o};this.config?.cache&&(u.cache=this.config.cache),g&&(u.duplex="half"),typeof AbortController<"u"&&(u.signal=r),Ud.supported&&(u.keepalive=n),typeof this.config.requestInit=="function"&&Object.assign(u,this.config.requestInit(t));let I=()=>{},C=Pd(d,u),B=[fetch(C).then(h=>{let Q=h.headers,D={};for(let x of Q.entries())D[x[0]]=x[1];return h.body!=null?{response:new Ue({headers:D,reason:h.statusText,statusCode:h.status,body:h.body})}:h.blob().then(x=>({response:new Ue({headers:D,reason:h.statusText,statusCode:h.status,body:x})}))}),oQ(i)];return r&&B.push(new Promise((h,Q)=>{let D=()=>{let E=new Error("Request aborted");E.name="AbortError",Q(E)};if(typeof r.addEventListener=="function"){let E=r;E.addEventListener("abort",D,{once:!0}),I=()=>E.removeEventListener("abort",D)}else r.onabort=D})),Promise.race(B).finally(I)}updateHttpClientConfig(t,r){this.config=void 0,this.configProvider=this.configProvider.then(i=>(i[t]=r,i))}httpHandlerConfigs(){return this.config??{}}};var Qa=async e=>typeof Blob=="function"&&e instanceof Blob||e.constructor?.name==="Blob"?Blob.prototype.arrayBuffer!==void 0?new Uint8Array(await e.arrayBuffer()):jL(e):XL(e);async function jL(e){let t=await ZL(e),r=si(t);return new Uint8Array(r)}async function XL(e){let t=[],r=e.getReader(),i=!1,n=0;for(;!i;){let{done:s,value:c}=await r.read();c&&(t.push(c),n+=c.length),i=s}let o=new Uint8Array(n),a=0;for(let s of t)o.set(s,a),a+=s.length;return o}function ZL(e){return new Promise((t,r)=>{let i=new FileReader;i.onloadend=()=>{if(i.readyState!==2)return r(new Error("Reader aborted too early"));let n=i.result??"",o=n.indexOf(","),a=o>-1?o+1:n.length;t(n.substring(a))},i.onabort=()=>r(new Error("Read aborted")),i.onerror=()=>r(i.error),i.readAsDataURL(e)})}var sQ={},Od={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();t.length===1&&(t=`0${t}`),sQ[e]=t,Od[t]=e}function wa(e){if(e.length%2!==0)throw new Error("Hex encoded strings must have an even number length");let t=new Uint8Array(e.length/2);for(let r=0;r<e.length;r+=2){let i=e.slice(r,r+2).toLowerCase();if(i in Od)t[r/2]=Od[i];else throw new Error(`Cannot decode unrecognized sequence ${i} as hexadecimal`)}return t}function ue(e){let t="";for(let r=0;r<e.byteLength;r++)t+=sQ[e[r]];return t}var aQ="The stream has already been transformed.",qd=e=>{if(!cQ(e)&&!Ao(e)){let n=e?.__proto__?.constructor?.name||e;throw new Error(`Unexpected stream implementation, expect Blob or ReadableStream, got ${n}`)}let t=!1,r=async()=>{if(t)throw new Error(aQ);return t=!0,await Qa(e)},i=n=>{if(typeof n.stream!="function")throw new Error(`Cannot transform payload Blob to web stream. Please make sure the Blob.stream() is polyfilled.
If you are using React Native, this API is not yet supported, see: https://react-native.canny.io/feature-requests/p/fetch-streaming-body`);return n.stream()};return Object.assign(e,{transformToByteArray:r,transformToString:async n=>{let o=await r();if(n==="base64")return cr(o);if(n==="hex")return ue(o);if(n===void 0||n==="utf8"||n==="utf-8")return Tr(o);if(typeof TextDecoder=="function")return new TextDecoder(n).decode(o);throw new Error("TextDecoder is not available, please make sure polyfill is provided.")},transformToWebStream:()=>{if(t)throw new Error(aQ);if(t=!0,cQ(e))return i(e);if(Ao(e))return e;throw new Error(`Cannot transform payload to web stream, got ${e}`)}})},cQ=e=>typeof Blob=="function"&&e instanceof Blob;async function AQ(e){return typeof e.stream=="function"&&(e=e.stream()),e.tee()}var lr=async(e=new Uint8Array,t)=>{if(e instanceof Uint8Array)return Ar.mutate(e);if(!e)return Ar.mutate(new Uint8Array);let r=t.streamCollector(e);return Ar.mutate(await r)};function lo(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()})}var dr=class e{constructor(t,r=new Map){this.namespace=t,this.schemas=r}static for(t){return e.registries.has(t)||e.registries.set(t,new e(t)),e.registries.get(t)}register(t,r){let i=this.normalizeShapeId(t);e.for(this.getNamespace(t)).schemas.set(i,r)}getSchema(t){let r=this.normalizeShapeId(t);if(!this.schemas.has(r))throw new Error(`@smithy/core/schema - schema not found for ${r}`);return this.schemas.get(r)}getBaseException(){for(let[t,r]of this.schemas.entries())if(t.startsWith("smithy.ts.sdk.synthetic.")&&t.endsWith("ServiceException"))return r}find(t){return[...this.schemas.values()].find(t)}destroy(){e.registries.delete(this.namespace),this.schemas.clear()}normalizeShapeId(t){return t.includes("#")?t:this.namespace+"#"+t}getNamespace(t){return this.normalizeShapeId(t).split("#")[0]}};dr.registries=new Map;var Sa=e=>{switch(e){case"true":return!0;case"false":return!1;default:throw new Error(`Unable to parse boolean value "${e}"`)}};var eK=e=>{if(e!=null){if(typeof e=="string"){let t=parseFloat(e);if(!Number.isNaN(t))return String(t)!==String(e)&&BQ.warn(CQ(`Expected number but observed string: ${e}`)),t}if(typeof e=="number")return e;throw new TypeError(`Expected number, got ${typeof e}: ${e}`)}},tK=Math.ceil(34028234663852886e22),lQ=e=>{let t=eK(e);if(t!==void 0&&!Number.isNaN(t)&&t!==1/0&&t!==-1/0&&Math.abs(t)>tK)throw new TypeError(`Expected 32-bit float, got ${e}`);return t},Gd=e=>{if(e!=null){if(Number.isInteger(e)&&!Number.isNaN(e))return e;throw new TypeError(`Expected integer, got ${typeof e}: ${e}`)}};var dQ=e=>uQ(e,16),gQ=e=>uQ(e,8),uQ=(e,t)=>{let r=Gd(e);if(r!==void 0&&rK(r,t)!==r)throw new TypeError(`Expected ${t}-bit integer, got ${e}`);return r},rK=(e,t)=>{switch(t){case 32:return Int32Array.of(e)[0];case 16:return Int16Array.of(e)[0];case 8:return Int8Array.of(e)[0]}},go=(e,t)=>{if(e==null)throw t?new TypeError(`Expected a non-null value for ${t}`):new TypeError("Expected a non-null value");return e},fQ=e=>{if(e==null)return;if(typeof e=="object"&&!Array.isArray(e))return e;let t=Array.isArray(e)?"array":typeof e;throw new TypeError(`Expected object, got ${t}: ${e}`)},cn=e=>{if(e!=null){if(typeof e=="string")return e;if(["boolean","number","bigint"].includes(typeof e))return BQ.warn(CQ(`Expected string, got ${typeof e}: ${e}`)),String(e);throw new TypeError(`Expected string, got ${typeof e}: ${e}`)}};var IQ=e=>lQ(typeof e=="string"?xa(e):e),iK=/(-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?)|(-?Infinity)|(NaN)/g,xa=e=>{let t=e.match(iK);if(t===null||t[0].length!==e.length)throw new TypeError("Expected real number, got implicit NaN");return parseFloat(e)};var pQ=e=>Gd(typeof e=="string"?xa(e):e);var hQ=e=>dQ(typeof e=="string"?xa(e):e),mQ=e=>gQ(typeof e=="string"?xa(e):e),CQ=e=>String(new TypeError(e).stack||e).split(`
`).slice(0,5).filter(t=>!t.includes("stackTraceWarning")).join(`
`),BQ={warn:console.warn};var nK=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],yQ=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Hd(e){let t=e.getUTCFullYear(),r=e.getUTCMonth(),i=e.getUTCDay(),n=e.getUTCDate(),o=e.getUTCHours(),a=e.getUTCMinutes(),s=e.getUTCSeconds(),c=n<10?`0${n}`:`${n}`,A=o<10?`0${o}`:`${o}`,l=a<10?`0${a}`:`${a}`,d=s<10?`0${s}`:`${s}`;return`${nK[i]}, ${c} ${yQ[r]} ${t} ${A}:${l}:${d} GMT`}var Oce=new RegExp(/^(\d{4})-(\d{2})-(\d{2})[tT](\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?[zZ]$/);var oK=new RegExp(/^(\d{4})-(\d{2})-(\d{2})[tT](\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?(([-+]\d{2}\:\d{2})|[zZ])$/),Ld=e=>{if(e==null)return;if(typeof e!="string")throw new TypeError("RFC-3339 date-times must be expressed as strings");let t=oK.exec(e);if(!t)throw new TypeError("Invalid RFC-3339 date-time value");let[r,i,n,o,a,s,c,A,l]=t,d=hQ(EQ(i)),g=uo(n,"month",1,12),u=uo(o,"day",1,31),I=sK(d,g,u,{hours:a,minutes:s,seconds:c,fractionalMilliseconds:A});return l.toUpperCase()!="Z"&&I.setTime(I.getTime()-dK(l)),I},qce=new RegExp(/^(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d{2}) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? GMT$/),Gce=new RegExp(/^(?:Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d{2})-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d{2}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? GMT$/),Hce=new RegExp(/^(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( [1-9]|\d{2}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? (\d{4})$/);var sK=(e,t,r,i)=>{let n=t-1;return cK(e,n,r),new Date(Date.UTC(e,n,r,uo(i.hours,"hour",0,23),uo(i.minutes,"minute",0,59),uo(i.seconds,"seconds",0,60),lK(i.fractionalMilliseconds)))};var Lce=50*365*24*60*60*1e3;var aK=[31,28,31,30,31,30,31,31,30,31,30,31],cK=(e,t,r)=>{let i=aK[t];if(t===1&&AK(e)&&(i=29),r>i)throw new TypeError(`Invalid day for ${yQ[t]} in ${e}: ${r}`)},AK=e=>e%4===0&&(e%100!==0||e%400===0),uo=(e,t,r,i)=>{let n=mQ(EQ(e));if(n<r||n>i)throw new TypeError(`${t} must be between ${r} and ${i}, inclusive`);return n},lK=e=>e==null?0:IQ("0."+e)*1e3,dK=e=>{let t=e[0],r=1;if(t=="+")r=1;else if(t=="-")r=-1;else throw new TypeError(`Offset direction, ${t}, must be "+" or "-"`);let i=Number(e.substring(1,3)),n=Number(e.substring(4,6));return r*(i*60+n)*60*1e3},EQ=e=>{let t=0;for(;t<e.length-1&&e.charAt(t)==="0";)t++;return t===0?e:e.slice(t)};var _r=function(t){return Object.assign(new String(t),{deserializeJSON(){return JSON.parse(String(t))},toString(){return String(t)},toJSON(){return String(t)}})};_r.from=e=>e&&typeof e=="object"&&(e instanceof _r||"deserializeJSON"in e)?e:typeof e=="string"||Object.getPrototypeOf(e)===String.prototype?_r(String(e)):_r(JSON.stringify(e));_r.fromObject=_r.from;var Kd=(e,t,r,i,n,o)=>{if(t!=null&&t[r]!==void 0){let a=i();if(a.length<=0)throw new Error("Empty value provided for input HTTP label: "+r+".");e=e.replace(n,o?a.split("/").map(s=>lo(s)).join("/"):lo(a))}else throw new Error("No value provided for input HTTP label: "+r+".");return e};function fo(e,t){return new Jd(e,t)}var Jd=class{constructor(t,r){this.input=t,this.context=r,this.query={},this.method="",this.headers={},this.path="",this.body=null,this.hostname="",this.resolvePathStack=[]}async build(){let{hostname:t,protocol:r="https",port:i,path:n}=await this.context.endpoint();this.path=n;for(let o of this.resolvePathStack)o(this.path);return new O({protocol:r,hostname:this.hostname||t,port:i,method:this.method,path:this.path,query:this.query,body:this.body,headers:this.headers})}hn(t){return this.hostname=t,this}bp(t){return this.resolvePathStack.push(r=>{this.path=`${r?.endsWith("/")?r.slice(0,-1):r||""}`+t}),this}p(t,r,i,n){return this.resolvePathStack.push(o=>{this.path=Kd(o,this.input,t,r,i,n)}),this}h(t){return this.headers=t,this}q(t){return this.query=t,this}b(t){return this.body=t,this}m(t){return this.method=t,this}};function wQ(e,t,r){e.__smithy_context?e.__smithy_context.features||(e.__smithy_context.features={}):e.__smithy_context={features:{}},e.__smithy_context.features[t]=r}var ka=class{constructor(t){this.authSchemes=new Map;for(let[r,i]of Object.entries(t))i!==void 0&&this.authSchemes.set(r,i)}getIdentityProvider(t){return this.authSchemes.get(t)}};var pK=e=>t=>zd(t)&&t.expiration.getTime()-Date.now()<e;var bQ=pK(3e5),zd=e=>e.expiration!==void 0,SQ=(e,t,r)=>{if(e===void 0)return;let i=typeof e!="function"?async()=>Promise.resolve(e):e,n,o,a,s=!1,c=async A=>{o||(o=i(A));try{n=await o,a=!0,s=!1}finally{o=void 0}return n};return t===void 0?async A=>((!a||A?.forceRefresh)&&(n=await c(A)),n):async A=>((!a||A?.forceRefresh)&&(n=await c(A)),s?n:r(n)?(t(n)&&await c(A),n):(s=!0,n))};var xQ=(e,t,r)=>{let i,n,o,a=!1,s=async()=>{n||(n=e());try{i=await n,o=!0,a=!1}finally{n=void 0}return i};return t===void 0?async c=>((!o||c?.forceRefresh)&&(i=await s()),i):async c=>((!o||c?.forceRefresh)&&(i=await s()),a?i:r&&!r(i)?(a=!0,i):(t(i)&&await s(),i))};var kQ=e=>(e.sigv4aSigningRegionSet=sr(e.sigv4aSigningRegionSet),e);var DQ="X-Amz-Algorithm",vQ="X-Amz-Credential",Yd="X-Amz-Date",FQ="X-Amz-SignedHeaders",RQ="X-Amz-Expires",Wd="X-Amz-Signature",jd="X-Amz-Security-Token";var Xd="authorization",Zd=Yd.toLowerCase(),hK="date",TQ=[Xd,Zd,hK],_Q=Wd.toLowerCase(),Io="x-amz-content-sha256",MQ=jd.toLowerCase();var NQ={authorization:!0,"cache-control":!0,connection:!0,expect:!0,from:!0,"keep-alive":!0,"max-forwards":!0,pragma:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,"x-amzn-trace-id":!0},PQ=/^proxy-/,UQ=/^sec-/;var Da="AWS4-HMAC-SHA256";var OQ="AWS4-HMAC-SHA256-PAYLOAD",qQ="UNSIGNED-PAYLOAD",GQ=50,$d="aws4_request",HQ=3600*24*7;var va={},eg=[],Fa=(e,t,r)=>`${e}/${t}/${r}/${$d}`,KQ=async(e,t,r,i,n)=>{let o=await LQ(e,t.secretAccessKey,t.accessKeyId),a=`${r}:${i}:${n}:${ue(o)}:${t.sessionToken}`;if(a in va)return va[a];for(eg.push(a);eg.length>GQ;)delete va[eg.shift()];let s=`AWS4${t.secretAccessKey}`;for(let c of[r,i,n,$d])s=await LQ(e,s,c);return va[a]=s};var LQ=(e,t,r)=>{let i=new e(t);return i.update(Dt(r)),i.digest()};var Ra=({headers:e},t,r)=>{let i={};for(let n of Object.keys(e).sort()){if(e[n]==null)continue;let o=n.toLowerCase();(o in NQ||t?.has(o)||PQ.test(o)||UQ.test(o))&&(!r||r&&!r.has(o))||(i[o]=e[n].trim().replace(/\s+/g," "))}return i};var Ta=e=>typeof ArrayBuffer=="function"&&e instanceof ArrayBuffer||Object.prototype.toString.call(e)==="[object ArrayBuffer]";var po=async({headers:e,body:t},r)=>{for(let i of Object.keys(e))if(i.toLowerCase()===Io)return e[i];if(t==null)return"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855";if(typeof t=="string"||ArrayBuffer.isView(t)||Ta(t)){let i=new r;return i.update(Dt(t)),ue(await i.digest())}return qQ};var _a=class{format(t){let r=[];for(let o of Object.keys(t)){let a=At(o);r.push(Uint8Array.from([a.byteLength]),a,this.formatHeaderValue(t[o]))}let i=new Uint8Array(r.reduce((o,a)=>o+a.byteLength,0)),n=0;for(let o of r)i.set(o,n),n+=o.byteLength;return i}formatHeaderValue(t){switch(t.type){case"boolean":return Uint8Array.from([t.value?0:1]);case"byte":return Uint8Array.from([2,t.value]);case"short":let r=new DataView(new ArrayBuffer(3));return r.setUint8(0,3),r.setInt16(1,t.value,!1),new Uint8Array(r.buffer);case"integer":let i=new DataView(new ArrayBuffer(5));return i.setUint8(0,4),i.setInt32(1,t.value,!1),new Uint8Array(i.buffer);case"long":let n=new Uint8Array(9);return n[0]=5,n.set(t.value.bytes,1),n;case"binary":let o=new DataView(new ArrayBuffer(3+t.value.byteLength));o.setUint8(0,6),o.setUint16(1,t.value.byteLength,!1);let a=new Uint8Array(o.buffer);return a.set(t.value,3),a;case"string":let s=At(t.value),c=new DataView(new ArrayBuffer(3+s.byteLength));c.setUint8(0,7),c.setUint16(1,s.byteLength,!1);let A=new Uint8Array(c.buffer);return A.set(s,3),A;case"timestamp":let l=new Uint8Array(9);return l[0]=8,l.set(tg.fromNumber(t.value.valueOf()).bytes,1),l;case"uuid":if(!mK.test(t.value))throw new Error(`Invalid UUID received: ${t.value}`);let d=new Uint8Array(17);return d[0]=9,d.set(wa(t.value.replace(/\-/g,"")),1),d}}},JQ;(function(e){e[e.boolTrue=0]="boolTrue",e[e.boolFalse=1]="boolFalse",e[e.byte=2]="byte",e[e.short=3]="short",e[e.integer=4]="integer",e[e.long=5]="long",e[e.byteArray=6]="byteArray",e[e.string=7]="string",e[e.timestamp=8]="timestamp",e[e.uuid=9]="uuid"})(JQ||(JQ={}));var mK=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/,tg=class e{constructor(t){if(this.bytes=t,t.byteLength!==8)throw new Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(t){if(t>9223372036854776e3||t<-9223372036854776e3)throw new Error(`${t} is too large (or, if negative, too small) to represent as an Int64`);let r=new Uint8Array(8);for(let i=7,n=Math.abs(Math.round(t));i>-1&&n>0;i--,n/=256)r[i]=n;return t<0&&zQ(r),new e(r)}valueOf(){let t=this.bytes.slice(0),r=t[0]&128;return r&&zQ(t),parseInt(ue(t),16)*(r?-1:1)}toString(){return String(this.valueOf())}};function zQ(e){for(let t=0;t<8;t++)e[t]^=255;for(let t=7;t>-1&&(e[t]++,e[t]===0);t--);}var rg=(e,t)=>{e=e.toLowerCase();for(let r of Object.keys(t))if(e===r.toLowerCase())return!0;return!1};var ig=(e,t={})=>{let{headers:r,query:i={}}=O.clone(e);for(let n of Object.keys(r)){let o=n.toLowerCase();(o.slice(0,6)==="x-amz-"&&!t.unhoistableHeaders?.has(o)||t.hoistableHeaders?.has(o))&&(i[n]=r[n],delete r[n])}return{...e,headers:r,query:i}};var Ma=e=>{e=O.clone(e);for(let t of Object.keys(e.headers))TQ.indexOf(t.toLowerCase())>-1&&delete e.headers[t];return e};var ng=({query:e={}})=>{let t=[],r={};for(let i of Object.keys(e)){if(i.toLowerCase()===_Q)continue;let n=vt(i);t.push(n);let o=e[i];typeof o=="string"?r[n]=`${n}=${vt(o)}`:Array.isArray(o)&&(r[n]=o.slice(0).reduce((a,s)=>a.concat([`${n}=${vt(s)}`]),[]).sort().join("&"))}return t.sort().map(i=>r[i]).filter(i=>i).join("&")};var VQ=e=>CK(e).toISOString().replace(/\.\d{3}Z$/,"Z"),CK=e=>typeof e=="number"?new Date(e*1e3):typeof e=="string"?Number(e)?new Date(Number(e)*1e3):new Date(e):e;var ho=class{constructor({applyChecksum:t,credentials:r,region:i,service:n,sha256:o,uriEscapePath:a=!0}){this.service=n,this.sha256=o,this.uriEscapePath=a,this.applyChecksum=typeof t=="boolean"?t:!0,this.regionProvider=Oe(i),this.credentialProvider=Oe(r)}createCanonicalRequest(t,r,i){let n=Object.keys(r).sort();return`${t.method}
${this.getCanonicalPath(t)}
${ng(t)}
${n.map(o=>`${o}:${r[o]}`).join(`
`)}

${n.join(";")}
${i}`}async createStringToSign(t,r,i,n){let o=new this.sha256;o.update(Dt(i));let a=await o.digest();return`${n}
${t}
${r}
${ue(a)}`}getCanonicalPath({path:t}){if(this.uriEscapePath){let r=[];for(let o of t.split("/"))o?.length!==0&&o!=="."&&(o===".."?r.pop():r.push(o));let i=`${t?.startsWith("/")?"/":""}${r.join("/")}${r.length>0&&t?.endsWith("/")?"/":""}`;return vt(i).replace(/%2F/g,"/")}return t}validateResolvedCredentials(t){if(typeof t!="object"||typeof t.accessKeyId!="string"||typeof t.secretAccessKey!="string")throw new Error("Resolved credential object is not valid")}formatDate(t){let r=VQ(t).replace(/[\-:]/g,"");return{longDate:r,shortDate:r.slice(0,8)}}getCanonicalHeaderList(t){return Object.keys(t).sort().join(";")}};var ci=class extends ho{constructor({applyChecksum:t,credentials:r,region:i,service:n,sha256:o,uriEscapePath:a=!0}){super({applyChecksum:t,credentials:r,region:i,service:n,sha256:o,uriEscapePath:a}),this.headerFormatter=new _a}async presign(t,r={}){let{signingDate:i=new Date,expiresIn:n=3600,unsignableHeaders:o,unhoistableHeaders:a,signableHeaders:s,hoistableHeaders:c,signingRegion:A,signingService:l}=r,d=await this.credentialProvider();this.validateResolvedCredentials(d);let g=A??await this.regionProvider(),{longDate:u,shortDate:I}=this.formatDate(i);if(n>HQ)return Promise.reject("Signature version 4 presigned URLs must have an expiration date less than one week in the future");let C=Fa(I,g,l??this.service),B=ig(Ma(t),{unhoistableHeaders:a,hoistableHeaders:c});d.sessionToken&&(B.query[jd]=d.sessionToken),B.query[DQ]=Da,B.query[vQ]=`${d.accessKeyId}/${C}`,B.query[Yd]=u,B.query[RQ]=n.toString(10);let h=Ra(B,o,s);return B.query[FQ]=this.getCanonicalHeaderList(h),B.query[Wd]=await this.getSignature(u,C,this.getSigningKey(d,g,I,l),this.createCanonicalRequest(B,h,await po(t,this.sha256))),B}async sign(t,r){return typeof t=="string"?this.signString(t,r):t.headers&&t.payload?this.signEvent(t,r):t.message?this.signMessage(t,r):this.signRequest(t,r)}async signEvent({headers:t,payload:r},{signingDate:i=new Date,priorSignature:n,signingRegion:o,signingService:a}){let s=o??await this.regionProvider(),{shortDate:c,longDate:A}=this.formatDate(i),l=Fa(c,s,a??this.service),d=await po({headers:{},body:r},this.sha256),g=new this.sha256;g.update(t);let u=ue(await g.digest()),I=[OQ,A,l,n,u,d].join(`
`);return this.signString(I,{signingDate:i,signingRegion:s,signingService:a})}async signMessage(t,{signingDate:r=new Date,signingRegion:i,signingService:n}){return this.signEvent({headers:this.headerFormatter.format(t.message.headers),payload:t.message.body},{signingDate:r,signingRegion:i,signingService:n,priorSignature:t.priorSignature}).then(a=>({message:t.message,signature:a}))}async signString(t,{signingDate:r=new Date,signingRegion:i,signingService:n}={}){let o=await this.credentialProvider();this.validateResolvedCredentials(o);let a=i??await this.regionProvider(),{shortDate:s}=this.formatDate(r),c=new this.sha256(await this.getSigningKey(o,a,s,n));return c.update(Dt(t)),ue(await c.digest())}async signRequest(t,{signingDate:r=new Date,signableHeaders:i,unsignableHeaders:n,signingRegion:o,signingService:a}={}){let s=await this.credentialProvider();this.validateResolvedCredentials(s);let c=o??await this.regionProvider(),A=Ma(t),{longDate:l,shortDate:d}=this.formatDate(r),g=Fa(d,c,a??this.service);A.headers[Zd]=l,s.sessionToken&&(A.headers[MQ]=s.sessionToken);let u=await po(A,this.sha256);!rg(Io,A.headers)&&this.applyChecksum&&(A.headers[Io]=u);let I=Ra(A,n,i),C=await this.getSignature(l,g,this.getSigningKey(s,c,d,a),this.createCanonicalRequest(A,I,u));return A.headers[Xd]=`${Da} Credential=${s.accessKeyId}/${g}, SignedHeaders=${this.getCanonicalHeaderList(I)}, Signature=${C}`,A}async getSignature(t,r,i,n){let o=await this.createStringToSign(t,r,n,Da),a=new this.sha256(await i);return a.update(Dt(o)),ue(await a.digest())}getSigningKey(t,r,i,n){return KQ(this.sha256,t,i,r,n||this.service)}};var YQ=e=>{let t=!1,r;e.credentials&&(t=!0,r=SQ(e.credentials,bQ,zd)),r||(e.credentialDefaultProvider?r=sr(e.credentialDefaultProvider(Object.assign({},e,{parentClientConfig:e}))):r=async()=>{throw new Error("`credentials` is missing")});let i=async()=>r({callerClientConfig:e}),{signingEscapePath:n=!0,systemClockOffset:o=e.systemClockOffset||0,sha256:a}=e,s;return e.signer?s=sr(e.signer):e.regionInfoProvider?s=()=>sr(e.region)().then(async c=>[await e.regionInfoProvider(c,{useFipsEndpoint:await e.useFipsEndpoint(),useDualstackEndpoint:await e.useDualstackEndpoint()})||{},c]).then(([c,A])=>{let{signingRegion:l,signingService:d}=c;e.signingRegion=e.signingRegion||l||A,e.signingName=e.signingName||d||e.serviceId;let g={...e,credentials:i,region:e.signingRegion,service:e.signingName,sha256:a,uriEscapePath:n},u=e.signerConstructor||ci;return new u(g)}):s=async c=>{c=Object.assign({},{name:"sigv4",signingName:e.signingName||e.defaultSigningName,signingRegion:await sr(e.region)(),properties:{}},c);let A=c.signingRegion,l=c.signingName;e.signingRegion=e.signingRegion||A,e.signingName=e.signingName||l||e.serviceId;let d={...e,credentials:i,region:e.signingRegion,service:e.signingName,sha256:a,uriEscapePath:n},g=e.signerConstructor||ci;return new g(d)},{...e,systemClockOffset:o,signingEscapePath:n,credentials:t?async()=>i().then(c=>KE(c,"CREDENTIALS_CODE","e")):i,signer:s}};var Ai=(e,t)=>{let r=[];if(e&&r.push(e),t)for(let i of t)r.push(i);return r},Mr=(e,t)=>`${e||"anonymous"}${t&&t.length>0?` (a.k.a. ${t.join(",")})`:""}`,An=()=>{let e=[],t=[],r=!1,i=new Set,n=d=>d.sort((g,u)=>WQ[u.step]-WQ[g.step]||jQ[u.priority||"normal"]-jQ[g.priority||"normal"]),o=d=>{let g=!1,u=I=>{let C=Ai(I.name,I.aliases);if(C.includes(d)){g=!0;for(let B of C)i.delete(B);return!1}return!0};return e=e.filter(u),t=t.filter(u),g},a=d=>{let g=!1,u=I=>{if(I.middleware===d){g=!0;for(let C of Ai(I.name,I.aliases))i.delete(C);return!1}return!0};return e=e.filter(u),t=t.filter(u),g},s=d=>(e.forEach(g=>{d.add(g.middleware,{...g})}),t.forEach(g=>{d.addRelativeTo(g.middleware,{...g})}),d.identifyOnResolve?.(l.identifyOnResolve()),d),c=d=>{let g=[];return d.before.forEach(u=>{u.before.length===0&&u.after.length===0?g.push(u):g.push(...c(u))}),g.push(d),d.after.reverse().forEach(u=>{u.before.length===0&&u.after.length===0?g.push(u):g.push(...c(u))}),g},A=(d=!1)=>{let g=[],u=[],I={};return e.forEach(B=>{let h={...B,before:[],after:[]};for(let Q of Ai(h.name,h.aliases))I[Q]=h;g.push(h)}),t.forEach(B=>{let h={...B,before:[],after:[]};for(let Q of Ai(h.name,h.aliases))I[Q]=h;u.push(h)}),u.forEach(B=>{if(B.toMiddleware){let h=I[B.toMiddleware];if(h===void 0){if(d)return;throw new Error(`${B.toMiddleware} is not found when adding ${Mr(B.name,B.aliases)} middleware ${B.relation} ${B.toMiddleware}`)}B.relation==="after"&&h.after.push(B),B.relation==="before"&&h.before.push(B)}}),n(g).map(c).reduce((B,h)=>(B.push(...h),B),[])},l={add:(d,g={})=>{let{name:u,override:I,aliases:C}=g,B={step:"initialize",priority:"normal",middleware:d,...g},h=Ai(u,C);if(h.length>0){if(h.some(Q=>i.has(Q))){if(!I)throw new Error(`Duplicate middleware name '${Mr(u,C)}'`);for(let Q of h){let D=e.findIndex(x=>x.name===Q||x.aliases?.some(w=>w===Q));if(D===-1)continue;let E=e[D];if(E.step!==B.step||B.priority!==E.priority)throw new Error(`"${Mr(E.name,E.aliases)}" middleware with ${E.priority} priority in ${E.step} step cannot be overridden by "${Mr(u,C)}" middleware with ${B.priority} priority in ${B.step} step.`);e.splice(D,1)}}for(let Q of h)i.add(Q)}e.push(B)},addRelativeTo:(d,g)=>{let{name:u,override:I,aliases:C}=g,B={middleware:d,...g},h=Ai(u,C);if(h.length>0){if(h.some(Q=>i.has(Q))){if(!I)throw new Error(`Duplicate middleware name '${Mr(u,C)}'`);for(let Q of h){let D=t.findIndex(x=>x.name===Q||x.aliases?.some(w=>w===Q));if(D===-1)continue;let E=t[D];if(E.toMiddleware!==B.toMiddleware||E.relation!==B.relation)throw new Error(`"${Mr(E.name,E.aliases)}" middleware ${E.relation} "${E.toMiddleware}" middleware cannot be overridden by "${Mr(u,C)}" middleware ${B.relation} "${B.toMiddleware}" middleware.`);t.splice(D,1)}}for(let Q of h)i.add(Q)}t.push(B)},clone:()=>s(An()),use:d=>{d.applyToStack(l)},remove:d=>typeof d=="string"?o(d):a(d),removeByTag:d=>{let g=!1,u=I=>{let{tags:C,name:B,aliases:h}=I;if(C&&C.includes(d)){let Q=Ai(B,h);for(let D of Q)i.delete(D);return g=!0,!1}return!0};return e=e.filter(u),t=t.filter(u),g},concat:d=>{let g=s(An());return g.use(d),g.identifyOnResolve(r||g.identifyOnResolve()||(d.identifyOnResolve?.()??!1)),g},applyToStack:s,identify:()=>A(!0).map(d=>{let g=d.step??d.relation+" "+d.toMiddleware;return Mr(d.name,d.aliases)+" - "+g}),identifyOnResolve(d){return typeof d=="boolean"&&(r=d),r},resolve:(d,g)=>{for(let u of A().map(I=>I.middleware).reverse())d=u(d,g);return d}};return l},WQ={initialize:5,serialize:4,build:3,finalizeRequest:2,deserialize:1},jQ={high:3,normal:2,low:1};var Na=class{constructor(t){this.config=t,this.middlewareStack=An()}send(t,r,i){let n=typeof r!="function"?r:void 0,o=typeof r=="function"?r:i,a=n===void 0&&this.config.cacheMiddleware===!0,s;if(a){this.handlers||(this.handlers=new WeakMap);let c=this.handlers;c.has(t.constructor)?s=c.get(t.constructor):(s=t.resolveMiddleware(this.middlewareStack,this.config,n),c.set(t.constructor,s))}else delete this.handlers,s=t.resolveMiddleware(this.middlewareStack,this.config,n);if(o)s(t).then(c=>o(null,c.output),c=>o(c)).catch(()=>{});else return s(t).then(c=>c.output)}destroy(){this.config?.requestHandler?.destroy?.(),delete this.handlers}};var gr=class{constructor(){this.middlewareStack=An()}static classBuilder(){return new og}resolveMiddlewareWithContext(t,r,i,{middlewareFn:n,clientName:o,commandName:a,inputFilterSensitiveLog:s,outputFilterSensitiveLog:c,smithyContext:A,additionalContext:l,CommandCtor:d}){for(let B of n.bind(this)(d,t,r,i))this.middlewareStack.use(B);let g=t.concat(this.middlewareStack),{logger:u}=r,I={logger:u,clientName:o,commandName:a,inputFilterSensitiveLog:s,outputFilterSensitiveLog:c,[nn]:{commandInstance:this,...A},...l},{requestHandler:C}=r;return g.resolve(B=>C.handle(B.request,i||{}),I)}},og=class{constructor(){this._init=()=>{},this._ep={},this._middlewareFn=()=>[],this._commandName="",this._clientName="",this._additionalContext={},this._smithyContext={},this._inputFilterSensitiveLog=t=>t,this._outputFilterSensitiveLog=t=>t,this._serializer=null,this._deserializer=null}init(t){this._init=t}ep(t){return this._ep=t,this}m(t){return this._middlewareFn=t,this}s(t,r,i={}){return this._smithyContext={service:t,operation:r,...i},this}c(t={}){return this._additionalContext=t,this}n(t,r){return this._clientName=t,this._commandName=r,this}f(t=i=>i,r=i=>i){return this._inputFilterSensitiveLog=t,this._outputFilterSensitiveLog=r,this}ser(t){return this._serializer=t,this}de(t){return this._deserializer=t,this}sc(t){return this._operationSchema=t,this._smithyContext.operationSchema=t,this}build(){let t=this,r;return r=class extends gr{static getEndpointParameterInstructions(){return t._ep}constructor(...[i]){super(),this.serialize=t._serializer,this.deserialize=t._deserializer,this.input=i??{},t._init(this),this.schema=t._operationSchema}resolveMiddleware(i,n,o){return this.resolveMiddlewareWithContext(i,n,o,{CommandCtor:r,middlewareFn:t._middlewareFn,clientName:t._clientName,commandName:t._commandName,inputFilterSensitiveLog:t._inputFilterSensitiveLog,outputFilterSensitiveLog:t._outputFilterSensitiveLog,smithyContext:t._smithyContext,additionalContext:t._additionalContext})}}}};var tt="***SensitiveInformation***";var Pa=class e extends Error{constructor(t){super(t.message),Object.setPrototypeOf(this,Object.getPrototypeOf(this).constructor.prototype),this.name=t.name,this.$fault=t.$fault,this.$metadata=t.$metadata}static isInstance(t){if(!t)return!1;let r=t;return e.prototype.isPrototypeOf(r)||!!r.$fault&&!!r.$metadata&&(r.$fault==="client"||r.$fault==="server")}static[Symbol.hasInstance](t){if(!t)return!1;let r=t;return this===e?e.isInstance(t):e.isInstance(t)?r.name&&this.name?this.prototype.isPrototypeOf(t)||r.name===this.name:this.prototype.isPrototypeOf(t):!1}},Le=(e,t={})=>{Object.entries(t).filter(([,i])=>i!==void 0).forEach(([i,n])=>{(e[i]==null||e[i]==="")&&(e[i]=n)});let r=e.message||e.Message||"UnknownError";return e.message=r,delete e.Message,e};var BK=({output:e,parsedBody:t,exceptionCtor:r,errorCode:i})=>{let n=yK(e),o=n.httpStatusCode?n.httpStatusCode+"":void 0,a=new r({name:t?.code||t?.Code||i||o||"UnknownError",$fault:"client",$metadata:n});throw Le(a,t)},XQ=e=>({output:t,parsedBody:r,errorCode:i})=>{BK({output:t,parsedBody:r,exceptionCtor:e,errorCode:i})},yK=e=>({httpStatusCode:e.statusCode,requestId:e.headers["x-amzn-requestid"]??e.headers["x-amzn-request-id"]??e.headers["x-amz-request-id"],extendedRequestId:e.headers["x-amz-id-2"],cfId:e.headers["x-amz-cf-id"]});var ZQ=e=>{switch(e){case"standard":return{retryMode:"standard",connectionTimeout:3100};case"in-region":return{retryMode:"standard",connectionTimeout:1100};case"cross-region":return{retryMode:"standard",connectionTimeout:3100};case"mobile":return{retryMode:"standard",connectionTimeout:3e4};default:return{}}};var $Q=e=>{let t=[];for(let r in rn){let i=rn[r];e[i]!==void 0&&t.push({algorithmId:()=>i,checksumConstructor:()=>e[i]})}return{addChecksumAlgorithm(r){t.push(r)},checksumAlgorithms(){return t}}},ew=e=>{let t={};return e.checksumAlgorithms().forEach(r=>{t[r.algorithmId()]=r.checksumConstructor()}),t};var tw=e=>({setRetryStrategy(t){e.retryStrategy=t},retryStrategy(){return e.retryStrategy}}),rw=e=>{let t={};return t.retryStrategy=e.retryStrategy(),t};var iw=e=>Object.assign($Q(e),tw(e));var nw=e=>Object.assign(ew(e),rw(e));var sg=e=>{let t="#text";for(let r in e)e.hasOwnProperty(r)&&e[r][t]!==void 0?e[r]=e[r][t]:typeof e[r]=="object"&&e[r]!==null&&(e[r]=sg(e[r]));return e};var Ft=e=>e!=null;var Nr=class{trace(){}debug(){}info(){}warn(){}error(){}};function de(e,t,r){let i,n,o;if(typeof t>"u"&&typeof r>"u")i={},o=e;else{if(i=e,typeof t=="function")return n=t,o=r,EK(i,n,o);o=t}for(let a of Object.keys(o)){if(!Array.isArray(o[a])){i[a]=o[a];continue}QK(i,null,o,a)}return i}var EK=(e,t,r)=>de(e,Object.entries(r).reduce((i,[n,o])=>(Array.isArray(o)?i[n]=o:typeof o=="function"?i[n]=[t,o()]:i[n]=[t,o],i),{})),QK=(e,t,r,i)=>{if(t!==null){let a=r[i];typeof a=="function"&&(a=[,a]);let[s=wK,c=bK,A=i]=a;(typeof s=="function"&&s(t[A])||typeof s!="function"&&s)&&(e[i]=c(t[A]));return}let[n,o]=r[i];if(typeof o=="function"){let a,s=n===void 0&&(a=o())!=null,c=typeof n=="function"&&!!n(void 0)||typeof n!="function"&&!!n;s?e[i]=a:c&&(e[i]=o())}else{let a=n===void 0&&o!=null,s=typeof n=="function"&&!!n(o)||typeof n!="function"&&!!n;(a||s)&&(e[i]=o)}},wK=e=>e!=null,bK=e=>e;var ow=e=>e.toISOString().replace(".000Z","Z");var sw=(e,t)=>lr(e,t).then(r=>t.utf8Encoder(r));var Ow=G(Uw());var Ig=(e,t)=>sw(e,t).then(r=>{if(r.length){let i=new Ow.XMLParser({attributeNamePrefix:"",htmlEntities:!0,ignoreAttributes:!1,ignoreDeclaration:!0,parseTagValue:!1,trimValues:!1,tagValueProcessor:(c,A)=>A.trim()===""&&A.includes(`
`)?"":void 0});i.addEntity("#xD","\r"),i.addEntity("#10",`
`);let n;try{n=i.parse(r,!0)}catch(c){throw c&&typeof c=="object"&&Object.defineProperty(c,"$responseBodyText",{value:r}),c}let o="#text",a=Object.keys(n)[0],s=n[a];return s[o]&&(s[a]=s[o],delete s[o]),sg(s)}return{}}),qw=async(e,t)=>{let r=await Ig(e,t);return r.Error&&(r.Error.message=r.Error.message??r.Error.Message),r},Gw=(e,t)=>{if(t?.Error?.Code!==void 0)return t.Error.Code;if(t?.Code!==void 0)return t.Code;if(e.statusCode==404)return"NotFound"};var Bo=[ie.CRC32,ie.CRC32C,ie.SHA1,ie.SHA256],Hw=[ie.SHA256,ie.SHA1,ie.CRC32,ie.CRC32C];var Lw=(e,{requestChecksumRequired:t,requestAlgorithmMember:r},i)=>{let n=i?LE:HE;if(!r||!e[r])return t?n:void 0;let o=e[r];if(!Bo.includes(o))throw new Error(`The checksum algorithm "${o}" is not supported by the client. Select one of ${Bo}.`);return o};var ln=e=>e===ie.MD5?"content-md5":`x-amz-checksum-${e.toLowerCase()}`;var Kw=(e,t)=>{let r=e.toLowerCase();for(let i of Object.keys(t))if(r===i.toLowerCase())return!0;return!1};var Jw=(e,t)=>{let r=e.toLowerCase();for(let i of Object.keys(t))if(i.toLowerCase().startsWith(r))return!0;return!1};var dn=e=>e!==void 0&&typeof e!="string"&&!ArrayBuffer.isView(e)&&!Ta(e);var pg=e=>new TextEncoder().encode(e);var _2=typeof Buffer<"u"&&Buffer.from?function(e){return Buffer.from(e,"utf8")}:pg;function it(e){return e instanceof Uint8Array?e:typeof e=="string"?_2(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}function Vt(e){return typeof e=="string"?e.length===0:e.byteLength===0}function yo(e){return new Uint8Array([(e&4278190080)>>24,(e&16711680)>>16,(e&65280)>>8,e&255])}function Eo(e){if(!Uint32Array.from){for(var t=new Uint32Array(e.length),r=0;r<e.length;)t[r]=e[r],r+=1;return t}return Uint32Array.from(e)}var mg=(function(){function e(){this.crc32c=new hg}return e.prototype.update=function(t){Vt(t)||this.crc32c.update(it(t))},e.prototype.digest=function(){return Xi(this,void 0,void 0,function(){return Zi(this,function(t){return[2,yo(this.crc32c.digest())]})})},e.prototype.reset=function(){this.crc32c=new hg},e})();var hg=(function(){function e(){this.checksum=4294967295}return e.prototype.update=function(t){var r,i;try{for(var n=Ia(t),o=n.next();!o.done;o=n.next()){var a=o.value;this.checksum=this.checksum>>>8^N2[(this.checksum^a)&255]}}catch(s){r={error:s}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(r)throw r.error}}return this},e.prototype.digest=function(){return(this.checksum^4294967295)>>>0},e})();var M2=[0,4067132163,3778769143,324072436,3348797215,904991772,648144872,3570033899,2329499855,2024987596,1809983544,2575936315,1296289744,3207089363,2893594407,1578318884,274646895,3795141740,4049975192,51262619,3619967088,632279923,922689671,3298075524,2592579488,1760304291,2075979607,2312596564,1562183871,2943781820,3156637768,1313733451,549293790,3537243613,3246849577,871202090,3878099393,357341890,102525238,4101499445,2858735121,1477399826,1264559846,3107202533,1845379342,2677391885,2361733625,2125378298,820201905,3263744690,3520608582,598981189,4151959214,85089709,373468761,3827903834,3124367742,1213305469,1526817161,2842354314,2107672161,2412447074,2627466902,1861252501,1098587580,3004210879,2688576843,1378610760,2262928035,1955203488,1742404180,2511436119,3416409459,969524848,714683780,3639785095,205050476,4266873199,3976438427,526918040,1361435347,2739821008,2954799652,1114974503,2529119692,1691668175,2005155131,2247081528,3690758684,697762079,986182379,3366744552,476452099,3993867776,4250756596,255256311,1640403810,2477592673,2164122517,1922457750,2791048317,1412925310,1197962378,3037525897,3944729517,427051182,170179418,4165941337,746937522,3740196785,3451792453,1070968646,1905808397,2213795598,2426610938,1657317369,3053634322,1147748369,1463399397,2773627110,4215344322,153784257,444234805,3893493558,1021025245,3467647198,3722505002,797665321,2197175160,1889384571,1674398607,2443626636,1164749927,3070701412,2757221520,1446797203,137323447,4198817972,3910406976,461344835,3484808360,1037989803,781091935,3705997148,2460548119,1623424788,1939049696,2180517859,1429367560,2807687179,3020495871,1180866812,410100952,3927582683,4182430767,186734380,3756733383,763408580,1053836080,3434856499,2722870694,1344288421,1131464017,2971354706,1708204729,2545590714,2229949006,1988219213,680717673,3673779818,3383336350,1002577565,4010310262,493091189,238226049,4233660802,2987750089,1082061258,1395524158,2705686845,1972364758,2279892693,2494862625,1725896226,952904198,3399985413,3656866545,731699698,4283874585,222117402,510512622,3959836397,3280807620,837199303,582374963,3504198960,68661723,4135334616,3844915500,390545967,1230274059,3141532936,2825850620,1510247935,2395924756,2091215383,1878366691,2644384480,3553878443,565732008,854102364,3229815391,340358836,3861050807,4117890627,119113024,1493875044,2875275879,3090270611,1247431312,2660249211,1828433272,2141937292,2378227087,3811616794,291187481,34330861,4032846830,615137029,3603020806,3314634738,939183345,1776939221,2609017814,2295496738,2058945313,2926798794,1545135305,1330124605,3173225534,4084100981,17165430,307568514,3762199681,888469610,3332340585,3587147933,665062302,2042050490,2346497209,2559330125,1793573966,3190661285,1279665062,1595330642,2910671697],N2=Eo(M2);var Cg=(function(){function e(){this.crc32=new di}return e.prototype.update=function(t){Vt(t)||this.crc32.update(it(t))},e.prototype.digest=function(){return Xi(this,void 0,void 0,function(){return Zi(this,function(t){return[2,yo(this.crc32.digest())]})})},e.prototype.reset=function(){this.crc32=new di},e})();var di=(function(){function e(){this.checksum=4294967295}return e.prototype.update=function(t){var r,i;try{for(var n=Ia(t),o=n.next();!o.done;o=n.next()){var a=o.value;this.checksum=this.checksum>>>8^U2[(this.checksum^a)&255]}}catch(s){r={error:s}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(r)throw r.error}}return this},e.prototype.digest=function(){return(this.checksum^4294967295)>>>0},e})();var P2=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],U2=Eo(P2);var zw=()=>Cg;var Oa=(e,t)=>{switch(e){case ie.MD5:return t.md5;case ie.CRC32:return zw();case ie.CRC32C:return mg;case ie.SHA1:return t.sha1;case ie.SHA256:return t.sha256;default:throw new Error(`Unsupported checksum algorithm: ${e}`)}};var qa=(e,t)=>{let r=new e;return r.update(Dt(t||"")),r.digest()};var Vw={name:"flexibleChecksumsMiddleware",step:"build",tags:["BODY_CHECKSUM"],override:!0},Yw=(e,t)=>(r,i)=>async n=>{if(!O.isInstance(n.request)||Jw("x-amz-checksum-",n.request.headers))return r(n);let{request:o,input:a}=n,{body:s,headers:c}=o,{base64Encoder:A,streamHasher:l}=e,{requestChecksumRequired:d,requestAlgorithmMember:g}=t,u=Lw(a,{requestChecksumRequired:d,requestAlgorithmMember:g?.name},!!i.isS3ExpressBucket),I=s,C=c;if(u){switch(u){case ie.CRC32:ve(i,"FLEXIBLE_CHECKSUMS_REQ_CRC32","U");break;case ie.CRC32C:ve(i,"FLEXIBLE_CHECKSUMS_REQ_CRC32C","V");break;case ie.SHA1:ve(i,"FLEXIBLE_CHECKSUMS_REQ_SHA1","X");break;case ie.SHA256:ve(i,"FLEXIBLE_CHECKSUMS_REQ_SHA256","Y");break}let h=ln(u),Q=Oa(u,e);if(dn(s)){let{getAwsChunkedEncodingStream:D,bodyLengthChecker:E}=e;I=D(s,{base64Encoder:A,bodyLengthChecker:E,checksumLocationName:h,checksumAlgorithmFn:Q,streamHasher:l}),C={...c,"content-encoding":c["content-encoding"]?`${c["content-encoding"]},aws-chunked`:"aws-chunked","transfer-encoding":"chunked","x-amz-decoded-content-length":c["content-length"],"x-amz-content-sha256":"STREAMING-UNSIGNED-PAYLOAD-TRAILER","x-amz-trailer":h},delete C["content-length"]}else if(!Kw(h,c)){let D=await qa(Q,s);C={...c,[h]:A(D)}}}return await r({...n,request:{...o,headers:C,body:I}})};var Ga=(e=[])=>{let t=[];for(let r of Hw)!e.includes(r)||!Bo.includes(r)||t.push(r);return t};var Ww=e=>{let t=e.lastIndexOf("-");if(t!==-1){let r=e.slice(t+1);if(!r.startsWith("0")){let i=parseInt(r,10);if(!isNaN(i)&&i>=1&&i<=1e4)return!0}}return!1};function Bg(e){return new Blob([e]).stream()}var jw=async(e,{checksumAlgorithmFn:t,base64Encoder:r})=>r(await qa(t,e));var Xw=async(e,{config:t,responseAlgorithms:r})=>{let i=Ga(r),{body:n,headers:o}=e;for(let a of i){let s=ln(a),c=o[s];if(c){let A=Oa(a,t),{base64Encoder:l}=t;if(dn(n)){e.body=tQ({expectedChecksum:c,checksumSourceLocation:s,checksum:new A,source:n,base64Encoder:l});return}let d=await jw(n,{checksumAlgorithmFn:A,base64Encoder:l});if(d===c)break;throw new Error(`Checksum mismatch: expected "${d}" but received "${c}" in response header "${s}".`)}}};var Zw={name:"flexibleChecksumsResponseMiddleware",toMiddleware:"deserializerMiddleware",relation:"after",tags:["BODY_CHECKSUM"],override:!0},$w=(e,t)=>(r,i)=>async n=>{if(!O.isInstance(n.request))return r(n);let o=n.input,a=await r(n),s=a.response,c,{requestValidationModeMember:A,responseAlgorithms:l}=t;if(A&&o[A]==="ENABLED"){let{clientName:d,commandName:g}=i;if(d==="S3Client"&&g==="GetObjectCommand"&&Ga(l).every(C=>{let B=ln(C),h=s.headers[B];return!h||Ww(h)}))return a;let I=dn(s.body);I&&(c=await e.streamCollector(s.body),s.body=Bg(c)),await Xw(a.response,{config:e,responseAlgorithms:l}),I&&c&&(s.body=Bg(c))}return a};var Ha=(e,t)=>({applyToStack:r=>{r.add(Yw(e,t),Vw),r.addRelativeTo($w(e,t),Zw)}});var eb=e=>({...e,requestChecksumCalculation:Oe(e.requestChecksumCalculation??vd),responseChecksumValidation:Oe(e.responseChecksumValidation??Fd)});var O2=e=>t=>async r=>{if(!O.isInstance(r.request))return t(r);let{request:i}=r,{handlerProtocol:n=""}=e.requestHandler.metadata||{};if(n.indexOf("h2")>=0&&!i.headers[":authority"])delete i.headers.host,i.headers[":authority"]=i.hostname+(i.port?":"+i.port:"");else if(!i.headers.host){let o=i.hostname;i.port!=null&&(o+=`:${i.port}`),i.headers.host=o}return t(r)},q2={name:"hostHeaderMiddleware",step:"build",priority:"low",tags:["HOST"],override:!0},tb=e=>({applyToStack:t=>{t.add(O2(e),q2)}});var G2=()=>(e,t)=>async r=>{try{let i=await e(r),{clientName:n,commandName:o,logger:a,dynamoDbDocumentClientOptions:s={}}=t,{overrideInputFilterSensitiveLog:c,overrideOutputFilterSensitiveLog:A}=s,l=c??t.inputFilterSensitiveLog,d=A??t.outputFilterSensitiveLog,{$metadata:g,...u}=i.output;return a?.info?.({clientName:n,commandName:o,input:l(r.input),output:d(u),metadata:g}),i}catch(i){let{clientName:n,commandName:o,logger:a,dynamoDbDocumentClientOptions:s={}}=t,{overrideInputFilterSensitiveLog:c}=s,A=c??t.inputFilterSensitiveLog;throw a?.error?.({clientName:n,commandName:o,input:A(r.input),error:i,metadata:i.$metadata}),i}},H2={name:"loggerMiddleware",tags:["LOGGER"],step:"initialize",override:!0},rb=e=>({applyToStack:t=>{t.add(G2(),H2)}});var ib="X-Amzn-Trace-Id",L2="AWS_LAMBDA_FUNCTION_NAME",K2="_X_AMZN_TRACE_ID",J2=e=>t=>async r=>{let{request:i}=r;if(!O.isInstance(i)||e.runtime!=="node"||i.headers.hasOwnProperty(ib))return t(r);let n=process.env[L2],o=process.env[K2],a=s=>typeof s=="string"&&s.length>0;return a(n)&&a(o)&&(i.headers[ib]=o),t({...r,request:i})},z2={step:"build",tags:["RECURSION_DETECTION"],name:"recursionDetectionMiddleware",override:!0,priority:"low"},nb=e=>({applyToStack:t=>{t.add(J2(e),z2)}});var V2="content-length";function Y2(){return(e,t)=>async r=>{let{request:i}=r;return O.isInstance(i)&&(V2 in i.headers||typeof t?.logger?.warn=="function"&&!(t.logger instanceof Nr)&&t.logger.warn("Are you using a Stream of unknown length as the Body of a PutObject request? Consider using Upload instead from @aws-sdk/lib-storage.")),e({...r})}}var W2={step:"finalizeRequest",tags:["CHECK_CONTENT_LENGTH_HEADER"],name:"getCheckContentLengthHeaderPlugin",override:!0},ob=e=>({applyToStack:t=>{t.add(Y2(),W2)}});var sb=e=>(t,r)=>async i=>{let n=await e.region(),o=e.region,a=()=>{};r.__s3RegionRedirect&&(Object.defineProperty(e,"region",{writable:!1,value:async()=>r.__s3RegionRedirect}),a=()=>Object.defineProperty(e,"region",{writable:!0,value:o}));try{let s=await t(i);if(r.__s3RegionRedirect){a();let c=await e.region();if(n!==c)throw new Error("Region was not restored following S3 region redirect.")}return s}catch(s){throw a(),s}},ab={tags:["REGION_REDIRECT","S3"],name:"regionRedirectEndpointMiddleware",override:!0,relation:"before",toMiddleware:"endpointV2Middleware"};function j2(e){return(t,r)=>async i=>{try{return await t(i)}catch(n){if(e.followRegionRedirects&&(n?.$metadata?.httpStatusCode===301||n?.$metadata?.httpStatusCode===400&&n?.name==="IllegalLocationConstraintException")){try{let o=n.$response.headers["x-amz-bucket-region"];r.logger?.debug(`Redirecting from ${await e.region()} to ${o}`),r.__s3RegionRedirect=o}catch(o){throw new Error("Region redirect failed: "+o)}return t(i)}throw n}}}var X2={step:"initialize",tags:["REGION_REDIRECT","S3"],name:"regionRedirectMiddleware",override:!0},cb=e=>({applyToStack:t=>{t.add(j2(e),X2),t.addRelativeTo(sb(e),ab)}});var Qo=class e{data;lastPurgeTime=Date.now();static EXPIRED_CREDENTIAL_PURGE_INTERVAL_MS=3e4;constructor(t={}){this.data=t}get(t){let r=this.data[t];if(r)return r}set(t,r){return this.data[t]=r,r}delete(t){delete this.data[t]}async purgeExpired(){let t=Date.now();if(!(this.lastPurgeTime+e.EXPIRED_CREDENTIAL_PURGE_INTERVAL_MS>t))for(let r in this.data){let i=this.data[r];if(!i.isRefreshing){let n=await i.identity;n.expiration&&n.expiration.getTime()<t&&delete this.data[r]}}}};var gi=class{_identity;isRefreshing;accessed;constructor(t,r=!1,i=Date.now()){this._identity=t,this.isRefreshing=r,this.accessed=i}get identity(){return this.accessed=Date.now(),this._identity}};var wo=class e{createSessionFn;cache;static REFRESH_WINDOW_MS=6e4;constructor(t,r=new Qo){this.createSessionFn=t,this.cache=r}async getS3ExpressIdentity(t,r){let i=r.Bucket,{cache:n}=this,o=n.get(i);return o?o.identity.then(a=>(a.expiration?.getTime()??0)<Date.now()?n.set(i,new gi(this.getIdentity(i))).identity:((a.expiration?.getTime()??0)<Date.now()+e.REFRESH_WINDOW_MS&&!o.isRefreshing&&(o.isRefreshing=!0,this.getIdentity(i).then(A=>{n.set(i,new gi(Promise.resolve(A)))})),a)):n.set(i,new gi(this.getIdentity(i))).identity}async getIdentity(t){await this.cache.purgeExpired().catch(n=>{});let r=await this.createSessionFn(t);if(!r.Credentials?.AccessKeyId||!r.Credentials?.SecretAccessKey)throw new Error("s3#createSession response credential missing AccessKeyId or SecretAccessKey.");return{accessKeyId:r.Credentials.AccessKeyId,secretAccessKey:r.Credentials.SecretAccessKey,sessionToken:r.Credentials.SessionToken,expiration:r.Credentials.Expiration?new Date(r.Credentials.Expiration):void 0}}};var bo;(function(e){e.ENV="env",e.CONFIG="shared config entry"})(bo||(bo={}));var lb="Directory",db="S3Express",gb="sigv4-s3express",La="X-Amz-S3session-Token",So=La.toLowerCase();var xo=class extends ci{async signWithCredentials(t,r,i){let n=ub(r);t.headers[So]=r.sessionToken;let o=this;return fb(o,n),o.signRequest(t,i??{})}async presignWithCredentials(t,r,i){let n=ub(r);return delete t.headers[So],t.headers[La]=r.sessionToken,t.query=t.query??{},t.query[La]=r.sessionToken,fb(this,n),this.presign(t,i)}};function ub(e){return{accessKeyId:e.accessKeyId,secretAccessKey:e.secretAccessKey,expiration:e.expiration}}function fb(e,t){let r=setTimeout(()=>{throw new Error("SignatureV4S3Express credential override was created but not called.")},10),i=e.credentialProvider,n=()=>(clearTimeout(r),e.credentialProvider=i,Promise.resolve(t));e.credentialProvider=n}var Ib=e=>(t,r)=>async i=>{if(r.endpointV2){let n=r.endpointV2,o=n.properties?.authSchemes?.[0]?.name===gb;if((n.properties?.backend===db||n.properties?.bucketType===lb)&&(ve(r,"S3_EXPRESS_BUCKET","J"),r.isS3ExpressBucket=!0),o){let s=i.input.Bucket;if(s){let c=await e.s3ExpressIdentityProvider.getS3ExpressIdentity(await e.credentials(),{Bucket:s});r.s3ExpressIdentity=c,O.isInstance(i.request)&&c.sessionToken&&(i.request.headers[So]=c.sessionToken)}}}return t(i)},pb={name:"s3ExpressMiddleware",step:"build",tags:["S3","S3_EXPRESS"],override:!0},yg=e=>({applyToStack:t=>{t.add(Ib(e),pb)}});var hb=async(e,t,r,i)=>{let n=await i.signWithCredentials(r,e,{});if(n.headers["X-Amz-Security-Token"]||n.headers["x-amz-security-token"])throw new Error("X-Amz-Security-Token must not be set for s3-express requests.");return n};var Z2=e=>t=>{throw t},$2=(e,t)=>{};var mb=e=>(t,r)=>async i=>{if(!O.isInstance(i.request))return t(i);let o=ut(r).selectedHttpAuthScheme;if(!o)throw new Error("No HttpAuthScheme was selected: unable to sign request");let{httpAuthOption:{signingProperties:a={}},identity:s,signer:c}=o,A;r.s3ExpressIdentity?A=await hb(r.s3ExpressIdentity,a,i.request,await e.signer()):A=await c.sign(i.request,s,a);let l=await t({...i,request:A}).catch((c.errorHandler||Z2)(a));return(c.successHandler||$2)(l.response,a),l},Eg=e=>({applyToStack:t=>{t.addRelativeTo(mb(e),Nd)}});var Cb=(e,{session:t})=>{let[r,i]=t;return{...e,forcePathStyle:e.forcePathStyle??!1,useAccelerateEndpoint:e.useAccelerateEndpoint??!1,disableMultiregionAccessPoints:e.disableMultiregionAccessPoints??!1,followRegionRedirects:e.followRegionRedirects??!1,s3ExpressIdentityProvider:e.s3ExpressIdentityProvider??new wo(async n=>r().send(new i({Bucket:n,SessionMode:"ReadWrite"}))),bucketEndpoint:e.bucketEndpoint??!1}};var e1={CopyObjectCommand:!0,UploadPartCopyCommand:!0,CompleteMultipartUploadCommand:!0},t1=3e3,r1=e=>(t,r)=>async i=>{let n=await t(i),{response:o}=n;if(!Ue.isInstance(o))return n;let{statusCode:a,body:s}=o;if(a<200||a>=300||!(typeof s?.stream=="function"||typeof s?.pipe=="function"||typeof s?.tee=="function"))return n;let A=s,l=s;s&&typeof s=="object"&&!(s instanceof Uint8Array)&&([A,l]=await AQ(s)),o.body=l;let d=await i1(A,{streamCollector:async u=>iQ(u,t1)});typeof A?.destroy=="function"&&A.destroy();let g=e.utf8Encoder(d.subarray(d.length-16));if(d.length===0&&e1[r.commandName]){let u=new Error("S3 aborted request");throw u.name="InternalError",u}return g&&g.endsWith("</Error>")&&(o.statusCode=400),n},i1=(e=new Uint8Array,t)=>e instanceof Uint8Array?Promise.resolve(e):t.streamCollector(e)||Promise.resolve(new Uint8Array),n1={relation:"after",toMiddleware:"deserializerMiddleware",tags:["THROW_200_EXCEPTIONS","S3"],name:"throw200ExceptionsMiddleware",override:!0},gn=e=>({applyToStack:t=>{t.addRelativeTo(r1(e),n1)}});var Bb=e=>typeof e=="string"&&e.indexOf("arn:")===0&&e.split(":").length>=6;function yb(e){return(t,r)=>async i=>{if(e.bucketEndpoint){let n=r.endpointV2;if(n){let o=i.input.Bucket;if(typeof o=="string")try{let a=new URL(o);r.endpointV2={...n,url:a}}catch(a){let s=`@aws-sdk/middleware-sdk-s3: bucketEndpoint=true was set but Bucket=${o} could not be parsed as URL.`;throw r.logger?.constructor?.name==="NoOpLogger"||r.logger?.warn?.(s),a}}}return t(i)}}var Eb={name:"bucketEndpointMiddleware",override:!0,relation:"after",toMiddleware:"endpointV2Middleware"};function o1({bucketEndpoint:e}){return t=>async r=>{let{input:{Bucket:i}}=r;if(!e&&typeof i=="string"&&!Bb(i)&&i.indexOf("/")>=0){let n=new Error(`Bucket name shouldn't contain '/', received '${i}'`);throw n.name="InvalidBucketName",n}return t({...r})}}var s1={step:"initialize",tags:["VALIDATE_BUCKET_NAME"],name:"validateBucketNameMiddleware",override:!0},Qb=e=>({applyToStack:t=>{t.add(o1(e),s1),t.addRelativeTo(yb(e),Eb)}});var a1=void 0;function c1(e){return e===void 0?!0:typeof e=="string"&&e.length<=50}function wb(e){let t=sr(e.userAgentAppId??a1);return{...e,customUserAgent:typeof e.customUserAgent=="string"?[[e.customUserAgent]]:e.customUserAgent,userAgentAppId:async()=>{let r=await t();if(!c1(r)){let i=e.logger?.constructor?.name==="NoOpLogger"||!e.logger?console:e.logger;typeof r!="string"?i?.warn("userAgentAppId must be a string or undefined."):r.length>50&&i?.warn("The provided userAgentAppId exceeds the maximum length of 50 characters.")}return r}}}var Ka=class{constructor({size:t,params:r}){this.data=new Map,this.parameters=[],this.capacity=t??50,r&&(this.parameters=r)}get(t,r){let i=this.hash(t);if(i===!1)return r();if(!this.data.has(i)){if(this.data.size>this.capacity+10){let n=this.data.keys(),o=0;for(;;){let{value:a,done:s}=n.next();if(this.data.delete(a),s||++o>10)break}}this.data.set(i,r())}return this.data.get(i)}size(){return this.data.size}hash(t){let r="",{parameters:i}=this;if(i.length===0)return!1;for(let n of i){let o=String(t[n]??"");if(o.includes("|;"))return!1;r+=o+"|;"}return r}};var A1=new RegExp("^(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}$"),ko=e=>A1.test(e)||e.startsWith("[")&&e.endsWith("]");var l1=new RegExp("^(?!.*-$)(?!-)[a-zA-Z0-9-]{1,63}$"),Do=(e,t=!1)=>{if(!t)return l1.test(e);let r=e.split(".");for(let i of r)if(!Do(i))return!1;return!0};var ui={};var fr="endpoints";function Bt(e){return typeof e!="object"||e==null?e:"ref"in e?`$${Bt(e.ref)}`:"fn"in e?`${e.fn}(${(e.argv||[]).map(Bt).join(", ")})`:JSON.stringify(e,null,2)}var ne=class extends Error{constructor(t){super(t),this.name="EndpointError"}};var bb=(e,t)=>e===t;var Sb=e=>{let t=e.split("."),r=[];for(let i of t){let n=i.indexOf("[");if(n!==-1){if(i.indexOf("]")!==i.length-1)throw new ne(`Path: '${e}' does not end with ']'`);let o=i.slice(n+1,-1);if(Number.isNaN(parseInt(o)))throw new ne(`Invalid array index: '${o}' in path: '${e}'`);n!==0&&r.push(i.slice(0,n)),r.push(o)}else r.push(i)}return r};var Ja=(e,t)=>Sb(t).reduce((r,i)=>{if(typeof r!="object")throw new ne(`Index '${i}' in '${t}' not found in '${JSON.stringify(e)}'`);return Array.isArray(r)?r[parseInt(i)]:r[i]},e);var xb=e=>e!=null;var kb=e=>!e;var Qg={[tn.HTTP]:80,[tn.HTTPS]:443},Db=e=>{let t=(()=>{try{if(e instanceof URL)return e;if(typeof e=="object"&&"hostname"in e){let{hostname:g,port:u,protocol:I="",path:C="",query:B={}}=e,h=new URL(`${I}//${g}${u?`:${u}`:""}${C}`);return h.search=Object.entries(B).map(([Q,D])=>`${Q}=${D}`).join("&"),h}return new URL(e)}catch{return null}})();if(!t)return null;let r=t.href,{host:i,hostname:n,pathname:o,protocol:a,search:s}=t;if(s)return null;let c=a.slice(0,-1);if(!Object.values(tn).includes(c))return null;let A=ko(n),l=r.includes(`${i}:${Qg[c]}`)||typeof e=="string"&&e.includes(`${i}:${Qg[c]}`),d=`${i}${l?`:${Qg[c]}`:""}`;return{scheme:c,authority:d,path:o,normalizedPath:o.endsWith("/")?o:`${o}/`,isIp:A}};var vb=(e,t)=>e===t;var Fb=(e,t,r,i)=>t>=r||e.length<r?null:i?e.substring(e.length-r,e.length-t):e.substring(t,r);var Rb=e=>encodeURIComponent(e).replace(/[!*'()]/g,t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`);var Tb={booleanEquals:bb,getAttr:Ja,isSet:xb,isValidHostLabel:Do,not:kb,parseURL:Db,stringEquals:vb,substring:Fb,uriEncode:Rb};var za=(e,t)=>{let r=[],i={...t.endpointParams,...t.referenceRecord},n=0;for(;n<e.length;){let o=e.indexOf("{",n);if(o===-1){r.push(e.slice(n));break}r.push(e.slice(n,o));let a=e.indexOf("}",o);if(a===-1){r.push(e.slice(o));break}e[o+1]==="{"&&e[a+1]==="}"&&(r.push(e.slice(o+1,a)),n=a+2);let s=e.substring(o+1,a);if(s.includes("#")){let[c,A]=s.split("#");r.push(Ja(i[c],A))}else r.push(i[s]);n=a+1}return r.join("")};var _b=({ref:e},t)=>({...t.endpointParams,...t.referenceRecord})[e];var Ur=(e,t,r)=>{if(typeof e=="string")return za(e,r);if(e.fn)return Va(e,r);if(e.ref)return _b(e,r);throw new ne(`'${t}': ${String(e)} is not a string, function or reference.`)};var Va=({fn:e,argv:t},r)=>{let i=t.map(o=>["boolean","number"].includes(typeof o)?o:Ur(o,"arg",r)),n=e.split(".");return n[0]in ui&&n[1]!=null?ui[n[0]][n[1]](...i):Tb[e](...i)};var Mb=({assign:e,...t},r)=>{if(e&&e in r.referenceRecord)throw new ne(`'${e}' is already defined in Reference Record.`);let i=Va(t,r);return r.logger?.debug?.(`${fr} evaluateCondition: ${Bt(t)} = ${Bt(i)}`),{result:i===""?!0:!!i,...e!=null&&{toAssign:{name:e,value:i}}}};var un=(e=[],t)=>{let r={};for(let i of e){let{result:n,toAssign:o}=Mb(i,{...t,referenceRecord:{...t.referenceRecord,...r}});if(!n)return{result:n};o&&(r[o.name]=o.value,t.logger?.debug?.(`${fr} assign: ${o.name} := ${Bt(o.value)}`))}return{result:!0,referenceRecord:r}};var Nb=(e,t)=>Object.entries(e).reduce((r,[i,n])=>({...r,[i]:n.map(o=>{let a=Ur(o,"Header value entry",t);if(typeof a!="string")throw new ne(`Header '${i}' value '${a}' is not a string`);return a})}),{});var wg=(e,t)=>{if(Array.isArray(e))return e.map(r=>wg(r,t));switch(typeof e){case"string":return za(e,t);case"object":if(e===null)throw new ne(`Unexpected endpoint property: ${e}`);return Ya(e,t);case"boolean":return e;default:throw new ne(`Unexpected endpoint property type: ${typeof e}`)}};var Ya=(e,t)=>Object.entries(e).reduce((r,[i,n])=>({...r,[i]:wg(n,t)}),{});var Pb=(e,t)=>{let r=Ur(e,"Endpoint URL",t);if(typeof r=="string")try{return new URL(r)}catch(i){throw i}throw new ne(`Endpoint URL must be a string, got ${typeof r}`)};var Ub=(e,t)=>{let{conditions:r,endpoint:i}=e,{result:n,referenceRecord:o}=un(r,t);if(!n)return;let a={...t,referenceRecord:{...t.referenceRecord,...o}},{url:s,properties:c,headers:A}=i;return t.logger?.debug?.(`${fr} Resolving endpoint from template: ${Bt(i)}`),{...A!=null&&{headers:Nb(A,a)},...c!=null&&{properties:Ya(c,a)},url:Pb(s,a)}};var Ob=(e,t)=>{let{conditions:r,error:i}=e,{result:n,referenceRecord:o}=un(r,t);if(n)throw new ne(Ur(i,"Error",{...t,referenceRecord:{...t.referenceRecord,...o}}))};var qb=(e,t)=>{let{conditions:r,rules:i}=e,{result:n,referenceRecord:o}=un(r,t);if(n)return Wa(i,{...t,referenceRecord:{...t.referenceRecord,...o}})};var Wa=(e,t)=>{for(let r of e)if(r.type==="endpoint"){let i=Ub(r,t);if(i)return i}else if(r.type==="error")Ob(r,t);else if(r.type==="tree"){let i=qb(r,t);if(i)return i}else throw new ne(`Unknown endpoint rule: ${r}`);throw new ne("Rules evaluation failed")};var bg=(e,t)=>{let{endpointParams:r,logger:i}=t,{parameters:n,rules:o}=e;t.logger?.debug?.(`${fr} Initial EndpointParams: ${Bt(r)}`);let a=Object.entries(n).filter(([,A])=>A.default!=null).map(([A,l])=>[A,l.default]);if(a.length>0)for(let[A,l]of a)r[A]=r[A]??l;let s=Object.entries(n).filter(([,A])=>A.required).map(([A])=>A);for(let A of s)if(r[A]==null)throw new ne(`Missing required parameter: '${A}'`);let c=Wa(o,{endpointParams:r,logger:i,referenceRecord:{}});return t.logger?.debug?.(`${fr} Resolved endpoint: ${Bt(c)}`),c};var Sg=(e,t=!1)=>{if(t){for(let r of e.split("."))if(!Sg(r))return!1;return!0}return!(!Do(e)||e.length<3||e.length>63||e!==e.toLowerCase()||ko(e))};var Gb=e=>{let t=e.split(":");if(t.length<6)return null;let[r,i,n,o,a,...s]=t;if(r!=="arn"||i===""||n===""||s.join(":")==="")return null;let c=s.map(A=>A.split("/")).flat();return{partition:i,service:n,region:o,accountId:a,resourceId:c}};var Hb={partitions:[{id:"aws",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-east-1",name:"aws",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^(us|eu|ap|sa|ca|me|af|il|mx)\\-\\w+\\-\\d+$",regions:{"af-south-1":{description:"Africa (Cape Town)"},"ap-east-1":{description:"Asia Pacific (Hong Kong)"},"ap-northeast-1":{description:"Asia Pacific (Tokyo)"},"ap-northeast-2":{description:"Asia Pacific (Seoul)"},"ap-northeast-3":{description:"Asia Pacific (Osaka)"},"ap-south-1":{description:"Asia Pacific (Mumbai)"},"ap-south-2":{description:"Asia Pacific (Hyderabad)"},"ap-southeast-1":{description:"Asia Pacific (Singapore)"},"ap-southeast-2":{description:"Asia Pacific (Sydney)"},"ap-southeast-3":{description:"Asia Pacific (Jakarta)"},"ap-southeast-4":{description:"Asia Pacific (Melbourne)"},"ap-southeast-5":{description:"Asia Pacific (Malaysia)"},"ap-southeast-7":{description:"Asia Pacific (Thailand)"},"aws-global":{description:"AWS Standard global region"},"ca-central-1":{description:"Canada (Central)"},"ca-west-1":{description:"Canada West (Calgary)"},"eu-central-1":{description:"Europe (Frankfurt)"},"eu-central-2":{description:"Europe (Zurich)"},"eu-north-1":{description:"Europe (Stockholm)"},"eu-south-1":{description:"Europe (Milan)"},"eu-south-2":{description:"Europe (Spain)"},"eu-west-1":{description:"Europe (Ireland)"},"eu-west-2":{description:"Europe (London)"},"eu-west-3":{description:"Europe (Paris)"},"il-central-1":{description:"Israel (Tel Aviv)"},"me-central-1":{description:"Middle East (UAE)"},"me-south-1":{description:"Middle East (Bahrain)"},"sa-east-1":{description:"South America (Sao Paulo)"},"us-east-1":{description:"US East (N. Virginia)"},"us-east-2":{description:"US East (Ohio)"},"us-west-1":{description:"US West (N. California)"},"us-west-2":{description:"US West (Oregon)"}}},{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn",dualStackDnsSuffix:"api.amazonwebservices.com.cn",implicitGlobalRegion:"cn-northwest-1",name:"aws-cn",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:{"aws-cn-global":{description:"AWS China global region"},"cn-north-1":{description:"China (Beijing)"},"cn-northwest-1":{description:"China (Ningxia)"}}},{id:"aws-us-gov",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-gov-west-1",name:"aws-us-gov",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-gov\\-\\w+\\-\\d+$",regions:{"aws-us-gov-global":{description:"AWS GovCloud (US) global region"},"us-gov-east-1":{description:"AWS GovCloud (US-East)"},"us-gov-west-1":{description:"AWS GovCloud (US-West)"}}},{id:"aws-iso",outputs:{dnsSuffix:"c2s.ic.gov",dualStackDnsSuffix:"c2s.ic.gov",implicitGlobalRegion:"us-iso-east-1",name:"aws-iso",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-iso\\-\\w+\\-\\d+$",regions:{"aws-iso-global":{description:"AWS ISO (US) global region"},"us-iso-east-1":{description:"US ISO East"},"us-iso-west-1":{description:"US ISO WEST"}}},{id:"aws-iso-b",outputs:{dnsSuffix:"sc2s.sgov.gov",dualStackDnsSuffix:"sc2s.sgov.gov",implicitGlobalRegion:"us-isob-east-1",name:"aws-iso-b",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-isob\\-\\w+\\-\\d+$",regions:{"aws-iso-b-global":{description:"AWS ISOB (US) global region"},"us-isob-east-1":{description:"US ISOB East (Ohio)"}}},{id:"aws-iso-e",outputs:{dnsSuffix:"cloud.adc-e.uk",dualStackDnsSuffix:"cloud.adc-e.uk",implicitGlobalRegion:"eu-isoe-west-1",name:"aws-iso-e",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^eu\\-isoe\\-\\w+\\-\\d+$",regions:{"eu-isoe-west-1":{description:"EU ISOE West"}}},{id:"aws-iso-f",outputs:{dnsSuffix:"csp.hci.ic.gov",dualStackDnsSuffix:"csp.hci.ic.gov",implicitGlobalRegion:"us-isof-south-1",name:"aws-iso-f",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-isof\\-\\w+\\-\\d+$",regions:{}}],version:"1.1"};var g1=Hb,u1="",Lb=e=>{let{partitions:t}=g1;for(let i of t){let{regions:n,outputs:o}=i;for(let[a,s]of Object.entries(n))if(a===e)return{...o,...s}}for(let i of t){let{regionRegex:n,outputs:o}=i;if(new RegExp(n).test(e))return{...o}}let r=t.find(i=>i.id==="aws");if(!r)throw new Error("Provided region was not found in the partition array or regex, and default partition with id 'aws' doesn't exist.");return{...r.outputs}};var Kb=()=>u1;var xg={isVirtualHostableS3Bucket:Sg,parseArn:Gb,partition:Lb};ui.aws=xg;var f1=/\d{12}\.ddb/;async function Jb(e,t,r){if(r.request?.headers?.["smithy-protocol"]==="rpc-v2-cbor"&&ve(e,"PROTOCOL_RPC_V2_CBOR","M"),typeof t.retryStrategy=="function"){let o=await t.retryStrategy();typeof o.acquireInitialRetryToken=="function"?o.constructor?.name?.includes("Adaptive")?ve(e,"RETRY_MODE_ADAPTIVE","F"):ve(e,"RETRY_MODE_STANDARD","E"):ve(e,"RETRY_MODE_LEGACY","D")}if(typeof t.accountIdEndpointMode=="function"){let o=e.endpointV2;switch(String(o?.url?.hostname).match(f1)&&ve(e,"ACCOUNT_ID_ENDPOINT","O"),await t.accountIdEndpointMode?.()){case"disabled":ve(e,"ACCOUNT_ID_MODE_DISABLED","Q");break;case"preferred":ve(e,"ACCOUNT_ID_MODE_PREFERRED","P");break;case"required":ve(e,"ACCOUNT_ID_MODE_REQUIRED","R");break}}let n=e.__smithy_context?.selectedHttpAuthScheme?.identity;if(n?.$source){let o=n;o.accountId&&ve(e,"RESOLVED_ACCOUNT_ID","T");for(let[a,s]of Object.entries(o.$source??{}))ve(e,a,s)}}var kg="user-agent",ja="x-amz-user-agent";var zb=/[^\!\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w]/g,Vb=/[^\!\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w\#]/g;function Yb(e){let t="";for(let r in e){let i=e[r];if(t.length+i.length+1<=1024){t.length?t+=","+i:t+=i;continue}break}return t}var I1=e=>(t,r)=>async i=>{let{request:n}=i;if(!O.isInstance(n))return t(i);let{headers:o}=n,a=r?.userAgent?.map(Xa)||[],s=(await e.defaultUserAgentProvider()).map(Xa);await Jb(r,e,i);let c=r;s.push(`m/${Yb(Object.assign({},r.__smithy_context?.features,c.__aws_sdk_context?.features))}`);let A=e?.customUserAgent?.map(Xa)||[],l=await e.userAgentAppId();l&&s.push(Xa([`app/${l}`]));let d=Kb(),g=(d?[d]:[]).concat([...s,...a,...A]).join(" "),u=[...s.filter(I=>I.startsWith("aws-sdk-")),...A].join(" ");return e.runtime!=="browser"?(u&&(o[ja]=o[ja]?`${o[kg]} ${u}`:u),o[kg]=g):o[ja]=g,t({...i,request:n})},Xa=e=>{let t=e[0].split("/").map(a=>a.replace(zb,"-")).join("/"),r=e[1]?.replace(Vb,"-"),i=t.indexOf("/"),n=t.substring(0,i),o=t.substring(i+1);return n==="api"&&(o=o.toLowerCase()),[n,o,r].filter(a=>a&&a.length>0).reduce((a,s,c)=>{switch(c){case 0:return s;case 1:return`${a}/${s}`;default:return`${a}#${s}`}},"")},p1={name:"getUserAgentMiddleware",step:"build",priority:"low",tags:["SET_USER_AGENT","USER_AGENT"],override:!0},Xb=e=>({applyToStack:t=>{t.add(I1(e),p1)}});var Zb=!1;var $b=!1;var Za=e=>typeof e=="string"&&(e.startsWith("fips-")||e.endsWith("-fips"));var vg=e=>Za(e)?["fips-aws-global","aws-fips"].includes(e)?"us-east-1":e.replace(/fips-(dkr-|prod-)?|-fips/,""):e;var eS=e=>{let{region:t,useFipsEndpoint:r}=e;if(!t)throw new Error("Region is missing");return Object.assign(e,{region:async()=>{if(typeof t=="string")return vg(t);let i=await t();return vg(i)},useFipsEndpoint:async()=>{let i=typeof t=="string"?t:await t();return Za(i)?!0:typeof r!="function"?Promise.resolve(!!r):r()}})};var tS=e=>Object.assign(e,{eventStreamMarshaller:e.eventStreamSerdeProvider(e)});var rS="content-length";function h1(e){return t=>async r=>{let i=r.request;if(O.isInstance(i)){let{body:n,headers:o}=i;if(n&&Object.keys(o).map(a=>a.toLowerCase()).indexOf(rS)===-1)try{let a=e(n);i.headers={...i.headers,[rS]:String(a)}}catch{}}return t({...r,request:i})}}var m1={step:"build",tags:["SET_CONTENT_LENGTH","CONTENT_LENGTH"],name:"contentLengthMiddleware",override:!0},iS=e=>({applyToStack:t=>{t.add(h1(e.bodyLengthChecker),m1)}});var nS=async e=>{let t=e?.Bucket||"";if(typeof e.Bucket=="string"&&(e.Bucket=t.replace(/#/g,encodeURIComponent("#")).replace(/\?/g,encodeURIComponent("?"))),Q1(t)){if(e.ForcePathStyle===!0)throw new Error("Path-style addressing cannot be used with ARN buckets")}else(!E1(t)||t.indexOf(".")!==-1&&!String(e.Endpoint).startsWith("http:")||t.toLowerCase()!==t||t.length<3)&&(e.ForcePathStyle=!0);return e.DisableMultiRegionAccessPoints&&(e.disableMultiRegionAccessPoints=!0,e.DisableMRAP=!0),e},C1=/^[a-z0-9][a-z0-9\.\-]{1,61}[a-z0-9]$/,B1=/(\d+\.){3}\d+/,y1=/\.\./;var E1=e=>C1.test(e)&&!B1.test(e)&&!y1.test(e),Q1=e=>{let[t,r,i,,,n]=e.split(":"),o=t==="arn"&&e.split(":").length>=6,a=!!(o&&r&&i&&n);if(o&&!a)throw new Error(`Invalid ARN: ${e} was an invalid ARN.`);return a};var oS=(e,t,r)=>{let i=async()=>{let n=r[e]??r[t];return typeof n=="function"?n():n};return e==="credentialScope"||t==="CredentialScope"?async()=>{let n=typeof r.credentials=="function"?await r.credentials():r.credentials;return n?.credentialScope??n?.CredentialScope}:e==="accountId"||t==="AccountId"?async()=>{let n=typeof r.credentials=="function"?await r.credentials():r.credentials;return n?.accountId??n?.AccountId}:e==="endpoint"||t==="endpoint"?async()=>{let n=await i();if(n&&typeof n=="object"){if("url"in n)return n.url.href;if("hostname"in n){let{protocol:o,hostname:a,port:s,path:c}=n;return`${o}//${a}${s?":"+s:""}${c}`}}return n}:i};var $a=async e=>{};function sS(e){let t={};if(e=e.replace(/^\?/,""),e)for(let r of e.split("&")){let[i,n=null]=r.split("=");i=decodeURIComponent(i),n&&(n=decodeURIComponent(n)),i in t?Array.isArray(t[i])?t[i].push(n):t[i]=[t[i],n]:t[i]=n}return t}var fn=e=>{if(typeof e=="string")return fn(new URL(e));let{hostname:t,pathname:r,port:i,protocol:n,search:o}=e,a;return o&&(a=sS(o)),{hostname:t,port:i?parseInt(i):void 0,protocol:n,path:r,query:a}};var ec=e=>typeof e=="object"?"url"in e?fn(e.url):e:fn(e);var aS=async(e,t,r,i)=>{if(!r.endpoint){let a;r.serviceConfiguredEndpoint?a=await r.serviceConfiguredEndpoint():a=await $a(r.serviceId),a&&(r.endpoint=()=>Promise.resolve(ec(a)))}let n=await Fg(e,t,r);if(typeof r.endpointProvider!="function")throw new Error("config.endpointProvider is not set.");return r.endpointProvider(n,i)},Fg=async(e,t,r)=>{let i={},n=t?.getEndpointParameterInstructions?.()||{};for(let[o,a]of Object.entries(n))switch(a.type){case"staticContextParams":i[o]=a.value;break;case"contextParams":i[o]=e[a.name];break;case"clientContextParams":case"builtInParams":i[o]=await oS(a.name,o,r)();break;case"operationContextParams":i[o]=a.get(e);break;default:throw new Error("Unrecognized endpoint parameter instruction: "+JSON.stringify(a))}return Object.keys(n).length===0&&Object.assign(i,r),String(r.serviceId).toLowerCase()==="s3"&&await nS(i),i};var cS=({config:e,instructions:t})=>(r,i)=>async n=>{e.endpoint&&wQ(i,"ENDPOINT_OVERRIDE","N");let o=await aS(n.input,{getEndpointParameterInstructions(){return t}},{...e},i);i.endpointV2=o,i.authSchemes=o.properties?.authSchemes;let a=i.authSchemes?.[0];if(a){i.signing_region=a.signingRegion,i.signing_service=a.signingName;let c=ut(i)?.selectedHttpAuthScheme?.httpAuthOption;c&&(c.signingProperties=Object.assign(c.signingProperties||{},{signing_region:a.signingRegion,signingRegion:a.signingRegion,signing_service:a.signingName,signingName:a.signingName,signingRegionSet:a.signingRegionSet},a.properties))}return r({...n})};var w1={step:"serialize",tags:["ENDPOINT_PARAMETERS","ENDPOINT_V2","ENDPOINT"],name:"endpointV2Middleware",override:!0,relation:"before",toMiddleware:co.name},In=(e,t)=>({applyToStack:r=>{r.addRelativeTo(cS({config:e,instructions:t}),w1)}});var AS=e=>{let t=e.tls??!0,{endpoint:r,useDualstackEndpoint:i,useFipsEndpoint:n}=e,o=r!=null?async()=>ec(await Oe(r)()):void 0,s=Object.assign(e,{endpoint:o,tls:t,isCustomEndpoint:!!r,useDualstackEndpoint:Oe(i??!1),useFipsEndpoint:Oe(n??!1)}),c;return s.serviceConfiguredEndpoint=async()=>(e.serviceId&&!c&&(c=$a(e.serviceId)),c),s};var Rt;(function(e){e.STANDARD="standard",e.ADAPTIVE="adaptive"})(Rt||(Rt={}));var fi=3,Rg=Rt.STANDARD;var lS=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException","TransactionInProgressException"],dS=["TimeoutError","RequestTimeout","RequestTimeoutException"],gS=[500,502,503,504],uS=["ECONNRESET","ECONNREFUSED","EPIPE","ETIMEDOUT"];var b1=e=>e.$metadata?.clockSkewCorrected,S1=e=>{let t=new Set(["Failed to fetch","NetworkError when attempting to fetch resource","The Internet connection appears to be offline","Load failed","Network request failed"]);return e&&e instanceof TypeError?t.has(e.message):!1},pn=e=>e.$metadata?.httpStatusCode===429||lS.includes(e.name)||e.$retryable?.throttling==!0,vo=(e,t=0)=>b1(e)||dS.includes(e.name)||uS.includes(e?.code||"")||gS.includes(e.$metadata?.httpStatusCode||0)||S1(e)||e.cause!==void 0&&t<=10&&vo(e.cause,t+1),fS=e=>{if(e.$metadata?.httpStatusCode!==void 0){let t=e.$metadata.httpStatusCode;return 500<=t&&t<=599&&!vo(e)}return!1};var hn=class e{constructor(t){this.currentCapacity=0,this.enabled=!1,this.lastMaxRate=0,this.measuredTxRate=0,this.requestCount=0,this.lastTimestamp=0,this.timeWindow=0,this.beta=t?.beta??.7,this.minCapacity=t?.minCapacity??1,this.minFillRate=t?.minFillRate??.5,this.scaleConstant=t?.scaleConstant??.4,this.smooth=t?.smooth??.8;let r=this.getCurrentTimeInSeconds();this.lastThrottleTime=r,this.lastTxRateBucket=Math.floor(this.getCurrentTimeInSeconds()),this.fillRate=this.minFillRate,this.maxCapacity=this.minCapacity}getCurrentTimeInSeconds(){return Date.now()/1e3}async getSendToken(){return this.acquireTokenBucket(1)}async acquireTokenBucket(t){if(this.enabled){if(this.refillTokenBucket(),t>this.currentCapacity){let r=(t-this.currentCapacity)/this.fillRate*1e3;await new Promise(i=>e.setTimeoutFn(i,r))}this.currentCapacity=this.currentCapacity-t}}refillTokenBucket(){let t=this.getCurrentTimeInSeconds();if(!this.lastTimestamp){this.lastTimestamp=t;return}let r=(t-this.lastTimestamp)*this.fillRate;this.currentCapacity=Math.min(this.maxCapacity,this.currentCapacity+r),this.lastTimestamp=t}updateClientSendingRate(t){let r;if(this.updateMeasuredRate(),pn(t)){let n=this.enabled?Math.min(this.measuredTxRate,this.fillRate):this.measuredTxRate;this.lastMaxRate=n,this.calculateTimeWindow(),this.lastThrottleTime=this.getCurrentTimeInSeconds(),r=this.cubicThrottle(n),this.enableTokenBucket()}else this.calculateTimeWindow(),r=this.cubicSuccess(this.getCurrentTimeInSeconds());let i=Math.min(r,2*this.measuredTxRate);this.updateTokenBucketRate(i)}calculateTimeWindow(){this.timeWindow=this.getPrecise(Math.pow(this.lastMaxRate*(1-this.beta)/this.scaleConstant,1/3))}cubicThrottle(t){return this.getPrecise(t*this.beta)}cubicSuccess(t){return this.getPrecise(this.scaleConstant*Math.pow(t-this.lastThrottleTime-this.timeWindow,3)+this.lastMaxRate)}enableTokenBucket(){this.enabled=!0}updateTokenBucketRate(t){this.refillTokenBucket(),this.fillRate=Math.max(t,this.minFillRate),this.maxCapacity=Math.max(t,this.minCapacity),this.currentCapacity=Math.min(this.currentCapacity,this.maxCapacity)}updateMeasuredRate(){let t=this.getCurrentTimeInSeconds(),r=Math.floor(t*2)/2;if(this.requestCount++,r>this.lastTxRateBucket){let i=this.requestCount/(r-this.lastTxRateBucket);this.measuredTxRate=this.getPrecise(i*this.smooth+this.measuredTxRate*(1-this.smooth)),this.requestCount=0,this.lastTxRateBucket=r}}getPrecise(t){return parseFloat(t.toFixed(8))}};hn.setTimeoutFn=setTimeout;var tc="amz-sdk-invocation-id",rc="amz-sdk-request";var IS=()=>{let e=100;return{computeNextBackoffDelay:i=>Math.floor(Math.min(2e4,Math.random()*2**i*e)),setDelayBase:i=>{e=i}}};var Tg=({retryDelay:e,retryCount:t,retryCost:r})=>({getRetryCount:()=>t,getRetryDelay:()=>Math.min(2e4,e),getRetryCost:()=>r});var Ii=class{constructor(t){this.maxAttempts=t,this.mode=Rt.STANDARD,this.capacity=500,this.retryBackoffStrategy=IS(),this.maxAttemptsProvider=typeof t=="function"?t:async()=>t}async acquireInitialRetryToken(t){return Tg({retryDelay:100,retryCount:0})}async refreshRetryTokenForRetry(t,r){let i=await this.getMaxAttempts();if(this.shouldRetry(t,r,i)){let n=r.errorType;this.retryBackoffStrategy.setDelayBase(n==="THROTTLING"?500:100);let o=this.retryBackoffStrategy.computeNextBackoffDelay(t.getRetryCount()),a=r.retryAfterHint?Math.max(r.retryAfterHint.getTime()-Date.now()||0,o):o,s=this.getCapacityCost(n);return this.capacity-=s,Tg({retryDelay:a,retryCount:t.getRetryCount()+1,retryCost:s})}throw new Error("No retry token available")}recordSuccess(t){this.capacity=Math.max(500,this.capacity+(t.getRetryCost()??1))}getCapacity(){return this.capacity}async getMaxAttempts(){try{return await this.maxAttemptsProvider()}catch{return fi}}shouldRetry(t,r,i){return t.getRetryCount()+1<i&&this.capacity>=this.getCapacityCost(r.errorType)&&this.isRetryableError(r.errorType)}getCapacityCost(t){return t==="TRANSIENT"?10:5}isRetryableError(t){return t==="THROTTLING"||t==="TRANSIENT"}};var nc=class{constructor(t,r){this.maxAttemptsProvider=t,this.mode=Rt.ADAPTIVE;let{rateLimiter:i}=r??{};this.rateLimiter=i??new hn,this.standardRetryStrategy=new Ii(t)}async acquireInitialRetryToken(t){return await this.rateLimiter.getSendToken(),this.standardRetryStrategy.acquireInitialRetryToken(t)}async refreshRetryTokenForRetry(t,r){return this.rateLimiter.updateClientSendingRate(r),this.standardRetryStrategy.refreshRetryTokenForRetry(t,r)}recordSuccess(t){this.rateLimiter.updateClientSendingRate({}),this.standardRetryStrategy.recordSuccess(t)}};var oc,x1=new Uint8Array(16);function Mg(){if(!oc&&(oc=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!oc))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return oc(x1)}var qe=[];for(let e=0;e<256;++e)qe.push((e+256).toString(16).slice(1));function BS(e,t=0){return qe[e[t+0]]+qe[e[t+1]]+qe[e[t+2]]+qe[e[t+3]]+"-"+qe[e[t+4]]+qe[e[t+5]]+"-"+qe[e[t+6]]+qe[e[t+7]]+"-"+qe[e[t+8]]+qe[e[t+9]]+"-"+qe[e[t+10]]+qe[e[t+11]]+qe[e[t+12]]+qe[e[t+13]]+qe[e[t+14]]+qe[e[t+15]]}var k1=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Ng={randomUUID:k1};function D1(e,t,r){if(Ng.randomUUID&&!t&&!e)return Ng.randomUUID();e=e||{};let i=e.random||(e.rng||Mg)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,t){r=r||0;for(let n=0;n<16;++n)t[r+n]=i[n];return t}return BS(i)}var Pg=D1;var Ug=e=>e instanceof Error?e:e instanceof Object?Object.assign(new Error,e):typeof e=="string"?new Error(e):new Error(`AWS SDK error wrapper for ${e}`);var yS=e=>{let{retryStrategy:t,retryMode:r,maxAttempts:i}=e,n=Oe(i??fi);return Object.assign(e,{maxAttempts:n,retryStrategy:async()=>t||(await Oe(r)()===Rt.ADAPTIVE?new nc(n):new Ii(n))})};var ES=e=>e?.body instanceof ReadableStream;var v1=e=>(t,r)=>async i=>{let n=await e.retryStrategy(),o=await e.maxAttempts();if(F1(n)){n=n;let a=await n.acquireInitialRetryToken(r.partition_id),s=new Error,c=0,A=0,{request:l}=i,d=O.isInstance(l);for(d&&(l.headers[tc]=Pg());;)try{d&&(l.headers[rc]=`attempt=${c+1}; max=${o}`);let{response:g,output:u}=await t(i);return n.recordSuccess(a),u.$metadata.attempts=c+1,u.$metadata.totalRetryDelay=A,{response:g,output:u}}catch(g){let u=R1(g);if(s=Ug(g),d&&ES(l))throw(r.logger instanceof Nr?console:r.logger)?.warn("An error was encountered in a non-retryable streaming request."),s;try{a=await n.refreshRetryTokenForRetry(a,u)}catch{throw s.$metadata||(s.$metadata={}),s.$metadata.attempts=c+1,s.$metadata.totalRetryDelay=A,s}c=a.getRetryCount();let I=a.getRetryDelay();A+=I,await new Promise(C=>setTimeout(C,I))}}else return n=n,n?.mode&&(r.userAgent=[...r.userAgent||[],["cfg/retry-mode",n.mode]]),n.retry(t,i)},F1=e=>typeof e.acquireInitialRetryToken<"u"&&typeof e.refreshRetryTokenForRetry<"u"&&typeof e.recordSuccess<"u",R1=e=>{let t={error:e,errorType:T1(e)},r=M1(e.$response);return r&&(t.retryAfterHint=r),t},T1=e=>pn(e)?"THROTTLING":vo(e)?"TRANSIENT":fS(e)?"SERVER_ERROR":"CLIENT_ERROR",_1={name:"retryMiddleware",tags:["RETRY"],step:"finalizeRequest",priority:"high",override:!0},QS=e=>({applyToStack:t=>{t.add(v1(e),_1)}}),M1=e=>{if(!Ue.isInstance(e))return;let t=Object.keys(e.headers).find(o=>o.toLowerCase()==="retry-after");if(!t)return;let r=e.headers[t],i=Number(r);return Number.isNaN(i)?new Date(r):new Date(i*1e3)};var sc={CrtSignerV4:null};var ac=class{sigv4aSigner;sigv4Signer;signerOptions;constructor(t){this.sigv4Signer=new xo(t),this.signerOptions=t}async sign(t,r={}){if(r.signingRegion==="*"){if(this.signerOptions.runtime!=="node")throw new Error("This request requires signing with SigV4Asymmetric algorithm. It's only available in Node.js");return this.getSigv4aSigner().sign(t,r)}return this.sigv4Signer.sign(t,r)}async signWithCredentials(t,r,i={}){if(i.signingRegion==="*"){if(this.signerOptions.runtime!=="node")throw new Error("This request requires signing with SigV4Asymmetric algorithm. It's only available in Node.js");return this.getSigv4aSigner().signWithCredentials(t,r,i)}return this.sigv4Signer.signWithCredentials(t,r,i)}async presign(t,r={}){if(r.signingRegion==="*"){if(this.signerOptions.runtime!=="node")throw new Error("This request requires signing with SigV4Asymmetric algorithm. It's only available in Node.js");return this.getSigv4aSigner().presign(t,r)}return this.sigv4Signer.presign(t,r)}async presignWithCredentials(t,r,i={}){if(i.signingRegion==="*")throw new Error("Method presignWithCredentials is not supported for [signingRegion=*].");return this.sigv4Signer.presignWithCredentials(t,r,i)}getSigv4aSigner(){if(!this.sigv4aSigner){let t=null;try{if(t=sc.CrtSignerV4,typeof t!="function")throw new Error}catch(r){throw r.message=`${r.message}
Please check whether you have installed the "@aws-sdk/signature-v4-crt" package explicitly. 
You must also register the package by calling [require("@aws-sdk/signature-v4-crt");] or an ESM equivalent such as [import "@aws-sdk/signature-v4-crt";]. 
For more information please go to https://github.com/aws/aws-sdk-js-v3#functionality-requiring-aws-common-runtime-crt`,r}this.sigv4aSigner=new t({...this.signerOptions,signingAlgorithm:1})}return this.sigv4aSigner}};var lu="required",f="type",p="conditions";var y="argv";var $="assign";var v="properties",bx="backend",_t="authSchemes",ft="disableDoubleEncoding",It="signingName",Yt="signingRegion",F="headers",du="signingRegionSet";var yt="isSet",_e="booleanEquals",R="error",fc="aws.partition",Z="stringEquals",me="getAttr",Je="name",Ke="substring",wS="bucketSuffix",Sx="parseURL",bS="{url#scheme}://{url#authority}/{uri_encoded_bucket}{url#path}",S="endpoint",b="tree",xx="aws.isVirtualHostableS3Bucket",dc="{url#scheme}://{Bucket}.{url#authority}{url#path}";var gc="{url#scheme}://{url#authority}{url#path}",kx="hardwareType",Dx="regionPrefix",SS="bucketAliasSuffix",cu="outpostId",hi="isValidHostLabel",gu="sigv4a",Mo="s3-outposts";var vx="{url#scheme}://{url#authority}{url#normalizedPath}{Bucket}",Fx="https://{Bucket}.s3-accelerate.{partitionResult#dnsSuffix}",xS="https://{Bucket}.s3.{partitionResult#dnsSuffix}",Rx="aws.parseArn",Tx="bucketArn",_x="arnType";var uu="s3-object-lambda",Mx="accesspoint",fu="accessPointName",kS="{url#scheme}://{accessPointName}-{bucketArn#accountId}.{url#authority}{url#path}",DS="mrapPartition",vS="outpostType",FS="arnPrefix",Nx="{url#scheme}://{url#authority}{url#normalizedPath}{uri_encoded_bucket}",RS="https://s3.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",TS="https://s3.{partitionResult#dnsSuffix}",Cn={[lu]:!1,[f]:"String"},Bn={[lu]:!0,default:!1,[f]:"Boolean"},Fo={[lu]:!1,[f]:"Boolean"},Tt={fn:_e,[y]:[{ref:"Accelerate"},!0]},se={fn:_e,[y]:[{ref:"UseFIPS"},!0]},oe={fn:_e,[y]:[{ref:"UseDualStack"},!0]},Qe={fn:yt,[y]:[{ref:"Endpoint"}]},Px={fn:fc,[y]:[{ref:"Region"}],[$]:"partitionResult"},_S={fn:Z,[y]:[{fn:me,[y]:[{ref:"partitionResult"},Je]},"aws-cn"]},Ic={fn:yt,[y]:[{ref:"Bucket"}]},Ce={ref:"Bucket"},nt={fn:Sx,[y]:[{ref:"Endpoint"}],[$]:"url"},uc={fn:_e,[y]:[{fn:me,[y]:[{ref:"url"},"isIp"]},!0]},Ux={ref:"url"},Ox={fn:"uriEncode",[y]:[Ce],[$]:"uri_encoded_bucket"},Ir={[bx]:"S3Express",[_t]:[{[ft]:!0,[Je]:"sigv4",[It]:"s3express",[Yt]:"{Region}"}]},M={},qx={fn:xx,[y]:[Ce,!1]},Og={[R]:"S3Express bucket name is not a valid virtual hostable name.",[f]:R},pc={[bx]:"S3Express",[_t]:[{[ft]:!0,[Je]:"sigv4-s3express",[It]:"s3express",[Yt]:"{Region}"}]},MS={fn:yt,[y]:[{ref:"UseS3ExpressControlEndpoint"}]},NS={fn:_e,[y]:[{ref:"UseS3ExpressControlEndpoint"},!0]},P={fn:"not",[y]:[Qe]},PS={[R]:"Unrecognized S3Express bucket name format.",[f]:R},US={fn:"not",[y]:[Ic]},OS={ref:kx},qS={[p]:[P],[R]:"Expected a endpoint to be specified but no endpoint was found",[f]:R},cc={[_t]:[{[ft]:!0,[Je]:gu,[It]:Mo,[du]:["*"]},{[ft]:!0,[Je]:"sigv4",[It]:Mo,[Yt]:"{Region}"}]},qg={fn:_e,[y]:[{ref:"ForcePathStyle"},!1]},N1={ref:"ForcePathStyle"},Ee={fn:_e,[y]:[{ref:"Accelerate"},!1]},Se={fn:Z,[y]:[{ref:"Region"},"aws-global"]},Fe={[_t]:[{[ft]:!0,[Je]:"sigv4",[It]:"s3",[Yt]:"us-east-1"}]},V={fn:"not",[y]:[Se]},Re={fn:_e,[y]:[{ref:"UseGlobalEndpoint"},!0]},GS={url:"https://{Bucket}.s3-fips.dualstack.{Region}.{partitionResult#dnsSuffix}",[v]:{[_t]:[{[ft]:!0,[Je]:"sigv4",[It]:"s3",[Yt]:"{Region}"}]},[F]:{}},we={[_t]:[{[ft]:!0,[Je]:"sigv4",[It]:"s3",[Yt]:"{Region}"}]},Te={fn:_e,[y]:[{ref:"UseGlobalEndpoint"},!1]},z={fn:_e,[y]:[{ref:"UseDualStack"},!1]},HS={url:"https://{Bucket}.s3-fips.{Region}.{partitionResult#dnsSuffix}",[v]:we,[F]:{}},L={fn:_e,[y]:[{ref:"UseFIPS"},!1]},LS={url:"https://{Bucket}.s3-accelerate.dualstack.{partitionResult#dnsSuffix}",[v]:we,[F]:{}},KS={url:"https://{Bucket}.s3.dualstack.{Region}.{partitionResult#dnsSuffix}",[v]:we,[F]:{}},Gg={fn:_e,[y]:[{fn:me,[y]:[Ux,"isIp"]},!1]},Hg={url:vx,[v]:we,[F]:{}},Au={url:dc,[v]:we,[F]:{}},JS={[S]:Au,[f]:S},Lg={url:Fx,[v]:we,[F]:{}},zS={url:"https://{Bucket}.s3.{Region}.{partitionResult#dnsSuffix}",[v]:we,[F]:{}},Ac={[R]:"Invalid region: region was not a valid DNS name.",[f]:R},lt={ref:Tx},Gx={ref:_x},Kg={fn:me,[y]:[lt,"service"]},Iu={ref:fu},VS={[p]:[oe],[R]:"S3 Object Lambda does not support Dual-stack",[f]:R},YS={[p]:[Tt],[R]:"S3 Object Lambda does not support S3 Accelerate",[f]:R},WS={[p]:[{fn:yt,[y]:[{ref:"DisableAccessPoints"}]},{fn:_e,[y]:[{ref:"DisableAccessPoints"},!0]}],[R]:"Access points are not supported for this operation",[f]:R},Jg={[p]:[{fn:yt,[y]:[{ref:"UseArnRegion"}]},{fn:_e,[y]:[{ref:"UseArnRegion"},!1]},{fn:"not",[y]:[{fn:Z,[y]:[{fn:me,[y]:[lt,"region"]},"{Region}"]}]}],[R]:"Invalid configuration: region from ARN `{bucketArn#region}` does not match client region `{Region}` and UseArnRegion is `false`",[f]:R},Hx={fn:me,[y]:[{ref:"bucketPartition"},Je]},Lx={fn:me,[y]:[lt,"accountId"]},zg={[_t]:[{[ft]:!0,[Je]:"sigv4",[It]:uu,[Yt]:"{bucketArn#region}"}]},jS={[R]:"Invalid ARN: The access point name may only contain a-z, A-Z, 0-9 and `-`. Found: `{accessPointName}`",[f]:R},Vg={[R]:"Invalid ARN: The account id may only contain a-z, A-Z, 0-9 and `-`. Found: `{bucketArn#accountId}`",[f]:R},Yg={[R]:"Invalid region in ARN: `{bucketArn#region}` (invalid DNS name)",[f]:R},Wg={[R]:"Client was configured for partition `{partitionResult#name}` but ARN (`{Bucket}`) has `{bucketPartition#name}`",[f]:R},XS={[R]:"Invalid ARN: The ARN may only contain a single resource component after `accesspoint`.",[f]:R},ZS={[R]:"Invalid ARN: Expected a resource of the format `accesspoint:<accesspoint name>` but no name was provided",[f]:R},Ro={[_t]:[{[ft]:!0,[Je]:"sigv4",[It]:"s3",[Yt]:"{bucketArn#region}"}]},$S={[_t]:[{[ft]:!0,[Je]:gu,[It]:Mo,[du]:["*"]},{[ft]:!0,[Je]:"sigv4",[It]:Mo,[Yt]:"{bucketArn#region}"}]},ex={fn:Rx,[y]:[Ce]},tx={url:"https://s3-fips.dualstack.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[v]:we,[F]:{}},rx={url:"https://s3-fips.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[v]:we,[F]:{}},ix={url:"https://s3.dualstack.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[v]:we,[F]:{}},jg={url:Nx,[v]:we,[F]:{}},nx={url:"https://s3.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[v]:we,[F]:{}},ox={ref:"UseObjectLambdaEndpoint"},Xg={[_t]:[{[ft]:!0,[Je]:"sigv4",[It]:uu,[Yt]:"{Region}"}]},sx={url:"https://s3-fips.dualstack.{Region}.{partitionResult#dnsSuffix}",[v]:we,[F]:{}},ax={url:"https://s3-fips.{Region}.{partitionResult#dnsSuffix}",[v]:we,[F]:{}},cx={url:"https://s3.dualstack.{Region}.{partitionResult#dnsSuffix}",[v]:we,[F]:{}},Zg={url:gc,[v]:we,[F]:{}},Ax={url:"https://s3.{Region}.{partitionResult#dnsSuffix}",[v]:we,[F]:{}},$g=[{ref:"Region"}],P1=[{ref:"Endpoint"}],U1=[Ce],eu=[oe],lc=[Tt],pi=[Qe,nt],lx=[{fn:yt,[y]:[{ref:"DisableS3ExpressSessionAuth"}]},{fn:_e,[y]:[{ref:"DisableS3ExpressSessionAuth"},!0]}],dx=[uc],tu=[Ox],ru=[qx],yn=[se],gx=[{fn:Ke,[y]:[Ce,6,14,!0],[$]:"s3expressAvailabilityZoneId"},{fn:Ke,[y]:[Ce,14,16,!0],[$]:"s3expressAvailabilityZoneDelim"},{fn:Z,[y]:[{ref:"s3expressAvailabilityZoneDelim"},"--"]}],To=[{[p]:[se],[S]:{url:"https://{Bucket}.s3express-fips-{s3expressAvailabilityZoneId}.{Region}.amazonaws.com",[v]:Ir,[F]:{}},[f]:S},{[S]:{url:"https://{Bucket}.s3express-{s3expressAvailabilityZoneId}.{Region}.amazonaws.com",[v]:Ir,[F]:{}},[f]:S}],ux=[{fn:Ke,[y]:[Ce,6,15,!0],[$]:"s3expressAvailabilityZoneId"},{fn:Ke,[y]:[Ce,15,17,!0],[$]:"s3expressAvailabilityZoneDelim"},{fn:Z,[y]:[{ref:"s3expressAvailabilityZoneDelim"},"--"]}],fx=[{fn:Ke,[y]:[Ce,6,19,!0],[$]:"s3expressAvailabilityZoneId"},{fn:Ke,[y]:[Ce,19,21,!0],[$]:"s3expressAvailabilityZoneDelim"},{fn:Z,[y]:[{ref:"s3expressAvailabilityZoneDelim"},"--"]}],Ix=[{fn:Ke,[y]:[Ce,6,20,!0],[$]:"s3expressAvailabilityZoneId"},{fn:Ke,[y]:[Ce,20,22,!0],[$]:"s3expressAvailabilityZoneDelim"},{fn:Z,[y]:[{ref:"s3expressAvailabilityZoneDelim"},"--"]}],px=[{fn:Ke,[y]:[Ce,6,26,!0],[$]:"s3expressAvailabilityZoneId"},{fn:Ke,[y]:[Ce,26,28,!0],[$]:"s3expressAvailabilityZoneDelim"},{fn:Z,[y]:[{ref:"s3expressAvailabilityZoneDelim"},"--"]}],_o=[{[p]:[se],[S]:{url:"https://{Bucket}.s3express-fips-{s3expressAvailabilityZoneId}.{Region}.amazonaws.com",[v]:pc,[F]:{}},[f]:S},{[S]:{url:"https://{Bucket}.s3express-{s3expressAvailabilityZoneId}.{Region}.amazonaws.com",[v]:pc,[F]:{}},[f]:S}],O1=[Ic],hx=[{fn:hi,[y]:[{ref:cu},!1]}],mx=[{fn:Z,[y]:[{ref:Dx},"beta"]}],q1=["*"],Or=[Px],Cx=[{fn:hi,[y]:[{ref:"Region"},!1]}],qr=[{fn:Z,[y]:[{ref:"Region"},"us-east-1"]}],iu=[{fn:Z,[y]:[Gx,Mx]}],Bx=[{fn:me,[y]:[lt,"resourceId[1]"],[$]:fu},{fn:"not",[y]:[{fn:Z,[y]:[Iu,""]}]}],G1=[lt,"resourceId[1]"],nu=[{fn:"not",[y]:[{fn:Z,[y]:[{fn:me,[y]:[lt,"region"]},""]}]}],yx=[{fn:"not",[y]:[{fn:yt,[y]:[{fn:me,[y]:[lt,"resourceId[2]"]}]}]}],H1=[lt,"resourceId[2]"],ou=[{fn:fc,[y]:[{fn:me,[y]:[lt,"region"]}],[$]:"bucketPartition"}],Ex=[{fn:Z,[y]:[Hx,{fn:me,[y]:[{ref:"partitionResult"},Je]}]}],su=[{fn:hi,[y]:[{fn:me,[y]:[lt,"region"]},!0]}],au=[{fn:hi,[y]:[Lx,!1]}],Qx=[{fn:hi,[y]:[Iu,!1]}],wx=[{fn:hi,[y]:[{ref:"Region"},!0]}],L1={version:"1.0",parameters:{Bucket:Cn,Region:Cn,UseFIPS:Bn,UseDualStack:Bn,Endpoint:Cn,ForcePathStyle:Bn,Accelerate:Bn,UseGlobalEndpoint:Bn,UseObjectLambdaEndpoint:Fo,Key:Cn,Prefix:Cn,CopySource:Cn,DisableAccessPoints:Fo,DisableMultiRegionAccessPoints:Bn,UseArnRegion:Fo,UseS3ExpressControlEndpoint:Fo,DisableS3ExpressSessionAuth:Fo},rules:[{[p]:[{fn:yt,[y]:$g}],rules:[{[p]:[Tt,se],error:"Accelerate cannot be used with FIPS",[f]:R},{[p]:[oe,Qe],error:"Cannot set dual-stack in combination with a custom endpoint.",[f]:R},{[p]:[Qe,se],error:"A custom endpoint cannot be combined with FIPS",[f]:R},{[p]:[Qe,Tt],error:"A custom endpoint cannot be combined with S3 Accelerate",[f]:R},{[p]:[se,Px,_S],error:"Partition does not support FIPS",[f]:R},{[p]:[Ic,{fn:Ke,[y]:[Ce,0,6,!0],[$]:wS},{fn:Z,[y]:[{ref:wS},"--x-s3"]}],rules:[{[p]:eu,error:"S3Express does not support Dual-stack.",[f]:R},{[p]:lc,error:"S3Express does not support S3 Accelerate.",[f]:R},{[p]:pi,rules:[{[p]:lx,rules:[{[p]:dx,rules:[{[p]:tu,rules:[{endpoint:{url:bS,[v]:Ir,[F]:M},[f]:S}],[f]:b}],[f]:b},{[p]:ru,rules:[{endpoint:{url:dc,[v]:Ir,[F]:M},[f]:S}],[f]:b},Og],[f]:b},{[p]:dx,rules:[{[p]:tu,rules:[{endpoint:{url:bS,[v]:pc,[F]:M},[f]:S}],[f]:b}],[f]:b},{[p]:ru,rules:[{endpoint:{url:dc,[v]:pc,[F]:M},[f]:S}],[f]:b},Og],[f]:b},{[p]:[MS,NS],rules:[{[p]:[Ox,P],rules:[{[p]:yn,endpoint:{url:"https://s3express-control-fips.{Region}.amazonaws.com/{uri_encoded_bucket}",[v]:Ir,[F]:M},[f]:S},{endpoint:{url:"https://s3express-control.{Region}.amazonaws.com/{uri_encoded_bucket}",[v]:Ir,[F]:M},[f]:S}],[f]:b}],[f]:b},{[p]:ru,rules:[{[p]:lx,rules:[{[p]:gx,rules:To,[f]:b},{[p]:ux,rules:To,[f]:b},{[p]:fx,rules:To,[f]:b},{[p]:Ix,rules:To,[f]:b},{[p]:px,rules:To,[f]:b},PS],[f]:b},{[p]:gx,rules:_o,[f]:b},{[p]:ux,rules:_o,[f]:b},{[p]:fx,rules:_o,[f]:b},{[p]:Ix,rules:_o,[f]:b},{[p]:px,rules:_o,[f]:b},PS],[f]:b},Og],[f]:b},{[p]:[US,MS,NS],rules:[{[p]:pi,endpoint:{url:gc,[v]:Ir,[F]:M},[f]:S},{[p]:yn,endpoint:{url:"https://s3express-control-fips.{Region}.amazonaws.com",[v]:Ir,[F]:M},[f]:S},{endpoint:{url:"https://s3express-control.{Region}.amazonaws.com",[v]:Ir,[F]:M},[f]:S}],[f]:b},{[p]:[Ic,{fn:Ke,[y]:[Ce,49,50,!0],[$]:kx},{fn:Ke,[y]:[Ce,8,12,!0],[$]:Dx},{fn:Ke,[y]:[Ce,0,7,!0],[$]:SS},{fn:Ke,[y]:[Ce,32,49,!0],[$]:cu},{fn:fc,[y]:$g,[$]:"regionPartition"},{fn:Z,[y]:[{ref:SS},"--op-s3"]}],rules:[{[p]:hx,rules:[{[p]:[{fn:Z,[y]:[OS,"e"]}],rules:[{[p]:mx,rules:[qS,{[p]:pi,endpoint:{url:"https://{Bucket}.ec2.{url#authority}",[v]:cc,[F]:M},[f]:S}],[f]:b},{endpoint:{url:"https://{Bucket}.ec2.s3-outposts.{Region}.{regionPartition#dnsSuffix}",[v]:cc,[F]:M},[f]:S}],[f]:b},{[p]:[{fn:Z,[y]:[OS,"o"]}],rules:[{[p]:mx,rules:[qS,{[p]:pi,endpoint:{url:"https://{Bucket}.op-{outpostId}.{url#authority}",[v]:cc,[F]:M},[f]:S}],[f]:b},{endpoint:{url:"https://{Bucket}.op-{outpostId}.s3-outposts.{Region}.{regionPartition#dnsSuffix}",[v]:cc,[F]:M},[f]:S}],[f]:b},{error:'Unrecognized hardware type: "Expected hardware type o or e but got {hardwareType}"',[f]:R}],[f]:b},{error:"Invalid ARN: The outpost Id must only contain a-z, A-Z, 0-9 and `-`.",[f]:R}],[f]:b},{[p]:O1,rules:[{[p]:[Qe,{fn:"not",[y]:[{fn:yt,[y]:[{fn:Sx,[y]:P1}]}]}],error:"Custom endpoint `{Endpoint}` was not a valid URI",[f]:R},{[p]:[qg,qx],rules:[{[p]:Or,rules:[{[p]:Cx,rules:[{[p]:[Tt,_S],error:"S3 Accelerate cannot be used in this region",[f]:R},{[p]:[oe,se,Ee,P,Se],endpoint:{url:"https://{Bucket}.s3-fips.dualstack.us-east-1.{partitionResult#dnsSuffix}",[v]:Fe,[F]:M},[f]:S},{[p]:[oe,se,Ee,P,V,Re],rules:[{endpoint:GS,[f]:S}],[f]:b},{[p]:[oe,se,Ee,P,V,Te],endpoint:GS,[f]:S},{[p]:[z,se,Ee,P,Se],endpoint:{url:"https://{Bucket}.s3-fips.us-east-1.{partitionResult#dnsSuffix}",[v]:Fe,[F]:M},[f]:S},{[p]:[z,se,Ee,P,V,Re],rules:[{endpoint:HS,[f]:S}],[f]:b},{[p]:[z,se,Ee,P,V,Te],endpoint:HS,[f]:S},{[p]:[oe,L,Tt,P,Se],endpoint:{url:"https://{Bucket}.s3-accelerate.dualstack.us-east-1.{partitionResult#dnsSuffix}",[v]:Fe,[F]:M},[f]:S},{[p]:[oe,L,Tt,P,V,Re],rules:[{endpoint:LS,[f]:S}],[f]:b},{[p]:[oe,L,Tt,P,V,Te],endpoint:LS,[f]:S},{[p]:[oe,L,Ee,P,Se],endpoint:{url:"https://{Bucket}.s3.dualstack.us-east-1.{partitionResult#dnsSuffix}",[v]:Fe,[F]:M},[f]:S},{[p]:[oe,L,Ee,P,V,Re],rules:[{endpoint:KS,[f]:S}],[f]:b},{[p]:[oe,L,Ee,P,V,Te],endpoint:KS,[f]:S},{[p]:[z,L,Ee,Qe,nt,uc,Se],endpoint:{url:vx,[v]:Fe,[F]:M},[f]:S},{[p]:[z,L,Ee,Qe,nt,Gg,Se],endpoint:{url:dc,[v]:Fe,[F]:M},[f]:S},{[p]:[z,L,Ee,Qe,nt,uc,V,Re],rules:[{[p]:qr,endpoint:Hg,[f]:S},{endpoint:Hg,[f]:S}],[f]:b},{[p]:[z,L,Ee,Qe,nt,Gg,V,Re],rules:[{[p]:qr,endpoint:Au,[f]:S},JS],[f]:b},{[p]:[z,L,Ee,Qe,nt,uc,V,Te],endpoint:Hg,[f]:S},{[p]:[z,L,Ee,Qe,nt,Gg,V,Te],endpoint:Au,[f]:S},{[p]:[z,L,Tt,P,Se],endpoint:{url:Fx,[v]:Fe,[F]:M},[f]:S},{[p]:[z,L,Tt,P,V,Re],rules:[{[p]:qr,endpoint:Lg,[f]:S},{endpoint:Lg,[f]:S}],[f]:b},{[p]:[z,L,Tt,P,V,Te],endpoint:Lg,[f]:S},{[p]:[z,L,Ee,P,Se],endpoint:{url:xS,[v]:Fe,[F]:M},[f]:S},{[p]:[z,L,Ee,P,V,Re],rules:[{[p]:qr,endpoint:{url:xS,[v]:we,[F]:M},[f]:S},{endpoint:zS,[f]:S}],[f]:b},{[p]:[z,L,Ee,P,V,Te],endpoint:zS,[f]:S}],[f]:b},Ac],[f]:b}],[f]:b},{[p]:[Qe,nt,{fn:Z,[y]:[{fn:me,[y]:[Ux,"scheme"]},"http"]},{fn:xx,[y]:[Ce,!0]},qg,L,z,Ee],rules:[{[p]:Or,rules:[{[p]:Cx,rules:[JS],[f]:b},Ac],[f]:b}],[f]:b},{[p]:[qg,{fn:Rx,[y]:U1,[$]:Tx}],rules:[{[p]:[{fn:me,[y]:[lt,"resourceId[0]"],[$]:_x},{fn:"not",[y]:[{fn:Z,[y]:[Gx,""]}]}],rules:[{[p]:[{fn:Z,[y]:[Kg,uu]}],rules:[{[p]:iu,rules:[{[p]:Bx,rules:[VS,YS,{[p]:nu,rules:[WS,{[p]:yx,rules:[Jg,{[p]:ou,rules:[{[p]:Or,rules:[{[p]:Ex,rules:[{[p]:su,rules:[{[p]:[{fn:Z,[y]:[Lx,""]}],error:"Invalid ARN: Missing account id",[f]:R},{[p]:au,rules:[{[p]:Qx,rules:[{[p]:pi,endpoint:{url:kS,[v]:zg,[F]:M},[f]:S},{[p]:yn,endpoint:{url:"https://{accessPointName}-{bucketArn#accountId}.s3-object-lambda-fips.{bucketArn#region}.{bucketPartition#dnsSuffix}",[v]:zg,[F]:M},[f]:S},{endpoint:{url:"https://{accessPointName}-{bucketArn#accountId}.s3-object-lambda.{bucketArn#region}.{bucketPartition#dnsSuffix}",[v]:zg,[F]:M},[f]:S}],[f]:b},jS],[f]:b},Vg],[f]:b},Yg],[f]:b},Wg],[f]:b}],[f]:b}],[f]:b},XS],[f]:b},{error:"Invalid ARN: bucket ARN is missing a region",[f]:R}],[f]:b},ZS],[f]:b},{error:"Invalid ARN: Object Lambda ARNs only support `accesspoint` arn types, but found: `{arnType}`",[f]:R}],[f]:b},{[p]:iu,rules:[{[p]:Bx,rules:[{[p]:nu,rules:[{[p]:iu,rules:[{[p]:nu,rules:[WS,{[p]:yx,rules:[Jg,{[p]:ou,rules:[{[p]:Or,rules:[{[p]:[{fn:Z,[y]:[Hx,"{partitionResult#name}"]}],rules:[{[p]:su,rules:[{[p]:[{fn:Z,[y]:[Kg,"s3"]}],rules:[{[p]:au,rules:[{[p]:Qx,rules:[{[p]:lc,error:"Access Points do not support S3 Accelerate",[f]:R},{[p]:[se,oe],endpoint:{url:"https://{accessPointName}-{bucketArn#accountId}.s3-accesspoint-fips.dualstack.{bucketArn#region}.{bucketPartition#dnsSuffix}",[v]:Ro,[F]:M},[f]:S},{[p]:[se,z],endpoint:{url:"https://{accessPointName}-{bucketArn#accountId}.s3-accesspoint-fips.{bucketArn#region}.{bucketPartition#dnsSuffix}",[v]:Ro,[F]:M},[f]:S},{[p]:[L,oe],endpoint:{url:"https://{accessPointName}-{bucketArn#accountId}.s3-accesspoint.dualstack.{bucketArn#region}.{bucketPartition#dnsSuffix}",[v]:Ro,[F]:M},[f]:S},{[p]:[L,z,Qe,nt],endpoint:{url:kS,[v]:Ro,[F]:M},[f]:S},{[p]:[L,z],endpoint:{url:"https://{accessPointName}-{bucketArn#accountId}.s3-accesspoint.{bucketArn#region}.{bucketPartition#dnsSuffix}",[v]:Ro,[F]:M},[f]:S}],[f]:b},jS],[f]:b},Vg],[f]:b},{error:"Invalid ARN: The ARN was not for the S3 service, found: {bucketArn#service}",[f]:R}],[f]:b},Yg],[f]:b},Wg],[f]:b}],[f]:b}],[f]:b},XS],[f]:b}],[f]:b}],[f]:b},{[p]:[{fn:hi,[y]:[Iu,!0]}],rules:[{[p]:eu,error:"S3 MRAP does not support dual-stack",[f]:R},{[p]:yn,error:"S3 MRAP does not support FIPS",[f]:R},{[p]:lc,error:"S3 MRAP does not support S3 Accelerate",[f]:R},{[p]:[{fn:_e,[y]:[{ref:"DisableMultiRegionAccessPoints"},!0]}],error:"Invalid configuration: Multi-Region Access Point ARNs are disabled.",[f]:R},{[p]:[{fn:fc,[y]:$g,[$]:DS}],rules:[{[p]:[{fn:Z,[y]:[{fn:me,[y]:[{ref:DS},Je]},{fn:me,[y]:[lt,"partition"]}]}],rules:[{endpoint:{url:"https://{accessPointName}.accesspoint.s3-global.{mrapPartition#dnsSuffix}",[v]:{[_t]:[{[ft]:!0,name:gu,[It]:"s3",[du]:q1}]},[F]:M},[f]:S}],[f]:b},{error:"Client was configured for partition `{mrapPartition#name}` but bucket referred to partition `{bucketArn#partition}`",[f]:R}],[f]:b}],[f]:b},{error:"Invalid Access Point Name",[f]:R}],[f]:b},ZS],[f]:b},{[p]:[{fn:Z,[y]:[Kg,Mo]}],rules:[{[p]:eu,error:"S3 Outposts does not support Dual-stack",[f]:R},{[p]:yn,error:"S3 Outposts does not support FIPS",[f]:R},{[p]:lc,error:"S3 Outposts does not support S3 Accelerate",[f]:R},{[p]:[{fn:yt,[y]:[{fn:me,[y]:[lt,"resourceId[4]"]}]}],error:"Invalid Arn: Outpost Access Point ARN contains sub resources",[f]:R},{[p]:[{fn:me,[y]:G1,[$]:cu}],rules:[{[p]:hx,rules:[Jg,{[p]:ou,rules:[{[p]:Or,rules:[{[p]:Ex,rules:[{[p]:su,rules:[{[p]:au,rules:[{[p]:[{fn:me,[y]:H1,[$]:vS}],rules:[{[p]:[{fn:me,[y]:[lt,"resourceId[3]"],[$]:fu}],rules:[{[p]:[{fn:Z,[y]:[{ref:vS},Mx]}],rules:[{[p]:pi,endpoint:{url:"https://{accessPointName}-{bucketArn#accountId}.{outpostId}.{url#authority}",[v]:$S,[F]:M},[f]:S},{endpoint:{url:"https://{accessPointName}-{bucketArn#accountId}.{outpostId}.s3-outposts.{bucketArn#region}.{bucketPartition#dnsSuffix}",[v]:$S,[F]:M},[f]:S}],[f]:b},{error:"Expected an outpost type `accesspoint`, found {outpostType}",[f]:R}],[f]:b},{error:"Invalid ARN: expected an access point name",[f]:R}],[f]:b},{error:"Invalid ARN: Expected a 4-component resource",[f]:R}],[f]:b},Vg],[f]:b},Yg],[f]:b},Wg],[f]:b}],[f]:b}],[f]:b},{error:"Invalid ARN: The outpost Id may only contain a-z, A-Z, 0-9 and `-`. Found: `{outpostId}`",[f]:R}],[f]:b},{error:"Invalid ARN: The Outpost Id was not set",[f]:R}],[f]:b},{error:"Invalid ARN: Unrecognized format: {Bucket} (type: {arnType})",[f]:R}],[f]:b},{error:"Invalid ARN: No ARN type specified",[f]:R}],[f]:b},{[p]:[{fn:Ke,[y]:[Ce,0,4,!1],[$]:FS},{fn:Z,[y]:[{ref:FS},"arn:"]},{fn:"not",[y]:[{fn:yt,[y]:[ex]}]}],error:"Invalid ARN: `{Bucket}` was not a valid ARN",[f]:R},{[p]:[{fn:_e,[y]:[N1,!0]},ex],error:"Path-style addressing cannot be used with ARN buckets",[f]:R},{[p]:tu,rules:[{[p]:Or,rules:[{[p]:[Ee],rules:[{[p]:[oe,P,se,Se],endpoint:{url:"https://s3-fips.dualstack.us-east-1.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[v]:Fe,[F]:M},[f]:S},{[p]:[oe,P,se,V,Re],rules:[{endpoint:tx,[f]:S}],[f]:b},{[p]:[oe,P,se,V,Te],endpoint:tx,[f]:S},{[p]:[z,P,se,Se],endpoint:{url:"https://s3-fips.us-east-1.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[v]:Fe,[F]:M},[f]:S},{[p]:[z,P,se,V,Re],rules:[{endpoint:rx,[f]:S}],[f]:b},{[p]:[z,P,se,V,Te],endpoint:rx,[f]:S},{[p]:[oe,P,L,Se],endpoint:{url:"https://s3.dualstack.us-east-1.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[v]:Fe,[F]:M},[f]:S},{[p]:[oe,P,L,V,Re],rules:[{endpoint:ix,[f]:S}],[f]:b},{[p]:[oe,P,L,V,Te],endpoint:ix,[f]:S},{[p]:[z,Qe,nt,L,Se],endpoint:{url:Nx,[v]:Fe,[F]:M},[f]:S},{[p]:[z,Qe,nt,L,V,Re],rules:[{[p]:qr,endpoint:jg,[f]:S},{endpoint:jg,[f]:S}],[f]:b},{[p]:[z,Qe,nt,L,V,Te],endpoint:jg,[f]:S},{[p]:[z,P,L,Se],endpoint:{url:RS,[v]:Fe,[F]:M},[f]:S},{[p]:[z,P,L,V,Re],rules:[{[p]:qr,endpoint:{url:RS,[v]:we,[F]:M},[f]:S},{endpoint:nx,[f]:S}],[f]:b},{[p]:[z,P,L,V,Te],endpoint:nx,[f]:S}],[f]:b},{error:"Path-style addressing cannot be used with S3 Accelerate",[f]:R}],[f]:b}],[f]:b}],[f]:b},{[p]:[{fn:yt,[y]:[ox]},{fn:_e,[y]:[ox,!0]}],rules:[{[p]:Or,rules:[{[p]:wx,rules:[VS,YS,{[p]:pi,endpoint:{url:gc,[v]:Xg,[F]:M},[f]:S},{[p]:yn,endpoint:{url:"https://s3-object-lambda-fips.{Region}.{partitionResult#dnsSuffix}",[v]:Xg,[F]:M},[f]:S},{endpoint:{url:"https://s3-object-lambda.{Region}.{partitionResult#dnsSuffix}",[v]:Xg,[F]:M},[f]:S}],[f]:b},Ac],[f]:b}],[f]:b},{[p]:[US],rules:[{[p]:Or,rules:[{[p]:wx,rules:[{[p]:[se,oe,P,Se],endpoint:{url:"https://s3-fips.dualstack.us-east-1.{partitionResult#dnsSuffix}",[v]:Fe,[F]:M},[f]:S},{[p]:[se,oe,P,V,Re],rules:[{endpoint:sx,[f]:S}],[f]:b},{[p]:[se,oe,P,V,Te],endpoint:sx,[f]:S},{[p]:[se,z,P,Se],endpoint:{url:"https://s3-fips.us-east-1.{partitionResult#dnsSuffix}",[v]:Fe,[F]:M},[f]:S},{[p]:[se,z,P,V,Re],rules:[{endpoint:ax,[f]:S}],[f]:b},{[p]:[se,z,P,V,Te],endpoint:ax,[f]:S},{[p]:[L,oe,P,Se],endpoint:{url:"https://s3.dualstack.us-east-1.{partitionResult#dnsSuffix}",[v]:Fe,[F]:M},[f]:S},{[p]:[L,oe,P,V,Re],rules:[{endpoint:cx,[f]:S}],[f]:b},{[p]:[L,oe,P,V,Te],endpoint:cx,[f]:S},{[p]:[L,z,Qe,nt,Se],endpoint:{url:gc,[v]:Fe,[F]:M},[f]:S},{[p]:[L,z,Qe,nt,V,Re],rules:[{[p]:qr,endpoint:Zg,[f]:S},{endpoint:Zg,[f]:S}],[f]:b},{[p]:[L,z,Qe,nt,V,Te],endpoint:Zg,[f]:S},{[p]:[L,z,P,Se],endpoint:{url:TS,[v]:Fe,[F]:M},[f]:S},{[p]:[L,z,P,V,Re],rules:[{[p]:qr,endpoint:{url:TS,[v]:we,[F]:M},[f]:S},{endpoint:Ax,[f]:S}],[f]:b},{[p]:[L,z,P,V,Te],endpoint:Ax,[f]:S}],[f]:b},Ac],[f]:b}],[f]:b}],[f]:b},{error:"A region must be set when sending requests to S3.",[f]:R}]},Kx=L1;var K1=new Ka({size:50,params:["Accelerate","Bucket","DisableAccessPoints","DisableMultiRegionAccessPoints","DisableS3ExpressSessionAuth","Endpoint","ForcePathStyle","Region","UseArnRegion","UseDualStack","UseFIPS","UseGlobalEndpoint","UseObjectLambdaEndpoint","UseS3ExpressControlEndpoint"]}),hc=(e,t={})=>K1.get(e,()=>bg(Kx,{endpointParams:e,logger:t.logger}));ui.aws=xg;var J1=e=>async(t,r,i)=>{if(!i)throw new Error("Could not find `input` for `defaultEndpointRuleSetHttpAuthSchemeParametersProvider`");let n=await e(t,r,i),o=ut(r)?.commandInstance?.constructor?.getEndpointParameterInstructions;if(!o)throw new Error(`getEndpointParameterInstructions() is not defined on \`${r.commandName}\``);let a=await Fg(i,{getEndpointParameterInstructions:o},t);return Object.assign(n,a)},z1=async(e,t,r)=>({operation:ut(t).operation,region:await Oe(e.region)()||(()=>{throw new Error("expected `region` to be configured for `aws.auth#sigv4`")})()}),Jx=J1(z1);function zx(e){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"s3",region:e.region},propertiesExtractor:(t,r)=>({signingProperties:{config:t,context:r}})}}function Vx(e){return{schemeId:"aws.auth#sigv4a",signingProperties:{name:"s3",region:e.region},propertiesExtractor:(t,r)=>({signingProperties:{config:t,context:r}})}}var V1=(e,t,r)=>n=>{let a=e(n).properties?.authSchemes;if(!a)return t(n);let s=[];for(let c of a){let{name:A,properties:l={},...d}=c,g=A.toLowerCase(),u;if(g==="sigv4a"){u="aws.auth#sigv4a";let B=a.find(h=>{let Q=h.name.toLowerCase();return Q!=="sigv4a"&&Q.startsWith("sigv4")});if(!sc.CrtSignerV4&&B)continue}else if(g.startsWith("sigv4"))u="aws.auth#sigv4";else throw new Error(`Unknown HttpAuthScheme found in \`@smithy.rules#endpointRuleSet\`: \`${g}\``);let I=r[u];if(!I)throw new Error(`Could not find HttpAuthOption create function for \`${u}\``);let C=I(n);C.schemeId=u,C.signingProperties={...C.signingProperties||{},...d,...l},s.push(C)}return s},Y1=e=>{let t=[];switch(e.operation){default:t.push(zx(e)),t.push(Vx(e))}return t},Yx=V1(hc,Y1,{"aws.auth#sigv4":zx,"aws.auth#sigv4a":Vx}),Wx=e=>{let t=YQ(e);return{...kQ(t)}};var jx=e=>({...e,useFipsEndpoint:e.useFipsEndpoint??!1,useDualstackEndpoint:e.useDualstackEndpoint??!1,forcePathStyle:e.forcePathStyle??!1,useAccelerateEndpoint:e.useAccelerateEndpoint??!1,useGlobalEndpoint:e.useGlobalEndpoint??!1,disableMultiregionAccessPoints:e.disableMultiregionAccessPoints??!1,defaultSigningName:"s3"}),En={ForcePathStyle:{type:"clientContextParams",name:"forcePathStyle"},UseArnRegion:{type:"clientContextParams",name:"useArnRegion"},DisableMultiRegionAccessPoints:{type:"clientContextParams",name:"disableMultiregionAccessPoints"},Accelerate:{type:"clientContextParams",name:"useAccelerateEndpoint"},DisableS3ExpressSessionAuth:{type:"clientContextParams",name:"disableS3ExpressSessionAuth"},UseGlobalEndpoint:{type:"builtInParams",name:"useGlobalEndpoint"},UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}};var xe=class e extends Pa{constructor(t){super(t),Object.setPrototypeOf(this,e.prototype)}};var mc=class e extends xe{name="NoSuchUpload";$fault="client";constructor(t){super({name:"NoSuchUpload",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}};var Cc=class e extends xe{name="ObjectNotInActiveTierError";$fault="client";constructor(t){super({name:"ObjectNotInActiveTierError",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},Bc=class e extends xe{name="BucketAlreadyExists";$fault="client";constructor(t){super({name:"BucketAlreadyExists",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},yc=class e extends xe{name="BucketAlreadyOwnedByYou";$fault="client";constructor(t){super({name:"BucketAlreadyOwnedByYou",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}};var Ec=class e extends xe{name="NoSuchBucket";$fault="client";constructor(t){super({name:"NoSuchBucket",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},pu;(function(e){e.visit=(t,r)=>t.Prefix!==void 0?r.Prefix(t.Prefix):t.Tag!==void 0?r.Tag(t.Tag):t.And!==void 0?r.And(t.And):r._(t.$unknown[0],t.$unknown[1])})(pu||(pu={}));var hu;(function(e){e.visit=(t,r)=>t.Prefix!==void 0?r.Prefix(t.Prefix):t.Tag!==void 0?r.Tag(t.Tag):t.AccessPointArn!==void 0?r.AccessPointArn(t.AccessPointArn):t.And!==void 0?r.And(t.And):r._(t.$unknown[0],t.$unknown[1])})(hu||(hu={}));var Qc=class e extends xe{name="InvalidObjectState";$fault="client";StorageClass;AccessTier;constructor(t){super({name:"InvalidObjectState",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.StorageClass=t.StorageClass,this.AccessTier=t.AccessTier}},wc=class e extends xe{name="NoSuchKey";$fault="client";constructor(t){super({name:"NoSuchKey",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}};var bc=class e extends xe{name="NotFound";$fault="client";constructor(t){super({name:"NotFound",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}};var W1=e=>({...e,...e.SecretAccessKey&&{SecretAccessKey:tt},...e.SessionToken&&{SessionToken:tt}}),Xx=e=>({...e,...e.SSEKMSKeyId&&{SSEKMSKeyId:tt},...e.SSEKMSEncryptionContext&&{SSEKMSEncryptionContext:tt},...e.Credentials&&{Credentials:W1(e.Credentials)}}),Zx=e=>({...e,...e.SSEKMSKeyId&&{SSEKMSKeyId:tt},...e.SSEKMSEncryptionContext&&{SSEKMSEncryptionContext:tt}});var Sc=class e extends xe{name="EncryptionTypeMismatch";$fault="client";constructor(t){super({name:"EncryptionTypeMismatch",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},xc=class e extends xe{name="InvalidRequest";$fault="client";constructor(t){super({name:"InvalidRequest",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},kc=class e extends xe{name="InvalidWriteOffset";$fault="client";constructor(t){super({name:"InvalidWriteOffset",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},Dc=class e extends xe{name="TooManyParts";$fault="client";constructor(t){super({name:"TooManyParts",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},vc=class e extends xe{name="ObjectAlreadyInActiveTierError";$fault="client";constructor(t){super({name:"ObjectAlreadyInActiveTierError",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}};var $x;(function(e){e.visit=(t,r)=>t.Records!==void 0?r.Records(t.Records):t.Stats!==void 0?r.Stats(t.Stats):t.Progress!==void 0?r.Progress(t.Progress):t.Cont!==void 0?r.Cont(t.Cont):t.End!==void 0?r.End(t.End):r._(t.$unknown[0],t.$unknown[1])})($x||($x={}));var ek=e=>({...e,...e.SSEKMSKeyId&&{SSEKMSKeyId:tt},...e.SSEKMSEncryptionContext&&{SSEKMSEncryptionContext:tt}}),tk=e=>({...e,...e.SSECustomerKey&&{SSECustomerKey:tt},...e.SSEKMSKeyId&&{SSEKMSKeyId:tt},...e.SSEKMSEncryptionContext&&{SSEKMSEncryptionContext:tt}});var rk=e=>({...e,...e.SSEKMSKeyId&&{SSEKMSKeyId:tt}}),ik=e=>({...e,...e.SSECustomerKey&&{SSECustomerKey:tt}});var ck=async(e,t)=>{let r=fo(e,t),i=de({},Ft,{[JJ]:e[xJ],[Uo]:e[No],[Oo]:e[Po],[Jc]:e[qc],[Gr]:[()=>Ft(e[mi]),()=>e[mi].toString()]});r.bp("/"),r.p("Bucket",()=>e.Bucket,"{Bucket}",!1);let n=de({[HJ]:[,""]});return r.m("GET").h(i).q(n).b(void 0),r.build()};var Ak=async(e,t)=>{let r=fo(e,t),i=de({},Ft,{[PJ]:e[hJ]||"application/octet-stream",[KJ]:e[gJ],[TJ]:e[uJ],[_J]:e[fJ],[MJ]:e[IJ],[NJ]:e[pJ],[yk]:[()=>Ft(e[Tc]),()=>e[Tc].toString()],[Ek]:e[Ik],[xk]:e[fk],[Gc]:e[_c],[Hc]:e[Mc],[Lc]:e[Nc],[Kc]:e[Pc],[UJ]:[()=>Ft(e[nk]),()=>Hd(e[nk]).toString()],[OJ]:e[EJ],[qJ]:e[QJ],[VJ]:e[mJ],[YJ]:e[CJ],[WJ]:e[BJ],[jJ]:e[yJ],[i8]:[()=>Ft(e[sk]),()=>e[sk].toString()],[Uo]:e[No],[e8]:e[Rc],[n8]:e[RJ],[zc]:e[Uc],[kk]:e[Bk],[Vc]:e[Oc],[Oo]:e[Po],[Jc]:e[qc],[Gr]:[()=>Ft(e[mi]),()=>e[mi].toString()],[Sk]:e[Ck],[t8]:e[DJ],[ZJ]:e[bJ],[$J]:[()=>Ft(e[ok]),()=>ow(e[ok]).toString()],[XJ]:e[wJ],[wk]:e[pk],...e.Metadata!==void 0&&Object.keys(e.Metadata).reduce((s,c)=>(s[`x-amz-meta-${c.toLowerCase()}`]=e.Metadata[c],s),{})});r.bp("/{Key+}"),r.p("Bucket",()=>e.Bucket,"{Bucket}",!1),r.p("Key",()=>e.Key,"{Key+}",!0);let n=de({[Dk]:[,"PutObject"]}),o,a;return e.Body!==void 0&&(a=e.Body,o=a),r.m("PUT").h(i).q(n).b(o),r.build()};var lk=async(e,t)=>{let r=fo(e,t),i=de({},Ft,{"content-type":"application/octet-stream",[yk]:[()=>Ft(e[Tc]),()=>e[Tc].toString()],[Ek]:e[Ik],[xk]:e[fk],[Gc]:e[_c],[Hc]:e[Mc],[Lc]:e[Nc],[Kc]:e[Pc],[zc]:e[Uc],[kk]:e[Bk],[Vc]:e[Oc],[Sk]:e[Ck],[wk]:e[pk]});r.bp("/{Key+}"),r.p("Bucket",()=>e.Bucket,"{Bucket}",!1),r.p("Key",()=>e.Key,"{Key+}",!0);let n=de({[Dk]:[,"UploadPart"],[GJ]:[go(e.PartNumber,"PartNumber")!=null,()=>e[SJ].toString()],[LJ]:[,go(e[vJ],"UploadId")]}),o,a;return e.Body!==void 0&&(a=e.Body,o=a),r.m("PUT").h(i).q(n).b(o),r.build()};var dk=async(e,t)=>{if(e.statusCode!==200&&e.statusCode>=300)return Qu(e,t);let r=de({$metadata:ze(e),[No]:[,e.headers[Uo]],[Po]:[,e.headers[Oo]],[qc]:[,e.headers[Jc]],[mi]:[()=>e.headers[Gr]!==void 0,()=>Sa(e.headers[Gr])]}),i=go(fQ(await Ig(e.body,t)),"body");return i[Bu]!=null&&(r[Bu]=dJ(i[Bu],t)),r};var gk=async(e,t)=>{if(e.statusCode!==200&&e.statusCode>=300)return Qu(e,t);let r=de({$metadata:ze(e),[Fc]:[,e.headers[zJ]],[hk]:[,e.headers[Qk]],[_c]:[,e.headers[Gc]],[Mc]:[,e.headers[Hc]],[Nc]:[,e.headers[Lc]],[Pc]:[,e.headers[Kc]],[No]:[,e.headers[Uo]],[FJ]:[,e.headers[r8]],[Uc]:[,e.headers[zc]],[Oc]:[,e.headers[Vc]],[Po]:[,e.headers[Oo]],[qc]:[,e.headers[Jc]],[mi]:[()=>e.headers[Gr]!==void 0,()=>Sa(e.headers[Gr])],[kJ]:[()=>e.headers[ak]!==void 0,()=>pQ(e.headers[ak])],[mk]:[,e.headers[bk]]});return await lr(e.body,t),r};var uk=async(e,t)=>{if(e.statusCode!==200&&e.statusCode>=300)return Qu(e,t);let r=de({$metadata:ze(e),[No]:[,e.headers[Uo]],[hk]:[,e.headers[Qk]],[_c]:[,e.headers[Gc]],[Mc]:[,e.headers[Hc]],[Nc]:[,e.headers[Lc]],[Pc]:[,e.headers[Kc]],[Uc]:[,e.headers[zc]],[Oc]:[,e.headers[Vc]],[Po]:[,e.headers[Oo]],[mi]:[()=>e.headers[Gr]!==void 0,()=>Sa(e.headers[Gr])],[mk]:[,e.headers[bk]]});return await lr(e.body,t),r};var Qu=async(e,t)=>{let r={...e,body:await qw(e.body,t)},i=Gw(e,r.body);switch(i){case"NoSuchUpload":case"com.amazonaws.s3#NoSuchUpload":throw await sJ(r,t);case"ObjectNotInActiveTierError":case"com.amazonaws.s3#ObjectNotInActiveTierError":throw await AJ(r,t);case"BucketAlreadyExists":case"com.amazonaws.s3#BucketAlreadyExists":throw await Z1(r,t);case"BucketAlreadyOwnedByYou":case"com.amazonaws.s3#BucketAlreadyOwnedByYou":throw await $1(r,t);case"NoSuchBucket":case"com.amazonaws.s3#NoSuchBucket":throw await nJ(r,t);case"InvalidObjectState":case"com.amazonaws.s3#InvalidObjectState":throw await tJ(r,t);case"NoSuchKey":case"com.amazonaws.s3#NoSuchKey":throw await oJ(r,t);case"NotFound":case"com.amazonaws.s3#NotFound":throw await aJ(r,t);case"EncryptionTypeMismatch":case"com.amazonaws.s3#EncryptionTypeMismatch":throw await eJ(r,t);case"InvalidRequest":case"com.amazonaws.s3#InvalidRequest":throw await rJ(r,t);case"InvalidWriteOffset":case"com.amazonaws.s3#InvalidWriteOffset":throw await iJ(r,t);case"TooManyParts":case"com.amazonaws.s3#TooManyParts":throw await lJ(r,t);case"ObjectAlreadyInActiveTierError":case"com.amazonaws.s3#ObjectAlreadyInActiveTierError":throw await cJ(r,t);default:let n=r.body;return X1({output:e,parsedBody:n,errorCode:i})}},X1=XQ(xe),Z1=async(e,t)=>{let r=de({}),i=e.body,n=new Bc({$metadata:ze(e),...r});return Le(n,e.body)},$1=async(e,t)=>{let r=de({}),i=e.body,n=new yc({$metadata:ze(e),...r});return Le(n,e.body)},eJ=async(e,t)=>{let r=de({}),i=e.body,n=new Sc({$metadata:ze(e),...r});return Le(n,e.body)},tJ=async(e,t)=>{let r=de({}),i=e.body;i[Cu]!=null&&(r[Cu]=cn(i[Cu])),i[Rc]!=null&&(r[Rc]=cn(i[Rc]));let n=new Qc({$metadata:ze(e),...r});return Le(n,e.body)},rJ=async(e,t)=>{let r=de({}),i=e.body,n=new xc({$metadata:ze(e),...r});return Le(n,e.body)},iJ=async(e,t)=>{let r=de({}),i=e.body,n=new kc({$metadata:ze(e),...r});return Le(n,e.body)},nJ=async(e,t)=>{let r=de({}),i=e.body,n=new Ec({$metadata:ze(e),...r});return Le(n,e.body)},oJ=async(e,t)=>{let r=de({}),i=e.body,n=new wc({$metadata:ze(e),...r});return Le(n,e.body)},sJ=async(e,t)=>{let r=de({}),i=e.body,n=new mc({$metadata:ze(e),...r});return Le(n,e.body)},aJ=async(e,t)=>{let r=de({}),i=e.body,n=new bc({$metadata:ze(e),...r});return Le(n,e.body)},cJ=async(e,t)=>{let r=de({}),i=e.body,n=new vc({$metadata:ze(e),...r});return Le(n,e.body)},AJ=async(e,t)=>{let r=de({}),i=e.body,n=new Cc({$metadata:ze(e),...r});return Le(n,e.body)},lJ=async(e,t)=>{let r=de({}),i=e.body,n=new Dc({$metadata:ze(e),...r});return Le(n,e.body)};var dJ=(e,t)=>{let r={};return e[mu]!=null&&(r[mu]=cn(e[mu])),e[yu]!=null&&(r[yu]=cn(e[yu])),e[Eu]!=null&&(r[Eu]=cn(e[Eu])),e[Fc]!=null&&(r[Fc]=go(Ld(e[Fc]))),r};var ze=e=>({httpStatusCode:e.statusCode,requestId:e.headers["x-amzn-requestid"]??e.headers["x-amzn-request-id"]??e.headers["x-amz-request-id"],extendedRequestId:e.headers["x-amz-id-2"],cfId:e.headers["x-amz-cf-id"]});var gJ="ACL";var mu="AccessKeyId";var Cu="AccessTier";var mi="BucketKeyEnabled";var Bu="Credentials",fk="ChecksumAlgorithm";var uJ="CacheControl",_c="ChecksumCRC32",Mc="ChecksumCRC32C",fJ="ContentDisposition";var IJ="ContentEncoding";var pJ="ContentLanguage",Tc="ContentLength";var Ik="ContentMD5";var Nc="ChecksumSHA1",Pc="ChecksumSHA256";var hJ="ContentType";var nk="Expires";var pk="ExpectedBucketOwner";var hk="ETag";var Fc="Expiration";var mJ="GrantFullControl";var CJ="GrantRead",BJ="GrantReadACP";var yJ="GrantWriteACP";var EJ="IfMatch";var QJ="IfNoneMatch";var wJ="ObjectLockLegalHoldStatus",bJ="ObjectLockMode";var ok="ObjectLockRetainUntilDate";var SJ="PartNumber";var mk="RequestCharged";var Ck="RequestPayer";var yu="SecretAccessKey";var Rc="StorageClass";var xJ="SessionMode";var No="ServerSideEncryption";var Uc="SSECustomerAlgorithm",Bk="SSECustomerKey",Oc="SSECustomerKeyMD5";var qc="SSEKMSEncryptionContext",Po="SSEKMSKeyId";var Eu="SessionToken";var kJ="Size";var DJ="Tagging";var vJ="UploadId";var FJ="VersionId";var sk="WriteOffsetBytes",RJ="WebsiteRedirectLocation";var TJ="cache-control",_J="content-disposition",MJ="content-encoding",NJ="content-language",yk="content-length",Ek="content-md5";var PJ="content-type";var UJ="expires";var Qk="etag";var OJ="if-match";var qJ="if-none-match";var GJ="partNumber";var HJ="session";var LJ="uploadId";var KJ="x-amz-acl";var Gc="x-amz-checksum-crc32",Hc="x-amz-checksum-crc32c";var Lc="x-amz-checksum-sha1",Kc="x-amz-checksum-sha256";var JJ="x-amz-create-session-mode";var zJ="x-amz-expiration",wk="x-amz-expected-bucket-owner";var VJ="x-amz-grant-full-control",YJ="x-amz-grant-read",WJ="x-amz-grant-read-acp";var jJ="x-amz-grant-write-acp";var XJ="x-amz-object-lock-legal-hold",ZJ="x-amz-object-lock-mode",$J="x-amz-object-lock-retain-until-date";var ak="x-amz-object-size";var bk="x-amz-request-charged";var Sk="x-amz-request-payer";var e8="x-amz-storage-class",xk="x-amz-sdk-checksum-algorithm";var Uo="x-amz-server-side-encryption",Oo="x-amz-server-side-encryption-aws-kms-key-id",Gr="x-amz-server-side-encryption-bucket-key-enabled",Jc="x-amz-server-side-encryption-context",zc="x-amz-server-side-encryption-customer-algorithm",kk="x-amz-server-side-encryption-customer-key",Vc="x-amz-server-side-encryption-customer-key-md5",t8="x-amz-tagging";var r8="x-amz-version-id",i8="x-amz-write-offset-bytes",n8="x-amz-website-redirect-location",Dk="x-id";var Yc=class extends gr.classBuilder().ep({...En,DisableS3ExpressSessionAuth:{type:"staticContextParams",value:!0},Bucket:{type:"contextParams",name:"Bucket"}}).m(function(t,r,i,n){return[sn(i,this.serialize,this.deserialize),In(i,t.getEndpointParameterInstructions()),gn(i)]}).s("AmazonS3","CreateSession",{}).n("S3Client","CreateSessionCommand").f(Zx,Xx).ser(ck).de(dk).build(){};var vk={name:"@aws-sdk/client-s3",description:"AWS SDK for JavaScript S3 Client for Node.js, Browser and React Native",version:"3.726.1",scripts:{build:"concurrently 'yarn:build:cjs' 'yarn:build:es' 'yarn:build:types'","build:cjs":"node ../../scripts/compilation/inline client-s3","build:es":"tsc -p tsconfig.es.json","build:include:deps":"lerna run --scope $npm_package_name --include-dependencies build","build:types":"tsc -p tsconfig.types.json","build:types:downlevel":"downlevel-dts dist-types dist-types/ts3.4",clean:"rimraf ./dist-* && rimraf *.tsbuildinfo","extract:docs":"api-extractor run --local","generate:client":"node ../../scripts/generate-clients/single-service --solo s3",test:"yarn g:vitest run","test:browser":"node ./test/browser-build/esbuild && yarn g:vitest run -c vitest.config.browser.ts","test:browser:watch":"node ./test/browser-build/esbuild && yarn g:vitest watch -c vitest.config.browser.ts","test:e2e":"yarn g:vitest run -c vitest.config.e2e.ts && yarn test:browser","test:e2e:watch":"yarn g:vitest watch -c vitest.config.e2e.ts","test:watch":"yarn g:vitest watch"},main:"./dist-cjs/index.js",types:"./dist-types/index.d.ts",module:"./dist-es/index.js",sideEffects:!1,dependencies:{"@aws-crypto/sha1-browser":"5.2.0","@aws-crypto/sha256-browser":"5.2.0","@aws-crypto/sha256-js":"5.2.0","@aws-sdk/client-sso-oidc":"3.726.0","@aws-sdk/client-sts":"3.726.1","@aws-sdk/core":"3.723.0","@aws-sdk/credential-provider-node":"3.726.0","@aws-sdk/middleware-bucket-endpoint":"3.726.0","@aws-sdk/middleware-expect-continue":"3.723.0","@aws-sdk/middleware-flexible-checksums":"3.723.0","@aws-sdk/middleware-host-header":"3.723.0","@aws-sdk/middleware-location-constraint":"3.723.0","@aws-sdk/middleware-logger":"3.723.0","@aws-sdk/middleware-recursion-detection":"3.723.0","@aws-sdk/middleware-sdk-s3":"3.723.0","@aws-sdk/middleware-ssec":"3.723.0","@aws-sdk/middleware-user-agent":"3.726.0","@aws-sdk/region-config-resolver":"3.723.0","@aws-sdk/signature-v4-multi-region":"3.723.0","@aws-sdk/types":"3.723.0","@aws-sdk/util-endpoints":"3.726.0","@aws-sdk/util-user-agent-browser":"3.723.0","@aws-sdk/util-user-agent-node":"3.726.0","@aws-sdk/xml-builder":"3.723.0","@smithy/config-resolver":"^4.0.0","@smithy/core":"^3.0.0","@smithy/eventstream-serde-browser":"^4.0.0","@smithy/eventstream-serde-config-resolver":"^4.0.0","@smithy/eventstream-serde-node":"^4.0.0","@smithy/fetch-http-handler":"^5.0.0","@smithy/hash-blob-browser":"^4.0.0","@smithy/hash-node":"^4.0.0","@smithy/hash-stream-node":"^4.0.0","@smithy/invalid-dependency":"^4.0.0","@smithy/md5-js":"^4.0.0","@smithy/middleware-content-length":"^4.0.0","@smithy/middleware-endpoint":"^4.0.0","@smithy/middleware-retry":"^4.0.0","@smithy/middleware-serde":"^4.0.0","@smithy/middleware-stack":"^4.0.0","@smithy/node-config-provider":"^4.0.0","@smithy/node-http-handler":"^4.0.0","@smithy/protocol-http":"^5.0.0","@smithy/smithy-client":"^4.0.0","@smithy/types":"^4.0.0","@smithy/url-parser":"^4.0.0","@smithy/util-base64":"^4.0.0","@smithy/util-body-length-browser":"^4.0.0","@smithy/util-body-length-node":"^4.0.0","@smithy/util-defaults-mode-browser":"^4.0.0","@smithy/util-defaults-mode-node":"^4.0.0","@smithy/util-endpoints":"^3.0.0","@smithy/util-middleware":"^4.0.0","@smithy/util-retry":"^4.0.0","@smithy/util-stream":"^4.0.0","@smithy/util-utf8":"^4.0.0","@smithy/util-waiter":"^4.0.0",tslib:"^2.6.2"},devDependencies:{"@aws-sdk/signature-v4-crt":"3.726.0","@tsconfig/node18":"18.2.4","@types/node":"^18.19.69",concurrently:"7.0.0","downlevel-dts":"0.10.1",rimraf:"3.0.2",typescript:"~5.2.2"},engines:{node:">=18.0.0"},typesVersions:{"<4.0":{"dist-types/*":["dist-types/ts3.4/*"]}},files:["dist-*/**"],author:{name:"AWS SDK for JavaScript Team",url:"https://aws.amazon.com/javascript/"},license:"Apache-2.0",browser:{"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.browser"},"react-native":{"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.native"},homepage:"https://github.com/aws/aws-sdk-js-v3/tree/main/clients/client-s3",repository:{type:"git",url:"https://github.com/aws/aws-sdk-js-v3.git",directory:"clients/client-s3"}};var wu=e=>new TextEncoder().encode(e);function bu(e){return typeof e=="string"?e.length===0:e.byteLength===0}var Su={name:"SHA-1"},xu={name:"HMAC",hash:Su},Fk=new Uint8Array([218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9]);var s8={};function Et(){return typeof window<"u"?window:typeof self<"u"?self:s8}var ku=(function(){function e(t){this.toHash=new Uint8Array(0),t!==void 0&&(this.key=new Promise(function(r,i){Et().crypto.subtle.importKey("raw",Rk(t),xu,!1,["sign"]).then(r,i)}),this.key.catch(function(){}))}return e.prototype.update=function(t){if(!bu(t)){var r=Rk(t),i=new Uint8Array(this.toHash.byteLength+r.byteLength);i.set(this.toHash,0),i.set(r,this.toHash.byteLength),this.toHash=i}},e.prototype.digest=function(){var t=this;return this.key?this.key.then(function(r){return Et().crypto.subtle.sign(xu,r,t.toHash).then(function(i){return new Uint8Array(i)})}):bu(this.toHash)?Promise.resolve(Fk):Promise.resolve().then(function(){return Et().crypto.subtle.digest(Su,t.toHash)}).then(function(r){return Promise.resolve(new Uint8Array(r))})},e.prototype.reset=function(){this.toHash=new Uint8Array(0)},e})();function Rk(e){return typeof e=="string"?wu(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}var a8=["decrypt","digest","encrypt","exportKey","generateKey","importKey","sign","verify"];function Wc(e){if(c8(e)&&typeof e.crypto.subtle=="object"){var t=e.crypto.subtle;return A8(t)}return!1}function c8(e){if(typeof e=="object"&&typeof e.crypto=="object"){var t=e.crypto.getRandomValues;return typeof t=="function"}return!1}function A8(e){return e&&a8.every(function(t){return typeof e[t]=="function"})}var Tk=(function(){function e(t){if(Wc(Et()))this.hash=new ku(t);else throw new Error("SHA1 not supported")}return e.prototype.update=function(t,r){this.hash.update(it(t))},e.prototype.digest=function(){return this.hash.digest()},e.prototype.reset=function(){this.hash.reset()},e})();var Du={name:"SHA-256"},vu={name:"HMAC",hash:Du},_k=new Uint8Array([227,176,196,66,152,252,28,20,154,251,244,200,153,111,185,36,39,174,65,228,100,155,147,76,164,149,153,27,120,82,184,85]);var Fu=(function(){function e(t){this.toHash=new Uint8Array(0),this.secret=t,this.reset()}return e.prototype.update=function(t){if(!Vt(t)){var r=it(t),i=new Uint8Array(this.toHash.byteLength+r.byteLength);i.set(this.toHash,0),i.set(r,this.toHash.byteLength),this.toHash=i}},e.prototype.digest=function(){var t=this;return this.key?this.key.then(function(r){return Et().crypto.subtle.sign(vu,r,t.toHash).then(function(i){return new Uint8Array(i)})}):Vt(this.toHash)?Promise.resolve(_k):Promise.resolve().then(function(){return Et().crypto.subtle.digest(Du,t.toHash)}).then(function(r){return Promise.resolve(new Uint8Array(r))})},e.prototype.reset=function(){var t=this;this.toHash=new Uint8Array(0),this.secret&&this.secret!==void 0&&(this.key=new Promise(function(r,i){Et().crypto.subtle.importKey("raw",it(t.secret),vu,!1,["sign"]).then(r,i)}),this.key.catch(function(){}))},e})();var dt=64,Mk=32,Nk=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Pk=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],Uk=Math.pow(2,53)-1;var qo=(function(){function e(){this.state=Int32Array.from(Pk),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return e.prototype.update=function(t){if(this.finished)throw new Error("Attempted to update an already finished hash.");var r=0,i=t.byteLength;if(this.bytesHashed+=i,this.bytesHashed*8>Uk)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;i>0;)this.buffer[this.bufferLength++]=t[r++],i--,this.bufferLength===dt&&(this.hashBuffer(),this.bufferLength=0)},e.prototype.digest=function(){if(!this.finished){var t=this.bytesHashed*8,r=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),i=this.bufferLength;if(r.setUint8(this.bufferLength++,128),i%dt>=dt-8){for(var n=this.bufferLength;n<dt;n++)r.setUint8(n,0);this.hashBuffer(),this.bufferLength=0}for(var n=this.bufferLength;n<dt-8;n++)r.setUint8(n,0);r.setUint32(dt-8,Math.floor(t/4294967296),!0),r.setUint32(dt-4,t),this.hashBuffer(),this.finished=!0}for(var o=new Uint8Array(Mk),n=0;n<8;n++)o[n*4]=this.state[n]>>>24&255,o[n*4+1]=this.state[n]>>>16&255,o[n*4+2]=this.state[n]>>>8&255,o[n*4+3]=this.state[n]>>>0&255;return o},e.prototype.hashBuffer=function(){for(var t=this,r=t.buffer,i=t.state,n=i[0],o=i[1],a=i[2],s=i[3],c=i[4],A=i[5],l=i[6],d=i[7],g=0;g<dt;g++){if(g<16)this.temp[g]=(r[g*4]&255)<<24|(r[g*4+1]&255)<<16|(r[g*4+2]&255)<<8|r[g*4+3]&255;else{var u=this.temp[g-2],I=(u>>>17|u<<15)^(u>>>19|u<<13)^u>>>10;u=this.temp[g-15];var C=(u>>>7|u<<25)^(u>>>18|u<<14)^u>>>3;this.temp[g]=(I+this.temp[g-7]|0)+(C+this.temp[g-16]|0)}var B=(((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))+(c&A^~c&l)|0)+(d+(Nk[g]+this.temp[g]|0)|0)|0,h=((n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10))+(n&o^n&a^o&a)|0;d=l,l=A,A=c,c=s+B|0,s=a,a=o,o=n,n=B+h|0}i[0]+=n,i[1]+=o,i[2]+=a,i[3]+=s,i[4]+=c,i[5]+=A,i[6]+=l,i[7]+=d},e})();var Ok=(function(){function e(t){this.secret=t,this.hash=new qo,this.reset()}return e.prototype.update=function(t){if(!(Vt(t)||this.error))try{this.hash.update(it(t))}catch(r){this.error=r}},e.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},e.prototype.digest=function(){return Xi(this,void 0,void 0,function(){return Zi(this,function(t){return[2,this.digestSync()]})})},e.prototype.reset=function(){if(this.hash=new qo,this.secret){this.outer=new qo;var t=l8(this.secret),r=new Uint8Array(dt);r.set(t);for(var i=0;i<dt;i++)t[i]^=54,r[i]^=92;this.hash.update(t),this.outer.update(r);for(var i=0;i<t.byteLength;i++)t[i]=0}},e})();function l8(e){var t=it(e);if(t.byteLength>dt){var r=new qo;r.update(t),t=r.digest()}var i=new Uint8Array(dt);return i.set(t),i}var qk=(function(){function e(t){Wc(Et())?this.hash=new Fu(t):this.hash=new Ok(t)}return e.prototype.update=function(t,r){this.hash.update(it(t))},e.prototype.digest=function(){return this.hash.digest()},e.prototype.reset=function(){this.hash.reset()},e})();var Gk=G(Tu()),Hk=({serviceId:e,clientVersion:t})=>async r=>{let i=typeof window<"u"&&window?.navigator?.userAgent?Gk.default.parse(window.navigator.userAgent):void 0,n=[["aws-sdk-js",t],["ua","2.1"],[`os/${i?.os?.name||"other"}`,i?.os?.version],["lang/js"],["md/browser",`${i?.browser?.name??"unknown"}_${i?.browser?.version??"unknown"}`]];e&&n.push([`api/${e}`,t]);let o=await r?.userAgentAppId?.();return o&&n.push([`app/${o}`]),n};var Qn=class e{constructor(t){if(this.bytes=t,t.byteLength!==8)throw new Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(t){if(t>9223372036854776e3||t<-9223372036854776e3)throw new Error(`${t} is too large (or, if negative, too small) to represent as an Int64`);let r=new Uint8Array(8);for(let i=7,n=Math.abs(Math.round(t));i>-1&&n>0;i--,n/=256)r[i]=n;return t<0&&Lk(r),new e(r)}valueOf(){let t=this.bytes.slice(0),r=t[0]&128;return r&&Lk(t),parseInt(ue(t),16)*(r?-1:1)}toString(){return String(this.valueOf())}};function Lk(e){for(let t=0;t<8;t++)e[t]^=255;for(let t=7;t>-1&&(e[t]++,e[t]===0);t--);}var jc=class{constructor(t,r){this.toUtf8=t,this.fromUtf8=r}format(t){let r=[];for(let o of Object.keys(t)){let a=this.fromUtf8(o);r.push(Uint8Array.from([a.byteLength]),a,this.formatHeaderValue(t[o]))}let i=new Uint8Array(r.reduce((o,a)=>o+a.byteLength,0)),n=0;for(let o of r)i.set(o,n),n+=o.byteLength;return i}formatHeaderValue(t){switch(t.type){case"boolean":return Uint8Array.from([t.value?0:1]);case"byte":return Uint8Array.from([2,t.value]);case"short":let r=new DataView(new ArrayBuffer(3));return r.setUint8(0,3),r.setInt16(1,t.value,!1),new Uint8Array(r.buffer);case"integer":let i=new DataView(new ArrayBuffer(5));return i.setUint8(0,4),i.setInt32(1,t.value,!1),new Uint8Array(i.buffer);case"long":let n=new Uint8Array(9);return n[0]=5,n.set(t.value.bytes,1),n;case"binary":let o=new DataView(new ArrayBuffer(3+t.value.byteLength));o.setUint8(0,6),o.setUint16(1,t.value.byteLength,!1);let a=new Uint8Array(o.buffer);return a.set(t.value,3),a;case"string":let s=this.fromUtf8(t.value),c=new DataView(new ArrayBuffer(3+s.byteLength));c.setUint8(0,7),c.setUint16(1,s.byteLength,!1);let A=new Uint8Array(c.buffer);return A.set(s,3),A;case"timestamp":let l=new Uint8Array(9);return l[0]=8,l.set(Qn.fromNumber(t.value.valueOf()).bytes,1),l;case"uuid":if(!C8.test(t.value))throw new Error(`Invalid UUID received: ${t.value}`);let d=new Uint8Array(17);return d[0]=9,d.set(wa(t.value.replace(/\-/g,"")),1),d}}parse(t){let r={},i=0;for(;i<t.byteLength;){let n=t.getUint8(i++),o=this.toUtf8(new Uint8Array(t.buffer,t.byteOffset+i,n));switch(i+=n,t.getUint8(i++)){case 0:r[o]={type:Jk,value:!0};break;case 1:r[o]={type:Jk,value:!1};break;case 2:r[o]={type:d8,value:t.getInt8(i++)};break;case 3:r[o]={type:g8,value:t.getInt16(i,!1)},i+=2;break;case 4:r[o]={type:u8,value:t.getInt32(i,!1)},i+=4;break;case 5:r[o]={type:f8,value:new Qn(new Uint8Array(t.buffer,t.byteOffset+i,8))},i+=8;break;case 6:let a=t.getUint16(i,!1);i+=2,r[o]={type:I8,value:new Uint8Array(t.buffer,t.byteOffset+i,a)},i+=a;break;case 7:let s=t.getUint16(i,!1);i+=2,r[o]={type:p8,value:this.toUtf8(new Uint8Array(t.buffer,t.byteOffset+i,s))},i+=s;break;case 8:r[o]={type:h8,value:new Date(new Qn(new Uint8Array(t.buffer,t.byteOffset+i,8)).valueOf())},i+=8;break;case 9:let c=new Uint8Array(t.buffer,t.byteOffset+i,16);i+=16,r[o]={type:m8,value:`${ue(c.subarray(0,4))}-${ue(c.subarray(4,6))}-${ue(c.subarray(6,8))}-${ue(c.subarray(8,10))}-${ue(c.subarray(10))}`};break;default:throw new Error("Unrecognized header type tag")}}return r}},Kk;(function(e){e[e.boolTrue=0]="boolTrue",e[e.boolFalse=1]="boolFalse",e[e.byte=2]="byte",e[e.short=3]="short",e[e.integer=4]="integer",e[e.long=5]="long",e[e.byteArray=6]="byteArray",e[e.string=7]="string",e[e.timestamp=8]="timestamp",e[e.uuid=9]="uuid"})(Kk||(Kk={}));var Jk="boolean",d8="byte",g8="short",u8="integer",f8="long",I8="binary",p8="string",h8="timestamp",m8="uuid",C8=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/;var zk=4,Hr=zk*2,Ci=4,B8=Hr+Ci*2;function Vk({byteLength:e,byteOffset:t,buffer:r}){if(e<B8)throw new Error("Provided message too short to accommodate event stream message overhead");let i=new DataView(r,t,e),n=i.getUint32(0,!1);if(e!==n)throw new Error("Reported message length does not match received message length");let o=i.getUint32(zk,!1),a=i.getUint32(Hr,!1),s=i.getUint32(e-Ci,!1),c=new di().update(new Uint8Array(r,t,Hr));if(a!==c.digest())throw new Error(`The prelude checksum specified in the message (${a}) does not match the calculated CRC32 checksum (${c.digest()})`);if(c.update(new Uint8Array(r,t+Hr,e-(Hr+Ci))),s!==c.digest())throw new Error(`The message checksum (${c.digest()}) did not match the expected value of ${s}`);return{headers:new DataView(r,t+Hr+Ci,o),body:new Uint8Array(r,t+Hr+Ci+o,n-o-(Hr+Ci+Ci))}}var Xc=class{constructor(t,r){this.headerMarshaller=new jc(t,r),this.messageBuffer=[],this.isEndOfStream=!1}feed(t){this.messageBuffer.push(this.decode(t))}endOfStream(){this.isEndOfStream=!0}getMessage(){let t=this.messageBuffer.pop(),r=this.isEndOfStream;return{getMessage(){return t},isEndOfStream(){return r}}}getAvailableMessages(){let t=this.messageBuffer;this.messageBuffer=[];let r=this.isEndOfStream;return{getMessages(){return t},isEndOfStream(){return r}}}encode({headers:t,body:r}){let i=this.headerMarshaller.format(t),n=i.byteLength+r.byteLength+16,o=new Uint8Array(n),a=new DataView(o.buffer,o.byteOffset,o.byteLength),s=new di;return a.setUint32(0,n,!1),a.setUint32(4,i.byteLength,!1),a.setUint32(8,s.update(o.subarray(0,8)).digest(),!1),o.set(i,12),o.set(r,i.byteLength+12),a.setUint32(n-4,s.update(o.subarray(8,n-4)).digest(),!1),o}decode(t){let{headers:r,body:i}=Vk(t);return{headers:this.headerMarshaller.parse(r),body:i}}formatHeaders(t){return this.headerMarshaller.format(t)}};var Zc=class{constructor(t){this.options=t}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(let t of this.options.inputStream)yield this.options.decoder.decode(t)}};var $c=class{constructor(t){this.options=t}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(let t of this.options.messageStream)yield this.options.encoder.encode(t);this.options.includeEndFrame&&(yield new Uint8Array(0))}};var eA=class{constructor(t){this.options=t}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(let t of this.options.messageStream){let r=await this.options.deserializer(t);r!==void 0&&(yield r)}}};var tA=class{constructor(t){this.options=t}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(let t of this.options.inputStream)yield this.options.serializer(t)}};function Yk(e){let t=0,r=0,i=null,n=null,o=s=>{if(typeof s!="number")throw new Error("Attempted to allocate an event message where size was not a number: "+s);t=s,r=4,i=new Uint8Array(s),new DataView(i.buffer).setUint32(0,s,!1)},a=async function*(){let s=e[Symbol.asyncIterator]();for(;;){let{value:c,done:A}=await s.next();if(A){if(t)if(t===r)yield i;else throw new Error("Truncated event message received.");else return;return}let l=c.length,d=0;for(;d<l;){if(!i){let u=l-d;n||(n=new Uint8Array(4));let I=Math.min(4-r,u);if(n.set(c.slice(d,d+I),r),r+=I,d+=I,r<4)break;o(new DataView(n.buffer).getUint32(0,!1)),n=null}let g=Math.min(t-r,l-d);i.set(c.slice(d,d+g),r),r+=g,d+=g,t&&t===r&&(yield i,i=null,t=0,r=0)}}};return{[Symbol.asyncIterator]:a}}function Wk(e,t){return async function(r){let{value:i}=r.headers[":message-type"];if(i==="error"){let n=new Error(r.headers[":error-message"].value||"UnknownError");throw n.name=r.headers[":error-code"].value,n}else if(i==="exception"){let n=r.headers[":exception-type"].value,o={[n]:r},a=await e(o);if(a.$unknown){let s=new Error(t(r.body));throw s.name=n,s}throw a[n]}else if(i==="event"){let n={[r.headers[":event-type"].value]:r},o=await e(n);return o.$unknown?void 0:o}else throw Error(`Unrecognizable event type: ${r.headers[":event-type"].value}`)}}var Ho=class{constructor({utf8Encoder:t,utf8Decoder:r}){this.eventStreamCodec=new Xc(t,r),this.utfEncoder=t}deserialize(t,r){let i=Yk(t);return new eA({messageStream:new Zc({inputStream:i,decoder:this.eventStreamCodec}),deserializer:Wk(r,this.utfEncoder)})}serialize(t,r){return new $c({messageStream:new tA({inputStream:t,serializer:r}),encoder:this.eventStreamCodec,includeEndFrame:!0})}};var jk=e=>({[Symbol.asyncIterator]:async function*(){let t=e.getReader();try{for(;;){let{done:r,value:i}=await t.read();if(r)return;yield i}}finally{t.releaseLock()}}}),Xk=e=>{let t=e[Symbol.asyncIterator]();return new ReadableStream({async pull(r){let{done:i,value:n}=await t.next();if(i)return r.close();r.enqueue(n)}})};var rA=class{constructor({utf8Encoder:t,utf8Decoder:r}){this.universalMarshaller=new Ho({utf8Decoder:r,utf8Encoder:t})}deserialize(t,r){let i=y8(t)?jk(t):t;return this.universalMarshaller.deserialize(i,r)}serialize(t,r){let i=this.universalMarshaller.serialize(t,r);return typeof ReadableStream=="function"?Xk(i):i}},y8=e=>typeof ReadableStream=="function"&&e instanceof ReadableStream;var Zk=e=>new rA(e);async function $k(e,t,r=1024*1024){let i=e.size,n=0;for(;n<i;){let o=e.slice(n,Math.min(i,n+r));t(new Uint8Array(await o.arrayBuffer())),n+=o.size}}var eD=async function(t,r){let i=new t;return await $k(r,n=>{i.update(n)}),i.digest()};var tD=e=>()=>Promise.reject(e);var rD=[1732584193,4023233417,2562383102,271733878];var iA=class{constructor(){this.reset()}update(t){if(Q8(t))return;if(this.finished)throw new Error("Attempted to update an already finished hash.");let r=w8(t),i=0,{byteLength:n}=r;for(this.bytesHashed+=n;n>0;)this.buffer.setUint8(this.bufferLength++,r[i++]),n--,this.bufferLength===64&&(this.hashBuffer(),this.bufferLength=0)}async digest(){if(!this.finished){let{buffer:r,bufferLength:i,bytesHashed:n}=this,o=n*8;if(r.setUint8(this.bufferLength++,128),i%64>=56){for(let a=this.bufferLength;a<64;a++)r.setUint8(a,0);this.hashBuffer(),this.bufferLength=0}for(let a=this.bufferLength;a<56;a++)r.setUint8(a,0);r.setUint32(56,o>>>0,!0),r.setUint32(60,Math.floor(o/4294967296),!0),this.hashBuffer(),this.finished=!0}let t=new DataView(new ArrayBuffer(16));for(let r=0;r<4;r++)t.setUint32(r*4,this.state[r],!0);return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}hashBuffer(){let{buffer:t,state:r}=this,i=r[0],n=r[1],o=r[2],a=r[3];i=Ve(i,n,o,a,t.getUint32(0,!0),7,3614090360),a=Ve(a,i,n,o,t.getUint32(4,!0),12,3905402710),o=Ve(o,a,i,n,t.getUint32(8,!0),17,606105819),n=Ve(n,o,a,i,t.getUint32(12,!0),22,3250441966),i=Ve(i,n,o,a,t.getUint32(16,!0),7,4118548399),a=Ve(a,i,n,o,t.getUint32(20,!0),12,1200080426),o=Ve(o,a,i,n,t.getUint32(24,!0),17,2821735955),n=Ve(n,o,a,i,t.getUint32(28,!0),22,4249261313),i=Ve(i,n,o,a,t.getUint32(32,!0),7,1770035416),a=Ve(a,i,n,o,t.getUint32(36,!0),12,2336552879),o=Ve(o,a,i,n,t.getUint32(40,!0),17,4294925233),n=Ve(n,o,a,i,t.getUint32(44,!0),22,2304563134),i=Ve(i,n,o,a,t.getUint32(48,!0),7,1804603682),a=Ve(a,i,n,o,t.getUint32(52,!0),12,4254626195),o=Ve(o,a,i,n,t.getUint32(56,!0),17,2792965006),n=Ve(n,o,a,i,t.getUint32(60,!0),22,1236535329),i=Ye(i,n,o,a,t.getUint32(4,!0),5,4129170786),a=Ye(a,i,n,o,t.getUint32(24,!0),9,3225465664),o=Ye(o,a,i,n,t.getUint32(44,!0),14,643717713),n=Ye(n,o,a,i,t.getUint32(0,!0),20,3921069994),i=Ye(i,n,o,a,t.getUint32(20,!0),5,3593408605),a=Ye(a,i,n,o,t.getUint32(40,!0),9,38016083),o=Ye(o,a,i,n,t.getUint32(60,!0),14,3634488961),n=Ye(n,o,a,i,t.getUint32(16,!0),20,3889429448),i=Ye(i,n,o,a,t.getUint32(36,!0),5,568446438),a=Ye(a,i,n,o,t.getUint32(56,!0),9,3275163606),o=Ye(o,a,i,n,t.getUint32(12,!0),14,4107603335),n=Ye(n,o,a,i,t.getUint32(32,!0),20,1163531501),i=Ye(i,n,o,a,t.getUint32(52,!0),5,2850285829),a=Ye(a,i,n,o,t.getUint32(8,!0),9,4243563512),o=Ye(o,a,i,n,t.getUint32(28,!0),14,1735328473),n=Ye(n,o,a,i,t.getUint32(48,!0),20,2368359562),i=We(i,n,o,a,t.getUint32(20,!0),4,4294588738),a=We(a,i,n,o,t.getUint32(32,!0),11,2272392833),o=We(o,a,i,n,t.getUint32(44,!0),16,1839030562),n=We(n,o,a,i,t.getUint32(56,!0),23,4259657740),i=We(i,n,o,a,t.getUint32(4,!0),4,2763975236),a=We(a,i,n,o,t.getUint32(16,!0),11,1272893353),o=We(o,a,i,n,t.getUint32(28,!0),16,4139469664),n=We(n,o,a,i,t.getUint32(40,!0),23,3200236656),i=We(i,n,o,a,t.getUint32(52,!0),4,681279174),a=We(a,i,n,o,t.getUint32(0,!0),11,3936430074),o=We(o,a,i,n,t.getUint32(12,!0),16,3572445317),n=We(n,o,a,i,t.getUint32(24,!0),23,76029189),i=We(i,n,o,a,t.getUint32(36,!0),4,3654602809),a=We(a,i,n,o,t.getUint32(48,!0),11,3873151461),o=We(o,a,i,n,t.getUint32(60,!0),16,530742520),n=We(n,o,a,i,t.getUint32(8,!0),23,3299628645),i=je(i,n,o,a,t.getUint32(0,!0),6,4096336452),a=je(a,i,n,o,t.getUint32(28,!0),10,1126891415),o=je(o,a,i,n,t.getUint32(56,!0),15,2878612391),n=je(n,o,a,i,t.getUint32(20,!0),21,4237533241),i=je(i,n,o,a,t.getUint32(48,!0),6,1700485571),a=je(a,i,n,o,t.getUint32(12,!0),10,2399980690),o=je(o,a,i,n,t.getUint32(40,!0),15,4293915773),n=je(n,o,a,i,t.getUint32(4,!0),21,2240044497),i=je(i,n,o,a,t.getUint32(32,!0),6,1873313359),a=je(a,i,n,o,t.getUint32(60,!0),10,4264355552),o=je(o,a,i,n,t.getUint32(24,!0),15,2734768916),n=je(n,o,a,i,t.getUint32(52,!0),21,1309151649),i=je(i,n,o,a,t.getUint32(16,!0),6,4149444226),a=je(a,i,n,o,t.getUint32(44,!0),10,3174756917),o=je(o,a,i,n,t.getUint32(8,!0),15,718787259),n=je(n,o,a,i,t.getUint32(36,!0),21,3951481745),r[0]=i+r[0]&4294967295,r[1]=n+r[1]&4294967295,r[2]=o+r[2]&4294967295,r[3]=a+r[3]&4294967295}reset(){this.state=Uint32Array.from(rD),this.buffer=new DataView(new ArrayBuffer(64)),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}};function nA(e,t,r,i,n,o){return t=(t+e&4294967295)+(i+o&4294967295)&4294967295,(t<<n|t>>>32-n)+r&4294967295}function Ve(e,t,r,i,n,o,a){return nA(t&r|~t&i,e,t,n,o,a)}function Ye(e,t,r,i,n,o,a){return nA(t&i|r&~i,e,t,n,o,a)}function We(e,t,r,i,n,o,a){return nA(t^r^i,e,t,n,o,a)}function je(e,t,r,i,n,o,a){return nA(r^(t|~i),e,t,n,o,a)}function Q8(e){return typeof e=="string"?e.length===0:e.byteLength===0}function w8(e){return typeof e=="string"?At(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}var iD=typeof TextEncoder=="function"?new TextEncoder:null,nD=e=>{if(typeof e=="string"){if(iD)return iD.encode(e).byteLength;let t=e.length;for(let r=t-1;r>=0;r--){let i=e.charCodeAt(r);i>127&&i<=2047?t++:i>2047&&i<=65535&&(t+=2),i>=56320&&i<=57343&&r--}return t}else{if(typeof e.byteLength=="number")return e.byteLength;if(typeof e.size=="number")return e.size}throw new Error(`Body Length computation failed for ${e}`)};var oD=e=>({apiVersion:"2006-03-01",base64Decoder:e?.base64Decoder??si,base64Encoder:e?.base64Encoder??cr,disableHostPrefix:e?.disableHostPrefix??!1,endpointProvider:e?.endpointProvider??hc,extensions:e?.extensions??[],getAwsChunkedEncodingStream:e?.getAwsChunkedEncodingStream??rQ,httpAuthSchemeProvider:e?.httpAuthSchemeProvider??Yx,httpAuthSchemes:e?.httpAuthSchemes??[{schemeId:"aws.auth#sigv4",identityProvider:t=>t.getIdentityProvider("aws.auth#sigv4"),signer:new ii},{schemeId:"aws.auth#sigv4a",identityProvider:t=>t.getIdentityProvider("aws.auth#sigv4a"),signer:new ao}],logger:e?.logger??new Nr,sdkStreamMixin:e?.sdkStreamMixin??qd,serviceId:e?.serviceId??"S3",signerConstructor:e?.signerConstructor??ac,signingEscapePath:e?.signingEscapePath??!1,urlParser:e?.urlParser??fn,useArnRegion:e?.useArnRegion??!1,utf8Decoder:e?.utf8Decoder??At,utf8Encoder:e?.utf8Encoder??Tr});var aD=G(Tu());var sD=["in-region","cross-region","mobile","standard","legacy"];var cD=({defaultsMode:e}={})=>xQ(async()=>{let t=typeof e=="function"?await e():e;switch(t?.toLowerCase()){case"auto":return Promise.resolve(b8()?"mobile":"standard");case"mobile":case"in-region":case"cross-region":case"standard":case"legacy":return Promise.resolve(t?.toLocaleLowerCase());case void 0:return Promise.resolve("legacy");default:throw new Error(`Invalid parameter for "defaultsMode", expect ${sD.join(", ")}, got ${t}`)}}),b8=()=>{let t=(typeof window<"u"&&window?.navigator?.userAgent?aD.default.parse(window.navigator.userAgent):void 0)?.platform?.type;return t==="tablet"||t==="mobile"};var AD=e=>{let t=cD(e),r=()=>t().then(ZQ),i=oD(e);return{...i,...e,runtime:"browser",defaultsMode:t,bodyLengthChecker:e?.bodyLengthChecker??nD,credentialDefaultProvider:e?.credentialDefaultProvider??(n=>()=>Promise.reject(new Error("Credential is missing"))),defaultUserAgentProvider:e?.defaultUserAgentProvider??Hk({serviceId:i.serviceId,clientVersion:vk.version}),eventStreamSerdeProvider:e?.eventStreamSerdeProvider??Zk,maxAttempts:e?.maxAttempts??fi,md5:e?.md5??iA,region:e?.region??tD("Region is missing"),requestHandler:Ea.create(e?.requestHandler??r),retryMode:e?.retryMode??(async()=>(await r()).retryMode||Rg),sha1:e?.sha1??Tk,sha256:e?.sha256??qk,streamCollector:e?.streamCollector??Qa,streamHasher:e?.streamHasher??eD,useDualstackEndpoint:e?.useDualstackEndpoint??(()=>Promise.resolve(Zb)),useFipsEndpoint:e?.useFipsEndpoint??(()=>Promise.resolve($b))}};var lD=e=>{let t=async()=>{if(e.region===void 0)throw new Error("Region is missing from runtimeConfig");let r=e.region;return typeof r=="string"?r:r()};return{setRegion(r){t=r},region(){return t}}},dD=e=>({region:e.region()});var gD=e=>{let t=e.httpAuthSchemes,r=e.httpAuthSchemeProvider,i=e.credentials;return{setHttpAuthScheme(n){let o=t.findIndex(a=>a.schemeId===n.schemeId);o===-1?t.push(n):t.splice(o,1,n)},httpAuthSchemes(){return t},setHttpAuthSchemeProvider(n){r=n},httpAuthSchemeProvider(){return r},setCredentials(n){i=n},credentials(){return i}}},uD=e=>({httpAuthSchemes:e.httpAuthSchemes(),httpAuthSchemeProvider:e.httpAuthSchemeProvider(),credentials:e.credentials()});var oA=e=>e,fD=(e,t)=>{let r={...oA(lD(e)),...oA(iw(e)),...oA(ME(e)),...oA(gD(e))};return t.forEach(i=>i.configure(r)),{...e,...dD(r),...nw(r),...NE(r),...uD(r)}};var sA=class extends Na{config;constructor(...[t]){let r=AD(t||{}),i=jx(r),n=wb(i),o=eb(n),a=yS(o),s=eS(a),c=s,A=AS(c),l=tS(A),d=Wx(l),g=Cb(d,{session:[()=>this,Yc]}),u=fD(g,t?.extensions||[]);super(u),this.config=u,this.middlewareStack.use(Xb(this.config)),this.middlewareStack.use(QS(this.config)),this.middlewareStack.use(iS(this.config)),this.middlewareStack.use(tb(this.config)),this.middlewareStack.use(rb(this.config)),this.middlewareStack.use(nb(this.config)),this.middlewareStack.use(VE(this.config,{httpAuthSchemeParametersProvider:Jx,identityProviderConfigProvider:async I=>new ka({"aws.auth#sigv4":I.credentials,"aws.auth#sigv4a":I.credentials})})),this.middlewareStack.use(XE(this.config)),this.middlewareStack.use(Qb(this.config)),this.middlewareStack.use(qE(this.config)),this.middlewareStack.use(cb(this.config)),this.middlewareStack.use(yg(this.config)),this.middlewareStack.use(Eg(this.config))}destroy(){super.destroy()}};function x8(e){return t=>async r=>{let i={...r.input},n=[{target:"SSECustomerKey",hash:"SSECustomerKeyMD5"},{target:"CopySourceSSECustomerKey",hash:"CopySourceSSECustomerKeyMD5"}];for(let o of n){let a=i[o.target];if(a){let s;typeof a=="string"?D8(a,e)?s=e.base64Decoder(a):(s=e.utf8Decoder(a),i[o.target]=e.base64Encoder(s)):(s=ArrayBuffer.isView(a)?new Uint8Array(a.buffer,a.byteOffset,a.byteLength):new Uint8Array(a),i[o.target]=e.base64Encoder(s));let c=new e.md5;c.update(s),i[o.hash]=e.base64Encoder(await c.digest())}}return t({...r,input:i})}}var k8={name:"ssecMiddleware",step:"initialize",tags:["SSE"],override:!0},aA=e=>({applyToStack:t=>{t.add(x8(e),k8)}});function D8(e,t){if(!/^(?:[A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e))return!1;try{return t.base64Decoder(e).length===32}catch{return!1}}var cA=class extends gr.classBuilder().ep({...En,Bucket:{type:"contextParams",name:"Bucket"},Key:{type:"contextParams",name:"Key"}}).m(function(t,r,i,n){return[sn(i,this.serialize,this.deserialize),In(i,t.getEndpointParameterInstructions()),Ha(i,{requestAlgorithmMember:{httpHeader:"x-amz-sdk-checksum-algorithm",name:"ChecksumAlgorithm"},requestChecksumRequired:!1}),ob(i),gn(i),aA(i)]}).s("AmazonS3","PutObject",{}).n("S3Client","PutObjectCommand").f(tk,ek).ser(Ak).de(gk).build(){};var AA=class extends gr.classBuilder().ep({...En,Bucket:{type:"contextParams",name:"Bucket"},Key:{type:"contextParams",name:"Key"}}).m(function(t,r,i,n){return[sn(i,this.serialize,this.deserialize),In(i,t.getEndpointParameterInstructions()),Ha(i,{requestAlgorithmMember:{httpHeader:"x-amz-sdk-checksum-algorithm",name:"ChecksumAlgorithm"},requestChecksumRequired:!1}),gn(i),aA(i)]}).s("AmazonS3","UploadPart",{}).n("S3Client","UploadPartCommand").f(ik,rk).ser(lk).de(uk).build(){};function Jo(e,t,r,i){function n(o){return o instanceof r?o:new r(function(a){a(o)})}return new(r||(r=Promise))(function(o,a){function s(l){try{A(i.next(l))}catch(d){a(d)}}function c(l){try{A(i.throw(l))}catch(d){a(d)}}function A(l){l.done?o(l.value):n(l.value).then(s,c)}A((i=i.apply(e,t||[])).next())})}var ce=class{constructor(){this.mutex=Promise.resolve()}lock(){let t=()=>{};return this.mutex=this.mutex.then(()=>new Promise(t)),new Promise(r=>{t=r})}dispatch(t){return Jo(this,void 0,void 0,function*(){let r=yield this.lock();try{return yield Promise.resolve(t())}finally{r()}})}},_u;function v8(){return typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global}var Pu=v8(),Mu=(_u=Pu.Buffer)!==null&&_u!==void 0?_u:null,F8=Pu.TextEncoder?new Pu.TextEncoder:null;function BD(e,t){return(e&15)+(e>>6|e>>3&8)<<4|(t&15)+(t>>6|t>>3&8)}function R8(e,t){let r=t.length>>1;for(let i=0;i<r;i++){let n=i<<1;e[i]=BD(t.charCodeAt(n),t.charCodeAt(n+1))}}function T8(e,t){if(e.length!==t.length*2)return!1;for(let r=0;r<t.length;r++){let i=r<<1;if(t[r]!==BD(e.charCodeAt(i),e.charCodeAt(i+1)))return!1}return!0}var ID=87,pD=48;function hD(e,t,r){let i=0;for(let n=0;n<r;n++){let o=t[n]>>>4;e[i++]=o>9?o+ID:o+pD,o=t[n]&15,e[i++]=o>9?o+ID:o+pD}return String.fromCharCode.apply(null,e)}var mD=Mu!==null?e=>{if(typeof e=="string"){let t=Mu.from(e,"utf8");return new Uint8Array(t.buffer,t.byteOffset,t.length)}if(Mu.isBuffer(e))return new Uint8Array(e.buffer,e.byteOffset,e.length);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Invalid data type!")}:e=>{if(typeof e=="string")return F8.encode(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Invalid data type!")},CD="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ko=new Uint8Array(256);for(let e=0;e<CD.length;e++)Ko[CD.charCodeAt(e)]=e;function _8(e){let t=Math.floor(e.length*.75),r=e.length;return e[r-1]==="="&&(t-=1,e[r-2]==="="&&(t-=1)),t}function M8(e){let t=_8(e),r=e.length,i=new Uint8Array(t),n=0;for(let o=0;o<r;o+=4){let a=Ko[e.charCodeAt(o)],s=Ko[e.charCodeAt(o+1)],c=Ko[e.charCodeAt(o+2)],A=Ko[e.charCodeAt(o+3)];i[n]=a<<2|s>>4,n+=1,i[n]=(s&15)<<4|c>>2,n+=1,i[n]=(c&3)<<6|A&63,n+=1}return i}var lA=16*1024,Lo=4,N8=new ce,Nu=new Map;function P8(e,t){return Jo(this,void 0,void 0,function*(){let r=null,i=null,n=!1;if(typeof WebAssembly>"u")throw new Error("WebAssembly is not supported in this environment!");let o=(w,k=0)=>{i.set(w,k)},a=()=>i,s=()=>r.exports,c=w=>{r.exports.Hash_SetMemorySize(w);let k=r.exports.Hash_GetBuffer(),N=r.exports.memory.buffer;i=new Uint8Array(N,k,w)},A=()=>new DataView(r.exports.memory.buffer).getUint32(r.exports.STATE_SIZE,!0),l=N8.dispatch(()=>Jo(this,void 0,void 0,function*(){if(!Nu.has(e.name)){let k=M8(e.data),N=WebAssembly.compile(k);Nu.set(e.name,N)}let w=yield Nu.get(e.name);r=yield WebAssembly.instantiate(w,{})})),d=()=>Jo(this,void 0,void 0,function*(){r||(yield l);let w=r.exports.Hash_GetBuffer(),k=r.exports.memory.buffer;i=new Uint8Array(k,w,lA)}),g=(w=null)=>{n=!0,r.exports.Hash_Init(w)},u=w=>{let k=0;for(;k<w.length;){let N=w.subarray(k,k+lA);k+=N.length,i.set(N),r.exports.Hash_Update(N.length)}},I=w=>{if(!n)throw new Error("update() called before init()");let k=mD(w);u(k)},C=new Uint8Array(t*2),B=(w,k=null)=>{if(!n)throw new Error("digest() called before init()");return n=!1,r.exports.Hash_Final(k),w==="binary"?i.slice(0,t):hD(C,i,t)},h=()=>{if(!n)throw new Error("save() can only be called after init() and before digest()");let w=r.exports.Hash_GetState(),k=A(),N=r.exports.memory.buffer,J=new Uint8Array(N,w,k),X=new Uint8Array(Lo+k);return R8(X,e.hash),X.set(J,Lo),X},Q=w=>{if(!(w instanceof Uint8Array))throw new Error("load() expects an Uint8Array generated by save()");let k=r.exports.Hash_GetState(),N=A(),J=Lo+N,X=r.exports.memory.buffer;if(w.length!==J)throw new Error(`Bad state length (expected ${J} bytes, got ${w.length})`);if(!T8(e.hash,w.subarray(0,Lo)))throw new Error("This state was written by an incompatible hash implementation");let K=w.subarray(Lo);new Uint8Array(X,k,N).set(K),n=!0},D=w=>typeof w=="string"?w.length<lA/4:w.byteLength<lA,E=D;switch(e.name){case"argon2":case"scrypt":E=()=>!0;break;case"blake2b":case"blake2s":E=(w,k)=>k<=512&&D(w);break;case"blake3":E=(w,k)=>k===0&&D(w);break;case"xxhash64":case"xxhash3":case"xxhash128":case"crc64":E=()=>!1;break}let x=(w,k=null,N=null)=>{if(!E(w,k))return g(k),I(w),B("hex",N);let J=mD(w);return i.set(J),r.exports.Hash_Calculate(J.length,k,N),hD(C,i,t)};return yield d(),{getMemory:a,writeMemory:o,getExports:s,setMemorySize:c,init:g,update:I,digest:B,save:h,load:Q,calculate:x,hashLength:t}})}function U8(e,t,r){return Jo(this,void 0,void 0,function*(){let i=yield e.lock(),n=yield P8(t,r);return i(),n})}var Zxe=new ce;var $xe=new ce;var eke=new DataView(new ArrayBuffer(4));var tke=new ce;var rke=new ce;var ike=new ce;var nke=new ce;var oke=new Uint8Array(8);var ske=new ce;var O8="md5",q8="AGFzbQEAAAABEgRgAAF/YAAAYAF/AGACf38BfwMIBwABAgMBAAIFBAEBAgIGDgJ/AUGgigULfwBBgAgLB3AIBm1lbW9yeQIADkhhc2hfR2V0QnVmZmVyAAAJSGFzaF9Jbml0AAELSGFzaF9VcGRhdGUAAgpIYXNoX0ZpbmFsAAQNSGFzaF9HZXRTdGF0ZQAFDkhhc2hfQ2FsY3VsYXRlAAYKU1RBVEVfU0laRQMBCoMaBwUAQYAJCy0AQQBC/rnrxemOlZkQNwKQiQFBAEKBxpS6lvHq5m83AoiJAUEAQgA3AoCJAQu+BQEHf0EAQQAoAoCJASIBIABqQf////8BcSICNgKAiQFBAEEAKAKEiQEgAiABSWogAEEddmo2AoSJAQJAAkACQAJAAkACQCABQT9xIgMNAEGACSEEDAELIABBwAAgA2siBUkNASAFQQNxIQZBACEBAkAgA0E/c0EDSQ0AIANBgIkBaiEEIAVB/ABxIQdBACEBA0AgBCABaiICQRhqIAFBgAlqLQAAOgAAIAJBGWogAUGBCWotAAA6AAAgAkEaaiABQYIJai0AADoAACACQRtqIAFBgwlqLQAAOgAAIAcgAUEEaiIBRw0ACwsCQCAGRQ0AIANBmIkBaiECA0AgAiABaiABQYAJai0AADoAACABQQFqIQEgBkF/aiIGDQALC0GYiQFBwAAQAxogACAFayEAIAVBgAlqIQQLIABBwABPDQEgACECDAILIABFDQIgAEEDcSEGQQAhAQJAIABBBEkNACADQYCJAWohBCAAQXxxIQBBACEBA0AgBCABaiICQRhqIAFBgAlqLQAAOgAAIAJBGWogAUGBCWotAAA6AAAgAkEaaiABQYIJai0AADoAACACQRtqIAFBgwlqLQAAOgAAIAAgAUEEaiIBRw0ACwsgBkUNAiADQZiJAWohAgNAIAIgAWogAUGACWotAAA6AAAgAUEBaiEBIAZBf2oiBg0ADAMLCyAAQT9xIQIgBCAAQUBxEAMhBAsgAkUNACACQQNxIQZBACEBAkAgAkEESQ0AIAJBPHEhAEEAIQEDQCABQZiJAWogBCABaiICLQAAOgAAIAFBmYkBaiACQQFqLQAAOgAAIAFBmokBaiACQQJqLQAAOgAAIAFBm4kBaiACQQNqLQAAOgAAIAAgAUEEaiIBRw0ACwsgBkUNAANAIAFBmIkBaiAEIAFqLQAAOgAAIAFBAWohASAGQX9qIgYNAAsLC4cQARl/QQAoApSJASECQQAoApCJASEDQQAoAoyJASEEQQAoAoiJASEFA0AgACgCCCIGIAAoAhgiByAAKAIoIgggACgCOCIJIAAoAjwiCiAAKAIMIgsgACgCHCIMIAAoAiwiDSAMIAsgCiANIAkgCCAHIAMgBmogAiAAKAIEIg5qIAUgBCACIANzcSACc2ogACgCACIPakH4yKq7fWpBB3cgBGoiECAEIANzcSADc2pB1u6exn5qQQx3IBBqIhEgECAEc3EgBHNqQdvhgaECakERdyARaiISaiAAKAIUIhMgEWogACgCECIUIBBqIAQgC2ogEiARIBBzcSAQc2pB7p33jXxqQRZ3IBJqIhAgEiARc3EgEXNqQa+f8Kt/akEHdyAQaiIRIBAgEnNxIBJzakGqjJ+8BGpBDHcgEWoiEiARIBBzcSAQc2pBk4zBwXpqQRF3IBJqIhVqIAAoAiQiFiASaiAAKAIgIhcgEWogDCAQaiAVIBIgEXNxIBFzakGBqppqakEWdyAVaiIQIBUgEnNxIBJzakHYsYLMBmpBB3cgEGoiESAQIBVzcSAVc2pBr++T2nhqQQx3IBFqIhIgESAQc3EgEHNqQbG3fWpBEXcgEmoiFWogACgCNCIYIBJqIAAoAjAiGSARaiANIBBqIBUgEiARc3EgEXNqQb6v88p4akEWdyAVaiIQIBUgEnNxIBJzakGiosDcBmpBB3cgEGoiESAQIBVzcSAVc2pBk+PhbGpBDHcgEWoiFSARIBBzcSAQc2pBjofls3pqQRF3IBVqIhJqIAcgFWogDiARaiAKIBBqIBIgFSARc3EgEXNqQaGQ0M0EakEWdyASaiIQIBJzIBVxIBJzakHiyviwf2pBBXcgEGoiESAQcyAScSAQc2pBwOaCgnxqQQl3IBFqIhIgEXMgEHEgEXNqQdG0+bICakEOdyASaiIVaiAIIBJqIBMgEWogDyAQaiAVIBJzIBFxIBJzakGqj9vNfmpBFHcgFWoiECAVcyAScSAVc2pB3aC8sX1qQQV3IBBqIhEgEHMgFXEgEHNqQdOokBJqQQl3IBFqIhIgEXMgEHEgEXNqQYHNh8V9akEOdyASaiIVaiAJIBJqIBYgEWogFCAQaiAVIBJzIBFxIBJzakHI98++fmpBFHcgFWoiECAVcyAScSAVc2pB5puHjwJqQQV3IBBqIhEgEHMgFXEgEHNqQdaP3Jl8akEJdyARaiISIBFzIBBxIBFzakGHm9Smf2pBDncgEmoiFWogBiASaiAYIBFqIBcgEGogFSAScyARcSASc2pB7anoqgRqQRR3IBVqIhAgFXMgEnEgFXNqQYXSj896akEFdyAQaiIRIBBzIBVxIBBzakH4x75nakEJdyARaiISIBFzIBBxIBFzakHZhby7BmpBDncgEmoiFWogFyASaiATIBFqIBkgEGogFSAScyARcSASc2pBipmp6XhqQRR3IBVqIhAgFXMiFSASc2pBwvJoakEEdyAQaiIRIBVzakGB7ce7eGpBC3cgEWoiEiARcyIaIBBzakGiwvXsBmpBEHcgEmoiFWogFCASaiAOIBFqIAkgEGogFSAac2pBjPCUb2pBF3cgFWoiECAVcyIVIBJzakHE1PulempBBHcgEGoiESAVc2pBqZ/73gRqQQt3IBFqIhIgEXMiCSAQc2pB4JbttX9qQRB3IBJqIhVqIA8gEmogGCARaiAIIBBqIBUgCXNqQfD4/vV7akEXdyAVaiIQIBVzIhUgEnNqQcb97cQCakEEdyAQaiIRIBVzakH6z4TVfmpBC3cgEWoiEiARcyIIIBBzakGF4bynfWpBEHcgEmoiFWogGSASaiAWIBFqIAcgEGogFSAIc2pBhbqgJGpBF3cgFWoiESAVcyIQIBJzakG5oNPOfWpBBHcgEWoiEiAQc2pB5bPutn5qQQt3IBJqIhUgEnMiByARc2pB+PmJ/QFqQRB3IBVqIhBqIAwgFWogDyASaiAGIBFqIBAgB3NqQeWssaV8akEXdyAQaiIRIBVBf3NyIBBzakHExKShf2pBBncgEWoiEiAQQX9zciARc2pBl/+rmQRqQQp3IBJqIhAgEUF/c3IgEnNqQafH0Nx6akEPdyAQaiIVaiALIBBqIBkgEmogEyARaiAVIBJBf3NyIBBzakG5wM5kakEVdyAVaiIRIBBBf3NyIBVzakHDs+2qBmpBBncgEWoiECAVQX9zciARc2pBkpmz+HhqQQp3IBBqIhIgEUF/c3IgEHNqQf3ov39qQQ93IBJqIhVqIAogEmogFyAQaiAOIBFqIBUgEEF/c3IgEnNqQdG7kax4akEVdyAVaiIQIBJBf3NyIBVzakHP/KH9BmpBBncgEGoiESAVQX9zciAQc2pB4M2zcWpBCncgEWoiEiAQQX9zciARc2pBlIaFmHpqQQ93IBJqIhVqIA0gEmogFCARaiAYIBBqIBUgEUF/c3IgEnNqQaGjoPAEakEVdyAVaiIQIBJBf3NyIBVzakGC/c26f2pBBncgEGoiESAVQX9zciAQc2pBteTr6XtqQQp3IBFqIhIgEEF/c3IgEXNqQbul39YCakEPdyASaiIVIARqIBYgEGogFSARQX9zciASc2pBkaeb3H5qQRV3aiEEIBUgA2ohAyASIAJqIQIgESAFaiEFIABBwABqIQAgAUFAaiIBDQALQQAgAjYClIkBQQAgAzYCkIkBQQAgBDYCjIkBQQAgBTYCiIkBIAALyAMBBX9BACgCgIkBQT9xIgBBmIkBakGAAToAACAAQQFqIQECQAJAAkACQCAAQT9zIgJBB0sNACACRQ0BIAFBmIkBakEAOgAAIAJBAUYNASAAQZqJAWpBADoAACACQQJGDQEgAEGbiQFqQQA6AAAgAkEDRg0BIABBnIkBakEAOgAAIAJBBEYNASAAQZ2JAWpBADoAACACQQVGDQEgAEGeiQFqQQA6AAAgAkEGRg0BIABBn4kBakEAOgAADAELIAJBCEYNAkE2IABrIgMhBAJAIAJBA3EiAEUNAEEAIABrIQRBACEAA0AgAEHPiQFqQQA6AAAgBCAAQX9qIgBHDQALIAMgAGohBAsgA0EDSQ0CDAELQZiJAUHAABADGkEAIQFBNyEECyABQYCJAWohAEF/IQIDQCAAIARqQRVqQQA2AAAgAEF8aiEAIAQgAkEEaiICRw0ACwtBAEEAKAKEiQE2AtSJAUEAQQAoAoCJASIAQRV2OgDTiQFBACAAQQ12OgDSiQFBACAAQQV2OgDRiQFBACAAQQN0IgA6ANCJAUEAIAA2AoCJAUGYiQFBwAAQAxpBAEEAKQKIiQE3A4AJQQBBACkCkIkBNwOICQsGAEGAiQELMwBBAEL+uevF6Y6VmRA3ApCJAUEAQoHGlLqW8ermbzcCiIkBQQBCADcCgIkBIAAQAhAECwsLAQBBgAgLBJgAAAA=",G8="e6508e4b",H8={name:O8,data:q8,hash:G8},L8=new ce,dA=null;function yD(e){if(dA===null)return U8(L8,H8,16).then(t=>(dA=t,dA.calculate(e)));try{let t=dA.calculate(e);return Promise.resolve(t)}catch(t){return Promise.reject(t)}}var ake=new ce;var cke=new ce;var Ake=new ce;var lke=new ce;var dke=new ce;var gke=new ce;var uke=new ce;var fke=new ce;var Ike=new ce;var pke=new Uint8Array(8);var hke=new ce;var mke=new Uint8Array(8);var Cke=new ce;var Bke=new Uint8Array(8);var yke=new ce;var Eke=new ce;var Qke=new ce;async function gA(e){return await yD(new Uint8Array(await e.arrayBuffer()))}var Ge=[];for(let e=0;e<256;++e)Ge.push((e+256).toString(16).slice(1));function ED(e,t=0){return(Ge[e[t+0]]+Ge[e[t+1]]+Ge[e[t+2]]+Ge[e[t+3]]+"-"+Ge[e[t+4]]+Ge[e[t+5]]+"-"+Ge[e[t+6]]+Ge[e[t+7]]+"-"+Ge[e[t+8]]+Ge[e[t+9]]+"-"+Ge[e[t+10]]+Ge[e[t+11]]+Ge[e[t+12]]+Ge[e[t+13]]+Ge[e[t+14]]+Ge[e[t+15]]).toLowerCase()}var Uu,K8=new Uint8Array(16);function Ou(){if(!Uu){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Uu=crypto.getRandomValues.bind(crypto)}return Uu(K8)}var J8=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),qu={randomUUID:J8};function z8(e,t,r){e=e||{};let i=e.random??e.rng?.()??Ou();if(i.length<16)throw new Error("Random bytes length must be >= 16");if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,t){if(r=r||0,r<0||r+16>t.length)throw new RangeError(`UUID byte range ${r}:${r+15} is out of buffer bounds`);for(let n=0;n<16;++n)t[r+n]=i[n];return t}return ED(i)}function V8(e,t,r){return qu.randomUUID&&!t&&!e?qu.randomUUID():z8(e,t,r)}var Xe=V8;var jo=G(Ae(),1);var g4=G(Ae(),1);function uA(e){let t,r,i,n,o,a,s;return c(),{feed:A,reset:c};function c(){t=!0,r="",i=0,n=-1,o=void 0,a=void 0,s=""}function A(d){r=r?r+d:d,t&&Y8(r)&&(r=r.slice(QD.length)),t=!1;let g=r.length,u=0,I=!1;for(;u<g;){I&&(r[u]===`
`&&++u,I=!1);let C=-1,B=n,h;for(let Q=i;C<0&&Q<g;++Q)h=r[Q],h===":"&&B<0?B=Q-u:h==="\r"?(I=!0,C=Q-u):h===`
`&&(C=Q-u);if(C<0){i=g-u,n=B;break}else i=0,n=-1;l(r,u,B,C),u+=C+1}u===g?r="":u>0&&(r=r.slice(u))}function l(d,g,u,I){if(I===0){s.length>0&&(e({type:"event",id:o,event:a||void 0,data:s.slice(0,-1)}),s="",o=void 0),a=void 0;return}let C=u<0,B=d.slice(g,g+(C?I:u)),h=0;C?h=I:d[g+u+1]===" "?h=u+2:h=u+1;let Q=g+h,D=I-h,E=d.slice(Q,Q+D).toString();if(B==="data")s+=E?"".concat(E,`
`):`
`;else if(B==="event")a=E;else if(B==="id"&&!E.includes("\0"))o=E;else if(B==="retry"){let x=parseInt(E,10);Number.isNaN(x)||e({type:"reconnect-interval",value:x})}}}var QD=[239,187,191];function Y8(e){return QD.every((t,r)=>e.charCodeAt(r)===t)}var W8=Object.prototype.toString,j8=e=>W8.call(e)==="[object Error]",X8=new Set(["network error","Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed","fetch failed","terminated"," A network error occurred.","Network connection lost"]);function Gu(e){if(!(e&&j8(e)&&e.name==="TypeError"&&typeof e.message=="string"))return!1;let{message:r,stack:i}=e;return r==="Load failed"?i===void 0||"__sentry_captured__"in e:r.startsWith("error sending request for url")?!0:X8.has(r)}var Z8=G(Ae(),1);var pr="domainPool",zo="domainPoolIndex";async function Hu(){let e=await ye({[pr]:[],[zo]:0}),t=e[zo]+1;t>=e[pr].length&&(t=0),e[pr].length>0&&H({[zo]:t})}async function $8(){let e=await ye({[pr]:[He.origin],[zo]:0});return e[pr]?.[e[zo]]??He.origin}async function fA(){let e=await $8();return new URL("api",e).toString()}async function Vo(e,t){let r=await ye({[pr]:[]});if(Gu(e)&&navigator.onLine)if(t){let i=!1;t instanceof URL?i=r[pr].some(n=>t.origin.includes(n)):i=r[pr].some(n=>t.includes(n)),i&&await Hu()}else await Hu()}var RD=G(Ku(),1),TD=G(Ae(),1);var DD=G(Ku(),1);var o4=G(Ae(),1);var i4=G(Ae(),1);var vD="ChatGPT Webapp",s4=`${vD}: error_chatgpt_auth`;var QDe=new DD.default(10*1e3);var FD=0,A4=!1,kDe=new RD.default(1e3*30);try{TD.default.storage.local.get({guardChatgptTabId:0}).then(({guardChatgptTabId:e})=>{FD==0&&(FD=e),A4=e!=0})}catch{}async function*bn(e){let t=e.pipeThrough(new TextDecoderStream).getReader();try{for(;;){let{done:r,value:i}=await t.read();if(r)return;yield i}}finally{t.releaseLock()}}var l4=G(Ae(),1);function _D(e){switch(e.split(".").pop()){case"cs":return"text/x-csharp";case"md":return"text/markdown";case"jpg":case"jpeg":return"image/jpeg";case"png":return"image/png";case"gif":return"image/gif";default:return""}}var b4=G(Ae(),1);var h4=G(Ae(),1);var Bi={609:"error_sider_premium_required",610:"error_sider_high_traffic",616:"error_sider_ultra_vip_required",700:"error_sider_basic_credit_limit",701:"error_sider_advanced_credit_limit",702:"error_sider_elite_credit_limit",1001:"error_sider_invalid_token ",1003:"error_sider_need_login",1006:"error_sider_device_bind_account",1011:"error_sider_login_expired",1012:"error_sider_admin_kickout",1013:"error_sider_device_limit_logout",1018:"error_sider_login_expired",1019:"error_sider_user_banned",1101:"error_sider_processing",1102:"error_sider_api_limit",1107:"error_sider_api_limit2",1109:"error_sider_gpt4_highload",1110:"error_sider_gpt_highload",1112:"error_sider_gpt4_limit",1113:"error_sider_gpt4_limit",1136:"error_sider_o1_limit",1137:"error_sider_unlimited_limit",1138:"error_sider_new_unlimited_limit_1",1139:"error_sider_new_unlimited_limit_2",1141:"error_sider_new_unlimited_limit_3",1142:"error_sider_data_analysis_credit",1143:"error_sider_translate_api_limit",1144:"error_sider_gpt45_rate_limit",1145:"error_sider_opus_limit",1146:"error_sider_opus_t_limit",3509:"error_sider_audio_advanced_limit",5522:"error_sider_thinking_model_credit_limit",1118:"error_sider_image_limit",1127:"error_sider_ocr_limit",1128:"error_sider_summary_video_limit",1501:"error_sider_openai_fault",1515:"error_sider_gemini_pro_busy",1129:"error_sider_basic_text_limit",1130:"error_sider_advanced_text_limit",1135:"error_sider_credit_freq_limit",1132:"error_sider_openai_filter",2003:"error_sider_embedding_limit_by_count",3511:"error_sider_audio_to_text_service_overload",4e3:"error_sider_trial_feat_limit",4500:"error_sider_video_too_long",4501:"error_sider_failed_to_create_user_video_task",4502:"error_sider_failed_to_send_whisper_request",4503:"error_sider_got_error_response_from_whisper",4504:"error_sider_failed_to_get_subtitle",4505:"error_sider_failed_to_get_video_info",4506:"error_sider_not_support_live_video",5200:"error_sider_upgrade_ext_needed",1516:"error_sider_function_call_error",750:"error_sider_model_error",15040:"error_sider_chat_deep_research_failed"};function Ju(e,t){switch(e){case 1001:case 1011:case 1012:case 1013:case 1018:H({__force_logout_reason__:Bi[e]}).then(()=>{zu()});break;case 609:case 616:case 1102:case 1107:case 1112:case 1113:case 1118:case 1127:case 1128:case 3511:case 4e3:case 4501:case 4502:case 4503:case 4504:wn.getVipInfoCached();break;default:break}throw new Error(u4(e,t))}function u4(e,t){if(e===1136)return t.includes(`ask.${He.domain}`)?Bi[e]:t;if(e===1135){let r=t.match(/after (.*) minutes/i)?.[1]||60;return`${Bi[e]}|${r}`}if(e===1137){let r=t.match(/is \( (.*) uses/i)?.[1],i=t.match(/every (.*) hours, resetting/i)?.[1],n=t.match(/resetting at (.*). Full/i)?.[1];return`${Bi[e]}|${r}|${i}|${n}`}if(e===1139||e===1141){let r=t.match(/Current speed limit is \((.*) times \//i)?.[1],i=t.match(/\/ (.*) hour/i)?.[1];return`${Bi[e]}|${r}|${i}`}return e in Bi?Bi[e]:typeof t=="string"&&t.startsWith("504")?"error_sider_timeout":t}async function f4(e,t,r){return new Promise((i,n)=>{let o=new XMLHttpRequest;o.open(t.method||"GET",e),t.headers instanceof Headers&&t.headers.forEach((a,s)=>{o.setRequestHeader(s,a)}),o.onload=function(){i(new Response(o.responseText,{status:o.status,statusText:o.statusText}))},o.upload.onprogress=function(a){a.lengthComputable&&r&&r?.(a.loaded/a.total*100)},o.onerror=function(){n(new TypeError("Network request failed"))},o.ontimeout=function(){n(new TypeError("Network request timed out"))},o.send(t.body),t.signal&&(t.signal.onabort=function(){o.abort(),n(new DOMException("Aborted","AbortError"))})})}async function Vu(e,t=null,r={}){if(!e.startsWith("http")){let I=await fA();e=ro(I,e)}e=new URL(e).href;let{onStreamData:i,getAbortMethod:n,noAuth:o,timeout:a,returnRawResponse:s,onProgress:c,...A}=r;A.method&&(A.method=A.method.toUpperCase());let l=new AbortController;if(A.signal||(A.signal=l.signal),n?.(()=>{l.abort()}),A.headers=new Headers(A.headers||{}),!o&&!A.headers.has("Authorization")){let I=(await IA()).token;if(I)A.headers.set("Authorization",I),gt("ERR_MUST_LOGIN");else throw new Error("Need Login",{cause:{url:e,method:A.method}})}if(t)try{t instanceof FormData||t instanceof Blob||t instanceof URLSearchParams||t instanceof ReadableStream||t instanceof ArrayBuffer?A.body=t:(A.body=JSON.stringify(t),A.headers.set("Content-Type","application/json"))}catch{A.body=t}let d;a&&(d=setTimeout(()=>l.abort(),a));let g=null;try{g=c?await f4(e,A,c):await fetch(e,A)}catch(I){throw Vo(I,e),I}if(!g)throw new Error("No response");if(a&&clearTimeout(d),s)return g;let u=null;if(i||(u=await g.json().catch(()=>({}))),!g.ok||g.status!==204&&u&&u.code!==0){if(u||(u=await g.json().catch(()=>({}))),u.errMsg=u.msg||u.message,ad(u))u.errMsg=`${g.status} ${g.statusText}`;else{(u.code===1003||u.code===1006)&&H({ERR_MUST_LOGIN:!0});try{Ju(u.code,u.msg||u.message)}catch(I){u.errMsg=I.message}}throw i&&i({data:null,done:!0}),u}if(i&&g.body){let I=uA(C=>{if(C.type==="event"){let B={code:0,data:null,msg:"",errMsg:"",done:C.data==="[DONE]"},h=null;try{h=JSON.parse(C.data)}catch{}if(h&&(B={...B,...h}),B.code!==0){try{Ju(B.code,B.msg)}catch(Q){B.errMsg=Q.message}throw i({data:null,done:!0}),B}i({data:B.data,done:B.done})}});for await(let C of bn(g.body))I.feed(C)}return u?.data}var j=(...e)=>Vu(e[0],e[1],{...e[2],method:"GET"}),T=(...e)=>Vu(e[0],e[1],{...e[2],method:"POST"});var Yu=(...e)=>Vu(e[0],e[1],{...e[2],method:"DELETE"});var I4=G(Ae(),1);var MD=G(Ae(),1);async function Yo(){let{generatedRandomId:e}=await ye({generatedRandomId:""});if(!e){let t=await m4();return t||(t=Xe(),C4(t)),MD.default.storage.local.set({generatedRandomId:t}),t}return e}var ND=He.origin.replace(/\/\/\w+?\./,"//Y2hhdGdwdC1zaWRlYmFy."),PD="zgv2awnlswq";async function m4(){try{return await ud({url:ND,name:PD})}catch{return""}}async function C4(e){let t=Math.round(Date.now()/1e3)+31104e3;try{return await BE({url:ND,name:PD,value:e,expirationDate:t,secure:!0})}catch{}}var w4=G(Ae(),1);var Q4=G(Ae(),1);async function pA(e,t,r={},i={}){let n=r.signal;if(n?.aborted)throw new DOMException("Aborted","AbortError");let o=URL.parse(e)??new URL(`${await fA()}${e}`),a=E4(r.body??t),s=new Headers(r.headers),c=(r.method??"GET").toUpperCase(),A=c==="GET"||c==="HEAD";s.has("Content-Type")||s.set("Content-Type","application/json");let{noAuth:l=!1,timeout:d,noAppInfo:g=!1}=i;if(!l&&!s.has("Authorization")){let h;try{h=(await IA()).token}catch(Q){throw Q instanceof Error?Q:y4(Q)&&Q.msg?new Error(Q.msg,{cause:Q}):new Error("Failed to get token")}if(h)s.set("Authorization",h);else throw new Error("Need Login",{cause:{url:o.href,method:c}})}if(a instanceof FormData&&s.delete("Content-Type"),!g){let h=function(Q){if(A){let D=o.searchParams;for(let E in Q)D.has(E)||D.append(E,Q[E])}else if(a instanceof FormData)for(let D in Q)a.has(D)||a.append(D,Q[D]);else if(Ki(a))for(let D in Q)Object.hasOwn(a,D)||(a[D]=Q[D])};var B=h;h({app_name:_,tz_name:W,app_version:Kt})}let u=Object.assign({},r,{signal:MC([n,d?NC(d):null].filter(dd)),headers:s,method:c,body:A?void 0:s.get("Content-Type")==="application/json"?JSON.stringify(a):a}),I=await fetch(o,u).catch(h=>{throw Vo(h,o),h});if(i.onStream&&I.body&&I.ok){let h=i.onStream,Q=uA(D=>{if(D.type!=="event")return;let E=D.data==="[DONE]";if(E){h({done:E});return}let x=JSON.parse(D.data);if(x.code!==0)throw new Error(x.msg,{cause:x});h({data:x.data})});for await(let D of bn(I.body))Q.feed(D);return{}}let C=await I.json().catch(()=>{});if(!I.ok)throw new Error(`${I.status}: ${C?.msg||I.statusText}`,{cause:C});if(!C)throw new Error("Response body is not json");if(typeof C.code=="number"&&C.code!==0)throw(C.code===1003||C.code===1006)&&H({ERR_MUST_LOGIN:!0}),new Error(C.msg,{cause:C});return gt("ERR_MUST_LOGIN"),Object.hasOwn(C,"data")?C.data:C}function y4(e){return Ki(e)&&Object.hasOwn(e,"code")&&Object.hasOwn(e,"data")&&Object.hasOwn(e,"msg")&&typeof e.code=="number"}function E4(e){if(e instanceof FormData){let t=new FormData;for(let[r,i]of e)t.append(r,i);return t}else return id(e)}async function Wo(e,t,r){let i,n;(e==="gpt-3.5"||e==="gpt-4")&&t&&(i={[e]:cd({total:t.total,remain:t.remain,extraTotal:t.extra_total,extraRemain:t.extra_quota,period:t.remain_period,used:t.used},dd)}),r&&(n={videoSummary:{total:r.total.video_summary,used:r.used.video_summary,remain:r.total.video_summary-r.used.video_summary},chatFile:{total:r.total.chat_file,used:r.used.chat_file,remain:r.total.chat_file-r.used.chat_file},painter:{total:r.total.painter,used:r.used.painter,remain:r.total.painter-r.used.painter},tts:{total:r.total.tts,used:r.used.tts,remain:r.total.tts-r.used.tts},artifacts:{total:r.total.artifacts,used:r.used.artifacts,remain:r.total.artifacts-r.used.artifacts},thinking_mode:{total:r.total.thinking_mode,used:r.used.thinking_mode,remain:r.total.thinking_mode-r.used.thinking_mode},data_analysis:{total:r.total.data_analysis,used:r.used.data_analysis,remain:r.total.data_analysis-r.used.data_analysis},text_to_image:{total:r.total.text_to_image,used:r.used.text_to_image,remain:r.total.text_to_image-r.used.text_to_image},search:{total:r.total.search,used:r.used.search,remain:r.total.search-r.used.search},...r.total.short_video&&{shortVideo:{total:r.total.short_video,used:r.used.short_video,remain:r.total.short_video-r.used.short_video}}}),await Sn({...i&&i,...n&&{trial:n}})}function UD(e){return ro(He.origin,e)}async function OD({fileId:e,wisebaseId:t,noteId:r}){(!t||t==="inbox")&&(t="ai-inbox");let i=new URLSearchParams;i.set("fid",e),r&&i.set("noteId",r),fd({url:UD(`/wisebase/chat/${t}/?${i.toString()}`)})}var S4={token:"",refresh_token:"","userinfo-type":"","userinfo-avatar":"","userinfo-name":""};async function ju(){let e=await hA("userinfo-type"),t=await hA("token");return e===null?null:!!(t&&e&&e!=="device")}async function zu(){await H({__manual_logout__:!0}),await gt(Object.keys(S4)),await gt("userInfo"),await H({logged:!1})}async function x4(){let{vipInfo:e}=await ye({vipInfo:{isVIP:!1,isTrial:!1,payment:{interval:""},userTypeDetail:"login",planName:"",resetTimeSec:0,"gpt-3.5":{total:0,remain:0,used:0,extraTotal:0,extraRemain:0,period:"total"},"gpt-4":{total:0,remain:0,used:0,extraTotal:0,extraRemain:0,period:"total"},eliteCredit:{total:0,remain:0,used:0,extraTotal:0,extraRemain:0,period:"total"},trial:{chatFile:{total:0,remain:0,used:0},painter:{total:0,remain:0,used:0},videoSummary:{total:0,remain:0,used:0},tts:{total:0,remain:0,used:0},shortVideo:{total:0,remain:0,used:0},artifacts:{total:0,remain:0,used:0},search:{total:0,remain:0,used:0},text_to_image:{total:0,remain:0,used:0},data_analysis:{total:0,remain:0,used:0},thinking_mode:{total:0,remain:0,used:0}},"image-creator":{total:0,remain:0,used:0,extraTotal:0,extraRemain:0,period:"total"},summary:{total:0,remain:0,cost:3,period:"total"},ocr:{cost:1},reader:{total:0,remain:0,used:0,limitSize:104857600,period:"total"}}});return e}async function Sn(e){let t=await x4();return typeof e=="function"&&(e=e(t)),od(t,e,(r,i)=>{if(Array.isArray(r))return i}),H({vipInfo:t})}async function IA(){let e=await yi();return e?{...e,anonymous:!1}:{token:"",refreshToken:"",anonymous:!1}}async function yi(){if(await ju()){let e=await hA("token"),t=await hA("refresh_token");return e?{token:e,refreshToken:t}:null}return null}async function hA(e){let{__manual_logout__:t,__force_logout_reason__:r}=await ye({__manual_logout__:!1,__force_logout_reason__:""});if(t||r)return"";try{let i=await yE(e);if(!i)throw new Error("");return H({[e]:i}),i}catch{return(await ye({[e]:""}))[e]}}function mA(e,t=!1){let r=new Map,i=new WeakMap,n=a=>{let s=r.get(a);return s||(t?s=a.replace(/[A-Z]/g,c=>`_${c.toLowerCase()}`):s=a.replace(/_([a-z])/g,(c,A)=>A.toUpperCase()),r.set(a,s),s)},o=a=>{if(a===null||typeof a!="object")return a;if(i.has(a))return i.get(a);if(Array.isArray(a)){let c=a.map(o);return i.set(a,c),c}let s={};i.set(a,s);for(let c in a)if(Object.prototype.hasOwnProperty.call(a,c)){let A=n(c);s[A]=o(a[c])}return s};return o(e)}var _=gE,U=Kt,W=Intl.DateTimeFormat().resolvedOptions().timeZone,Kr=`app_name=${_}&app_version=${U}&tz_name=${W}`,Xu="ChitChat_Ext",Zu="ChitChat_Ext_UserStatus",wn={async refreshToken(e){let t=await T("/v1/user/token/refresh",{refresh_token:e},{noAuth:!0});return{token:t.token.token,refreshToken:t.token.refresh_token}},getSiderAnonymousToken:ji(async()=>{let e=await Yo();return T("/v1/user/login/device_id",{device_id:e,uuid:e,app_name:_,app_version:U},{noAuth:!0})}),getUserInfo:async()=>{let e=await j(`/v1/user/info?app_name=${_}&app_version=${U}`);return await H({userInfo:e}),e},getVipInfo:qD,getVipInfoCached:ji(qD,5e3),getVipPeriodInfo:ji(async()=>{let e=await j(`/v1/completion/limit/static?app_name=${_}&app_version=${U}&tz_name=${W}`);return await H({vipPeriodInfo:e}),e},3e3),async getPricingPlan(){let e=await j("/v1/app/ipinfo",null,{noAuth:!0}),t=e.region==="CN"||W==="Asia/Shanghai"&&await pe("language","en")==="zh_CN",r=await j(`/v1/payment/pricing?from=web&location=${t?"CN":e.region}`,null,{noAuth:!0});$i({isCNUser:t,pricingPlan:r.plan.map(i=>({name:i.name,displayName:i.display_name,currency:i.currency,interval:i.interval,originPrice:i.origin_price/100,price:i.price/100,discount:i.discount/100||0,current:i.id==r.current_plan?.id}))})},getClientConfig:async e=>{let t=await j(`/v1/app/config?app_name=${_}&app_version=${U}&tz_name=${W}`);return t&&await H({configByServer:t}),e?t?.[e]:t},getUserSettings:ji(async()=>await ju()?(await j(`/v1/user/settings?app_name=${_}&keys=${Xu}`)).keys?.[Xu]:{},2e3),setUserSettings(e){if(!(!e||Object.keys(e).length===0))return Wi(()=>T("/v1/user/settings",{app_name:_,key:Xu,key_setting:e}))},getUserStatus:ji(async()=>{let t=(await j(`/v1/user/settings?app_name=${_}&keys=${Zu}`)).keys?.[Zu];return t&&Object.keys(t).length&&await H({userStatus:t}),t},2e3),async setUserStatus(e){if(!e||Object.keys(e).length===0)return;await Wi(()=>T("/v1/user/settings",{app_name:_,key:Zu,key_setting:e}));let{userStatus:t}=await pe({userStatus:{}});H({userStatus:{...t||{},...e}})},getUserPromptList(e){return j(`/v1/prompt/list?type=${e}&page_size=999`)},getAllPromptList:async()=>{let e=await pe({language:"",chatVisiblePromptKeys:null,readVisiblePromptKeys:null,writeVisiblePromptKeys:null}),t=e.language;if(!t)throw new Error("no language");let r=await wn.getUserSettings(),[i,n]=await Promise.all([j(`/v1/prompt/list_all?app_name=${_}&page_size=999&language=${t}`,null,{headers:{Authorization:(await yi())?.token||""}}),j(`/v1/prompt/list?type=special&app_name=${_}&page_size=999&language=${t}`,null,{headers:{Authorization:(await yi())?.token||""}})]),o=i.List;o.sort((h,Q)=>(h.sort!==0||h.key==="improve_writing")&&(Q.sort!==0||Q.key==="improve_writing")?Q.sort-h.sort:Q.sort===0?1:h.sort===0?-1:0);let a=o.reduce((h,Q)=>(h[Q.key||Q.id]=Q,h),{});function s(h){return{id:String(h.id),key:String(h.key||h.id),isCustom:!h.key||h.key.startsWith("custom"),name:h.display_name||h.name,shortName:h.short_name,content:h.content,icon:h.icon,placeholder:h.placeholder,usedIn:h.use||void 0,children:h.has_child?[]:void 0,parentKey:h.parent_key}}let c=[],A={};for(let h of o){let{key:Q,has_child:D,parent_key:E}=h;if(D){if(!(Q in A)){let w=s(h);A[Q]=w,c.push(w)}continue}if(E){let w=a[E];if(!w)continue;if(!(E in A)){let k=s(w);A[E]=k,c.push(k)}A[E]?.children?.push(s(h));continue}let x=s(h);c.push(x)}let l=new Map(c.map(h=>[h.key,h]));function d(h,Q){let D=l.get(h);if(D){let{usedIn:E}=D;return!E||E.includes(Q)}return!1}function g(h,Q=!1){let D=[];for(let E of c)d(E.key,h)&&(!Q||E.isCustom)&&D.push(E.key);return D}let u=i.Sort,I={chat:["chatVisiblePromptKeys","ChatAsk"],read:["readVisiblePromptKeys","ReadingAssistant"],write:["writeVisiblePromptKeys","WritingAssistant"]},C={};for(let[h,[Q,D]]of Object.entries(I)){let E=u[D].split(",").map(k=>k.trim()).filter(k=>l.has(k)),x=r?.[Q],w=e[Q]||x;if(w?C[Q]=ld([...w.filter(k=>l.has(k)),...g(h)]):C[Q]=ld([...g(h,!0),...E,...g(h)]),x?.length){let k=x.reduce((N,J,X)=>(N[J]=X,N),{});C[Q].sort((N,J)=>{let X=k[N],K=k[J],Ze=X===void 0,fe=K===void 0;return Ze&&fe?0:Ze?1:fe?-1:X-K})}}let B=n.List.map(h=>s(h));await H({...C,allPromptList:c,specialPromptList:B,__DONT_SYNC__:`visiblePromptKeys${Date.now()}`})},createPrompt(e){return Wi(()=>T("/v1/prompt/create",{is_template:!1,type:"sidebar",...e}))},editUserPrompt(e){return Wi(()=>T("/v1/prompt/edit",e))},delUserPrompt(e){return Wi(()=>T("/v1/prompt/update",{id:e,status:"Deleted"}))},async uploadHistoryMsg(e,t){let r=await T("/chat/v1/conversation/create",{title:t,messages:e},{headers:{"X-App-Name":_,"X-App-Version":U,"X-Time-Zone":W,"X-Trace-Id":Xe()}});return{conversation:r.conversation,messages:r.messages}},uploadConversion(e){return T("/v1/conversation/upload",{share:!0,app_name:_,app_version:U,messages:e})},saveConversion(e){return T("/v1/conversation/upload",{save_by_user:!0,app_name:_,app_version:U,messages:e})},async shareConversion(e){return(await j(`/v1/conversation/share/${e}`)).share_key},saveSiderConversion(e){return j(`/v1/conversation/save-by-user/${e}`)},unSaveSiderConversion(e){return j(`/v1/conversation/unsave-by-user/${e}`)},delConversion(e){return Yu(`/v1/conversation/delete/${e}`)},checkGrammarError(e){return T("/v1/completion/grammar_check",{content:e,tz_name:W,app_name:_,app_version:U})},async improveWriting(e){let t=Zn(Wo,1e3,{leading:!0});return T("/v1/completion/improve_writing",{content:e.content,model:e.model,tz_name:W,app_name:_,app_version:U},{onStreamData({data:r,done:i}){!i&&r&&e.quota&&t(e.quota,r),e.onStreamData({text:r?.text||"",done:i})},getAbortMethod:e.getAbortMethod})},async sendFeedback({title:e,detail:t,email:r}){let i=await yi();return T("/v1/app/feedback",{title:e,email:r,data:{detail:t},app_name:_,app_version:U},{headers:{Authorization:i?.token||""}})},async sendFiveStarFeedback(e,t){let r=await yi(),i=await pe("language","en"),n=`[FiveStarRate][${Kt}][${i}] Feedback by FiveStarRate`;return T("/v1/app/feedback",{title:n,data:{from:t,detail:e},app_name:_,app_version:U},{headers:{Authorization:r?.token||""}})},async sendSearchAgentDislikeFeedback(e,t,r){let i=await yi(),n=await pe("language","en"),o=`[SearchAgentDislike][${Kt}][${n}] Feedback by SearchAgentDislike`;return T("/v1/app/feedback",{title:o,data:{from:t,feedbackData:r||{}},app_name:_,app_version:U},{headers:{Authorization:i?.token||""}})},async getInviteRewardConfig(){let e=await j("/v1/invite/config",null,{noAuth:!0});return await H({inviteRewardConfig:{"gpt3.5":e.GPT3Dot5Count,gpt4:e.GPT4Count,"1_person_gpt3.5":e.SendUpTo1GPT3Dot5Count,"1_person_gpt4":e.SendUpTo1GPT4Count,"2_person_gpt3.5":e.SendUpTo2GPT3Dot5Count,"2_person_gpt4":e.SendUpTo2GPT4Count}}),e},async getInvitedFriendsList(){let e=await j("/v1/invite/list?page=1&page_size=1");return e?.list&&H({invitedFriendsCount:e.list.filter(t=>t.status==="Finished").length}),e},createInviteLink(){return T("/v1/invite/create",{type:"link"})},async getInviteRewardCount(e){let t=await j(`/v1/invite/reward?app_name=${_}&app_version=${U}&last_req_time=${e}`);return{addedQuery:t.recent_reward_gpt3dot5_count+t.recent_reward_gpt4_count,addedUser:t.recent_invited_count}},inviteFinish:async()=>{let e=await Yo();return T("/v1/invite/finish",{device_id:e})},async summaryVideo(e){function t(u){if(u?.total)if(e.vip){let I={"gpt-3.5":{total:u.total,remain:u.remain,extraTotal:u.extra_total,extraRemain:u.extra_quota,period:u.remain_period}};Sn(I)}else{let I={summary:{remain:u.remain}};Sn(I)}}let r=Zn(t,1e3,{leading:!0}),i={app_name:_,app_version:U,tz_name:W,content:e.text,title:e.title,language:e.lang,source:e.source,source_type:e.sourceType,request_id:Xe(),cid:""},n=[];e.getAbortMethod(()=>{for(let u of n)u()});let{content:o,cid:a,...s}=i,c=null;try{c=await T("/v1/completion/summarize_init",s,{getAbortMethod(u){n.push(u)}})}catch{}c&&(i.cid=c.cid||"");let A=T("/v1/completion/summarize_all",i,{onStreamData({data:u,done:I}){!I&&u&&r(u),e.onStreamData({text:u?.text||"",done:I})},getAbortMethod(u){n.push(u)}}),l=T("/v1/completion/summarize",i,{getAbortMethod(u){n.push(u)}}),[d,g]=await Promise.all([A,l]);return t(g),{text:g.text,subtitle:g.subtitle}},async summaryVideoByEid(e){function t(n){n?.total&&Wo(n?.chat_model??"gpt-3.5",n,n.feature_info)}let r=Zn(t,1e3,{leading:!0}),i={app_name:_,app_version:U,tz_name:W,use_whisper:!!e.useWhisper,eid:e.eid,language:e.language,re_summarize:!!e.reSummarize};await T("/v1/completion/video_summarize",i,{onStreamData({data:n,done:o}){!o&&n?(r(n),n.type==="text"?e.onStreamTextData({text:n.text,done:o}):n.type==="text_done"?e.onStreamTextData({text:n.text,done:!0}):n.type==="key_moments"&&e.onKey_momentsData(n.key_moments)):e.onStreamTextData({text:"",done:o})},getAbortMethod:n=>{e.getAbortMethod&&e.getAbortMethod(()=>{n()})}})},async getSummaryCache(e){let{is_creator:t,eid:r,summary:i,key_moments:n,language:o,from_whisper:a}=await T("/v1/completion/video_info",{source:e.source,source_type:e.source_type,title:e.title,app_name:_,app_version:U,tz_name:W,language:e.language});return{is_creator:t,eid:r,summary:i,key_moments:n,from_whisper:a,language:o}},async getSummaryCacheRaw(e){let{is_creator:t,eid:r,summary:i,key_moments:n,language:o,task_id:a,subtitle:s,summary_language:c}=await T("/v1/completion/raw_video_info",{source:e.source,source_type:e.source_type,title:e.title,app_name:_,app_version:U,tz_name:W,language:e.language});return{is_creator:t,eid:r,summary:i,subtitle:s,task_id:a,key_moments:n,language:o,summary_language:c}},async uploadWhisperSubtitle(e,t){return(await T("/v1/whisper/upload-subtitle",{app_name:_,app_version:U,tz_name:W,url:e,summary_language:t})).task_id},async poolingWhisperProgress(e,t){let r=await T("/v1/whisper/progress",{app_name:_,app_version:U,tz_name:W,task_id:e,webpage_url:t});return await Wo("gpt-4",r.quota_map),{eid:r.eid,subtitle:r.subtitle_info.subtitle,language:r.subtitle_info.language,progress:r.progress}},async uploadSubtitleCache(e){let t=new FormData;return t.append("video_url",e.videoUrl),t.append("language",e.language),t.append("subtitle",e.subtitle),t.append("app_name",_),t.append("app_version",U),T("/v1/video/cache_subtitle",t)},async getSubtitleCacheURL(e){let t={video_id:e.videoID,language:e.language,app_name:_,app_version:U};return(await j("/v1/video/get_subtitle?"+new URLSearchParams(t))).subtitle_url},statUserStop(e,t){return T("/v1/completion/mark-user-stop",{app_name:_,app_version:U,cid:e,mid:t})},async OCR(e,t){let r=new FormData;return r.append("file",e),r.append("app_name",_),r.append("app_version",U),r.append("tz_name",W),(await T("/v1/ocr/math",r,{getAbortMethod:t}))?.result?.text||""},adStat(e){return T("/v1/lp/action",{...e,meta:{browser:to?"Edge":"Chrome",ext_version:Kt}},{noAuth:!0})},async googleAnalytics(e,t){if(!jo.default.tabs)return jo.default.runtime.sendMessage({type:"GA_API",args:[e,t]});let r=e.replace(/-/gi,"_");return r.length>40,T(`${fE}?measurement_id=${IE}&api_secret=${pE}`,{client_id:await Yo(),events:[{name:r,params:{...t}}]},{noAuth:!0})},uploadImage(e){let t=new FormData;return t.append("file",e),T("/v1/imagechat/upload",t,{onProgress:r=>{}})},signImageCookie(){return j(He.api+"/v1/user/sign-file-cookies")},createWisebaseByFileIds(e,t){return T("/library/v1/wisebase-by-files",{desc:e,fileIds:t},{headers:{"x-app-name":_,"x-app-version":U,"x-time-zone":W}})},createQuestionByFileIds({answerId:e,conversationId:t,questionId:r,siderFileId:i}){return T("/library/v1/files/question/by-file",{answerId:e,conversationId:t,questionId:r,siderFileId:i},{headers:{"x-app-name":_,"x-app-version":U,"x-time-zone":W}})},loadSiderModels(e){return j(`/v1/app/load_models?app_name=${_}&app_version=${U}&lang=${e}`,null,{noAuth:!0})},loadWebsiteTools(e){return j(`/v1/app/load_tools?app_name=${_}&app_version=${U}&lang=${e}`,null,{noAuth:!0})},uploadFile(e,t,r,i,n){let o=new FormData;return o.append("file",e),o.append("app_name",_),o.append("app_version",U),o.append("tz_name",W),r&&o.append("webpage_url",r),i&&o.append("file_for",i),T("/v1/embedding/upload-file",o,{onProgress:t,getAbortMethod:a=>{n&&n(()=>{a()})}}).then(a=>{try{(a?.text_ready||!a.is_embedding)&&Id([a?.id],!0)}catch{}return a})},async uploadFileV2({file:e,onProgress:t,url:r,title:i,desc:n,fileFor:o,getAbortMethod:a,meta:s,tasks:c,noDirectUpload:A=!1}){let l=e.type||_D(e.name),d=[];l.startsWith("image")||d.push({type:"RAG"});let g=new FormData;return g.append("file",e),g.append("hash",String(await gA(e))),g.append("mime",l),g.append("app_name",_),g.append("app_version",U),g.append("tz_name",W),g.append("tasks",JSON.stringify(c||[...d,...e.type.startsWith("audio")?[{type:"audioDuration"}]:[]])),r&&g.append("type","webpage"),(r||o||s||i||n)&&g.append("meta",JSON.stringify({url:r,title:i,desc:n,fileFor:o,...s||{}})),T(A?"/uploader/v1/file/upload":"/uploader/v1/file/upload-directly",g,{onProgress:t,getAbortMethod:u=>{a&&a(()=>{u()})},headers:{"x-app-name":_,"x-app-version":U,"x-time-zone":W,"x-trace-id":Xe()}}).then(u=>{let{fileID:I,cdnURL:C}=u;try{(u?.textReady||!u?.textInTask||l.startsWith("image"))&&Id([I],!0)}catch{}return{id:I,url:C,limit:u.limit}})},getUploadPermission({name:e,mime:t,hash:r,size:i,subFiles:n}){return T(`/uploader/v1/file/upload-permission?${Kr}`,{name:e,mime:t,hash:r,size:i,subFiles:n})},fileUploaded({fileID:e,tasks:t,meta:r}){return T(`/uploader/v1/file/complete?${Kr}`,{id:e,meta:r,tasks:t})},getFileStauts(e){return T("uploader/v1/files/status",e)},async getPromotionCountdown(e){return await j(`/v2/user/promotion/promotion_info?app_name=${_}&app_version=${U}&tz_name=${W}${e?"&event_name="+e:""}`)},async getVoiceRoleList(){let e=uE,{voiceRoleList:t}=await ye({voiceRoleList:[]});t?.length===0&&H({voiceRoleList:[e]});let i=(await j(`/v1/audio/voice/list?app_name=${_}&app_version=${U}&tz_name=${W}&page=1&page_size=999`,null,{noAuth:!0})).list.map(n=>({name:n.name,avatar:n.avatar,gender:n.gender,platform:n.platform,requireVIP:n.need_premium}));H({voiceRoleList:[e,...i]}),Promise.allSettled(i.map(n=>new Promise((o,a)=>{n.avatar?.startsWith("http")?fetch(n.avatar).then(async s=>{n.avatar=await ua(await s.blob()),o("")}).catch(a):o("")}))).then(()=>{H({voiceRoleList:[e,...i]})})},async getTTSDemoText(){let{language:e}=await ye({language:""});if(e){let t=await j(`/v1/audio/audition/text?language_code=${e}`);return H({systemVoiceDemoText:t.text}),t.text}return""},async ttsPrepay(e,t){let r=await T("/v1/audio/speech/prepaid",{app_name:_,app_version:U,tz_name:W,texts:e.texts,voice:e.voice,scene:e.scene,scene_id:e.sceneId},{getAbortMethod:t});return r?.quota&&r?.quota_type&&Wo(r.quota_type==="basic"?"gpt-3.5":"gpt-4",r.quota,r.feature_info),r},tts(e,t){return T("/v1/audio/speech",{app_name:_,app_version:U,tz_name:W,input:e.input,voice:e.voice,scene:e.scene,scene_id:e.sceneId,...e.demoLang?{audition_opt:{audition:!0,language_code:e.demoLang}}:null},{returnRawResponse:!0,getAbortMethod:t})},publishArtifact(e){return T("/v1/artifacts_publish",e)},unpublishArtifact(e){return T("/v1/artifacts_unpublish",e)},updateSpeakerName(e){return T("/chat/v1/conversation/speakers_attr",e,{headers:{"X-App-Name":_,"X-App-Version":U,"X-Time-Zone":W,"X-Trace-Id":Xe()}})},syncSingleChatHistory(e){return T("/chat/v1/history/sync",{...e},{headers:{"X-App-Name":_,"X-App-Version":U,"X-Time-Zone":W,"X-Trace-Id":Xe()}})},async getChatHistoryList(e,t,r=200){let n=[],o,a=[];async function s(c,A,l=0){try{return await T("/chat/v1/conversation/list",{sync_tag:c,limit:A,client_type:e,favorite:!0},{headers:{"X-App-Name":_,"X-App-Version":U,"X-Time-Zone":W,"X-Trace-Id":Xe()}})}catch(d){if(d.code===429)throw d;if(l<2){let g=Math.pow(2,l)*1e3;return await new Promise(u=>setTimeout(u,g)),s(c,A,l+1)}throw d}}try{let c=await s(t,r);for(n.push(...c.conversations),o=c.next_sync_tag,a=c.deleted_ids||[];c.has_more;)c=await s(c.next_sync_tag,r),n.push(...c.conversations),o=c.next_sync_tag,a=c.deleted_ids||[];return{conversations:n,next_sync_tag:o,deleted_ids:a,favorites:c.favorites||[]}}catch(c){throw c}},async getChatHistoryByCid(e,t,r=200,i){let o={id:"",cid:"",messages:[]},a,s=[];async function c(A,l,d,g=0){try{return await T("/chat/v1/conversation/messages",{cid:A,sync_tag:l,limit:d},{headers:{"X-App-Name":_,"X-App-Version":U,"X-Time-Zone":W,"X-Trace-Id":Xe()},getAbortMethod:i})}catch(u){if(u.name==="AbortError"&&Promise.reject(),g<2){let I=Math.pow(2,g)*1e3;return await new Promise(C=>setTimeout(C,I)),c(A,l,d,g+1)}throw u}}try{let A=await c(e,t,r),l=mA(A);for(o={...o,id:l.conversation.cid,nextSyncTag:l.nextSyncTag,...l.conversation},o.messages.push(...l.messages),a=l.nextSyncTag,s=l.latestSwitchList||[];l.hasMore;){let d=await c(e,l.nextSyncTag,r);l=mA(d),o={...o,id:l.conversation.cid,nextSyncTag:l.nextSyncTag,...l.conversation},o.messages.push(...l.messages),a=l.nextSyncTag,s=l.latestSwitchList||[]}return{chatData:o,conversation:l.conversation,next_sync_tag:a,latest_switch_list:s}}catch(A){throw A}},switchChatBranch(e,t,r){return T("/chat/v1/conversation/switch",{cid:e,message_id:t,current_leaf_message_id:r},{headers:{"X-App-Name":_,"X-App-Version":U,"X-Time-Zone":W,"X-Trace-Id":Xe()}})},updateConversationTitle(e,t){return T("/chat/v1/conversation/update",{cid:e,title:t},{headers:{"X-App-Name":_,"X-App-Version":U,"X-Time-Zone":W,"X-Trace-Id":Xe()}})},deleteConversation(e,t){return T("/chat/v1/conversation/delete",{cid:t,delete_type:e},{headers:{"x-app-name":_,"x-app-version":U,"x-time-zone":W,"x-trace-id":Xe()}})},async getCustomInstruction(){return await j("/chat/v1/customize_instructions",null,{headers:{"X-App-Name":_,"X-App-Version":U,"X-Time-Zone":W,"X-Trace-Id":Xe()}})},updateCustomInstruction(e){return T("/chat/v1/customize_instructions",e,{headers:{"X-App-Name":_,"X-App-Version":U,"X-Time-Zone":W,"X-Trace-Id":Xe()}})}};async function qD(){let e=await j(`/v1/completion/limit/user?${Kr}`);if(!e.basic_credit.count)throw H({ERR_MUST_LOGIN:!0}),new Error("wrong_data");let t=e.user_type,r=["device","login","premium"],{vipPeriodInfo:i}=await ye({vipPeriodInfo:null});i||(i=await wn.getVipPeriodInfo());let n=i.basic_credit_period_info,o=i.advanced_credit_period_info,a=i.ocr_period_info,s=i.feature_total,c=e.feature_used,A={isVIP:e.user_type==="premium",isTrial:e.is_trial,payment:{interval:""},userTypeDetail:e.user_type_detail,resetTimeSec:e.basic_credit.reset_time,showNewPlan:!!e.show_new_plan,"gpt-3.5":{total:e.basic_credit.count,remain:e.basic_credit.remain,extraTotal:e.basic_credit.extra_total,extraRemain:e.basic_credit.extra_quota,used:e.basic_credit.used,period:e.basic_credit.period,maxToken:n[t]?.prompt_max_token,award:r.reduce((l,d)=>(l[d]={count:n[d].count},l),{})},"gpt-4":{total:e.advanced_credit.count,remain:e.advanced_credit.remain,extraTotal:e.advanced_credit.extra_total,extraRemain:e.advanced_credit.extra_quota,used:e.advanced_credit.used,period:e.advanced_credit.period,maxToken:o[t]?.prompt_max_token,award:r.reduce((l,d)=>(l[d]={count:o[d].count},l),{})},trial:{chatFile:{total:s.chat_file,used:c.chat_file,remain:s.chat_file-c.chat_file},painter:{total:s.painter,used:c.painter,remain:s.painter-c.painter},videoSummary:{total:s.video_summary,used:c.video_summary,remain:s.video_summary-c.video_summary},tts:{total:s.tts,used:c.tts,remain:s.tts-c.tts},data_analysis:{total:s.data_analysis,used:c.data_analysis,remain:s.data_analysis-c.data_analysis},artifacts:{total:s.artifacts,used:c.artifacts,remain:s.artifacts-c.artifacts},text_to_image:{total:s.text_to_image,used:c.text_to_image,remain:s.text_to_image-c.text_to_image},search:{total:s.search,used:c.search,remain:s.search-c.search},thinking_mode:{total:s.thinking_mode,used:c.thinking_mode,remain:s.thinking_mode-c.thinking_mode},...s.short_video?{shortVideo:{total:s.short_video,used:c.short_video,remain:s.short_video-c.short_video}}:{}},summary:{total:e.summarize.count,remain:e.summarize.remain,cost:e.summarize.deduct_count,period:e.summarize.period},ocr:{cost:a?.deduct_count||1},"image-creator":{total:e.image.count,remain:e.image.remain,used:e.image.used,extraTotal:e.image.extra_total,extraRemain:e.image.extra_quota,period:e.image.period},reader:{total:e.embedding.count,remain:e.embedding.remain,used:e.embedding.used,period:e.embedding.period,limitSize:e.embedding.size}};if(e.elite_credit&&(A.eliteCredit={total:e.elite_credit.count,remain:e.elite_credit.remain,extraTotal:e.elite_credit.extra_total,extraRemain:e.elite_credit.extra_quota,used:e.elite_credit.used,period:e.elite_credit.period}),e.plan_name&&(A.planName=e.plan_name),A.isVIP){let l=await j(`/v1/payment/info?${Kr}`);A.payment.interval=l.interval}if(Sn(A),A.isVIP){let{autoTools:l,isDoneAutoToolsAction:d}=await jo.default.storage.local.get(["autoTools","isDoneAutoToolsAction"]);(l===void 0||l&&!l.includes("search"))&&!d&&H({autoTools:mE.filter(g=>g.autoOn).map(g=>g.name),isDoneAutoToolsAction:!0})}else{let{autoTools:l}=await jo.default.storage.local.get("autoTools");typeof l<"u"&&H({autoTools:[]})}return A}var GD="/library";async function HD({content:e,siderFileSource:t,sources:r,title:i}){return pA(`${GD}/v1/note?${Kr}`,{title:i,content:e,wisebaseId:"",siderFileSource:t,sources:r,tags:["media_record_enhance"]},{method:"POST"})}async function Wu(e){return pA(`${GD}/v1/note/${e}?${Kr}`,{},{method:"DELETE"})}var Wt=class e{processing;apiOrigin;token;meta_query;key="";static credentialsRefreshThreshold=300*1e3;static MAX_RETRY_COUNT=1;siderFileId="";videoName="";uploadContexts=new Map;initPromise=null;isPaused=!1;isReady=!1;isDiscarded=!1;uploadTasks=new Map;processingTasks=new Set;connectedCallback;errorCallback;onSuccess;onTranscriptStatus;progressCallback;sliceUploadedCallback;getSliceCallback;constructor(t){this.apiOrigin=t.apiBase,this.token=t.token,this.meta_query=t.meta_query}checkNotDiscarded(){this.isDiscarded}async push(t,r,i){if(this.checkNotDiscarded(),typeof t=="string"&&i&&i!="transcript")return;let n={index:r,data:t,status:"pending",retryCount:0};if(this.uploadTasks.set(r,n),this.progressCallback&&(i!="transcript"||!i)){let o=this.uploadTasks.size;this.progressCallback(this.key,r,{finished:Array.from(this.uploadTasks.values()).filter(a=>a.status==="completed").length,current:r,total:o,binarySlice:typeof t=="string"?0:1})}try{await this.ensureInitialized(),this.uploadSliceWithoutRetry(n).catch(o=>{})}catch{n.status="failed"}}async ensureInitialized(){if(this.checkNotDiscarded(),this.initPromise,await this.initPromise,!this.siderFileId||!this.uploadContexts.has(this.siderFileId))throw new Error("Upload context not ready")}async uploadSliceWithoutRetry(t){if(this.checkNotDiscarded(),!this.processingTasks.has(t.index)){this.processingTasks.add(t.index),t.status="uploading";try{let r=t.data;if(r instanceof Blob)if(await this.s3FirstStrategyUpload(t.index,r)){if(t.status="completed",this.sliceUploadedCallback&&await this.sliceUploadedCallback(this.key,t.index-1),this.progressCallback){let n=this.uploadTasks.size;this.progressCallback(this.key,t.index,{finished:Array.from(this.uploadTasks.values()).filter(o=>o.status==="completed").length,current:t.index,total:n,binarySlice:1})}}else throw new Error("Upload failed");else if(typeof r=="string"){let i=await this.saveTranscript(r);if(this.onTranscriptStatus&&this.onTranscriptStatus(this.key,i),i)t.status="completed";else throw new Error("Upload failed")}}catch{t.status="failed"}finally{this.processingTasks.delete(t.index)}}}async ready(t){if(this.checkNotDiscarded(),this.isReady=!0,this.processing=!0,this.key=Date.now()+Math.random().toString(36),t.id){if(t.id&&t.s3UploadId){this.videoName=(t.title||"Untitled")+".webm",this.siderFileId=t.id;try{let r=await Jr(()=>this.getUploadCredentials(t.id),Ei,"\u83B7\u53D6\u4E0A\u4F20\u51ED\u8BC1"),i={id:t.id,bucket:r.bucket,s3Key:r.s3_key,s3UploadId:t.s3UploadId,credentials:r,s3Client:CA(r),subCredentials:r.subCredentials?.[0].credentials};this.uploadContexts.set(t.id,i)}catch{}}}else{this.videoName=(t.title||"Untitled")+".webm",this.initPromise||(this.initPromise=Jr(()=>this.create({name:this.videoName,mime:t.mime??"video/webm"}),Ei,"initUpload"));try{this.initPromise.then(r=>{this.siderFileId=r.id,this.onConnected&&this.onConnected(this.key,{vid:r.id,s3UploadId:r.s3UploadId,backupDetails:{videoName:this.videoName}})}).catch(r=>{this.errorCallback&&this.errorCallback(this.key,{message:"\u521D\u59CB\u5316\u5931\u8D25",error:r,type:"initError"})})}catch{this.errorCallback}}return this.key}start(t){return this.checkNotDiscarded(),{vid:"",title:""}}pause(){this.checkNotDiscarded(),this.isPaused=!0}resume(){this.checkNotDiscarded()}async create(t){this.checkNotDiscarded();let r=await this.fetchWithValidation(`${this.apiOrigin}/uploader/v1/file/multipart/create`,{method:"POST",body:JSON.stringify({name:t?.name||"uploadFileName.webm",mime:t?.mime||"video/webm",type:"record",subFiles:[{name:"transcipt.txt",mime:"text/plain",id:"readable"}]})}),i={id:r.id,bucket:r.credentials.bucket,s3Key:r.credentials.s3_key,s3UploadId:r.s3_upload_id,credentials:r.credentials,s3Client:CA(r.credentials),subCredentials:r.subCredentials?.[0].credentials};return this.uploadContexts.set(r.id,i),this.siderFileId=r.id,{id:r.id,s3UploadId:r.s3_upload_id}}getUploadContext(t){let r=this.uploadContexts.get(t);if(!r)throw new Error(`Upload context not found for id: ${t}`);return r}async s3FirstStrategyUpload(t,r){this.checkNotDiscarded();let i=this.getUploadContext(this.siderFileId);try{return await this.ensureCredentialsValid(i),await this.uploadPartToS3(i,t,r),!0}catch(n){try{return await this.uploadPartViaServer(i,t,r),!0}catch(o){throw new Error(`\u6240\u6709\u4E0A\u4F20\u65B9\u5F0F\u5747\u5931\u8D25: S3\u9519\u8BEF=${n}, \u670D\u52A1\u7AEF\u9519\u8BEF=${o}`)}}}createUploadPromise(t){return new Promise(r=>{let i=()=>{t.status==="completed"||t.status==="failed"?r():t.status==="pending"?this.uploadSliceWithoutRetry(t).finally(()=>{r()}):setTimeout(i,100)};i()})}async waitForAllUploadsComplete(){let t=Array.from(this.uploadTasks.values());if(t.length===0)return{completed:0,failed:0,total:0,success:!0};let r=t.map(a=>this.createUploadPromise(a));await Promise.allSettled(r);let i=t.filter(a=>a.status==="completed"),n=t.filter(a=>a.status==="failed");return{completed:i.length,failed:n.length,total:t.length,success:n.length===0}}async uploadAllPendingSlices(){this.checkNotDiscarded(),await this.ensureInitialized();let t=Array.from(this.uploadTasks.values()).filter(o=>o.status==="pending").sort((o,a)=>o.index-a.index);if(t.length===0)return;let r=t.map(o=>this.uploadSliceWithoutRetry(o));await Promise.allSettled(r);let i=t.filter(o=>o.status==="completed").length,n=t.filter(o=>o.status==="failed").length}async ensureCredentialsValid(t){this.checkNotDiscarded();let r=Date.now(),i=t.credentials.expire_at*1e3-e.credentialsRefreshThreshold;if(!(r<i)){if(t.credentialsRefreshPromise){await t.credentialsRefreshPromise;return}t.credentialsRefreshPromise=this.refreshCredentials(t);try{await t.credentialsRefreshPromise}finally{delete t.credentialsRefreshPromise}}}async refreshCredentials(t){this.checkNotDiscarded();try{let r=await Jr(()=>this.getUploadCredentials(t.id),Ei,"\u5237\u65B0\u4E0A\u4F20\u51ED\u8BC1");t.credentials=r,t.s3Client=CA(r),t.subCredentials=r.subCredentials?.[0].credentials}catch(r){throw new Error(`\u5237\u65B0\u4E0A\u4F20\u51ED\u8BC1\u5931\u8D25: ${r}`)}}getUploadCredentials(t){return this.fetchWithValidation(`${this.apiOrigin}/uploader/v1/file/multipart/credentials?id=${encodeURIComponent(t)}`)}async uploadPartViaServer(t,r,i){let n=new FormData;n.append("id",t.id),n.append("part_number",r.toString()),n.append("is_last_part",String(i.size<pa)),n.append("file",i),await this.fetchWithValidation(`${this.apiOrigin}/uploader/v1/file/multipart/upload`,{method:"POST",body:n})}async uploadPartToS3(t,r,i){await t.s3Client.send(new AA({Bucket:t.bucket,Key:t.s3Key,PartNumber:r,UploadId:t.s3UploadId,Body:i}))}async stop(t){this.checkNotDiscarded(),this.processing=!1;try{if(t.mark&&this.progressCallback){let i=this.uploadTasks.size,n=Array.from(this.uploadTasks.values()).filter(o=>o.status==="completed").length;this.progressCallback(this.key,n,{finished:Array.from(this.uploadTasks.values()).filter(o=>o.status==="completed").length,current:n,total:i,binarySlice:1,mark:!0})}await this.uploadAllPendingSlices(),(await this.waitForAllUploadsComplete()).failed>0?this.errorCallback&&this.errorCallback(this.key,{type:"networkError"}):await this.complete()?this.onSuccess&&this.onSuccess(this.key,{vid:this.siderFileId,title:this.videoName||"uploadFileName.webm"}):this.errorCallback&&this.errorCallback(this.key,{type:"completeFailed"})}catch{this.errorCallback&&this.errorCallback(this.key,{type:"networkError"})}finally{t.onStop&&t.onStop()}}async cancel(t){if(this.processing=!1,this.isPaused=!1,this.uploadTasks.clear(),this.processingTasks.clear(),!this.isDiscarded&&this.siderFileId)try{await this.discard()}catch{}}async complete(){this.checkNotDiscarded();try{if(!this.siderFileId)return!1;let t=await Jr(()=>this.fetchWithValidation(`${this.apiOrigin}/uploader/v1/file/multipart/complete`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:this.siderFileId,tasks:[{type:"RAG"}]})}),Ei,"complete");return this.uploadContexts.delete(this.siderFileId),!0}catch(t){return!!(t&&t.message=="Not Found")}}async saveFileToInbox(t){try{return this.siderFileId?{libraryFileId:(await Jr(()=>this.fetchWithValidation(`${this.apiOrigin}/library/v1/files?${this.meta_query}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({siderFileId:this.siderFileId,logicFileType:"record",fileType:t??"video/webm",fileName:this.videoName||"uploadFileName.webm",wisebaseId:""})}),Ei,"saveFileToInbox")).libraryFileId}:void 0}catch{return}}async saveNoteToInbox(t,r){let i=Object.keys(t.noteFiles??{});return await HD({title:t.noteTitle||"",content:t.noteText||"",siderFileSource:i,sources:[r]})}async saveTranscript(t){let r=this.uploadContexts.get(this.siderFileId);if(!r||!r.subCredentials)return!1;if(await this.ensureCredentialsValid(r),!t||t.trim().length===0)return await this.discardSubFileViaServer(r.id,"readable"),!0;let i=CA(r.subCredentials);try{return await i.send(new cA({Bucket:r.subCredentials.bucket,Key:r.subCredentials.s3_key,Body:new File([t],"transcript.txt",{type:"text/plain"}),ContentType:"text/plain"})),!0}catch{try{return await this.uploadSubFileViaServer(r.id,"readable",t),!0}catch{return!1}}}async uploadSubFileViaServer(t,r,i){let n=new FormData;n.append("file",new File([i],"transcript.txt",{type:"text/plain"})),await this.fetchWithValidation(`${this.apiOrigin}/uploader/v1/file/${t}/sub/${r}`,{method:"POST",body:n})}async discardSubFileViaServer(t,r){await this.fetchWithValidation(`${this.apiOrigin}/uploader/v1/file/${t}/sub/${r}`,{method:"DELETE",headers:{"Content-Type":"application/json"}})}async discardNoteFrom(t){await Wu(t)}async disCardFileFromInbox(t){await this.fetchWithValidation(`${this.apiOrigin}/library/v1/files/${t}?${this.meta_query}`,{method:"DELETE",headers:{"Content-Type":"application/json"}})}async getSpeechRecognitionResult(t,r,i,n,o){let a=new FormData;a.append("lang",i||"zh-Hans"),a.append("app_version",n||"1.0.0"),a.append("app_name",o||"web"),a.append("file",t),a.append("call_id",String(r));try{let s=await Jr(()=>this.fetchWithValidation(`${this.apiOrigin}/audio/v1/speech/shorten/realtime`,{method:"POST",body:a}),{maxRetries:2,baseDelay:1e3,maxDelay:1e4},"speechRecognition");return!s||typeof s.text!="string"?void 0:{index:r,text:s.text}}catch{return}}async updateUploadProgress(t,r,i){try{let n=await Jr(()=>this.fetchWithValidation(`${this.apiOrigin}/uploader/v1/file/multipart/update-progress?${this.meta_query}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:this.siderFileId,progress:r,total:i})}),Ei,"saveFileToInbox");return!0}catch{return!1}}async discard(){this.isDiscarded=!0;try{if(this.processing=!1,this.isPaused=!1,this.clearLocalUploadState(),this.siderFileId)try{await Jr(()=>this.sendDiscardToServer(),{maxRetries:2,baseDelay:1e3,maxDelay:5e3},"\u53D1\u9001\u4E22\u5F03\u8BF7\u6C42")}catch{}return!0}catch{return this.clearLocalUploadState(),!1}}clearLocalUploadState(){this.uploadTasks.clear(),this.processingTasks.clear(),this.siderFileId&&this.uploadContexts.delete(this.siderFileId),this.isReady=!1,this.processing=!1,this.isPaused=!1,this.initPromise=null}async sendDiscardToServer(){await this.fetchWithValidation(`${this.apiOrigin}/uploader/v1/file/multipart/discard?id=${this.siderFileId}`,{method:"DELETE",headers:{"Content-Type":"application/json"}})}set onConnected(t){this.connectedCallback=t}get onConnected(){return this.connectedCallback}set onError(t){this.errorCallback=t}get onError(){return this.errorCallback}set onProgress(t){this.progressCallback=t}get onProgress(){return this.progressCallback}set onSliceUploaded(t){this.sliceUploadedCallback=t}get onSliceUploaded(){return this.sliceUploadedCallback}set getSlice(t){this.getSliceCallback=t}get getSlice(){return this.getSliceCallback}async fetchWithValidation(t,r){let i={...r,headers:{...r?.headers,Authorization:`${this.token}`}},n=await fetch(t,i);if(!n.ok&&!(n.status===400&&t.endsWith("/multipart/complete")))throw new Error(`Request failed: ${n.status} ${n.statusText}`);let o=await n.json();if(o.code!==0)throw new Error(o.msg||"request failed");return o.data}},Ei={maxRetries:0,baseDelay:1e3,maxDelay:1e4};async function Jr(e,t=Ei,r="operation"){let i;for(let n=0;n<=t.maxRetries;n++)try{return e()}catch(o){i=o;let a=Math.min(t.baseDelay*Math.pow(2,n),t.maxDelay);await ti(a)}throw i}function CA(e){return new sA({credentials:{accessKeyId:e.access_key_id,secretAccessKey:e.secret_access_key,sessionToken:e.session_token},region:e.region})}var $u=1e3*30,Y={TIMEOUT_MULTIPLIER:10,STORE_NAME:"fmp4",STATUS:{CREATED:"created",UPLOADING:"uploading",FAILED:"failed",COMPLETED:"completed"},SLICE_TOTAL_FALLBACK:2e5,READY_DELAY:500,CLEANUP_DELAY:600,STOP_DELAY:1e3*2,RETRY_DELAY:2e3,UPLOAD_TIMEOUT:300*1e3,NETWORK_CHECK_INTERVAL:30*1e3},BA=class e{static instance;processingTasks=new Map;lockPrefix="upload_task_";static getInstance(){return e.instance||(e.instance=new e),e.instance}tryLock(t,r="manual"){let i=`${this.lockPrefix}${t}`;if(this.processingTasks.has(i)){let n=this.processingTasks.get(i);return!1}return this.processingTasks.set(i,{videoKey:t,source:r,startTime:Date.now(),processKey:Date.now().toString()}),!0}releaseLock(t){let r=`${this.lockPrefix}${t}`,i=this.processingTasks.get(r);if(i){this.processingTasks.delete(r);let n=Date.now()-i.startTime}}isProcessing(t){let r=`${this.lockPrefix}${t}`;return this.processingTasks.has(r)}getTaskInfo(t){let r=`${this.lockPrefix}${t}`;return this.processingTasks.get(r)}cleanupTimeoutTasks(t=3600*1e3){let r=Date.now(),i=[];for(let[n,o]of this.processingTasks)r-o.startTime>t&&i.push(o.videoKey);i.forEach(n=>{this.releaseLock(n)})}getStats(){let t=Array.from(this.processingTasks.values());return{total:t.length,manual:t.filter(r=>r.source==="manual").length,scheduler:t.filter(r=>r.source==="scheduler").length,oldest:t.length>0?Math.min(...t.map(r=>r.startTime)):0}}};async function LD(e,t){let r=new ct,i=zt.getInstance(),n=Date.now().toString(),o=BA.getInstance();i.register(n);let a=0,s=0;try{let c=o.getStats(),A=await k4(r,i,e.userId);if(A.length===0)return;for(let l of A){if(!o.tryLock(l.key,"scheduler")){s++;continue}try{await F4(l,n,e,t),a++}catch{a++}finally{o.releaseLock(l.key)}await new Promise(d=>setTimeout(d,100))}}catch{}finally{i.unregister(n)}}async function k4(e,t,r){let i=Date.now(),n=await e.getAllDetail();await D4(e,n,i);let o=n.filter(A=>A.status!==Y.STATUS.CREATED&&(A.processStatus!==Y.STATUS.COMPLETED||A.noteStatus&&A.noteStatus!=Y.STATUS.COMPLETED||A.transcriptStatus&&A.transcriptStatus!=Y.STATUS.COMPLETED)&&A.storeName===Y.STORE_NAME&&A.owner==r);if(o.length===0)return[];let a=o.map(A=>A.processKey),s=await t.queryOutageKeys(a),c=o.filter(A=>s.includes(A.processKey));return R4(c),v4(c)}async function D4(e,t,r){let i=$u*Y.TIMEOUT_MULTIPLIER,n=t.filter(o=>o.status===Y.STATUS.CREATED&&r-o.updateAt>i);if(n.length>0)for(let o of n)await e.update({...o,status:"closed",processStatus:Y.STATUS.FAILED},o.key)}function v4(e){let t=e.filter(o=>o.processStatus===Y.STATUS.FAILED),r=e.filter(o=>o.processStatus!==Y.STATUS.COMPLETED&&o.processStatus!==Y.STATUS.UPLOADING&&o.processStatus!==Y.STATUS.FAILED),i=e.filter(o=>o.noteStatus!==Y.STATUS.COMPLETED&&o.transcriptStatus!==Y.STATUS.FAILED),n=e.filter(o=>o.processStatus===Y.STATUS.UPLOADING);return[...t,...i,...r,...n]}async function F4(e,t,r,i){return new Promise((n,o)=>{let a=Date.now(),s=!1,c=!1,A=g=>{c||(c=!0,s=!0,o(g||new Error("Upload failed")))},l=g=>{},d=()=>{if(c)return;s=!0;let g=Date.now()-a;n()};ef(e.key,r,t,i,A,l,d).catch(g=>{A(g)})})}function R4(e){if(e&&e.length>0){let t=e.reduce((r,i)=>({...r,[i.key]:{...i,external:!0}}),{})}}async function ef(e,t,r,i,n,o,a){let s=BA.getInstance(),c=e.toString(),A=!r||r.length<=1;if(A&&!s.tryLock(c,"manual")){let I=s.getTaskInfo(c);n&&n();return}let l=new ct,d=!0,g,u;try{let I=await l.getDetail(e);if(await T4(I,a)||I.owner!=t.userId)return;let C=await _4("",l,e,I);r=C.processKey,d=C.isResume,g=C.singleLine,u=C.processKey_;let B=M4(t);if(Qi({status:"uploading",key:I.key},I.key),I.processStatus===Y.STATUS.COMPLETED){await B.ready({title:I.title,id:I.originId,s3UploadId:I.s3UploadId}),I.noteStatus!=Y.STATUS.COMPLETED&&(await tf(B,l),i&&i()),I.transcriptStatus&&I.transcriptStatus!==Y.STATUS.COMPLETED&&JD(B,l);return}N4(B,l,e,I,d,i,g,u,()=>{A&&s.releaseLock(c),n&&n()},o,()=>{A&&s.releaseLock(c),a&&a()});let D=await l.getAllSlices(e),E=Date.now(),x=$u*Y.TIMEOUT_MULTIPLIER;if(D.length===0){E-I.updateAt>x*2&&l.remove(e),i&&i();return}else if(D.length===1&&D[0].data&&D[0].data.size===0){E-I.updateAt>x*2&&l.remove(e),i&&i();return}else I.status=="started"&&I.sliceStart&&await l.update({status:"closed",closeAt:Date.now(),sliceEnd:I.sliceStart+D.length},e);await U4(B,l,I,e,i)}catch(I){throw g&&u&&g.unregister(u),A&&s.releaseLock(c),n&&n(),I}finally{g&&u&&g.unregister(u),A&&s.releaseLock(c)}}async function T4(e,t){return!e||e.processStatus===Y.STATUS.COMPLETED&&e.noteStatus===Y.STATUS.COMPLETED&&e.transcriptStatus===Y.STATUS.COMPLETED?(t&&t(),!0):!1}async function _4(e,t,r,i){let o,a;return e&&e.length>1||(o=zt.getInstance(),a=Date.now().toString(),o.register(a),e=a,await t.update({processKey:a},r)),{processKey:e,isResume:!0,singleLine:o,processKey_:a}}function M4(e){return new Wt({apiBase:e.serverAPI,token:e.token,meta_query:e.meta_query})}function N4(e,t,r,i,n,o,a,s,c,A,l){e.onConnected=async(d,g)=>{i.originId||await t.update({processStatus:Y.STATUS.UPLOADING,originId:g.vid,s3UploadId:g.s3UploadId},r),i.libraryFileId||(await P4(e,t,i,g),tf(e,t))},e.onTranscriptStatus=async(d,g)=>{g?(await t.update({transcriptStatus:"completed"}),KD(t)):(await t.update({transcriptStatus:"failed"}),Qi({status:"failed",key:i.key},i.key))},e.onError=async(d,g)=>{let u=await t.getDetail(r);u&&await t.update({processStatus:Y.STATUS.FAILED},r),g.type=="initError"&&Qi({status:"failed",key:u.key},u.key),a&&s&&a.unregister(s),o&&o(),c&&c()},e.onProgress=(d,g,u)=>{A&&A(g)},e.onSliceUploaded=async(d,g)=>{await t.updateSlice(g,{uploaded:!0});let u=await zD(t,r);i.originId&&u&&u.total&&e.updateUploadProgress&&u.finished>0&&e.updateUploadProgress(i.originId,u.finished,u.total),o&&o()},e.onSuccess=async(d,g)=>{let u={progress:1,processStatus:Y.STATUS.COMPLETED,...g?.vid?{originId:g.vid}:{}};await t.update(u,r),o&&o(),o&&o(),l&&l()}}async function P4(e,t,r,i){try{let n=r.options.recordType==="audioOnly"||r.options?.tabType=="tabVoiceOnly"?wi.fileType:zr.fileType,o=await e.saveFileToInbox(n);o?.libraryFileId&&await t.update({libraryFileId:o.libraryFileId,...i?.backupDetails||{}},r.key)}catch{}}async function Qi(e,t){}function KD(e){let t=e.getCurrentDetail();t&&t.key&&(t.noteStatus&&t.noteStatus==="completed"&&t.transcriptStatus&&t.transcriptStatus==="completed"?Qi({status:"success",key:t.key,noteId:t.noteId,libraryFileId:t.libraryFileId},t.key):(t.noteStatus&&t.noteStatus==="failed"||t.transcriptStatus&&t.transcriptStatus==="failed")&&Qi({status:"failed",key:t.key,noteId:t.noteId,libraryFileId:t.libraryFileId},t.key))}async function tf(e,t){let r=t.getCurrentDetail();if(r&&r.key)try{if(r.libraryFileId&&!r.noteId){let i=await e.saveNoteToInbox(r,r.libraryFileId);i.id?(await t.update({noteStatus:"completed",noteId:i.id}),KD(t)):Qi({status:"failed",key:r.key},r.key)}}catch{Qi({status:"failed",key:r.key},r.key)}}async function JD(e,t){let r=t.getCurrentDetail();r&&r.key&&e.push(r.transcript,-1,"transcript")}async function zD(e,t){let r=await e.getAllSlices(t);if(r.length>0){let i=r.filter(o=>o.uploaded),n=i.length/r.length;return await e.update({progress:n},t),{finished:i.length,total:r.length}}return{}}async function U4(e,t,r,i,n){await zD(t,i),r.originId&&r.s3UploadId?await e.ready({title:r.title,id:r.originId,s3UploadId:r.s3UploadId}):await e.ready({title:r.title,mime:r.options.recordType==="audioOnly"||r.options?.tabType=="tabVoiceOnly"?wi.fileType:zr.fileType}),await t.update({processStatus:Y.STATUS.UPLOADING},i),r.noteStatus!=Y.STATUS.COMPLETED&&r.libraryFileId&&tf(e,t),r.transcriptStatus&&r.transcriptStatus!==Y.STATUS.COMPLETED&&await JD(e,t),n&&n(),await new Promise(o=>setTimeout(o,Y.READY_DELAY||500)),await O4(e,t,r),setTimeout(()=>{e.stop({})},Y.STOP_DELAY)}async function O4(e,t,r){let i=isFinite(r.sliceEnd-r.sliceStart)?r.sliceEnd-r.sliceStart:Y.SLICE_TOTAL_FALLBACK,n=10,o=50,a=200,s=0;for(let c=0;c<i;c++){let A=await t.getSlice(r.key,c);A?.data&&A?.data.size>0&&!A.uploaded&&(await e.push(A.data,c+1),s++,await new Promise(l=>setTimeout(l,o)))}}async function VD(e=!1,t){let r=$u*Y.TIMEOUT_MULTIPLIER,i=new ct,n=zt.getInstance(),o=Date.now(),a=await i.getAllDetail();return a&&a.length>0?a.filter(c=>(["closed"].includes(c.status)&&c.storeName==="fmp4"&&o-(c.closeAt??0)>6e3||(c.status==="created"||c.status=="started")&&o-c.updateAt>r&&c.sliceEnd-c.sliceStart>0)&&c.owner==t).reverse():[]}async function YD(){let e=new ct;(await e.getAllDetail()).filter(i=>i.processStatus===Y.STATUS.COMPLETED&&(i.noteStatus===Y.STATUS.COMPLETED||!i.noteStatus)&&(i.transcriptStatus===Y.STATUS.COMPLETED||!i.transcriptStatus)&&i.storeName===Y.STORE_NAME).forEach(async i=>{await e.remove(i.key)})}async function WD(){let e=new ct,t=zt.getInstance(),r=await e.getAllDetail();return r&&r.length>0?r.filter(n=>!["started"].includes(n.status)&&n.storeName==="fmp4"):[]}var yA=class{isOnline;listeners=[];config;periodicCheckInterval;constructor(t={}){this.isOnline=navigator.onLine,this.config={pingUrl:"https://www.google.com/favicon.ico",fetchUrl:"https://jsonplaceholder.typicode.com/posts/1",timeout:4e3,retryAttempts:2,retryDelay:1e3,...t},this.init()}init(){window.addEventListener("online",()=>{this.isOnline=!0,this.notifyListeners("online")}),window.addEventListener("offline",()=>{this.isOnline=!1,this.notifyListeners("offline")})}isNetworkAvailable(){return navigator.onLine}async pingTest(t,r){return new Promise(i=>{let n=Date.now(),o=new Image,a=r||this.config.timeout,s=setTimeout(()=>{i({success:!1,responseTime:Date.now()-n})},a);o.onload=()=>{clearTimeout(s),i({success:!0,responseTime:Date.now()-n})},o.onerror=()=>{clearTimeout(s),i({success:!1,responseTime:Date.now()-n})},o.src=(t||this.config.pingUrl)+"?t="+Date.now()})}async fetchTest(t,r){let i=Date.now();try{let n=new AbortController,o=r||this.config.timeout,a=setTimeout(()=>n.abort(),o),s=await fetch(t||this.config.fetchUrl,{method:"HEAD",mode:"no-cors",signal:n.signal,cache:"no-cache"});return clearTimeout(a),{success:!0,responseTime:Date.now()-i}}catch{return{success:!1,responseTime:Date.now()-i}}}async checkWithRetry(t,r){let i=await t();return i.success?{isOnline:!0,method:r,message:"\u7F51\u7EDC\u8FDE\u63A5\u6B63\u5E38",timestamp:Date.now(),responseTime:i.responseTime}:{isOnline:!1,method:r,message:`\u7F51\u7EDC\u8FDE\u63A5\u5931\u8D25 (\u91CD\u8BD5${this.config.retryAttempts}\u6B21)`,timestamp:Date.now()}}delay(t){return new Promise(r=>setTimeout(r,t))}async checkNetworkStatus(){if(!this.isNetworkAvailable())return{isOnline:!1,method:"navigator.onLine",message:"\u8BBE\u5907\u5904\u4E8E\u79BB\u7EBF\u72B6\u6001",timestamp:Date.now()};let r=await this.checkWithRetry(()=>this.pingTest(),"ping");return r.isOnline,r}getNetworkInfo(){if("connection"in navigator&&navigator.connection){let t=navigator.connection;return{effectiveType:t.effectiveType||"unknown",downlink:t.downlink||0,rtt:t.rtt||0,saveData:t.saveData||!1}}return null}getNetworkQuality(){let t=this.getNetworkInfo();if(!t)return"unknown";let{effectiveType:r,downlink:i,rtt:n}=t;return r==="4g"&&i>10&&n<100?"excellent":r==="4g"&&i>1.5&&n<300?"good":r==="3g"||i>.5&&n<500?"fair":"poor"}addListener(t){this.listeners.push(t)}removeListener(t){this.listeners=this.listeners.filter(r=>r!==t)}notifyListeners(t,r){this.listeners.forEach(i=>i(t,this.isOnline,r))}startPeriodicCheck(t=3e4){this.periodicCheckInterval&&clearInterval(this.periodicCheckInterval),this.periodicCheckInterval=setInterval(async()=>{let r=await this.checkNetworkStatus();r.isOnline!==this.isOnline&&(this.isOnline=r.isOnline,this.notifyListeners(r.isOnline?"online":"offline",r))},t)}stopPeriodicCheck(){this.periodicCheckInterval&&(clearInterval(this.periodicCheckInterval),this.periodicCheckInterval=void 0)}destroy(){this.stopPeriodicCheck(),this.listeners=[],window.removeEventListener("online",this.init),window.removeEventListener("offline",this.init)}};var o0=G(Ae(),1);function jD(e,t){let[r,i]=e,[n,o]=t;if(r<=n&&i<=o)return[r,i];let a=Math.min(n/r,o/i);return[Math.ceil(a*r),Math.ceil(a*i)]}var pt=class e{_stream;_originalStream;desktopMediaRequestId=-1;desktopCaptureOptions;desktopStreamIdResolve;audioContext=null;audioDestination;micStream;turnOffMicTime=0;micAudioSource=null;setTimeout;clearTimeout;cropStream;isRecordingAudio;getAudioFailed;constructor(t){this.switchMic=this.switchMic.bind(this),this.setTimeout=t?.setTimeout||window.setTimeout,this.clearTimeout=t?.clearTimeout||window.clearTimeout,this.setTimeout=this.setTimeout.bind(null),this.clearTimeout=this.clearTimeout.bind(null),this.isRecordingAudio=!1,this.getAudioFailed=!1}async captureDesktop(t){this.desktopCaptureOptions=t||{};let{timeout:r,sources:i,constraints:n,audio:o,video:a}=t||{},s=t?.streamId;if(s||(s=await new Promise((d,g)=>{this.desktopStreamIdResolve=d,this.desktopMediaRequestId=chrome.desktopCapture.chooseDesktopMedia(i||["screen","window","tab","audio"],d),typeof r=="number"&&r>0&&this.setTimeout(()=>{chrome.desktopCapture.cancelChooseDesktopMedia(this.desktopMediaRequestId),this.desktopMediaRequestId=-1,g()},r)})),!s)throw new DOMException("Invalid state","NotAllowedError");let c=o!==!1?{...typeof n?.audio=="object"?n.audio:{},mandatory:{...typeof n?.audio=="object"?n.audio?.mandatory:{},chromeMediaSource:"desktop",chromeMediaSourceId:s}}:!1,A=a!==!1?{...typeof n?.video=="object"?n.video:{},mandatory:{...typeof n?.video=="object"?n.video?.mandatory:{},chromeMediaSource:"desktop",chromeMediaSourceId:s}}:!1,l={...n,audio:c,video:A};return this._stream&&e.stopStream(this._stream),this._stream=await navigator.mediaDevices.getUserMedia(l),this.desktopMediaRequestId=-1,this._stream}async reopenDesktopMediaPicker(t=0){this.desktopMediaRequestId&&chrome.desktopCapture.cancelChooseDesktopMedia(this.desktopMediaRequestId);let{sources:r}=this.desktopCaptureOptions||{};await new Promise((i,n)=>{this.desktopMediaRequestId=chrome.desktopCapture.chooseDesktopMedia(r||["screen","window","tab","audio"],o=>{i(o),typeof this.desktopStreamIdResolve=="function"&&this.desktopStreamIdResolve(o)}),t>0&&this.setTimeout(()=>{chrome.desktopCapture.cancelChooseDesktopMedia(this.desktopMediaRequestId),this.desktopMediaRequestId=-1,n()})})}static isCaptureDesktopSupported(){return!!(window.chrome&&window.chrome.desktopCapture&&window.chrome.desktopCapture.chooseDesktopMedia)}async captureTabMedia(t){this.stopCapture();let{tabId:r,captureOptions:i,noAudioPatch:n,dimension:o}=t||{},a={width:1920,height:1080};if(r&&chrome?.tabs&&o){let g=window?.devicePixelRatio,u=isFinite(g)?g:1,I=await new Promise(C=>{chrome.tabs.get(r,B=>C(B))});a={width:(I?.width??1920)*u,height:(I?.height??1080)*u}}let{maxWidth:s,maxHeight:c}=o||{maxWidth:1920,maxHeight:1080},[A,l]=jD([a.width,a.height],[s,c]),d={audio:!0,video:!0,...i,videoConstraints:{...i?.videoConstraints,mandatory:{...i?.videoConstraints?.mandatory,chromeMediaSource:"tab",...o?{maxWidth:A,maxHeight:l}:{}}}};return this._stream=await new Promise((g,u)=>{chrome.tabCapture.capture(d,I=>{I?g(I):u(new Error("Failed to capture tab media: stream is null"))})}),n!==!0&&this.patchTabCapture(),this._stream}async captureTab(t){let{targetTabId:r,consumerTabId:i,captureOptions:n,noAudioPatch:o}=t||{},a=t?.streamId;a||(a=await new Promise(g=>{chrome.tabCapture.getMediaStreamId({targetTabId:r,consumerTabId:i},function(u){g(u)})}));let{audio:s,video:c}=n||{},A={...n?.audioConstraints,mandatory:{...n?.audioConstraints?.mandatory,chromeMediaSource:"tab",chromeMediaSourceId:a}},l={...n?.videoConstraints,mandatory:{...n?.videoConstraints?.mandatory,chromeMediaSource:"tab",chromeMediaSourceId:a}},d={audio:s!=!1?A:!1,video:c!=!1?l:!1};return this._stream=await window.navigator.mediaDevices.getUserMedia(d),o!==!0&&this.patchTabCapture(),this._stream}patchTabCapture(){if(this._stream&&this._stream.getAudioTracks()?.length>0){let t=new AudioContext;t.createMediaStreamSource(this._stream).connect(t.destination),this._stream.getAudioTracks().forEach(i=>{i.addEventListener("ended",()=>{t.state!=="closed"&&t.close()})})}}async getDisplayMedia(t,r,i){if(this.stopCapture(),t={audio:!0,...t,video:{mediaSource:r?"browser":"screen",displaySurface:r?"browser":"monitor",...t?.video}},i&&i!=="tabVideoWithVoice"){this._originalStream=await window.navigator.mediaDevices.getDisplayMedia(t);let n=this._originalStream.getAudioTracks(),o=this._originalStream.getVideoTracks();return i==="tabVideoOnly"?this._stream=new MediaStream([...o]):i==="tabVoiceOnly"&&(this._stream=new MediaStream([...n]),n.forEach(a=>{a.addEventListener("ended",()=>{this.stopCapture()})})),this._stream}else return this._stream=await window.navigator.mediaDevices.getDisplayMedia(t),this._stream}async getUserMedia(t){return this.stopCapture(),t={audio:!0,video:!0,...t},this._stream=await navigator.mediaDevices.getUserMedia(t),this._stream}async getBlankStream(){return this._stream=await new MediaStream}get stream(){if(!this._stream)throw new Error("No MediaStream available");return this._stream}set stream(t){this._stream=t}prepareAudioContext(){if(!this.audioContext&&this._stream){this.audioContext=new AudioContext,this.audioDestination=this.audioContext.createMediaStreamDestination(),(this._stream.getAudioTracks().length>0?this.audioContext.createMediaStreamSource(this._stream):this.audioContext.createMediaElementSource(document.createElement("audio"))).connect(this.audioDestination);let i=this.audioDestination.stream.getAudioTracks()[0];this._stream.addTrack(i),this._stream.getAudioTracks().forEach(n=>{n!==i&&this._stream&&(this._stream.removeTrack(n),this._stream.addTrack(n))}),navigator.mediaDevices.ondevicechange=n=>{navigator.mediaDevices.enumerateDevices().then(o=>{let a=!1;o.forEach(s=>{s.kind==="audioinput"&&(a=!0)}),a&&this.isRecordingAudio&&this.getAudioFailed&&this.switchMic()})}}}async turnOnMic(t){this.micStream&&this.micStream&&this.micStream&&this.micStream&&this.micStream&&e.stopStream(this.micStream);try{this.micStream=await window.navigator.mediaDevices.getUserMedia({audio:t?{deviceId:t}:!0,video:!1})}catch(i){throw this.getAudioFailed=!0,i;return!1}this.getAudioFailed=!1,this.isRecordingAudio=!0,this.turnOffMicTime=0;let r=this.micStream.getAudioTracks()[0];return r&&(r.onended=this.switchMic),this.prepareAudioContext(),this.audioContext&&(this.micAudioSource=this.audioContext.createMediaStreamSource(this.micStream),this.audioDestination&&this.micAudioSource.connect(this.audioDestination)),!0}async turnOffMic(){this.turnOffMicTime=Date.now(),this.isRecordingAudio=!1,this.micAudioSource&&(this.micStream&&e.stopStream(this.micStream),this.micAudioSource=null,this.micStream=null)}switchMic(){Date.now()-this.turnOffMicTime>200&&(this._stream&&this.micStream&&this.micStream.getAudioTracks().length>0&&this._stream.removeTrack(this.micStream.getAudioTracks()[0]),this.turnOnMic())}async cropVideoTrack(t){if(this._stream&&this.cropStream)return this.cropStream.cropStream(t);this._stream&&(this.cropStream=new xn({stream:this._stream,crop:t,setTimeout:this.setTimeout,clearTimeout:this.clearTimeout}),await this.cropStream.cropStream(),this._stream=this.cropStream.output)}stopCapture(){this._stream&&e.stopStream(this._stream),this.desktopMediaRequestId>0&&chrome.desktopCapture.cancelChooseDesktopMedia(this.desktopMediaRequestId),this.micStream&&(this.turnOffMicTime=Date.now(),e.stopStream(this.micStream)),this._originalStream&&(e.stopStream(this._originalStream),this._originalStream=void 0),this.micAudioSource&&(this.micAudioSource=null),this.audioContext&&(this.audioContext.state!=="closed"&&this.audioContext.close(),this.audioContext=null,this.audioDestination=void 0),this.cropStream&&(this.cropStream.stop(),this.cropStream=void 0)}static stopStream(t){t&&t.getTracks&&t.getTracks().forEach(r=>r.stop())}};var EA=class{outputStream;inputStream;crop;constructor(t){this.inputStream=t.stream,this.crop=t.crop}stop(){this.outputStream&&(this.outputStream.getTracks().forEach(t=>t.stop()),this.outputStream=null),this.inputStream&&(this.inputStream.getTracks().forEach(t=>t.stop()),this.inputStream=null)}},QA=class extends EA{imageCapture;canvas;ctx;canvasStream;setTimeout;clearTimeout;timeoutId=0;timeout;constructor(t){super(t),this.setTimeout=t.setTimeout||window.setTimeout,this.clearTimeout=t.clearTimeout||window.clearTimeout,this.setTimeout=this.setTimeout.bind(null),this.clearTimeout=this.clearTimeout.bind(null),this.timeout=isFinite(t.timeout??NaN)?t.timeout:34}async absCrop(t){if(this.imageCapture){let r=await this.imageCapture.grabFrame(),{width:i,height:n}=r;return wA(t,{width:i,height:n})}return wA(t)}async prepare(){if(this.inputStream){let t=this.inputStream.getVideoTracks()[0];this.imageCapture=new ImageCapture(t),t.addEventListener("ended",()=>this.stop()),this.canvas=document.createElement("canvas");let r=await this.absCrop(this.crop);this.canvas.width=r.w,this.canvas.height=r.h,ZD(r.w,r.h)&&(this.canvas.height=Math.round(r.w*9/16)),this.ctx=this.canvas.getContext("2d"),this.canvasStream=this.canvas.captureStream();let i=this.inputStream.getAudioTracks(),n=this.canvasStream.getVideoTracks();this.outputStream=new MediaStream([...n,...i]),this.outputStream.getVideoTracks().forEach(o=>o.addEventListener("ended",()=>this.stop()));return}}async render(){let t=this.ctx,r=this.imageCapture,{x:i,y:n,w:o,h:a}=await this.absCrop(this.crop),s=0,c=()=>{let A=s++;r.grabFrame().then(l=>{this.canvas&&t&&t.drawImage(l,i,n,o,a,0,Math.round((this.canvas.height-a)/2),o,a)}).catch(l=>{}),this.timeoutId=this.setTimeout(c,this.timeout),s%30};this.clearTimeout(this.timeoutId),c()}stop(){super.stop(),clearTimeout(this.timeoutId),this.canvas=null,this.imageCapture=null,this.ctx=null}async cropStream(t){t&&(this.crop=t),await this.prepare(),this.render()}},G4=typeof MediaStreamTrackProcessor<"u"&&typeof MediaStreamTrackGenerator<"u",H4=!globalThis?.location?.href?.match(/^https?:\/\//),XD=G4&&H4,nf;XD&&(nf=new Worker("crop.worker.js"));var of=class extends EA{constructor(t){super(t)}async cropStream(t){if(t&&(this.crop=t),this.inputStream){let r=this.inputStream.getVideoTracks()[0],i=new MediaStreamTrackProcessor({track:r}),n=new MediaStreamTrackGenerator({kind:"video"}),{x:o,y:a,w:s,h:c}=wA(this.crop),{readable:A}=i,{writable:l}=n;nf.postMessage({action:"crop",readable:A,writable:l,visibleRect:{x:o,y:a,width:s,height:c}},[A,l]),await new Promise(g=>{nf.onmessage=u=>{u.data.action==="crop-worker"&&g(u.data)}}),r.addEventListener("ended",()=>this.stop());let d=this.inputStream.getAudioTracks();this.outputStream=new MediaStream([n,...d]),this.outputStream.getVideoTracks().forEach(g=>g.addEventListener("ended",()=>this.stop()))}}};function wA(e,t){let{x:r,y:i,w:n,h:o,ww:a,wh:s}=e;return t&&(a=t.width,s=t.height),r<1&&i<1&&n<=1&&o<=1&&(r=Math.round(r*a),i=Math.round(i*s),n=Math.round(n*a),o=Math.round(o*s)),r=r&1?r+1:r,i=i&1?i+1:i,n=n&1?n-3:n-2,o=o&1?o-3:o-2,{x:r,y:i,w:n,h:o,ww:a,wh:s}}function ZD(e,t){return e>475&&t<120}var xn=class e{cropInstance;static CropClass;constructor(t){let{w:r,h:i}=wA(t.crop);ZD(r,i)?this.cropInstance=new QA(t):this.cropInstance=new e.CropClass(t)}get output(){if(!this.cropInstance.outputStream)throw new Error("Output stream is not available.");return this.cropInstance.outputStream}async cropStream(t){return this.cropInstance.cropStream(t)}stop(){this.cropInstance.stop()}};xn.CropClass=XD?of:QA;function $D(e){switch(e){case"720p":return{maxWidth:1280,maxHeight:720,maxFrameRate:30};case"1080p":return{maxWidth:1920,maxHeight:1080,maxFrameRate:30};case"2k":return{maxWidth:2560,maxHeight:1440,maxFrameRate:30};case"4k":return{maxWidth:4096,maxHeight:2160,maxFrameRate:30};default:return{maxWidth:1920,maxHeight:1080,maxFrameRate:30}}}async function e0(e,t=3.5*1024*1024){let r=e.getVideoTracks()[0].getSettings(),i=r.width,n=r.height;try{let s=await new ImageCapture(e.getVideoTracks()[0]).grabFrame();i=s.width,n=s.height,s.close()}catch{}return{videoBitsPerSecond:Math.round(Math.sqrt(i*n/1920/1080)*t)}}var t0=/^video\/mp4;?\s*(codecs[=:][(h264)|(h.264)].*)?$/,r0=["video/webm;codecs=h264,opus","video/mp4;codecs:h.264,opus"],sf=class{mediaRecorder;realMimeType;mimeType;stream;blobChunk;safariTimeslicePatch;noFragmentedMp4;noWasmMuxer;size;timeSlice;startTime;stopTime;countedDuration;resumeTime;onAbort;ondataavailable;onRawDataAvailable;onAllDataAvailable;onSpeechBlob;isHookup;isRecording;wasmMuxer;lastSliceCrash;gotLastSlice;gotLastRemuxerSlice;gotLastSlicePromise;gotLastRemuxerSlicePromise;setTimeout;clearTimeout;constructor(t,r,i){this.setTimeout=i?.setTimeout||window.setTimeout,this.clearTimeout=i?.clearTimeout||window.clearTimeout,this.handleAbort=this.handleAbort.bind(this),this.handleDataAvailable=this.handleDataAvailable.bind(this),this.handleRemuxerDataAvailable=this.handleRemuxerDataAvailable.bind(this),this.handleError=this.handleError.bind(this),this.setTimeout=this.setTimeout.bind(null),this.clearTimeout=this.clearTimeout.bind(null),this.timeSlice=i?.timeSlice,this.safariTimeslicePatch=i?.safariTimeslicePatch===!0,this.noFragmentedMp4=i?.noFragmentedMp4===!0,this.noWasmMuxer=i?.noWasmMuxer===!0;let[n,o]=this.getMimeType(r?.mimeType,i?.fallbackMimeTypes);this.mimeType=n,this.realMimeType=o,this.stream=t;let a={...r,mimeType:o};this.mediaRecorder=new MediaRecorder(t,a),this.blobChunk=new af,this.hookup()}hookup(){this.isHookup=!0,this.countedDuration=0,this.size=0,this.isRecording=!1,this.lastSliceCrash=!1,this.gotLastSlice=null,this.gotLastRemuxerSlice=null,this.mediaRecorder.ondataavailable=this.handleDataAvailable,this.mediaRecorder.onstop=this.handleAbort,this.mediaRecorder.onerror=this.handleError,this.stream.getVideoTracks().forEach(t=>t.addEventListener("ended",this.handleAbort)),this.blobChunk.setChunkHandler(t=>{try{this.ondataavailable&&this.ondataavailable(new BlobEvent("dataavailable",{data:t}))}catch{}})}unHook(){this.isHookup=!1,this.mediaRecorder.ondataavailable=null,this.mediaRecorder.onstop=null,this.mediaRecorder.onerror=null,this.stream&&this.stream.getVideoTracks().forEach(t=>t.removeEventListener("ended",this.handleAbort))}getMimeType(t,r){let i=[];typeof t=="string"&&i.push(t),r&&r.forEach(o=>i.push(o)),i.length===0&&i.push(""),t=i[0];let n=window.Module;if(!this.noWasmMuxer&&n?.inited){let o=i.findIndex(c=>MediaRecorder.isTypeSupported(c)),a=i.findIndex(c=>t0.test(c)),s=r0.find(c=>MediaRecorder.isTypeSupported(c));if(this.wasmMuxer=!0,this.muxerInit(),o!==-1){let c=i[o];return[c,c]}}return[t,t]}static isTypeSupported(t,r=!1){let i=window.Module;if(!r&&i?.inited){let n=t0.test(t),o=r0.find(a=>MediaRecorder.isTypeSupported(a));if(n&&o)return!0}return MediaRecorder.isTypeSupported(t)}muxerInit(){let t=this.noFragmentedMp4?0:1,r=window.Module;r._mp4_muxer_close(1),r._mp4_muxer_set_trans_mode(1,10),r._mp4_muxer_set_segment_duration(20),r._mp4_muxer_create(0,t,0,3),window.muxer_data_out=this.handleRemuxerDataAvailable}start(t){if(this.isHookup||this.hookup(),this.gotLastSlicePromise=null,this.mediaRecorder.state==="inactive"){t===void 0&&(t=this.timeSlice),this.mediaRecorder.start(t>0?t:void 0);let r=Date.now();return this.startTime=r,this.resumeTime=this.startTime,this.isRecording=!0,this.startTime}}pause(){if(this.mediaRecorder.state==="recording"){this.mediaRecorder.pause();let t=Date.now();return this.countedDuration=this.countedDuration+t-this.resumeTime,this.countedDuration}}resume(){if(this.mediaRecorder.state==="paused"){this.mediaRecorder.resume();let t=Date.now();return this.resumeTime=t,t}}stop(){let t=this.mediaRecorder.state,r=Date.now();t=="recording"&&(this.countedDuration+=r-this.resumeTime),(t=="recording"||t=="paused")&&(this.mediaRecorder.stop(),this.isRecording=!1,this.awaitDataAvailable(),this.stopTime=r)}cancel(){this.unHook();let t=this.mediaRecorder.state;if(["recording","paused"].includes(t)){this.isRecording=!1,this.mediaRecorder.stop();let i=Date.now();this.stopTime=i}let r=window.Module;this.wasmMuxer&&r&&r._mp4_muxer_close(1)}handleAbort(t){let r=this.countedDuration;this.isRecording===!0&&(this.awaitDataAvailable(),this.isRecording=!1,this.stopTime=Date.now(),r=this.countedDuration+this.stopTime-this.resumeTime);try{this.onAbort&&this.onAbort(r,t)}catch{}}awaitDataAvailable(){if(this.gotLastSlicePromise)return;let t=window.Module;if(this.gotLastSlicePromise=new Promise(r=>{this.setTimeout(()=>r(),1e3),this.gotLastSlice=r}),this.wasmMuxer){this.gotLastRemuxerSlicePromise=new Promise(r=>{this.setTimeout(()=>r(),1e4),this.gotLastRemuxerSlice=r}),this.gotLastSlicePromise.then(()=>{t._mp4_muxer_close(1),this.blobChunk.flush()}),this.gotLastRemuxerSlicePromise.then(()=>{this.onAllDataAvailable&&this.onAllDataAvailable()});return}else this.gotLastSlicePromise.then(()=>{this.blobChunk.flush(),this.onAllDataAvailable&&this.onAllDataAvailable()})}handleDataAvailable(t){this.size=this.size+t.data.size;try{this.onRawDataAvailable&&this.onRawDataAvailable(t)}catch{}if(this.gotLastSlice&&this.gotLastSlice(),this.safariTimeslicePatch){if(t.data.size===0){this.lastSliceCrash=!0;return}if(this.lastSliceCrash===!0){this.lastSliceCrash=!1;return}}if(this.blobChunk&&this.blobChunk.addBlob(t.data),this.wasmMuxer){let r=window.Module,i=new FileReader;i.readAsArrayBuffer(t.data),i.onload=()=>{let n=new Uint8Array(i.result),o=r._malloc(n.length);r.HEAPU8.set(n,o),r._mp4_muxer_put_media(o,n.length)<0&&r._free(o),this.gotLastRemuxerSlice&&this.setTimeout(()=>{r._mp4_muxer_close(1)},0)};return}}handleRemuxerDataAvailable(t){let{type:r,data:i,flag:n,duration:o}=t,a=new Blob([i]);try{let s=new BlobEvent("dataavailable",{data:a});this.onSpeechBlob&&this.onSpeechBlob(s)}catch{}n===1&&this.gotLastRemuxerSlice&&this.gotLastRemuxerSlice(),r=="time"}handleError(t){}get duration(){let t=this.mediaRecorder.state;return t=="paused"?this.countedDuration:t=="recording"?this.countedDuration+Date.now()-this.resumeTime:t=="inactive"&&this.countedDuration?this.countedDuration:0}get state(){return this.mediaRecorder?this.mediaRecorder.state:"inactive"}},af=class{chunkSize;buffer;currentSize;onChunkReady;constructor(t=pa){this.chunkSize=t,this.buffer=[],this.currentSize=0,this.onChunkReady=null}setChunkHandler(t){this.onChunkReady=t}addBlob(t){this.buffer.push(t),this.currentSize+=t.size,this.currentSize>=this.chunkSize&&this.processChunk()}processChunk(){if(this.buffer.length===0)return;let t=new Blob(this.buffer);return this.onChunkReady&&this.onChunkReady(t),this.buffer=[],this.currentSize=0,t}flush(){return this.buffer.length>0?this.processChunk():null}getStatus(){return{bufferCount:this.buffer.length,currentSize:this.currentSize,remainingSize:this.chunkSize-this.currentSize}}},i0=sf;var cf=400,bA=class{onDataAvailable;onRawDataAvailable;onAllDataAvailable;onSpeechBlob;recorder;foregroundProcessing;processingProgress;showStatus;countdownTime;recorderEvent;options;isAllDataAvailable;setTimeout;clearTimeout;cancelled;stopping=!1;constructor(t){this.countdownTime=[0,0],this.setTimeout=t.setTimeout||window.setTimeout,this.clearTimeout=t.clearTimeout||window.clearTimeout,this.setTimeout=this.setTimeout.bind(null),this.clearTimeout=this.clearTimeout.bind(null)}setOptions(t){this.options=t}ready(t){return this.options=t,this.isAllDataAvailable=!1,this.cancelled=!1,this.taskInit(),this.prepare(this.initialize.bind(this))}initialize(...t){this.recorder=new i0(...t),this.recorder.ondataavailable=this.handleDataAvailable.bind(this),this.recorder.onRawDataAvailable=this.handleRawDataAvailable.bind(this),this.recorder.onAbort=this.handleAbort.bind(this),this.recorder.onAllDataAvailable=this.handleAllDataAvailable.bind(this),this.recorder.onSpeechBlob=this.handleSpeechBlob.bind(this)}start(){try{this.recorder.start()}catch{return this.cancel()}return this.showStatus=3,this.recordingTimer(),this.recorderEvent=2,this.refreshStatus(),this.recorderEvent=0,this.recorder.startTime}pause(){return this.showStatus=4,this.recorderEvent=3,this.refreshStatus(),this.recorderEvent=0,this.recorder.countedDuration}async safePause(){return this.recorder.size===0&&await ha(cf,this.setTimeout),this.pause()}resume(){return this.showStatus=3,this.recordingTimer(),this.recorderEvent=4,this.refreshStatus(),this.recorderEvent=0,this.recorder.resumeTime}cancel(){this.cancelled||(this.cancelled=!0,this.showStatus=1,this.recorder?.cancel(),this.recorderEvent=6,this.refreshStatus(),this.recorderEvent=0,this.clear())}stop(){this.recorder.stop(),this.foregroundProcessing?this.showStatus=7:this.showStatus=1,this.recorderEvent=5,this.refreshStatus(),this.recorderEvent=0,this.clear()}async safeStop(){this.stopping||(this.stopping=!0,this.recorder.size===0&&await ha(cf,this.setTimeout),this.stop(),this.stopping=!1)}handleDataAvailable(t){try{this.onDataAvailable&&this.onDataAvailable(t)}catch{}}handleRawDataAvailable(t){try{this.onRawDataAvailable&&this.onRawDataAvailable(t)}catch{}}handleSpeechBlob(t){try{this.onSpeechBlob&&this.onSpeechBlob(t)}catch{}}handleAllDataAvailable(){try{this.onAllDataAvailable&&this.onAllDataAvailable()}catch{}}handleAbort(t,r){switch(this.showStatus===3&&Date.now()-this.recorder.startTime<cf&&(this.showStatus=6),this.showStatus){case 1:break;case 2:case 5:case 6:this.cancel(),this.recorderEvent=7,this.refreshStatus(),this.recorderEvent=0;break;case 3:case 4:this.stop(),this.recorderEvent=8,this.refreshStatus(),this.recorderEvent=0;break}}clear(){this.recorderEvent=0}};var Zo=class extends bA{countdownTimeoutId;recordingTimeoutId;simpleTaskPool;taskPool;constructor(t){super(t),this.simpleTaskPool={},this.taskPool={}}setTask(t){t.id&&t.generate&&(this.taskPool[t.id]=t),t.id&&t.action&&(this.simpleTaskPool[t.id]=t)}taskInit(){this.simpleTaskPool={};for(let t of Object.keys(this.taskPool)){let r=this.taskPool[t];r.init&&r.init(r)}}removeTask(t){delete this.simpleTaskPool[t],delete this.taskPool[t]}getTask(t){return this.simpleTaskPool[t]||null}checkTask(t){let r=Date.now();for(let i of Object.keys(this.taskPool)){let n=this.taskPool[i],o=n.generate(n,t);o&&o.id&&this.setTask(o)}for(let i of Object.keys(this.simpleTaskPool)){let n=this.simpleTaskPool[i];isFinite(n.timestamp)&&n.timestamp<=r&&this.executeSimpleTask(n),isFinite(n.duration)&&n.duration<=t&&this.executeSimpleTask(n)}}executeSimpleTask(t){switch(t.action){case"stop":this.stop();break;case"pause":this.pause();break}delete this.simpleTaskPool[t.id]}showTimer(t,r){}countdownTimer(t){let r=()=>{let i=t[1]-(Date.now()-t[0]);if(i>0&&this.showStatus===6){this.showTimer(Math.round(i/1e3)+"",0),this.countdownTimeoutId=this.setTimeout(r,i%1e3);return}this.showTimer("",0),this.setTimeout(()=>{this.start()},100)};r()}recordingTimer(){let t=this.recorder.countedDuration,r=this.recorder.resumeTime,i,n,o=()=>{this.showStatus===3&&(i=t+Date.now()-r,this.showTimer(_E(i),i),this.checkTask(i),n=i%1e3,n=Math.max(1e3-n,n),this.recordingTimeoutId=this.setTimeout(o,n))};o()}clear(){super.clear(),this.showTimer("",0),this.clearTimeout(this.countdownTimeoutId),this.clearTimeout(this.recordingTimeoutId),this.simpleTaskPool={}}};var SA=class extends Zo{onCatch;catch(t,r){if(t&&t.message==="Invalid state")return this.report("cancelShareScreen",t);if(t&&r==="getStreamFailed"&&this.report("cameraUnavailable",t),t&&t.message==="Permission denied by system")return this.report("startFailed",t),this.report("recordingPermissionDenied");if(t&&t.message==="Could not start video source")return this.report("startFailed",t),this.report("recordingPermissionDenied")}report(t,r){typeof this.onCatch=="function"&&this.onCatch.call(null,t,r)}};var xA=class extends SA{isCameraOn;cameraID;tabId;videoEl;assistCapturer;cameraStream;cameraCapturerId;removeLoadedDataListener;pictureInPictureKey;blankCameraVideo;pipAspectRatio;closePendingPictureInPicture;onToggleTabCamera;constructor(t){super(t),t&&(this.blankCameraVideo=t.blankCameraVideo,this.pipAspectRatio=t.pipCameraAspectRatio),this.handleLeavePictureInPicture=this.handleLeavePictureInPicture.bind(this),this.isCameraOn=!1}async turnCameraTo(t,r=""){t==="on"&&this.showCamera(r),t==="off"&&await this.closeCamera(),this.refreshStatus()}async showCamera(t){let r=t||this.options.camera.deviceId;switch(this.cameraID=r,this.options.recordType){case"tab":await this.tabShowCamera(r);break;case"desktop":await this.showCameraPictureInPicture(r);break;case"camera":break}this.isCameraOn=!0,this.refreshStatus()}closeCamera(){switch(this.options?.recordType){case"tab":return this.tabCloseCamera();case"desktop":return this.exitPictureInPicture();case"camera":}}syncTabCameraStatus(t,r,i){let n=r?r===this.tabId:!0;t!==this.isCameraOn&&n&&(this.isCameraOn=t),i&&(this.cameraID=i)}async showCameraPictureInPicture(t){let r="on-"+t;if(r===this.pictureInPictureKey)return;let i=Date.now();if(this.pictureInPictureKey=r,this.closePendingPictureInPicture=!1,document.pictureInPictureElement!==void 0)try{await this.videoPictureInPicture()||await this.newVideoPictureInPicture(t)}finally{this.closePendingPictureInPicture&&this.exitPictureInPicture()}}async videoPictureInPicture(t){let r=document.querySelector(t||"video.ours-picture-in-picture-video");return r?(await r.requestPictureInPicture().then(()=>{r.classList.add("picture-in-picture"),r.play().catch(console.error)},()=>{function i(){r.requestPictureInPicture(),r.classList.add("picture-in-picture"),r.play().catch(()=>{})}r.addEventListener("loadeddata",i),this.removeLoadedDataListener=()=>{r.removeEventListener("loadeddata",i)}}),r.addEventListener("leavepictureinpicture",this.handleLeavePictureInPicture),!0):!1}async newVideoPictureInPicture(t){t=t||this.options?.camera?.deviceId,this.assistCapturer&&this.assistCapturer.stopCapture(),this.assistCapturer=new pt;let r=Date.now();this.cameraCapturerId=r,this.videoEl||(this.videoEl=document.createElement("video"));let i,n=new Promise(o=>{i=o});if(this.videoEl.onloadedmetadata=()=>{this.videoEl.onloadedmetadata=null,this.videoEl.requestPictureInPicture().then(()=>{this.videoEl.onleavepictureinpicture=this.handleLeavePictureInPicture,i&&i(!0)}).catch(o=>{i&&i(!1)})},!(this.blankCameraVideo&&(this.videoEl.srcObject=null,this.videoEl.src=this.blankCameraVideo,this.videoEl.play(),!await n)))return await this.assistCapturer.getUserMedia({audio:!1,video:t?{deviceId:t}:!0}).then(o=>{r!==this.cameraCapturerId&&pt.stopStream(o),this.pipAspectRatio&&o.getVideoTracks().forEach(a=>{a.applyConstraints({aspectRatio:this.pipAspectRatio})}),this.cameraStream=o}).catch(o=>{this.catch(o,"getStreamFailed"),this.pictureInPictureKey=""}),this.videoEl.srcObject=this.cameraStream,this.videoEl.play(),n}async exitPictureInPicture(){this.closePendingPictureInPicture=!0,this.pictureInPictureKey="off",pt.stopStream(this.cameraStream),document.pictureInPictureElement?await document.exitPictureInPicture():this.isCameraOn&&(this.isCameraOn=!1),this.removeLoadedDataListener&&this.removeLoadedDataListener()}handleLeavePictureInPicture(t){this.pictureInPictureKey="off",pt.stopStream(this.cameraStream),t&&t.target.classList.remove("picture-in-picture"),this.isCameraOn=!1,![0,1].includes(this.showStatus)&&this.refreshStatus()}async tabShowCamera(t){let r=t||this.options.camera.deviceId;this.safeSendMessageToTab({action:11,cameraId:r},this.options.tabId),this.onToggleTabCamera&&this.onToggleTabCamera({tabId:this.options.tabId,visible:!0,deviceId:r})}tabCloseCamera(){this.safeSendMessageToTab({action:12},this.options.tabId);try{this.onToggleTabCamera&&this.onToggleTabCamera({tabId:this.options.tabId,visible:!1})}catch{}this.isCameraOn=!1,this.refreshStatus()}clear(){super.clear(),this.closeCamera(),this.isCameraOn=!1,this.assistCapturer&&this.assistCapturer.stopCapture(),this.assistCapturer=null}};var kA=class extends xA{capturer;recordStream;tabInfo;mediaSources;mimeTypes;timeSlice;safariTimeslicePatch;bitrateBase;prepareAbort;isMicOn;micID;onAddBeacon;onRemoveBeacon;beforeCaptureStream;afterCaptureStream;onPrepare;constructor(t){super(t),this.foregroundProcessing=t.foregroundProcessing,this.mediaSources=t.mediaSources||["screen","window","tab","audio"],this.mimeTypes=t.mimeTypes,this.timeSlice=t.timeSlice||1e3,this.safariTimeslicePatch=t.safariTimeslicePatch===!0,this.bitrateBase=t.bitrateBase||3.5*1024*1024,this.showStatus=1}reopenDesktopMediaPicker(){this.showStatus===2&&["desktop"].includes(this.options.recordType)&&this.capturer&&this.capturer.reopenDesktopMediaPicker()}async turnMicTo(t,r=""){let i=r||this.options.microphone?.deviceId;t==="on"?this.isMicOn=await this.capturer.turnOnMic(i).catch(n=>{throw n}):t==="off"?(this.isMicOn=!1,this.capturer.turnOffMic()):(this.isMicOn?this.capturer.turnOffMic():this.capturer.turnOnMic(i),this.isMicOn=!this.isMicOn),this.micID=i,this.refreshStatus()}async prepare(t){this.showStatus=2,this.refreshStatus(),this.tabId=this.options.tabId;let r=this.onPrepare?this.onPrepare(this.options):Promise.resolve(),i=this.prepareStream(this.options);this.options.camera?.open&&this.showCamera(),this.prepareAbort=!1;let n=!1;i.then(o=>{try{this.afterCaptureStream&&this.afterCaptureStream(o)}catch{}this.validateStream(o),this.recordStream=o,this.showStatus=5,this.refreshStatus()}).then(()=>r).then(()=>{let o=this.options.quality||{},a={...o.videoBitsPerSecond?{videoBitsPerSecond:o.videoBitsPerSecond}:{}};return a.videoBitsPerSecond?Promise.resolve(a):this.options.recordType=="audioOnly"||this.options.tabType=="tabVoiceOnly"?Promise.resolve({audioBitsPerSecond:128e3}):e0(this.recordStream,this.bitrateBase)}).then(o=>{let{processorType:a,stopTimerTask:s}=this.options;this.capturer.prepareAudioContext();let c=a=="storage"||a=="none";t(this.recordStream,{...o},{fallbackMimeTypes:this.mimeTypes,timeSlice:this.timeSlice,noWasmMuxer:null,safariTimeslicePatch:this.safariTimeslicePatch,noFragmentedMp4:c,setTimeout:this.setTimeout,clearTimeout:this.clearTimeout}),s&&this.setTask(s),this.showStatus=6,this.countdownTime=[Date.now(),this.options.countdown],this.countdownTimer(this.countdownTime),this.refreshStatus()}).catch(o=>{this.recordStream||this.afterCaptureStream&&this.afterCaptureStream(null),this.prepareAbort=!0,n=!0,this.showStatus=1,this.refreshStatus(),this.resetPrepared(),this.cancel(),this.catch(o)}),this.recorderEvent=1,this.refreshStatus(),this.recorderEvent=0}async prepareStream(t){if(t.stream)return t.stream;this.beforeCaptureStream&&this.beforeCaptureStream(t);let r=this.options.microphone?.deviceId,i={...$D(this.options.quality.equivalent=="4k"?"2k":this.options.quality.equivalent||"1080p"),...this.options.quality},n=new pt({setTimeout:this.setTimeout,clearTimeout:this.clearTimeout});this.capturer=n,this.isMicOn=!1;let o=[];switch(t.recordType){case"desktop":pt.isCaptureDesktopSupported()?o.push(this.capturer.captureDesktop({streamId:t.streamId,sources:this.mediaSources,timeout:1e3*60*1,constraints:{audio:!0,video:{mandatory:{maxWidth:i.maxWidth,maxHeight:i.maxHeight,maxFrameRate:i.maxFrameRate}}}})):o.push(this.capturer.getDisplayMedia({audio:!0,video:{width:{max:i.maxWidth},height:{max:i.maxHeight},frameRate:i.maxFrameRate}},this.options.hackTab,this.options.tabType));break;case"tab":o.push(this.capturer.captureTab({targetTabId:this.options.tabId,streamId:this.options.streamId,captureOptions:{audio:this.options.tabAudio!==!1,video:!0,videoConstraints:{mandatory:this.options.crop?{maxWidth:this.options.crop.ww,maxHeight:this.options.crop.wh}:{maxWidth:i.maxWidth,maxHeight:i.maxHeight}}}}));break;case"camera":o.push(this.capturer.getUserMedia({video:{deviceId:this.options.camera?.deviceId},audio:!1}));break;case"audioOnly":o.push(this.capturer.getBlankStream());break}if(this.options.crop&&(await Promise.all(o),await this.capturer.cropVideoTrack(this.options.crop)),this.options?.microphone?.open){this.isMicOn=!0,this.micID=r,await Promise.all(o);let a=this.capturer.turnOnMic(r).then(s=>{s||(this.isMicOn=!1)}).catch(s=>{this.isMicOn=!1});o.push(a)}return await Promise.all(o),this.prepareAbort&&n.stopCapture(),n.stream}validateStream(t){let r=!0;if(t||(r=!1),t.active||(r=!1),!r)throw Error("Capturer: invalid stream.")}resetPrepared(){this.capturer&&this.capturer.stopCapture(),pt.stopStream(this.recordStream),this.closeCamera()}async getTabInfo(t){return{title:document.title,url:window.location.href}}async safeSendMessageToTab(t,r){}clear(){super.clear(),this.tabId=null,this.tabInfo=null,this.capturer&&this.capturer.stopCapture(),pt.stopStream(this.recordStream),this.recordStream=null,this.capturer=null}};var kn=class extends kA{constructor(t){super(t)}refreshStatus(){}getStatusData(){}};var Dn=class extends kn{backupStrategy;autoGenerateThumbnail;processorConfig;tab;processorType;backupType;title;userId;videoId;processKey;backupKey;isStorageAlert;isEmptyData;isEmptyFmp4Data;sliceIndex=1;singleLine;processorMap;processor;backup;onStatusChange;onStart;onStop;onCancel;onAbort;onClear;onStopDone;onException;constructor(t){super(t),this.backupStrategy=t.backupStrategy,this.autoGenerateThumbnail=t.autoGenerateThumbnail!==!1,this.isStorageAlert=!1,this.isEmptyData=!0,this.isEmptyFmp4Data=!0,this.sliceIndex=1,this.onPrepare=this.prepareCompat.bind(this),this.singleLine=zt.getInstance({setTimeout:this.setTimeout,clearTimeout:this.clearTimeout}),this.processorMap=new Map}async prepareCompat(){if(await this.beforePrepareProcessor(),this.prepareAbort)throw Error("prepareAborted");this.backupKey=await this.prepareBackup()??0,this.processKey=await this.prepareProcessor(),this.backup&&this.backup.update({processKey:this.processKey,originId:this.videoId,options:this.options}),this.singleLine?.register(this.processKey),await this.afterPrepareProcessor()}updateStorageAlert(t){this.isStorageAlert=t}async beforePrepareProcessor(){let{tabId:t,processorType:r,title:i,recordType:n}=this.options;switch(this.videoId="",this.processorType=r||"upload",this.backupType="none",this.backupStrategy){case"upload":this.backupType=this.processorType==="upload"?"output":"none";break;case"auto":this.backupType=this.processorType==="upload"?"output":"original";break;case"original":case"output":this.backupType=this.backupStrategy;break;default:break}this.title=this.generateTitle(n,i),typeof t=="number"&&isFinite(t)&&(this.tab=await this.getTabInfo(t));let o=await this.getProcessorConfig(this.processorType);this.processorConfig=o,"token"in o&&(Ct.meta.token=o.token,o.userId&&(this.userId=o.userId))}async prepareBackup(){let t=this.backupType;switch(t){case"original":case"output":this.backup=new ct;break;case"none":default:this.backup=null;break}return this.backup?(await this.backup.create({title:this.title,owner:this.userId,mimeType:t==="output"?"video/mp4":"video/webm"})).key:void 0}async prepareProcessor(){let t=this.processorType,{payload:r}=this.options;switch(t){case"download":this.processor=new ri;break;case"storage":this.processor=new no({autoGenerateThumbnail:this.autoGenerateThumbnail});break;case"upload":this.processor=new en(this.processorConfig);break;case"none":this.processor=new io(this.processorConfig);break;default:throw Error("RecorderCompat processorType not supported!")}this.processor.onConnected=this.handleProcessorConnected.bind(this),this.processor.onProgress=this.handleProcessorProgress.bind(this),this.processor.onSuccess=this.handleProcessorSuccess.bind(this),this.processor.onError=this.handleProcessorError.bind(this),this.processor.onSliceUploaded=this.handleSliceUploaded.bind(this);let i=await this.processor.ready({title:this.title,payload:r});return this.sliceIndex=1,i}async afterPrepareProcessor(){let t=this.processKey;this.processorMap.set(t,{key:t,type:this.processorType,vid:this.videoId,processor:this.processor,backup:this.backup,title:this.title,size:0,duration:0,progress:0})}generateTitle(t,r){let i=new Date,n=`${i.toLocaleDateString().replace(/\//g,"-")}_${i.toLocaleTimeString("en-US",{hour12:!1}).slice(0,-3)}`;switch(t){case"desktop":return n+(this.options.hackTab?"-Tab":"-Desktop");case"camera":return n+"-Camera";case"tab":return"Tab-"+n;case"audioOnly":return n+"-Audio";default:return"Record-"+n}}parseToken(t){try{return{id:JSON.parse(atob(t.split(".")[1])).user_id+""}}catch{return{id:""}}}handleDataAvailable(t){if(!this.cancelled){if(t.data&&t.data.size>0&&this.isEmptyFmp4Data&&(this.isEmptyFmp4Data=!1),this.processor.push(t.data,this.sliceIndex++),this.backup&&this.backupType==="output"&&!this.backup.push(t.data,{duration:this.recorder.duration}).then(()=>{},()=>{this.onException&&this.onException("saveFailed","save blob failed")})){let i="save indexDB before";(!t.data||!t.data.size)&&(i="empty blob"),this.onException&&this.onException("saveFailed",i)}super.handleDataAvailable(t)}}handleRawDataAvailable(t){this.cancelled||(t.data&&t.data.size>0&&this.isEmptyData&&(this.isEmptyData=!1),(!t.data||!t.data.size)&&this.onException&&this.onException("emptyBlob","empty original blob"),this.backup&&this.backupType==="original"&&this.backup.push(t.data,{duration:this.recorder.duration}),super.handleRawDataAvailable(t))}handleProcessorConnected(t,r){if(t===this.processKey&&(this.videoId=r.vid),this.processorMap.has(t)){let i=this.processorMap.get(t);if(!i)return;this.processorMap.set(t,{...i,vid:r.vid}),i.backup&&i.backup.update({originId:r.vid,s3UploadId:r.s3UploadId,processStatus:"uploading",sid:r.sid,...r?.backupDetails&&r.backupDetails})}}handleProcessorProgress(t,r,i){if(this.processingProgress=[i.finished,i.current,i.total],this.processorMap.has(t)){let n=this.processorMap.get(t);if(!n||!n.backup)return}this.isAllDataAvailable||(this.processingProgress=[i.finished,i.current,i.total+3]),this.showStatus===7&&this.refreshStatus()}handleProcessorError(t,r){if(t==this.processKey){if(r.type==="quotaExceeded"&&(this.report("quotaExceeded"),this.cancel()),r.type=="initError")return;switch(this.showStatus){case 2:case 5:case 6:this.prepareAbort=!0,this.cancel();break;case 3:case 4:this.stop();break}}r&&r.type==="networkError"&&t&&this.singleLine?.unregister(t)}handleProcessorSuccess(t){if(t==this.processKey&&(this.showStatus===7&&(this.showStatus=1),this.recorderEvent=10,this.refreshStatus(),this.recorderEvent=0,this.foregroundProcessing&&this.complete()),this.processorMap.has(t)){let{backup:r}=this.processorMap.get(t);r?.remove(),this.processorMap.delete(t)}this.singleLine?.unregister(t)}async handleSliceUploaded(t,r){if(this.processorMap.has(t)){let{backup:i}=this.processorMap.get(t);i&&(await i.updateSlice(r,{uploaded:!0}),this.isStorageAlert&&await i.deleteSlice(this.backupKey,r))}}async handleAllDataAvailable(){let{duration:t,size:r}=this.recorder;await this.backup?.close(t),this.onStopDone&&this.onStopDone({key:this.processKey,title:this.title,duration:this.recorder.duration,size:this.recorder.size,processorType:this.processorType})}getUploader(){return this.processor}start(){this.processor.start(this.recorder.mimeType),super.start();try{this.onStart&&this.onStart({options:this.options,key:this.processKey,title:this.title,processorType:this.processorType})}catch{}}pause(){return this.recorder.pause(),this.processor.pause(),super.pause()}resume(){return this.recorder.resume(),this.processor.resume(),super.resume()}cancel(){let t=Promise.all([this.processor?.cancel(),this.backup?.remove()]);this.backup=null,this.processKey&&this.processorMap.set(this.processKey,{...this.processorMap.get(this.processKey),backup:null}),this.singleLine?.unregister(this.processKey),super.cancel();try{this.onCancel&&this.onCancel({key:this.processKey,title:this.title,processorType:this.processorType,donePromise:t})}catch{}}stop(){super.stop();try{this.onStop&&this.onStop({key:this.processKey,title:this.title,duration:this.recorder.duration,size:this.recorder.size,processorType:this.processorType})}catch{}this.foregroundProcessing||this.complete()}abnormalExit(){this.recorder&&this.recorder.size?(this.backup&&this.backup.close(),this.processor.stop({keepalive:!0,mark:!0})):(this.processor.cancel(!0),this.backup&&this.backup.remove())}complete(){}clear(){super.clear();try{this.onClear&&this.onClear()}catch{}}getStatusData(){return this.recorder?{recordType:this.options.recordType,showStatus:this.showStatus,resumeTime:this.recorder.resumeTime,countedDuration:this.recorder.countedDuration,size:this.recorder.size,countdownTime:this.countdownTime,recorderEvent:this.recorderEvent,isCameraOn:this.isCameraOn,videoTitle:this.title,processingProgress:this.processingProgress,isMicOn:this.isMicOn,videoId:this.videoId,micID:this.micID,cameraID:this.cameraID,processorRunning:this.processor.processing,tabId:this.tabId}:{recordType:this.options?.recordType,showStatus:this.showStatus,resumeTime:0,countedDuration:0,size:0,countdownTime:this.countdownTime,recorderEvent:this.recorderEvent,isCameraOn:this.isCameraOn,videoTitle:this.title,processingProgress:this.processingProgress,isMicOn:this.isMicOn,videoId:this.videoId,micID:this.micID,cameraID:this.cameraID,processorRunning:!1,tabId:this.tabId}}refreshStatus(){let t=this.getStatusData();this.onStatusChange&&this.onStatusChange(t)}};var $o=class extends Dn{libraryFileId;noteId;noteContent;noteTitle;isconnected;isStarted;isCancel;isStop;initError;speechIndex=1;lang;app_name;app_version;haveOpen=!1;recognitionMap=new Map;pendingRecognitionTasks=new Set;allAudioDataSent=!1;transcriptSaved=!1;getValueCallback;moreAfterAction;recognitionResult;updateTimerContent;constructor(t){super(t)}getProcessorConfig(t){let{payload:r}=this.options,i=this.getValueCallback&&this.getValueCallback();this.lang=i.language,this.app_name=i.app_name,this.app_version=i.app_version;let n={apiBase:i.serverAPI,token:i.token,meta_query:i.meta_query,tabTitle:r?.tabTitle,userId:i.userId,maxQueueBlobSlice:200};return Promise.resolve(n)}showTimer(t,r){this.updateTimerContent&&this.updateTimerContent(t,r)}async prepareProcessor(){let t=this.processorType,{payload:r}=this.options;switch(t){case"download":this.processor=new ri;break;case"storage":this.processor=new no({autoGenerateThumbnail:this.autoGenerateThumbnail});break;case"upload":this.processor=new Wt(this.processorConfig);break;case"none":break;default:throw Error("RecorderCompat processorType not supported!")}this.processor.onConnected=this.handleProcessorConnected.bind(this),this.processor.onError=this.handleProcessorError.bind(this),this.processor.onProgress=this.handleProcessorProgress.bind(this),this.processor.onSuccess=this.handleProcessorSuccess.bind(this),this.processor.onSliceUploaded=this.handleSliceUploaded.bind(this),this.processor.onTranscriptStatus=this.handleTranscriptStatus.bind(this);let i=await this.processor.ready({title:this.title,payload:r,mime:this.options.recordType==="audioOnly"||this.options.tabType=="tabVoiceOnly"?wi.fileType:zr.fileType});return gt("pendingRecordItem"),this.recognitionResult&&this.recognitionResult(""),i}handleStart(){this.isStarted=!0,this.isconnected&&this.processKey&&this.getLibraryFileId()}async updatePendingItem(t){if(t.status==="success")this.haveOpen||(this.haveOpen=!0,OD({fileId:t.libraryFileId,noteId:t.noteId})),o0.default.runtime.sendMessage({type:"CLOSE_SIDEPANEL"}),gt("pendingRecordItem");else{let r=await pe("pendingRecordItem");r?.createAt?t.createAt=r.createAt:t.createAt=Date.now(),await H({pendingRecordItem:t})}}getLibraryFileId(){let{recordType:t}=this.options,r=this.processKey;this.processor.saveFileToInbox&&!this.libraryFileId&&this.processor.saveFileToInbox(t==="audioOnly"||this.options.tabType=="tabVoiceOnly"?wi.fileType:zr.fileType).then(async i=>{if(i&&i.libraryFileId)if(this.libraryFileId=i.libraryFileId,this.processorMap.has(r)&&!this.isCancel){let n=this.processorMap.get(r);if(!n)return;n&&n.backup&&await n?.backup.update({libraryFileId:this.libraryFileId})}else this.isCancel&&this.libraryFileId&&this.processor.disCardFileFromInbox&&this.processor.disCardFileFromInbox(this.libraryFileId)})}handleProcessorConnected(t,r){let{recordType:i}=this.options;super.handleProcessorConnected(t,r),this.isconnected=!0,this.isStarted&&this.processKey&&this.getLibraryFileId(),this.isCancel&&this.processor.cancel()}async handleProcessorError(t,r){if(super.handleProcessorError(t,r),this.processorMap.has(t)&&r.type!=="quotaExceeded"){let i=this.processorMap.get(t);r.type=="initError"&&(this.initError=!0),i&&(await i.backup?.update({processStatus:"failed"}),r.type==="completeFailed"&&i.backup?.update({completeFailed:"failed"}))}this.moreAfterAction&&this.moreAfterAction()}handleProcessorProgress(t,r,i){super.handleProcessorProgress(t,r,i),this.libraryFileId||this.getLibraryFileId(),i&&i.mark&&this.libraryFileId&&i.finished>=0&&this.processor.updateUploadProgress&&this.processor.updateUploadProgress(this.libraryFileId,i.finished,i.total)}async handleProcessorSuccess(t,r){if(t==this.processKey&&(this.showStatus===7&&(this.showStatus=1),this.recorderEvent=10,this.refreshStatus(),this.recorderEvent=0,this.foregroundProcessing&&this.complete()),this.processorMap.has(t)){let i=this.processorMap.get(t);i&&(r?await i.backup?.update({processStatus:"completed",progress:1,originId:r.vid}):await i.backup?.update({processStatus:"completed",progress:1})),this.checkFinish(t)}this.singleLine?.unregister(t)}async handleTranscriptStatus(t,r){if(this.processorMap.has(t)){let i=this.processorMap.get(t);i&&(r?await i.backup?.update({transcriptStatus:"completed"}):await i.backup?.update({transcriptStatus:"failed"}),this.checkFinish(t))}}async checkFinish(t){if(this.processorMap.has(t)){let r=this.processorMap.get(t);if(r?.backup){let i=r?.backup.getCurrentDetail();i.noteStatus&&i.noteStatus==="completed"&&i.transcriptStatus&&i.transcriptStatus==="completed"?(await pe("pendingRecordItem"))?.key==i.key&&this.updatePendingItem({status:"success",key:i.key,noteId:this.noteId,libraryFileId:this.libraryFileId}):(i.noteStatus&&i.noteStatus==="failed"||i.transcriptStatus&&i.transcriptStatus==="failed"||this.initError)&&this.isStop&&(await pe("pendingRecordItem"))?.key==i.key&&this.updatePendingItem({status:"failed",key:i.key,noteId:this.noteId,libraryFileId:this.libraryFileId}),i.processStatus==="completed"&&i.noteStatus&&i.noteStatus==="completed"&&i.transcriptStatus&&i.transcriptStatus==="completed"?(this.setTimeout(()=>{r.backup?.remove()},400),this.processorMap.delete(t)):(i.processStatus==="failed"||i.processStatus=="completed")&&i.noteStatus!=="waiting"&&i.transcriptStatus==="failed"&&this.processorMap.delete(t)}}}async handleAllDataAvailable(){super.handleAllDataAvailable(),this.isStop=!0,this.allAudioDataSent=!0,this.moreAfterAction&&this.moreAfterAction();try{await this.saveNoteOnline()}catch{}this.checkAndProcessFinalTranscript()}checkAndProcessFinalTranscript(){this.allAudioDataSent&&this.pendingRecognitionTasks.size===0&&!this.transcriptSaved&&this.processFinalTranscript()}async processFinalTranscript(){if(this.transcriptSaved)return;let t=this.processKey;if(!this.processorMap.has(t)||this.isCancel)return;let r=this.processorMap.get(t);if(!r?.backup)return;this.transcriptSaved=!0;let i=n0(this.recognitionMap);await r.backup.update({transcript:i,transcriptStatus:"waiting"}),this.processor.push(i,-1,"transcript"),this.processor?.stop({mark:!0})}async saveNoteOnline(){let t=this.processKey;if(this.processorMap.has(t)&&!this.isCancel){let r=this.processorMap.get(t);if(!r)return;r.backup&&this.libraryFileId?(await this.processor.saveNoteToInbox?.(r.backup.getCurrentDetail(),this.libraryFileId).then(({id:i})=>{this.noteId=i,this.isCancel&&this.processor.discardNoteFrom&&this.processor.discardNoteFrom(i),r.backup?.update({noteStatus:"completed",noteId:this.noteId})}).catch(async i=>{await r.backup?.update({noteStatus:"failed"})}),this.checkFinish(t)):(await r.backup?.update({noteStatus:"failed"}),this.checkFinish(t))}}async handleRecognitionText(t){let r=this.processKey,i=n0(this.recognitionMap);if(this.recognitionResult&&!this.isStop&&this.recognitionResult(i),this.processorMap.has(r)&&this.recognitionMap.get(t)!==void 0&&!this.isCancel){let n=this.processorMap.get(r);if(!n?.backup)return;await n.backup.update({transcript:i,transcriptStatus:"waiting"}),this.isStop&&this.checkAndProcessFinalTranscript()}}async handelNoteText({noteText:t,noteTitle:r,noteFiles:i,noteJson:n}){let o=this.processKey;if(t!==void 0&&(this.noteContent=t),r!==void 0&&(this.noteTitle=r),this.processorMap.has(o)&&!this.isCancel){let a=this.processorMap.get(o);if(!a)return;if(a.backup){let s=a.backup.getCurrentDetail()||{};await a.backup.update({noteStatus:"waiting",...t!==void 0&&{noteText:t},...r!==void 0&&{noteTitle:r},...n!==void 0&&{noteJson:n},...i!==void 0&&{noteFiles:{...s.noteFiles,...i}}})}}}async getRecordingDetail(){let t=this.processKey,r=this.processorMap.get(t);if(r&&r.backup)return typeof this.backupKey!="number"?null:r.backup.getDetail(this.backupKey)}handleSpeechBlob(t){if(super.handleSpeechBlob(t),t.data.size>0){let r=this.speechIndex++;this.pendingRecognitionTasks.add(r),this.processor.getSpeechRecognitionResult&&this.processor.getSpeechRecognitionResult(t.data,r,this.lang?this.lang:"zh-Hans",this.app_version,this.app_name).then(i=>{if(i){let n=i.text;n.length>5&&!n.endsWith(`
`)?this.recognitionMap.set(i.index,n+`
`):this.recognitionMap.set(i.index,n)}else this.recognitionMap.set(r,"");this.pendingRecognitionTasks.delete(r),this.handleRecognitionText(r)}).catch(i=>{this.recognitionMap.set(r,""),this.pendingRecognitionTasks.delete(r),this.handleRecognitionText(r)})}}stop(){if(this.processorMap.has(this.processKey)){let t=this.processorMap.get(this.processKey);if(t?.backup){let r=t?.backup.getCurrentDetail();this.updatePendingItem({status:"uploading",key:r.key,createAt:Date.now()})}}super.stop()}cancel(){super.cancel(),this.isCancel=!0,this.libraryFileId&&this.processor.disCardFileFromInbox&&this.processor.disCardFileFromInbox(this.libraryFileId),this.noteId&&this.processor.discardNoteFrom&&this.processor.discardNoteFrom(this.noteId),gt("pendingRecordItem")}set getValue(t){this.getValueCallback=t}set moreAction(t){this.moreAfterAction=t}};function n0(e){return[...e.entries()].sort((t,r)=>t[0]-r[0]).map(([t,r])=>r).join("")}var zr={videoCodec:"webm",fileType:"video/webm",mimeType:"video/webm;codecs=vp8"},t_e={videoCodec:"fmp4",fileType:"video/mp4",mimeType:"video/mp4;codecs=h264"},wi={videoCodec:"mp4",fileType:"audio/webm",mimeType:"audio/webm;codecs=opus"},L4=7200*1e3,K4=300*60*1e3,s0=1024*1024*1024,q,DA,a0=0,es="desktop",ht={status:"ready",showText:"",recordMs:0,isCameraOn:!1,isMicOn:!1,isTabSound:!1,recordedTabId:-1,isRecordVoiceTab:!1,isShowToolbar:!1,recognitionText:""},df=!1,gf=!1,Af=null,J4=!1,z4={};EE(Me.default.runtime.onMessage,j4);md("offscreen-fetch-blob",async({data:e})=>{let r=await(await fetch(e)).blob();return URL.createObjectURL(r)});DA=new yA;DA.startPeriodicCheck(30*1e3);DA.addListener(V4);vn();Me.default.runtime.connect({name:"record-page"});if(typeof window<"u"&&!document.querySelector('script[src="./mp4_muxer.js"]')){let t=document.createElement("script");t.src="./mp4_muxer.js",window.Module={inited:!1,onRuntimeInitialized:function(){window.Module.inited=!0}},document.head.appendChild(t)}function V4(e,t,r){Me.default.runtime.sendMessage({type:"UPDATE_NETWORK_STATUS",status:t}),t&&A0()}async function vn(){let e=await Me.default.runtime.sendMessage({type:"GET_API_INFO"}),t=await VD(df,e.userId);Me.default.runtime.sendMessage({type:"SAVE_RECORD_LIST",list:e.token?t:[]})}async function Y4(){await YD(),vn()}async function A0(){Iz();let e=Date.now();if(e-a0>1*1e3&&DA?.isNetworkAvailable){a0=e;let t=await Me.default.runtime.sendMessage({type:"GET_API_INFO"});t.token&&LD(t,vn)}}async function l0(e){let t=new ct;if(t){let r=await t.getDetail(e),i=await Me.default.runtime.sendMessage({type:"GET_API_INFO"});if(r&&r.originId&&i.token&&i.serverAPI){let n=new Wt({apiBase:i.serverAPI,token:i.token,meta_query:i.meta_query});n.ready({title:r.title,id:r.originId,s3UploadId:r.s3UploadId});try{n.discard(),r.libraryFileId&&n.disCardFileFromInbox(r.libraryFileId),r.noteId&&n.discardNoteFrom(r.noteId)}catch{}}await t.remove(e),vn()}}async function W4(e){Af||(Af=new Us);let t=await Af.getAllDevices({requestPermission:!1}),r=t.videoInputDevices,i=t.audioInputDevices;if(!Number.isNaN(parseInt(e))){let n=parseInt(e),o={};n%3==0&&(o.microphones=i),n%2==0&&(o.cameras=r),Me.default.runtime.sendMessage({type:"UPDATE_DEVICES",data:o})}}function j4(e,t,r){let i=hd(e,t);if(i)return i;if(e.target==="offscreen")switch(e.type){case"START_RECORDING/BG":return Az(e.payload,e.token,e.serverAPI,e.meta_query,e.app_name,e.app_version,e.language,e.userId);case"record/stop":ht.status!="recording"&&ht.status!="paused"?lf(!0):lf(e.isDiscard),r();break;case"record/pause":sz();break;case"record/resume":az(),r();break;case"record/discard":lf(!0);break;case"record/toggleMic":ez(e.data);break;case"record/changeMic":tz(e.deviceId);break;case"record/toggleCam":rz(e.data);break;case"record/changeCamera":iz(e.deviceId);break;case"record/toggleCtlBar":nz();break;case"record/toggleTabSound":oz();break;case"close-camera":return;case"update-record-list":vn();break;case"remove-complete-record":Y4();break;case"retryUploading":Z4(e.key);break;case"record/delete":l0(e.key);break;case"reloadRecorder":$4();break;case"getDevices":W4(e.data);break;case"getRecordStatus":r(ht);break;case"saveNoteLocal":q?.handelNoteText(e.data);break;case"getNoteLocal":if(q)return q.getRecordingDetail().then(r),!0;if(e.backupKey!=null){let n=X4(e.backupKey);return n?n.then(o=>{r(o)}):r(null),!0}break;case"updateAlertNoTranscript":Mt({haveAlertedNoTranscript:!0});break}}function X4(e){let t=new ct;return t?t.getDetail(e):null}Me.default.runtime.sendMessage({type:"UPDATE_RECORD_STATUS",data:ht});function Mt(e){ht={...ht,...e},Me.default.runtime.sendMessage({type:"UPDATE_RECORD_STATUS",data:ht})}async function Z4(e){let t=await Me.default.runtime.sendMessage({type:"GET_API_INFO"});t.token&&ef(e,t,"",vn)}function $4(){q&&q.cancel(),setTimeout(()=>{location.reload()},400)}function ez(e){q&&(ht.isMicOn?q.turnMicTo("off"):q.turnMicTo("on",e??ht.micID??"default").catch(t=>{d0("micError",t)}))}function tz(e){q&&q.turnMicTo("on",e??"default")}function rz(e){q&&(ht.isCameraOn?q.turnCameraTo("off"):q.turnCameraTo("on",e??ht.cameraID??"default"))}function iz(e){q&&e&&q.turnCameraTo("on",e)}function nz(){Mt({isShowToolbar:!ht.isShowToolbar})}function oz(){Mt({isTabSound:!ht.isTabSound})}function sz(){q&&q.pause()}function az(){q&&q.resume()}function lf(e){q?e?q.cancel():q.safeStop():e&&cz()}async function cz(){let e=await pe("pendingRecordItem");e?.key&&e.status&&(await l0(e?.key),gt("pendingRecordItem"))}function Az(e,t,r,i,n,o,a,s){let c=e.recordType?e.recordType:e.microphoneIsEnabled?"audioOnly":"desktop";q||(q=fz(c=="audioOnly")),z4={},Mt({recordType:c,isMicOn:e.microphoneIsEnabled,micID:e.micDeviceId,haveAlertedNoTranscript:!1,recognitionText:"",isTabSound:e.recordTabSound,recordedTabId:e.recordedTabId>=0&&e.streamId?e.recordedTabId:-1,isShowToolbar:e.showCtlBar}),gf=!1,J4=!1,q.getValue=()=>({meta_query:i,token:t,serverAPI:r,userId:s,app_name:n,language:SE(a||"en"),app_version:o}),q.moreAction=()=>{A0()},q.updateTimerContent=(l,d)=>{Mt({showText:l,recordMs:d})},q.recognitionResult=l=>{Mt({recognitionText:l})},q.onStart=()=>{q?.handleStart()},q.onCatch=(l,d)=>{d0(l,d)},q&&(q.onStatusChange=lz);let A=!1;c=="desktop"&&(A=!0),c=="tab"&&!e.streamId&&(c="desktop",A=!0),es=c,q.ready({recordType:c,hackTab:A,microphone:{deviceId:e.micDeviceId,open:!!e.microphoneIsEnabled},camera:{deviceId:e.camDeviceId,open:!1},quality:{equivalent:e.resolution=="4k"?"4k":e.resolution},countdown:c=="audioOnly"?0:parseInt(e.countdown)*1e3,tabAudio:e.recordTabSound,title:e.recordingTabTitle,tabType:e.tabType,processorType:"upload",streamId:e.streamId,payload:{videoCodec:zr.videoCodec,tabUrl:e.recordingTabUrl,tabTitle:e.recordingTabTitle,appAndPlatform:"Sider extension",recordType:e.recordType,recorderVersion:e.recorderVersion,appVersion:navigator.userAgent,screenSize:e.screenWidth+"*"+e.screenHeight}}),q.onStop=l=>{hz(l,c)}}function lz(e){let t=e.showStatus;if(t==1)Mt({status:"ready"}),df=!1,e.recorderEvent==5?setTimeout(()=>{c0()},100):(e.recorderEvent==6||e.recorderEvent==7)&&c0();else if(t==2)Mt({status:"waitingAuthorized"});else if(t==3){let r={status:"recording",isCameraOn:e.isCameraOn,isMicOn:e.isMicOn};e.isCameraOn&&(r.cameraID=e.cameraID),e.isMicOn&&(r.micID=e.micID),Mt(r),df=!0}else if(t==4){let r={status:"paused",isCameraOn:e.isCameraOn,isMicOn:e.isMicOn};e.isCameraOn&&(r.cameraID=e.cameraID),e.isMicOn&&(r.micID=e.micID),Mt(r)}else t==5||t==6&&(Mt({status:"countDown"}),uz())}function dz(e){let t=es=="audioOnly"?K4:L4;e>=t&&q&&(q?.pause(),Me.default.runtime.sendMessage({type:"RECORD_ALERT",data:{type:"timeLimit",number:es=="audioOnly"?5:2}})),gz()}function gz(){let e=es==="audioOnly"?s0*.5:s0*1;navigator.storage.estimate().then(t=>{if(t.quota!=null&&t.usage!=null){let r=t.quota-t.usage;!Number.isNaN(r)&&r<e&&!gf&&!navigator.brave&&(gf=!0,q&&(q?.pause(),Me.default.runtime.sendMessage({type:"RECORD_ALERT",data:{type:"storageLimit",number:es=="audioOnly"?5:2}})))}})}function uz(){let e={id:"norm-task",init:()=>{},generate:(t,r)=>(dz(r),!1),payload:{}};q?.setTask(e)}function c0(){q=void 0}function d0(e,t){e=="cancelShareScreen"||e=="startFailed"||(e=="cameraUnavailable"?Me.default.runtime.sendMessage({type:"cameraUnavailable",data:{name:t?.name,message:t?.message}}):e=="micError"&&Me.default.runtime.sendMessage({type:"micUnavailable",data:{name:t?.name,message:t?.message}}))}function fz(e){return new $o({backupStrategy:"upload",mimeTypes:e?[wi.mimeType]:[zr.mimeType],timeSlice:500,pipCameraAspectRatio:1.78,foregroundProcessing:!1,mediaSources:["screen","window","audio"]})}async function Iz(){let e=await WD();Me.default.runtime.sendMessage({type:"UPDATE_UNFINISHED_STATUS",status:e.length>0})}function pz(e){if(!e)return"";let t=Math.floor(e/6e4),r=Math.floor(e/1e3);return t>=1?`${t}min`:`${r}s`}function hz(e,t){let r=pz(e.duration);Me.default.runtime.sendMessage({type:"REPORT_DATA",data:{type:t=="audioOnly"?"finish_audio_record":"finish_video_record",data:{duration:r}}})}})();
