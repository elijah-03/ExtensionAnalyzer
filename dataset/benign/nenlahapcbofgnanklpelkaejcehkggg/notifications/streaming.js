import{b as p}from"../chunks/chunk-N2ICXIKO.js";import"../chunks/chunk-JDXM4SX2.js";import{h as m,o as s}from"../chunks/chunk-4XUWKJYA.js";import{l as o,s as _}from"../chunks/chunk-QWQLNDJC.js";import{c as u}from"../chunks/chunk-AYDLOBCW.js";import{a as i,c as y}from"../chunks/chunk-JENJKWHP.js";import"../chunks/chunk-53OM6ECF.js";import"../chunks/chunk-PDIOZR2P.js";import"../chunks/chunk-BTBTC4NL.js";import{e as d}from"../chunks/chunk-3GYLW4KZ.js";_();var r=d(u());y();function S(a){return(r.default.get(r.default.cloneDeep(a),"pageData.tag")||[]).includes("streaming_sports")}function g(a){switch(a){case"today":return o(new Date,"yyyyMMdd");case"tomorrow":return o(new Date(Date.now()+24*60*60*1e3),"yyyyMMdd");default:return o(new Date(`${a} ${new Date().getFullYear()}`),"yyyyMMdd")}}function D(a){let t=a.split(","),e=r.default.nth(t,0);return e==="today"||e==="tomorrow"?g(e):g(r.default.nth(t,1))?.trim()}function v(a,t){if(a==="today"||a==="tomorrow")return t;let e=t?.split(",")||a.split(",");return r.default.nth(e,1)?.trim()}function h(a){return r.default.nth(a.split("vs"),1)?.trim()}function E(a){let t={},e=r.default.get(r.default.cloneDeep(a),"pageData.meta")||{},n=r.default.first(e?.et_event_name.split("vs"))?.trim();return t={name:JSON.stringify({[n]:h(e?.et_event_name)}),platforms:JSON.stringify({[n]:f(e?.where_to_watch)}),league:JSON.stringify({[n]:e?.sports_division}),sport_date:JSON.stringify(D(e?.et_date)),sport_time:JSON.stringify({[n]:v(e?.et_date,e?.et_start_time)})},t}function O(a){let t=r.default.get(r.default.cloneDeep(a),"pageData.streaming")||{},e=r.default.get(r.default.cloneDeep(a),"pageData.meta")||{};return i("before validation ",t),t&&(t.platforms=JSON.stringify(t?.platforms||""),t.name=JSON.stringify(t?.title||""),t.league=JSON.stringify(t?.genre||""),t.sport_time=JSON.stringify(e?.sport_time||""),t.sport_date=e?.sport_date||"",delete t.field,delete t.genre,delete t.title),i("after validation ",t),t}function f(a){return r.default.uniq(a.split(",").map(t=>t?.trim()).filter(t=>t))}function w(a){return a.pageType==="searchPage"&&a.pageData?.tag?.includes("streaming_sports")?E(a):O(a)}function N(a){let t=r.default.get(r.default.cloneDeep(a),"pageData.streaming")||{};return i("before validation ",t),t&&(t.platforms=t.platforms?f(t.platforms):[],t.cast=t.cast?t.cast.splice(0,10):[],t.genre=t.genre?t.genre.splice(0,3):[],t.partner_title_urls=t.partner_title_urls?t.partner_title_urls:[],delete t.field),i("after validation ",t),t}function c(){let a=m.get("deweyResult")||{};if(S(a)){let e=w(a);if(e&&!r.default.isEmpty(e.name)&&!r.default.isEmpty(e.platforms)&&!r.default.isEmpty(e.league)&&!r.default.isEmpty(e.sport_date)&&!r.default.isEmpty(e.sport_time)){let n={name:e.name,league:e.league,platforms:e.platforms,sport_date:e.sport_date,sport_time:e.sport_time};s("track","streamingSportsEvents",n)}}else{let e=N(a);if(e&&e.platforms.length>0){let n={...e,name:e.title,year:e.premier_year,on_demand_platforms:e.platforms,streaming_partner_title_urls:e.partner_title_urls};i("before track ",n),s("track","streamingCanonical",n)}}}function J(){p.emitter.on("result",a=>{a.pageType==="searchPage"&&a.pageData?.tag?.includes("streaming_sports")&&c()})}async function l(){c(),J()}document.readyState!=="loading"?l():document.addEventListener("DOMContentLoaded",l);export{N as getValidStreamingData};
