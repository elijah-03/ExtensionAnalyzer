/**
* @license FireShot - Webpage Screenshots and Annotations
* Copyright (C) 2007-2025 Evgeny Vokilsus (contacts@getfireshot.com)
*/

!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="32bc46e8-cbce-5f5e-b063-04fffe1f1859")}catch(e){}}();
(()=>{function Rr(){return new Proxy({},{get:(e,t)=>(...i)=>{let o=null;return typeof i[i.length-1]=="function"&&(o=i.pop()),new Promise(s=>{chrome.runtime.sendMessage({message:"callExtensionMethodMsg",method:t,params:i,async:o!==null},c=>{chrome.runtime.lastError,o&&typeof c<"u"&&o(c),s(c)})})}})}function Z(e,t){return ut.getOption(e,t)}function ie(e,t){ut.setOption(e,t+"")}var ut={storage:{},onChanged:{listeners:[],addListener(e){this.listeners.indexOf(e)===-1&&this.listeners.push(e)},removeListener(e){this.listeners=this.listeners.filter(t=>t!==e)},notifyListeners(e){this.listeners.forEach(t=>{try{t(e)}catch{}})}},initPromise:null,inited:!1,onInit:null,assignOptions:function(e){this.storage={...this.storage,...e},chrome.storage.local.set(e)},ensureLoaded:function(){return this.initPromise=this.initPromise||new Promise(e=>{chrome.storage.onChanged.addListener((i,o)=>{if(o==="local"){let s=Object.keys(i);for(let c of s)this.storage[c]=i[c].newValue;this.inited&&this.onChanged.notifyListeners(i)}});let t=i=>{this.inited=!0,i&&(this.storage=i),this.onInit?this.onInit().then(()=>this.onInit=null).finally(e):e()};chrome.storage.local.get(null,i=>{chrome.runtime.lastError&&console.error(chrome.runtime.lastError),i?t(i):(console.log("chrome.storage.local.get failed to obtain preferences"),setTimeout(()=>chrome.storage.local.get(null,s=>{!s&&console.log("chrome.storage.local.get failed to obtain preferences for the second time"),t(s)}),500))})}),this.initPromise},setOption:function(e,t){if(!this.inited)console.error(`Preferences were not initialized yet! (setOption(${e}))`);else{var i={};i[e]=t,chrome.storage.local.set(i),this.storage[e]=t}},getOption:function(e,t){if(!this.inited)console.error(`Preferences were not initialized yet! (getOption(${e}))`);else return typeof this.storage[e]>"u"?t:this.storage[e]}};var R={H:0,I:1,Se:2,Ee:3,Ie:4,ke:5,xe:7,ut:8,p:10,Te:11,N:12,lt:13,ft:100,dt:101,W:0,V:1,z:2,Ce:3,k:4,G:268435456,Y:8192,q:"lastAction",J:"lastMode",Pe:"enableAPI",X:"fsDebug",Ae:"errorReporting",De:"notifyOnUpdates",ht:!1,Re:"disableWASMWorker",pt:"allTabsCaptureOnlyVisiblePart",t:"pluginProMode",i:"registeredMode",mt:"curVersion",gt:"curVersion1",b:"filenameTemplate",m:"filenameNumber",T:"filenameNumberPadCheck",C:"filenameNumberPadValue",P:"filenameMaxLen",Oe:"contextMenuIntegration",yt:"pageScrollSpeedValue",vt:"allowInfiniteScrolling",bt:"sendUsageDataToGA",Fe:"newTabIsNextToSource",wt:"screenshotDelay",Me:"defaultFolderLite",Ne:"FireShot",Q:"openFolderAfterSavingLite",Z:"noFilenamePrompt",ee:"closeTabAfterSavingLite",_t:"batchModePrefs",St:"historyRetainPeriod",Et:"notifyOnUpdates",It:"captureTimeLimit",$e:"nativeFetchErrorCntr-",kt:"uCheck",xt:"uEmit",Tt:"https://ssl.getfireshot.com/images/api/utm.gif?dummy:",te:"canBeCapturedBetterNextShow",ne:"errorFilter",Be:"https://ssl.getfireshot.com/sentry-filter-%VERSION%.csv",re:"onlyLite",Ct:"nativeInstall",A:"userLikedFireShot",ie:"userRatedFireShot",B:"resultPageShown",Pt:"WASMErrorReported",oe:"nextAdShownTime",g:"guid",At:1296e6,Dt:2592e5,Rt:432e5,Ot:1e4,Le:"png",Ue:"queuedBadgeURL.1",Ft:"showSelectionHint.1",Mt:"advancedFeaturesAvailable",Nt:"showAdvertising",se:"betaPreviewWarningExpanded",ae:"betaPreviewCompactMode",ce:"PDFOptionsEverDisplayed",ue:"regUserCorrected",le:"regKeyCorrected",D:"regUser",o:"regKey",$t:"taskProgressValue",Bt:"https://ssl.getfireshot.com/images/api/chromefeatures.gif?dummy:",fe:"FireShot Capture %n - %t - [%e]",Lt:"https://getfireshot.com/downloads/%VERSION%/fireshot-chrome-plugin.exe",je:"https://screenshot-program.com/fireshot/crash_report.php",R:"captureState",_:"nativeHostReady",Ke:"resumeMenuEnabled",Ut:"disableSelectionImprovements",u:"t",S:"te",He:"checksum",We:1,de:0,jt:1,Kt:2,Ht:4,Wt:8,Vt:16};var Kn=(function(e){let t=Object.prototype.toString;function i(n){switch(t.call(n)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return E(n,Error)}}function o(n,r){return t.call(n)===`[object ${r}]`}function s(n){return o(n,"ErrorEvent")}function c(n){return o(n,"DOMError")}function l(n){return o(n,"DOMException")}function d(n){return o(n,"String")}function h(n){return typeof n=="object"&&n!==null&&"__sentry_template_string__"in n&&"__sentry_template_values__"in n}function m(n){return n===null||h(n)||typeof n!="object"&&typeof n!="function"}function g(n){return o(n,"Object")}function y(n){return typeof Event<"u"&&E(n,Event)}function w(n){return typeof Element<"u"&&E(n,Element)}function k(n){return o(n,"RegExp")}function b(n){return!!(n&&n.then&&typeof n.then=="function")}function _(n){return g(n)&&"nativeEvent"in n&&"preventDefault"in n&&"stopPropagation"in n}function E(n,r){try{return n instanceof r}catch{return!1}}function I(n){return!!(typeof n=="object"&&n!==null&&(n.__isVue||n._isVue))}function C(n,r=0){return typeof n!="string"||r===0||n.length<=r?n:`${n.slice(0,r)}...`}function P(n,r){if(!Array.isArray(n))return"";let a=[];for(let u=0;u<n.length;u++){let f=n[u];try{I(f)?a.push("[VueViewModel]"):a.push(String(f))}catch{a.push("[value cannot be serialized]")}}return a.join(r)}function A(n,r,a=!1){return d(n)?k(r)?r.test(n):d(r)?a?n===r:n.includes(r):!1:!1}function T(n,r=[],a=!1){return r.some(u=>A(n,u,a))}function N(n,r,a=250,u,f,p,v){if(!p.exception||!p.exception.values||!v||!E(v.originalException,Error))return;let S=p.exception.values.length>0?p.exception.values[p.exception.values.length-1]:void 0;S&&(p.exception.values=ee(K(n,r,f,v.originalException,u,p.exception.values,S,0),a))}function K(n,r,a,u,f,p,v,S){if(p.length>=a+1)return p;let D=[...p];if(E(u[f],Error)){M(v,S);let F=n(r,u[f]),G=D.length;q(F,f,G,S),D=K(n,r,a,u[f],f,[F,...D],F,G)}return Array.isArray(u.errors)&&u.errors.forEach((F,G)=>{if(E(F,Error)){M(v,S);let z=n(r,F),fe=D.length;q(z,`errors[${G}]`,fe,S),D=K(n,r,a,F,f,[z,...D],z,fe)}}),D}function M(n,r){n.mechanism=n.mechanism||{type:"generic",handled:!0},n.mechanism={...n.mechanism,...n.type==="AggregateError"&&{is_exception_group:!0},exception_id:r}}function q(n,r,a,u){n.mechanism=n.mechanism||{type:"generic",handled:!0},n.mechanism={...n.mechanism,type:"chained",source:r,exception_id:a,parent_id:u}}function ee(n,r){return n.map(a=>(a.value&&(a.value=C(a.value,r)),a))}let j="8.18.0",L=globalThis;function Y(n,r,a){let u=a||L,f=u.v=u.v||{},p=f[j]=f[j]||{};return p[n]||(p[n]=r())}let ne=L,J=80;function me(n,r={}){if(!n)return"<unknown>";try{let a=n,u=5,f=[],p=0,v=0,S=" > ",D=S.length,F,G=Array.isArray(r)?r:r.keyAttrs,z=!Array.isArray(r)&&r.maxStringLength||J;for(;a&&p++<u&&(F=Se(a,G),!(F==="html"||p>1&&v+f.length*D+F.length>=z));)f.push(F),v+=F.length,a=a.parentNode;return f.reverse().join(S)}catch{return"<unknown>"}}function Se(n,r){let a=n,u=[];if(!a||!a.tagName)return"";if(ne.HTMLElement&&a instanceof HTMLElement&&a.dataset){if(a.dataset.sentryComponent)return a.dataset.sentryComponent;if(a.dataset.sentryElement)return a.dataset.sentryElement}u.push(a.tagName.toLowerCase());let f=r&&r.length?r.filter(v=>a.getAttribute(v)).map(v=>[v,a.getAttribute(v)]):null;if(f&&f.length)f.forEach(v=>{u.push(`[${v[0]}="${v[1]}"]`)});else{a.id&&u.push(`#${a.id}`);let v=a.className;if(v&&d(v)){let S=v.split(/\s+/);for(let D of S)u.push(`.${D}`)}}let p=["aria-label","type","name","title","alt"];for(let v of p){let S=a.getAttribute(v);S&&u.push(`[${v}="${S}"]`)}return u.join("")}function Ue(){try{return ne.document.location.href}catch{return""}}function ke(n){if(!ne.HTMLElement)return null;let r=n,a=5;for(let u=0;u<a;u++){if(!r)return null;if(r instanceof HTMLElement){if(r.dataset.sentryComponent)return r.dataset.sentryComponent;if(r.dataset.sentryElement)return r.dataset.sentryElement}r=r.parentNode}return null}let Ce="Sentry Logger ",Ge=["debug","info","warn","error","log","assert","trace"],Ee={};function Oe(n){if(!("console"in L))return n();let r=L.console,a={},u=Object.keys(Ee);u.forEach(f=>{let p=Ee[f];a[f]=r[f],r[f]=p});try{return n()}finally{u.forEach(f=>{r[f]=a[f]})}}function B(){let n=!1,r={enable:()=>{n=!0},disable:()=>{n=!1},isEnabled:()=>n};return Ge.forEach(a=>{r[a]=(...u)=>{n&&Oe(()=>{L.console[a](`${Ce}[${a}]:`,...u)})}}),r}let O=B(),re=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function de(n){return n==="http"||n==="https"}function se(n,r=!1){let{host:a,path:u,pass:f,port:p,projectId:v,protocol:S,publicKey:D}=n;return`${S}://${D}${r&&f?`:${f}`:""}@${a}${p?`:${p}`:""}/${u&&`${u}/`}${v}`}function H(n){let r=re.exec(n);if(!r){Oe(()=>{console.error(`Invalid Sentry Dsn: ${n}`)});return}let[a,u,f="",p="",v="",S=""]=r.slice(1),D="",F=S,G=F.split("/");if(G.length>1&&(D=G.slice(0,-1).join("/"),F=G.pop()),F){let z=F.match(/^\d+/);z&&(F=z[0])}return U({host:p,pass:f,path:D,projectId:F,port:v,protocol:a,publicKey:u})}function U(n){return{protocol:n.protocol,publicKey:n.publicKey||"",pass:n.pass||"",host:n.host,port:n.port||"",path:n.path||"",projectId:n.projectId}}function ae(n){let{port:r,projectId:a,protocol:u}=n;return["protocol","publicKey","host","projectId"].find(v=>n[v]?!1:(O.error(`Invalid Sentry Dsn: ${v} missing`),!0))?!1:a.match(/^\d+$/)?de(u)?r&&isNaN(parseInt(r,10))?(O.error(`Invalid Sentry Dsn: Invalid port ${r}`),!1):!0:(O.error(`Invalid Sentry Dsn: Invalid protocol ${u}`),!1):(O.error(`Invalid Sentry Dsn: Invalid projectId ${a}`),!1)}function ve(n){let r=typeof n=="string"?H(n):U(n);if(!(!r||!ae(r)))return r}class he extends Error{constructor(r,a="warn"){super(r),this.message=r,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype),this.logLevel=a}}function le(n,r,a){if(!(r in n))return;let u=n[r],f=a(u);typeof f=="function"&&It(f,u),n[r]=f}function Pe(n,r,a){try{Object.defineProperty(n,r,{value:a,writable:!0,configurable:!0})}catch{O.log(`Failed to add non-enumerable property "${r}" to object`,n)}}function It(n,r){try{let a=r.prototype||{};n.prototype=r.prototype=a,Pe(n,"__sentry_original__",r)}catch{}}function pt(n){return n.zt}function Kt(n){return Object.keys(n).map(r=>`${encodeURIComponent(r)}=${encodeURIComponent(n[r])}`).join("&")}function hr(n){if(i(n))return{message:n.message,name:n.name,stack:n.stack,...Ht(n)};if(y(n)){let r={type:n.type,target:je(n.target),currentTarget:je(n.currentTarget),...Ht(n)};return typeof CustomEvent<"u"&&E(n,CustomEvent)&&(r.detail=n.detail),r}else return n}function je(n){try{return w(n)?me(n):Object.prototype.toString.call(n)}catch{return"<unknown>"}}function Ht(n){if(typeof n=="object"&&n!==null){let r={};for(let a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a]);return r}else return{}}function _i(n,r=40){let a=Object.keys(hr(n));a.sort();let u=a[0];if(!u)return"[object has no keys]";if(u.length>=r)return C(u,r);for(let f=a.length;f>0;f--){let p=a.slice(0,f).join(", ");if(!(p.length>r))return f===a.length?p:C(p,r)}return""}function Fe(n){return at(n,new Map)}function at(n,r){if(pr(n)){let a=r.get(n);if(a!==void 0)return a;let u={};r.set(n,u);for(let f of Object.keys(n))typeof n[f]<"u"&&(u[f]=at(n[f],r));return u}if(Array.isArray(n)){let a=r.get(n);if(a!==void 0)return a;let u=[];return r.set(n,u),n.forEach(f=>{u.push(at(f,r))}),u}return n}function pr(n){if(!g(n))return!1;try{let r=Object.getPrototypeOf(n).constructor.name;return!r||r==="Object"}catch{return!0}}let kt=50,Ye="?",mr=/\(error: (.*)\)/,ns=/captureMessage|captureException/;function rs(...n){let r=n.sort((a,u)=>a[0]-u[0]).map(a=>a[1]);return(a,u=0,f=0)=>{let p=[],v=a.split(`
`);for(let S=u;S<v.length;S++){let D=v[S];if(D.length>1024)continue;let F=mr.test(D)?D.replace(mr,"$1"):D;if(!F.match(/\S*Error: /)){for(let G of r){let z=G(F);if(z){p.push(z);break}}if(p.length>=kt+f)break}}return cu(p.slice(f))}}function au(n){return Array.isArray(n)?rs(...n):n}function cu(n){if(!n.length)return[];let r=Array.from(n);return/sentryWrapped/.test(gr(r).function||"")&&r.pop(),r.reverse(),ns.test(gr(r).function||"")&&(r.pop(),ns.test(gr(r).function||"")&&r.pop()),r.slice(0,kt).map(a=>({...a,filename:a.filename||gr(r).filename,function:a.function||Ye}))}function gr(n){return n[n.length-1]||{}}let Si="<anonymous>";function xt(n){try{return!n||typeof n!="function"?Si:n.name||Si}catch{return Si}}function is(n){let r=n.exception;if(r){let a=[];try{return r.values.forEach(u=>{u.stacktrace.frames&&a.push(...u.stacktrace.frames)}),a}catch{return}}}let yr={},os={};function Wt(n,r){yr[n]=yr[n]||[],yr[n].push(r)}function Vt(n,r){os[n]||(r(),os[n]=!0)}function ct(n,r){let a=n&&yr[n];if(a)for(let u of a)try{u(r)}catch(f){O.error(`Error while triggering instrumentation handler.
Type: ${n}
Name: ${xt(u)}
Error:`,f)}}function uu(n){let r="console";Wt(r,n),Vt(r,lu)}function lu(){"console"in L&&Ge.forEach(function(n){n in L.console&&le(L.console,n,function(r){return Ee[n]=r,function(...a){ct("console",{args:a,level:n});let f=Ee[n];f&&f.apply(L.console,a)}})})}let Ei=L;function ss(){if(!("fetch"in Ei))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}}function Ii(n){return n&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(n.toString())}function fu(){if(typeof EdgeRuntime=="string")return!0;if(!ss())return!1;if(Ii(Ei.fetch))return!0;let n=!1,r=Ei.document;if(r&&typeof r.createElement=="function")try{let a=r.createElement("iframe");a.hidden=!0,r.head.appendChild(a),a.contentWindow&&a.contentWindow.fetch&&(n=Ii(a.contentWindow.fetch)),r.head.removeChild(a)}catch(a){O.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",a)}return n}let as=1e3;function On(){return Date.now()/as}function du(){let{performance:n}=L;if(!n||!n.now)return On;let r=Date.now()-n.now(),a=n.timeOrigin==null?r:n.timeOrigin;return()=>(a+n.now())/as}let mt=du();(()=>{let{performance:n}=L;if(!n||!n.now)return;let r=3600*1e3,a=n.now(),u=Date.now(),f=n.timeOrigin?Math.abs(n.timeOrigin+a-u):r,p=f<r,v=n.timing&&n.timing.navigationStart,D=typeof v=="number"?Math.abs(v+a-u):r,F=D<r;return p||F?f<=D?n.timeOrigin:v:u})();function hu(n){let r="fetch";Wt(r,n),Vt(r,pu)}function pu(){fu()&&le(L,"fetch",function(n){return function(...r){let{method:a,url:u}=mu(r),f={args:r,fetchData:{method:a,url:u},startTimestamp:mt()*1e3};ct("fetch",{...f});let p=new Error().stack;return n.apply(L,r).then(v=>{let S={...f,endTimestamp:mt()*1e3,response:v};return ct("fetch",S),v},v=>{let S={...f,endTimestamp:mt()*1e3,error:v};throw ct("fetch",S),i(v)&&v.stack===void 0&&(v.stack=p,Pe(v,"framesToPop",1)),v})}})}function ki(n,r){return!!n&&typeof n=="object"&&!!n[r]}function cs(n){return typeof n=="string"?n:n?ki(n,"url")?n.url:n.toString?n.toString():"":""}function mu(n){if(n.length===0)return{method:"GET",url:""};if(n.length===2){let[a,u]=n;return{url:cs(a),method:ki(u,"method")?String(u.method).toUpperCase():"GET"}}let r=n[0];return{url:cs(r),method:ki(r,"method")?String(r.method).toUpperCase():"GET"}}let vr=null;function gu(n){let r="error";Wt(r,n),Vt(r,yu)}function yu(){vr=L.onerror,L.onerror=function(n,r,a,u,f){return ct("error",{column:u,error:f,line:a,msg:n,url:r}),vr&&!vr.Ve?vr.apply(this,arguments):!1},L.onerror.ze=!0}let br=null;function vu(n){let r="unhandledrejection";Wt(r,n),Vt(r,bu)}function bu(){br=L.onunhandledrejection,L.onunhandledrejection=function(n){return ct("unhandledrejection",n),br&&!br.Ve?br.apply(this,arguments):!0},L.onunhandledrejection.ze=!0}function wu(){return"npm"}function _u(){let n=typeof WeakSet=="function",r=n?new WeakSet:[];function a(f){if(n)return r.has(f)?!0:(r.add(f),!1);for(let p=0;p<r.length;p++)if(r[p]===f)return!0;return r.push(f),!1}function u(f){if(n)r.delete(f);else for(let p=0;p<r.length;p++)if(r[p]===f){r.splice(p,1);break}}return[a,u]}function xe(){let n=L,r=n.crypto||n.msCrypto,a=()=>Math.random()*16;try{if(r&&r.randomUUID)return r.randomUUID().replace(/-/g,"");r&&r.getRandomValues&&(a=()=>{let u=new Uint8Array(1);return r.getRandomValues(u),u[0]})}catch{}return("10000000100040008000"+1e11).replace(/[018]/g,u=>(u^(a()&15)>>u/4).toString(16))}function us(n){return n.exception&&n.exception.values?n.exception.values[0]:void 0}function Tt(n){let{message:r,event_id:a}=n;if(r)return r;let u=us(n);return u?u.type&&u.value?`${u.type}: ${u.value}`:u.type||u.value||a||"<unknown>":a||"<unknown>"}function xi(n,r,a){let u=n.exception=n.exception||{},f=u.values=u.values||[],p=f[0]=f[0]||{};p.value||(p.value=r||""),p.type||(p.type=a||"Error")}function Fn(n,r){let a=us(n);if(!a)return;let u={type:"generic",handled:!0},f=a.mechanism;if(a.mechanism={...u,...f,...r},r&&"data"in r){let p={...f&&f.data,...r.data};a.mechanism.data=p}}function ls(n){if(n&&n.Gt)return!0;try{Pe(n,"__sentry_captured__",!0)}catch{}return!1}function fs(n){return Array.isArray(n)?n:[n]}function Ct(n,r=100,a=1/0){try{return Ti("",n,r,a)}catch(u){return{ERROR:`**non-serializable** (${u})`}}}function ds(n,r=3,a=102400){let u=Ct(n,r);return ku(u)>a?ds(n,r-1,a):u}function Ti(n,r,a=1/0,u=1/0,f=_u()){let[p,v]=f;if(r==null||["number","boolean","string"].includes(typeof r)&&!Number.isNaN(r))return r;let S=Su(n,r);if(!S.startsWith("[object "))return S;if(r.__sentry_skip_normalization__)return r;let D=typeof r.__sentry_override_normalization_depth__=="number"?r.__sentry_override_normalization_depth__:a;if(D===0)return S.replace("object ","");if(p(r))return"[Circular ~]";let F=r;if(F&&typeof F.toJSON=="function")try{let ge=F.toJSON();return Ti("",ge,D-1,u,f)}catch{}let G=Array.isArray(r)?[]:{},z=0,fe=hr(r);for(let ge in fe){if(!Object.prototype.hasOwnProperty.call(fe,ge))continue;if(z>=u){G[ge]="[MaxProperties ~]";break}let pe=fe[ge];G[ge]=Ti(ge,pe,D-1,u,f),z++}return v(r),G}function Su(n,r){try{if(n==="domain"&&r&&typeof r=="object"&&r._events)return"[Domain]";if(n==="domainEmitter")return"[DomainEmitter]";if(typeof global<"u"&&r===global)return"[Global]";if(typeof window<"u"&&r===window)return"[Window]";if(typeof document<"u"&&r===document)return"[Document]";if(I(r))return"[VueViewModel]";if(_(r))return"[SyntheticEvent]";if(typeof r=="number"&&r!==r)return"[NaN]";if(typeof r=="function")return`[Function: ${xt(r)}]`;if(typeof r=="symbol")return`[${String(r)}]`;if(typeof r=="bigint")return`[BigInt: ${String(r)}]`;let a=Eu(r);return/^HTML(\w*)Element$/.test(a)?`[HTMLElement: ${a}]`:`[object ${a}]`}catch(a){return`**non-serializable** (${a})`}}function Eu(n){let r=Object.getPrototypeOf(n);return r?r.constructor.name:"null prototype"}function Iu(n){return~-encodeURI(n).split(/%..|./).length}function ku(n){return Iu(JSON.stringify(n))}var gt;(function(n){n[n.PENDING=0]="PENDING";let a=1;n[n.RESOLVED=a]="RESOLVED";let u=2;n[n.REJECTED=u]="REJECTED"})(gt||(gt={}));function zt(n){return new it(r=>{r(n)})}function wr(n){return new it((r,a)=>{a(n)})}class it{constructor(r){it.prototype.__init.call(this),it.prototype.__init2.call(this),it.prototype.__init3.call(this),it.prototype.__init4.call(this),this._state=gt.PENDING,this._handlers=[];try{r(this._resolve,this._reject)}catch(a){this._reject(a)}}then(r,a){return new it((u,f)=>{this._handlers.push([!1,p=>{if(!r)u(p);else try{u(r(p))}catch(v){f(v)}},p=>{if(!a)f(p);else try{u(a(p))}catch(v){f(v)}}]),this._executeHandlers()})}catch(r){return this.then(a=>a,r)}finally(r){return new it((a,u)=>{let f,p;return this.then(v=>{p=!1,f=v,r&&r()},v=>{p=!0,f=v,r&&r()}).then(()=>{if(p){u(f);return}a(f)})})}__init(){this._resolve=r=>{this._setResult(gt.RESOLVED,r)}}__init2(){this._reject=r=>{this._setResult(gt.REJECTED,r)}}__init3(){this._setResult=(r,a)=>{if(this._state===gt.PENDING){if(b(a)){a.then(this._resolve,this._reject);return}this._state=r,this._value=a,this._executeHandlers()}}}__init4(){this._executeHandlers=()=>{if(this._state===gt.PENDING)return;let r=this._handlers.slice();this._handlers=[],r.forEach(a=>{a[0]||(this._state===gt.RESOLVED&&a[1](this._value),this._state===gt.REJECTED&&a[2](this._value),a[0]=!0)})}}}function xu(n){let r=[];function a(){return n===void 0||r.length<n}function u(v){return r.splice(r.indexOf(v),1)[0]||Promise.resolve(void 0)}function f(v){if(!a())return wr(new he("Not adding Promise because buffer limit was reached."));let S=v();return r.indexOf(S)===-1&&r.push(S),S.then(()=>u(S)).then(null,()=>u(S).then(null,()=>{})),S}function p(v){return new it((S,D)=>{let F=r.length;if(!F)return S(!0);let G=setTimeout(()=>{v&&v>0&&S(!1)},v);r.forEach(z=>{zt(z).then(()=>{--F||(clearTimeout(G),S(!0))},D)})})}return{$:r,add:f,drain:p}}function Ci(n){if(!n)return{};let r=n.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!r)return{};let a=r[6]||"",u=r[8]||"";return{host:r[4],path:r[5],protocol:r[2],search:a,hash:u,relative:r[5]+a+u}}let Tu=["fatal","error","warning","log","info","debug"];function Cu(n){return n==="warn"?"warning":Tu.includes(n)?n:"log"}let hs="sentry-",Pu=/^sentry-/,Au=8192;function ps(n){let r=Ru(n);if(!r)return;let a=Object.entries(r).reduce((u,[f,p])=>{if(f.match(Pu)){let v=f.slice(hs.length);u[v]=p}return u},{});if(Object.keys(a).length>0)return a}function Du(n){if(!n)return;let r=Object.entries(n).reduce((a,[u,f])=>(f&&(a[`${hs}${u}`]=f),a),{});return Ou(r)}function Ru(n){if(!(!n||!d(n)&&!Array.isArray(n)))return Array.isArray(n)?n.reduce((r,a)=>{let u=ms(a);return Object.entries(u).forEach(([f,p])=>{r[f]=p}),r},{}):ms(n)}function ms(n){return n.split(",").map(r=>r.split("=").map(a=>decodeURIComponent(a.trim()))).reduce((r,[a,u])=>(a&&u&&(r[a]=u),r),{})}function Ou(n){if(Object.keys(n).length!==0)return Object.entries(n).reduce((r,[a,u],f)=>{let p=`${encodeURIComponent(a)}=${encodeURIComponent(u)}`,v=f===0?p:`${r},${p}`;return v.length>Au?(O.warn(`Not adding key: ${a} with val: ${u} to baggage header due to exceeding baggage size limits.`),r):v},"")}let Fu=new RegExp("^[ \\t]*([0-9a-f]{32})?-?([0-9a-f]{16})?-?([01])?[ \\t]*$");function Mu(n){if(!n)return;let r=n.match(Fu);if(!r)return;let a;return r[3]==="1"?a=!0:r[3]==="0"&&(a=!1),{traceId:r[1],parentSampled:a,parentSpanId:r[2]}}function Nu(n,r){let a=Mu(n),u=ps(r),{traceId:f,parentSpanId:p,parentSampled:v}=a||{};return a?{traceId:f||xe(),parentSpanId:p||xe().substring(16),spanId:xe().substring(16),sampled:v,dsc:u||{}}:{traceId:f||xe(),spanId:xe().substring(16)}}function $u(n=xe(),r=xe().substring(16),a){let u="";return a!==void 0&&(u=a?"-1":"-0"),`${n}-${r}${u}`}function Mn(n,r=[]){return[n,r]}function Bu(n,r){let[a,u]=n;return[a,[...u,r]]}function gs(n,r){let a=n[1];for(let u of a){let f=u[0].type;if(r(u,f))return!0}return!1}function Pi(n){return L.v&&L.v.encodePolyfill?L.v.encodePolyfill(n):new TextEncoder().encode(n)}function Lu(n){let[r,a]=n,u=JSON.stringify(r);function f(p){typeof u=="string"?u=typeof p=="string"?u+p:[Pi(u),p]:u.push(typeof p=="string"?Pi(p):p)}for(let p of a){let[v,S]=p;if(f(`
${JSON.stringify(v)}
`),typeof S=="string"||S instanceof Uint8Array)f(S);else{let D;try{D=JSON.stringify(S)}catch{D=JSON.stringify(Ct(S))}f(D)}}return typeof u=="string"?u:Uu(u)}function Uu(n){let r=n.reduce((f,p)=>f+p.length,0),a=new Uint8Array(r),u=0;for(let f of n)a.set(f,u),u+=f.length;return a}function ju(n){let r=typeof n.data=="string"?Pi(n.data):n.data;return[Fe({type:"attachment",length:r.length,filename:n.filename,content_type:n.contentType,attachment_type:n.attachmentType}),r]}let Ku={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",statsd:"metric_bucket"};function ys(n){return Ku[n]}function vs(n){if(!n||!n.sdk)return;let{name:r,version:a}=n.sdk;return{name:r,version:a}}function Hu(n,r,a,u){let f=n.sdkProcessingMetadata&&n.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:n.event_id,sent_at:new Date().toISOString(),...r&&{sdk:r},...!!a&&u&&{dsn:se(u)},...f&&{trace:Fe({...f})}}}function Wu(n,r,a){let u=[{type:"client_report"},{timestamp:a||On(),discarded_events:n}];return Mn(r?{dsn:r}:{},[u])}let Vu=60*1e3;function zu(n,r=Date.now()){let a=parseInt(`${n}`,10);if(!isNaN(a))return a*1e3;let u=Date.parse(`${n}`);return isNaN(u)?Vu:u-r}function Gu(n,r){return n[r]||n.all||0}function Yu(n,r,a=Date.now()){return Gu(n,r)>a}function qu(n,{statusCode:r,headers:a},u=Date.now()){let f={...n},p=a&&a["x-sentry-rate-limits"],v=a&&a["retry-after"];if(p)for(let S of p.trim().split(",")){let[D,F,,,G]=S.split(":",5),z=parseInt(D,10),fe=(isNaN(z)?60:z)*1e3;if(!F)f.all=u+fe;else for(let ge of F.split(";"))ge==="metric_bucket"?(!G||G.split(";").includes("custom"))&&(f[ge]=u+fe):f[ge]=u+fe}else v?f.all=u+zu(v,u):r===429&&(f.all=u+6e4);return f}function bs(){return{traceId:xe(),spanId:xe().substring(16)}}let _r=L;function Ju(){let n=_r.chrome,r=n&&n.app&&n.app.runtime,a="history"in _r&&!!_r.history.pushState&&!!_r.history.replaceState;return!r&&a}let ws=()=>{},Xu=["attachTo","createWidget","remove"];function _s(n){return Oe(()=>{console.warn("You are using feedbackIntegration() even though this bundle does not include feedback.")}),{name:"Feedback",...Xu.reduce((r,a)=>(r[a]=ws,r),{})}}let Qu=["start","stop","flush"];function Zu(n){return Oe(()=>{console.warn("You are using replayIntegration() even though this bundle does not include replay.")}),{name:"Replay",...Qu.reduce((r,a)=>(r[a]=ws,r),{})}}function Nn(){return Ai(L),L}function Ai(n){let r=n.v=n.v||{};return r.version=r.version||j,r[j]=r[j]||{}}function el(n){let r=mt(),a={sid:xe(),init:!0,timestamp:r,started:r,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>nl(a)};return n&&dn(a,n),a}function dn(n,r={}){if(r.user&&(!n.ipAddress&&r.user.ip_address&&(n.ipAddress=r.user.ip_address),!n.did&&!r.did&&(n.did=r.user.id||r.user.email||r.user.username)),n.timestamp=r.timestamp||mt(),r.abnormal_mechanism&&(n.abnormal_mechanism=r.abnormal_mechanism),r.ignoreDuration&&(n.ignoreDuration=r.ignoreDuration),r.sid&&(n.sid=r.sid.length===32?r.sid:xe()),r.init!==void 0&&(n.init=r.init),!n.did&&r.did&&(n.did=`${r.did}`),typeof r.started=="number"&&(n.started=r.started),n.ignoreDuration)n.duration=void 0;else if(typeof r.duration=="number")n.duration=r.duration;else{let a=n.timestamp-n.started;n.duration=a>=0?a:0}r.release&&(n.release=r.release),r.environment&&(n.environment=r.environment),!n.ipAddress&&r.ipAddress&&(n.ipAddress=r.ipAddress),!n.userAgent&&r.userAgent&&(n.userAgent=r.userAgent),typeof r.errors=="number"&&(n.errors=r.errors),r.status&&(n.status=r.status)}function tl(n,r){let a={};r?a={status:r}:n.status==="ok"&&(a={status:"exited"}),dn(n,a)}function nl(n){return Fe({sid:`${n.sid}`,init:n.init,started:new Date(n.started*1e3).toISOString(),timestamp:new Date(n.timestamp*1e3).toISOString(),status:n.status,errors:n.errors,did:typeof n.did=="number"||typeof n.did=="string"?`${n.did}`:void 0,duration:n.duration,abnormal_mechanism:n.abnormal_mechanism,attrs:{release:n.release,environment:n.environment,ip_address:n.ipAddress,user_agent:n.userAgent}})}let Di="_sentrySpan";function Ss(n,r){r?Pe(n,Di,r):delete n[Di]}function Es(n){return n[Di]}let rl=100;class Ri{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext=bs()}clone(){let r=new Ri;return r._breadcrumbs=[...this._breadcrumbs],r._tags={...this._tags},r._extra={...this._extra},r._contexts={...this._contexts},r._user=this._user,r._level=this._level,r._session=this._session,r._transactionName=this._transactionName,r._fingerprint=this._fingerprint,r._eventProcessors=[...this._eventProcessors],r._requestSession=this._requestSession,r._attachments=[...this._attachments],r._sdkProcessingMetadata={...this._sdkProcessingMetadata},r._propagationContext={...this._propagationContext},r._client=this._client,r._lastEventId=this._lastEventId,Ss(r,Es(this)),r}setClient(r){this._client=r}setLastEventId(r){this._lastEventId=r}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(r){this._scopeListeners.push(r)}addEventProcessor(r){return this._eventProcessors.push(r),this}setUser(r){return this._user=r||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&dn(this._session,{user:r}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(r){return this._requestSession=r,this}setTags(r){return this._tags={...this._tags,...r},this._notifyScopeListeners(),this}setTag(r,a){return this._tags={...this._tags,[r]:a},this._notifyScopeListeners(),this}setExtras(r){return this._extra={...this._extra,...r},this._notifyScopeListeners(),this}setExtra(r,a){return this._extra={...this._extra,[r]:a},this._notifyScopeListeners(),this}setFingerprint(r){return this._fingerprint=r,this._notifyScopeListeners(),this}setLevel(r){return this._level=r,this._notifyScopeListeners(),this}setTransactionName(r){return this._transactionName=r,this._notifyScopeListeners(),this}setContext(r,a){return a===null?delete this._contexts[r]:this._contexts[r]=a,this._notifyScopeListeners(),this}setSession(r){return r?this._session=r:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(r){if(!r)return this;let a=typeof r=="function"?r(this):r,[u,f]=a instanceof yt?[a.getScopeData(),a.getRequestSession()]:g(a)?[r,r.requestSession]:[],{tags:p,extra:v,user:S,contexts:D,level:F,fingerprint:G=[],propagationContext:z}=u||{};return this._tags={...this._tags,...p},this._extra={...this._extra,...v},this._contexts={...this._contexts,...D},S&&Object.keys(S).length&&(this._user=S),F&&(this._level=F),G.length&&(this._fingerprint=G),z&&(this._propagationContext=z),f&&(this._requestSession=f),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._session=void 0,Ss(this,void 0),this._attachments=[],this._propagationContext=bs(),this._notifyScopeListeners(),this}addBreadcrumb(r,a){let u=typeof a=="number"?a:rl;if(u<=0)return this;let f={timestamp:On(),...r},p=this._breadcrumbs;return p.push(f),this._breadcrumbs=p.length>u?p.slice(-u):p,this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(r){return this._attachments.push(r),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:Es(this)}}setSDKProcessingMetadata(r){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...r},this}setPropagationContext(r){return this._propagationContext=r,this}getPropagationContext(){return this._propagationContext}captureException(r,a){let u=a&&a.event_id?a.event_id:xe();if(!this._client)return O.warn("No client configured on scope - will not capture exception!"),u;let f=new Error("Sentry syntheticException");return this._client.captureException(r,{originalException:r,syntheticException:f,...a,event_id:u},this),u}captureMessage(r,a,u){let f=u&&u.event_id?u.event_id:xe();if(!this._client)return O.warn("No client configured on scope - will not capture message!"),f;let p=new Error(r);return this._client.captureMessage(r,a,{originalException:r,syntheticException:p,...u,event_id:f},this),f}captureEvent(r,a){let u=a&&a.event_id?a.event_id:xe();return this._client?(this._client.captureEvent(r,{...a,event_id:u},this),u):(O.warn("No client configured on scope - will not capture event!"),u)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(r=>{r(this)}),this._notifyingListeners=!1)}}let yt=Ri;function il(){return Y("defaultCurrentScope",()=>new yt)}function ol(){return Y("defaultIsolationScope",()=>new yt)}class sl{constructor(r,a){let u;r?u=r:u=new yt;let f;a?f=a:f=new yt,this._stack=[{scope:u}],this._isolationScope=f}withScope(r){let a=this._pushScope(),u;try{u=r(a)}catch(f){throw this._popScope(),f}return b(u)?u.then(f=>(this._popScope(),f),f=>{throw this._popScope(),f}):(this._popScope(),u)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){let r=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:r}),r}_popScope(){return this._stack.length<=1?!1:!!this._stack.pop()}}function hn(){let n=Nn(),r=Ai(n);return r.stack=r.stack||new sl(il(),ol())}function al(n){return hn().withScope(n)}function cl(n,r){let a=hn();return a.withScope(()=>(a.getStackTop().scope=n,r(n)))}function Is(n){return hn().withScope(()=>n(hn().getIsolationScope()))}function ul(){return{withIsolationScope:Is,withScope:al,withSetScope:cl,withSetIsolationScope:(n,r)=>Is(r),getCurrentScope:()=>hn().getScope(),getIsolationScope:()=>hn().getIsolationScope()}}function Sr(n){let r=Ai(n);return r.acs?r.acs:ul()}function Ke(){let n=Nn();return Sr(n).getCurrentScope()}function qe(){let n=Nn();return Sr(n).getIsolationScope()}function ks(){return Y("globalScope",()=>new yt)}function Er(...n){let r=Nn(),a=Sr(r);if(n.length===2){let[u,f]=n;return u?a.withSetScope(u,f):a.withScope(f)}return a.withScope(n[0])}function ll(...n){let r=Nn(),a=Sr(r);if(n.length===2){let[u,f]=n;return u?a.withSetIsolationScope(u,f):a.withIsolationScope(f)}return a.withIsolationScope(n[0])}function be(){return Ke().getClient()}let fl="_sentryMetrics";function dl(n){let r=n[fl];if(!r)return;let a={};for(let[,[u,f]]of r)(a[u]||(a[u]=[])).push(Fe(f));return a}let xs="sentry.source",Ts="sentry.sample_rate",Cs="sentry.op",Ps="sentry.origin",hl=0,pl=1,ml=1;function gl(n){let{spanId:r,traceId:a}=n.spanContext(),{parent_span_id:u}=$n(n);return Fe({parent_span_id:u,span_id:r,trace_id:a})}function yl(n){let{traceId:r,spanId:a}=n.spanContext(),u=Rs(n);return $u(r,a,u)}function As(n){return typeof n=="number"?Ds(n):Array.isArray(n)?n[0]+n[1]/1e9:n instanceof Date?Ds(n.getTime()):mt()}function Ds(n){return n>9999999999?n/1e3:n}function $n(n){if(bl(n))return n.getSpanJSON();try{let{spanId:r,traceId:a}=n.spanContext();if(vl(n)){let{attributes:u,startTime:f,name:p,endTime:v,parentSpanId:S,status:D}=n;return Fe({span_id:r,trace_id:a,data:u,description:p,parent_span_id:S,start_timestamp:As(f),timestamp:As(v)||void 0,status:wl(D),op:u[Cs],origin:u[Ps],_metrics_summary:dl(n)})}return{span_id:r,trace_id:a}}catch{return{}}}function vl(n){let r=n;return!!r.attributes&&!!r.startTime&&!!r.name&&!!r.endTime&&!!r.status}function bl(n){return typeof n.getSpanJSON=="function"}function Rs(n){let{traceFlags:r}=n.spanContext();return r===ml}function wl(n){if(!(!n||n.code===hl))return n.code===pl?"ok":n.message||"unknown_error"}let _l="_sentryRootSpan";function Os(n){return n[_l]||n}let Oi="production",Sl="_frozenDsc";function Fs(n,r){let a=r.getOptions(),{publicKey:u}=r.getDsn()||{},f=Fe({environment:a.environment||Oi,release:a.release,public_key:u,trace_id:n});return r.emit("createDsc",f),f}function Ms(n){let r=be();if(!r)return{};let a=Fs($n(n).trace_id||"",r),u=Os(n),f=u[Sl];if(f)return f;let p=u.spanContext().traceState,v=p&&p.get("sentry.dsc"),S=v&&ps(v);if(S)return S;let D=$n(u),F=D.data||{},G=F[Ts];G!=null&&(a.sample_rate=`${G}`);let z=F[xs],fe=D.description;return z!=="url"&&fe&&(a.transaction=fe),a.sampled=String(Rs(u)),r.emit("createDsc",a,u),a}function El(n){let r=Ms(n);return Du(r)}function Il(n){if(typeof n=="boolean")return Number(n);let r=typeof n=="string"?parseFloat(n):n;if(typeof r!="number"||isNaN(r)||r<0||r>1){O.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(n)} of type ${JSON.stringify(typeof n)}.`);return}return r}function kl(n,r){return r&&(n.sdk=n.sdk||{},n.sdk.name=n.sdk.name||r.name,n.sdk.version=n.sdk.version||r.version,n.sdk.integrations=[...n.sdk.integrations||[],...r.integrations||[]],n.sdk.packages=[...n.sdk.packages||[],...r.packages||[]]),n}function xl(n,r,a,u){let f=vs(a),p={sent_at:new Date().toISOString(),...f&&{sdk:f},...!!u&&r&&{dsn:se(r)}},v="aggregates"in n?[{type:"sessions"},n]:[{type:"session"},n.toJSON()];return Mn(p,[v])}function Tl(n,r,a,u){let f=vs(a),p=n.type&&n.type!=="replay_event"?n.type:"event";kl(n,a&&a.sdk);let v=Hu(n,f,u,r);return delete n.sdkProcessingMetadata,Mn(v,[[{type:p},n]])}let Cl=({sentryTrace:n,baggage:r},a)=>Er(u=>{let f=Nu(n,r);return u.setPropagationContext(f),a()});function Fi(n,r,a,u=0){return new it((f,p)=>{let v=n[u];if(r===null||typeof v!="function")f(r);else{let S=v({...r},a);v.id&&S===null&&O.log(`Event processor "${v.id}" dropped event`),b(S)?S.then(D=>Fi(n,D,a,u+1).then(f)).then(null,p):Fi(n,S,a,u+1).then(f).then(null,p)}})}function Pl(n,r){let{fingerprint:a,span:u,breadcrumbs:f,sdkProcessingMetadata:p}=r;Al(n,r),u&&Ol(n,u),Fl(n,a),Dl(n,f),Rl(n,p)}function Ns(n,r){let{extra:a,tags:u,user:f,contexts:p,level:v,sdkProcessingMetadata:S,breadcrumbs:D,fingerprint:F,eventProcessors:G,attachments:z,propagationContext:fe,transactionName:ge,span:pe}=r;Bn(n,"extra",a),Bn(n,"tags",u),Bn(n,"user",f),Bn(n,"contexts",p),Bn(n,"sdkProcessingMetadata",S),v&&(n.level=v),ge&&(n.transactionName=ge),pe&&(n.span=pe),D.length&&(n.breadcrumbs=[...n.breadcrumbs,...D]),F.length&&(n.fingerprint=[...n.fingerprint,...F]),G.length&&(n.eventProcessors=[...n.eventProcessors,...G]),z.length&&(n.attachments=[...n.attachments,...z]),n.propagationContext={...n.propagationContext,...fe}}function Bn(n,r,a){if(a&&Object.keys(a).length){n[r]={...n[r]};for(let u in a)Object.prototype.hasOwnProperty.call(a,u)&&(n[r][u]=a[u])}}function Al(n,r){let{extra:a,tags:u,user:f,contexts:p,level:v,transactionName:S}=r,D=Fe(a);D&&Object.keys(D).length&&(n.extra={...D,...n.extra});let F=Fe(u);F&&Object.keys(F).length&&(n.tags={...F,...n.tags});let G=Fe(f);G&&Object.keys(G).length&&(n.user={...G,...n.user});let z=Fe(p);z&&Object.keys(z).length&&(n.contexts={...z,...n.contexts}),v&&(n.level=v),S&&n.type!=="transaction"&&(n.transaction=S)}function Dl(n,r){let a=[...n.breadcrumbs||[],...r];n.breadcrumbs=a.length?a:void 0}function Rl(n,r){n.sdkProcessingMetadata={...n.sdkProcessingMetadata,...r}}function Ol(n,r){n.contexts={trace:gl(r),...n.contexts},n.sdkProcessingMetadata={dynamicSamplingContext:Ms(r),...n.sdkProcessingMetadata};let a=Os(r),u=$n(a).description;u&&!n.transaction&&n.type==="transaction"&&(n.transaction=u)}function Fl(n,r){n.fingerprint=n.fingerprint?fs(n.fingerprint):[],r&&(n.fingerprint=n.fingerprint.concat(r)),n.fingerprint&&!n.fingerprint.length&&delete n.fingerprint}function Ml(n,r,a,u,f,p){let{normalizeDepth:v=3,normalizeMaxBreadth:S=1e3}=n,D={...r,event_id:r.event_id||a.event_id||xe(),timestamp:r.timestamp||On()},F=a.integrations||n.integrations.map(Je=>Je.name);Nl(D,n),Ll(D,F),f&&f.emit("applyFrameMetadata",r),r.type===void 0&&$l(D,n.stackParser);let G=jl(u,a.captureContext);a.mechanism&&Fn(D,a.mechanism);let z=f?f.getEventProcessors():[],fe=ks().getScopeData();if(p){let Je=p.getScopeData();Ns(fe,Je)}if(G){let Je=G.getScopeData();Ns(fe,Je)}let ge=[...a.attachments||[],...fe.attachments];ge.length&&(a.attachments=ge),Pl(D,fe);let pe=[...z,...fe.eventProcessors];return Fi(pe,D,a).then(Je=>(Je&&Bl(Je),typeof v=="number"&&v>0?Ul(Je,v,S):Je))}function Nl(n,r){let{environment:a,release:u,dist:f,maxValueLength:p=250}=r;"environment"in n||(n.environment="environment"in r?a:Oi),n.release===void 0&&u!==void 0&&(n.release=u),n.dist===void 0&&f!==void 0&&(n.dist=f),n.message&&(n.message=C(n.message,p));let v=n.exception&&n.exception.values&&n.exception.values[0];v&&v.value&&(v.value=C(v.value,p));let S=n.request;S&&S.url&&(S.url=C(S.url,p))}let $s=new WeakMap;function $l(n,r){let a=L._sentryDebugIds;if(!a)return;let u,f=$s.get(r);f?u=f:(u=new Map,$s.set(r,u));let p=Object.entries(a).reduce((v,[S,D])=>{let F,G=u.get(S);G?F=G:(F=r(S),u.set(S,F));for(let z=F.length-1;z>=0;z--){let fe=F[z];if(fe.filename){v[fe.filename]=D;break}}return v},{});try{n.exception.values.forEach(v=>{v.stacktrace.frames.forEach(S=>{S.filename&&(S.debug_id=p[S.filename])})})}catch{}}function Bl(n){let r={};try{n.exception.values.forEach(u=>{u.stacktrace.frames.forEach(f=>{f.debug_id&&(f.abs_path?r[f.abs_path]=f.debug_id:f.filename&&(r[f.filename]=f.debug_id),delete f.debug_id)})})}catch{}if(Object.keys(r).length===0)return;n.debug_meta=n.debug_meta||{},n.debug_meta.images=n.debug_meta.images||[];let a=n.debug_meta.images;Object.entries(r).forEach(([u,f])=>{a.push({type:"sourcemap",code_file:u,debug_id:f})})}function Ll(n,r){r.length>0&&(n.sdk=n.sdk||{},n.sdk.integrations=[...n.sdk.integrations||[],...r])}function Ul(n,r,a){if(!n)return null;let u={...n,...n.breadcrumbs&&{breadcrumbs:n.breadcrumbs.map(f=>({...f,...f.data&&{data:Ct(f.data,r,a)}}))},...n.user&&{user:Ct(n.user,r,a)},...n.contexts&&{contexts:Ct(n.contexts,r,a)},...n.extra&&{extra:Ct(n.extra,r,a)}};return n.contexts&&n.contexts.trace&&u.contexts&&(u.contexts.trace=n.contexts.trace,n.contexts.trace.data&&(u.contexts.trace.data=Ct(n.contexts.trace.data,r,a))),n.spans&&(u.spans=n.spans.map(f=>({...f,...f.data&&{data:Ct(f.data,r,a)}}))),u}function jl(n,r){if(!r)return n;let a=n?n.clone():new yt;return a.update(r),a}function Kl(n){if(n)return Hl(n)?{captureContext:n}:Vl(n)?{captureContext:n}:n}function Hl(n){return n instanceof yt||typeof n=="function"}let Wl=["user","level","extra","contexts","tags","fingerprint","requestSession","propagationContext"];function Vl(n){return Object.keys(n).some(r=>Wl.includes(r))}function Bs(n,r){return Ke().captureException(n,Kl(r))}function zl(n,r){let a=typeof r=="string"?r:void 0,u=typeof r!="string"?{captureContext:r}:void 0;return Ke().captureMessage(n,a,u)}function Ir(n,r){return Ke().captureEvent(n,r)}function Ls(n,r){qe().setContext(n,r)}function Us(n){qe().setExtras(n)}function js(n,r){qe().setExtra(n,r)}function Ks(n){qe().setTags(n)}function Hs(n,r){qe().setTag(n,r)}function Ws(n){qe().setUser(n)}function Vs(){return qe().lastEventId()}async function Gl(n){let r=be();return r?r.flush(n):(O.warn("Cannot flush events. No client defined."),Promise.resolve(!1))}async function Yl(n){let r=be();return r?r.close(n):(O.warn("Cannot flush events and disable SDK. No client defined."),Promise.resolve(!1))}function ql(){return!!be()}function Jl(n){qe().addEventProcessor(n)}function kr(n){let r=be(),a=qe(),u=Ke(),{release:f,environment:p=Oi}=r&&r.getOptions()||{},{userAgent:v}=L.navigator||{},S=el({release:f,environment:p,user:u.getUser()||a.getUser(),...v&&{userAgent:v},...n}),D=a.getSession();return D&&D.status==="ok"&&dn(D,{status:"exited"}),Ln(),a.setSession(S),u.setSession(S),S}function Ln(){let n=qe(),r=Ke(),a=r.getSession()||n.getSession();a&&tl(a),zs(),n.setSession(),r.setSession()}function zs(){let n=qe(),r=Ke(),a=be(),u=r.getSession()||n.getSession();u&&a&&a.captureSession(u)}function Mi(n=!1){if(n){Ln();return}zs()}let Xl="7";function Gs(n){let r=n.protocol?`${n.protocol}:`:"",a=n.port?`:${n.port}`:"";return`${r}//${n.host}${a}${n.path?`/${n.path}`:""}/api/`}function Ql(n){return`${Gs(n)}${n.projectId}/envelope/`}function Zl(n,r){return Kt({sentry_key:n.publicKey,sentry_version:Xl,...r&&{sentry_client:`${r.name}/${r.version}`}})}function ef(n,r,a){return r||`${Ql(n)}?${Zl(n,a)}`}function tf(n,r){let a=ve(n);if(!a)return"";let u=`${Gs(a)}embed/error-page/`,f=`dsn=${se(a)}`;for(let p in r)if(p!=="dsn"&&p!=="onClose")if(p==="user"){let v=r.user;if(!v)continue;v.name&&(f+=`&name=${encodeURIComponent(v.name)}`),v.email&&(f+=`&email=${encodeURIComponent(v.email)}`)}else f+=`&${encodeURIComponent(p)}=${encodeURIComponent(r[p])}`;return`${u}?${f}`}let Ys=[];function nf(n){let r={};return n.forEach(a=>{let{name:u}=a,f=r[u];f&&!f.isDefaultInstance&&a.isDefaultInstance||(r[u]=a)}),Object.values(r)}function rf(n){let r=n.defaultIntegrations||[],a=n.integrations;r.forEach(v=>{v.isDefaultInstance=!0});let u;Array.isArray(a)?u=[...r,...a]:typeof a=="function"?u=fs(a(r)):u=r;let f=nf(u),p=f.findIndex(v=>v.name==="Debug");if(p>-1){let[v]=f.splice(p,1);f.push(v)}return f}function of(n,r){let a={};return r.forEach(u=>{u&&Js(n,u,a)}),a}function qs(n,r){for(let a of r)a&&a.afterAllSetup&&a.afterAllSetup(n)}function Js(n,r,a){if(a[r.name]){O.log(`Integration skipped because it was already installed: ${r.name}`);return}if(a[r.name]=r,Ys.indexOf(r.name)===-1&&typeof r.setupOnce=="function"&&(r.setupOnce(),Ys.push(r.name)),r.setup&&typeof r.setup=="function"&&r.setup(n),typeof r.preprocessEvent=="function"){let u=r.preprocessEvent.bind(r);n.on("preprocessEvent",(f,p)=>u(f,p,n))}if(typeof r.processEvent=="function"){let u=r.processEvent.bind(r),f=Object.assign((p,v)=>u(p,v,n),{id:r.name});n.addEventProcessor(f)}O.log(`Integration installed: ${r.name}`)}function sf(n){let r=be();if(!r){O.warn(`Cannot add integration "${n.name}" because no SDK Client is available.`);return}r.addIntegration(n)}function rm(n){return n}let Xs="Not capturing exception because it's already been captured.";class af{constructor(r){if(this._options=r,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],r.dsn?this._dsn=ve(r.dsn):O.warn("No DSN provided, client will not send events."),this._dsn){let a=ef(this._dsn,r.tunnel,r._metadata?r._metadata.sdk:void 0);this._transport=r.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...r.transportOptions,url:a})}}captureException(r,a,u){let f=xe();if(ls(r))return O.log(Xs),f;let p={event_id:f,...a};return this._process(this.eventFromException(r,p).then(v=>this._captureEvent(v,p,u))),p.event_id}captureMessage(r,a,u,f){let p={event_id:xe(),...u},v=h(r)?r:String(r),S=m(r)?this.eventFromMessage(v,a,p):this.eventFromException(r,p);return this._process(S.then(D=>this._captureEvent(D,p,f))),p.event_id}captureEvent(r,a,u){let f=xe();if(a&&a.originalException&&ls(a.originalException))return O.log(Xs),f;let p={event_id:f,...a},S=(r.sdkProcessingMetadata||{}).capturedSpanScope;return this._process(this._captureEvent(r,p,S||u)),p.event_id}captureSession(r){typeof r.release!="string"?O.warn("Discarded session because of missing or non-string release"):(this.sendSession(r),dn(r,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(r){let a=this._transport;return a?(this.emit("flush"),this._isClientDoneProcessing(r).then(u=>a.flush(r).then(f=>u&&f))):zt(!0)}close(r){return this.flush(r).then(a=>(this.getOptions().enabled=!1,this.emit("close"),a))}getEventProcessors(){return this._eventProcessors}addEventProcessor(r){this._eventProcessors.push(r)}init(){this._isEnabled()&&this._setupIntegrations()}getIntegrationByName(r){return this._integrations[r]}addIntegration(r){let a=this._integrations[r.name];Js(this,r,this._integrations),a||qs(this,[r])}sendEvent(r,a={}){this.emit("beforeSendEvent",r,a);let u=Tl(r,this._dsn,this._options._metadata,this._options.tunnel);for(let p of a.attachments||[])u=Bu(u,ju(p));let f=this.sendEnvelope(u);f&&f.then(p=>this.emit("afterSendEvent",r,p),null)}sendSession(r){let a=xl(r,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(a)}recordDroppedEvent(r,a,u){if(this._options.sendClientReports){let f=`${r}:${a}`;O.log(`Adding outcome: "${f}"`),this._outcomes[f]=(this._outcomes[f]||0)+1}}on(r,a){let u=this._hooks[r]=this._hooks[r]||[];return u.push(a),()=>{let f=u.indexOf(a);f>-1&&u.splice(f,1)}}emit(r,...a){let u=this._hooks[r];u&&u.forEach(f=>f(...a))}sendEnvelope(r){return this.emit("beforeEnvelope",r),this._isEnabled()&&this._transport?this._transport.send(r).then(null,a=>(O.error("Error while sending event:",a),a)):(O.error("Transport disabled"),zt({}))}_setupIntegrations(){let{integrations:r}=this._options;this._integrations=of(this,r),qs(this,r)}_updateSessionFromEvent(r,a){let u=!1,f=!1,p=a.exception&&a.exception.values;if(p){f=!0;for(let D of p){let F=D.mechanism;if(F&&F.handled===!1){u=!0;break}}}let v=r.status==="ok";(v&&r.errors===0||v&&u)&&(dn(r,{...u&&{status:"crashed"},errors:r.errors||Number(f||u)}),this.captureSession(r))}_isClientDoneProcessing(r){return new it(a=>{let u=0,f=1,p=setInterval(()=>{this._numProcessing==0?(clearInterval(p),a(!0)):(u+=f,r&&u>=r&&(clearInterval(p),a(!1)))},f)})}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(r,a,u,f=qe()){let p=this.getOptions(),v=Object.keys(this._integrations);return!a.integrations&&v.length>0&&(a.integrations=v),this.emit("preprocessEvent",r,a),r.type||f.setLastEventId(r.event_id||a.event_id),Ml(p,r,a,u,this,f).then(S=>{if(S===null)return S;let D={...f.getPropagationContext(),...u?u.getPropagationContext():void 0};if(!(S.contexts&&S.contexts.trace)&&D){let{traceId:G,spanId:z,parentSpanId:fe,dsc:ge}=D;S.contexts={trace:Fe({trace_id:G,span_id:z,parent_span_id:fe}),...S.contexts};let pe=ge||Fs(G,this);S.sdkProcessingMetadata={dynamicSamplingContext:pe,...S.sdkProcessingMetadata}}return S})}_captureEvent(r,a={},u){return this._processEvent(r,a,u).then(f=>f.event_id,f=>{{let p=f;p.logLevel==="log"?O.log(p.message):O.warn(p)}})}_processEvent(r,a,u){let f=this.getOptions(),{sampleRate:p}=f,v=Ni(r),S=Qs(r),D=r.type||"error",F=`before send for type \`${D}\``,G=typeof p>"u"?void 0:Il(p);if(S&&typeof G=="number"&&Math.random()>G)return this.recordDroppedEvent("sample_rate","error",r),wr(new he(`Discarding event because it's not included in the random sample (sampling rate = ${p})`,"log"));let z=D==="replay_event"?"replay":D,ge=(r.sdkProcessingMetadata||{}).capturedSpanIsolationScope;return this._prepareEvent(r,a,u,ge).then(pe=>{if(pe===null)throw this.recordDroppedEvent("event_processor",z,r),new he("An event processor returned `null`, will not send event.","log");if(a.data&&a.data.Ge===!0)return pe;let Je=uf(this,f,pe,a);return cf(Je,F)}).then(pe=>{if(pe===null){if(this.recordDroppedEvent("before_send",z,r),Ni(r)){let Xd=1+(r.spans||[]).length;this._outcomes.span=(this._outcomes.span||0)+Xd}throw new he(`${F} returned \`null\`, will not send event.`,"log")}let Dr=u&&u.getSession();!v&&Dr&&this._updateSessionFromEvent(Dr,pe);let Je=pe.transaction_info;if(v&&Je&&pe.transaction!==r.transaction){let Fa="custom";pe.transaction_info={...Je,source:Fa}}return this.sendEvent(pe,a),pe}).then(null,pe=>{throw pe instanceof he?pe:(this.captureException(pe,{data:{Ge:!0},originalException:pe}),new he(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${pe}`))})}_process(r){this._numProcessing++,r.then(a=>(this._numProcessing--,a),a=>(this._numProcessing--,a))}_clearOutcomes(){let r=this._outcomes;return this._outcomes={},Object.entries(r).map(([a,u])=>{let[f,p]=a.split(":");return{reason:f,category:p,quantity:u}})}}function cf(n,r){let a=`${r} must return \`null\` or a valid event.`;if(b(n))return n.then(u=>{if(!g(u)&&u!==null)throw new he(a);return u},u=>{throw new he(`${r} rejected with ${u}`)});if(!g(n)&&n!==null)throw new he(a);return n}function uf(n,r,a,u){let{beforeSend:f,beforeSendTransaction:p,beforeSendSpan:v}=r;if(Qs(a)&&f)return f(a,u);if(Ni(a)){if(a.spans&&v){let S=[];for(let D of a.spans){let F=v(D);F?S.push(F):n.recordDroppedEvent("before_send","span")}a.spans=S}if(p)return p(a,u)}return a}function Qs(n){return n.type===void 0}function Ni(n){return n.type==="transaction"}function lf(n,r){r.debug===!0&&O.enable(),Ke().update(r.initialScope);let u=new n(r);return Zs(u),u.init(),u}function Zs(n){Ke().setClient(n)}let ff=64;function ea(n,r,a=xu(n.bufferSize||ff)){let u={},f=v=>a.drain(v);function p(v){let S=[];if(gs(v,(z,fe)=>{let ge=ys(fe);if(Yu(u,ge)){let pe=ta(z,fe);n.recordDroppedEvent("ratelimit_backoff",ge,pe)}else S.push(z)}),S.length===0)return zt({});let D=Mn(v[0],S),F=z=>{gs(D,(fe,ge)=>{let pe=ta(fe,ge);n.recordDroppedEvent(z,ys(ge),pe)})},G=()=>r({body:Lu(D)}).then(z=>(z.statusCode!==void 0&&(z.statusCode<200||z.statusCode>=300)&&O.warn(`Sentry responded with status code ${z.statusCode} to sent event.`),u=qu(u,z),z),z=>{throw F("network_error"),z});return a.add(G).then(z=>z,z=>{if(z instanceof he)return O.error("Skipped sending event because buffer is full."),F("queue_overflow"),zt({});throw z})}return{send:p,flush:f}}function ta(n,r){if(!(r!=="event"&&r!=="transaction"))return Array.isArray(n)?n[1]:void 0}function df(n,...r){let a=new String(String.raw(n,...r));return a.Ye=n.join("\0").replace(/%/g,"%%").replace(/\0/g,"%s"),a.qe=r,a}function hf(n,r,a=[r],u="npm"){let f=n._metadata||{};f.sdk||(f.sdk={name:`sentry.javascript.${r}`,packages:a.map(p=>({name:`${u}:@sentry/${p}`,version:j})),version:j}),n._metadata=f}let pf=100;function vt(n,r){let a=be(),u=qe();if(!a)return;let{beforeBreadcrumb:f=null,maxBreadcrumbs:p=pf}=a.getOptions();if(p<=0)return;let S={timestamp:On(),...n},D=f?Oe(()=>f(S,r)):S;D!==null&&(a.emit&&a.emit("beforeAddBreadcrumb",D,r),u.addBreadcrumb(D,p))}let na,mf="FunctionToString",ra=new WeakMap,ia=(()=>({name:mf,setupOnce(){na=Function.prototype.toString;try{Function.prototype.toString=function(...n){let r=pt(this),a=ra.has(be())&&r!==void 0?r:this;return na.apply(a,n)}}catch{}},setup(n){ra.set(n,!0)}})),gf=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,"undefined is not an object (evaluating 'a.L')",`can't redefine non-configurable property "solana"`,"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler"],yf="InboundFilters",oa=((n={})=>({name:yf,processEvent(r,a,u){let f=u.getOptions(),p=vf(n,f);return bf(r,p)?null:r}}));function vf(n={},r={}){return{allowUrls:[...n.allowUrls||[],...r.allowUrls||[]],denyUrls:[...n.denyUrls||[],...r.denyUrls||[]],ignoreErrors:[...n.ignoreErrors||[],...r.ignoreErrors||[],...n.disableErrorDefaults?[]:gf],ignoreTransactions:[...n.ignoreTransactions||[],...r.ignoreTransactions||[]],ignoreInternal:n.ignoreInternal!==void 0?n.ignoreInternal:!0}}function bf(n,r){return r.ignoreInternal&&kf(n)?(O.warn(`Event dropped due to being internal Sentry Error.
Event: ${Tt(n)}`),!0):wf(n,r.ignoreErrors)?(O.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${Tt(n)}`),!0):Tf(n)?(O.warn(`Event dropped due to not having an error message, error type or stacktrace.
Event: ${Tt(n)}`),!0):_f(n,r.ignoreTransactions)?(O.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${Tt(n)}`),!0):Sf(n,r.denyUrls)?(O.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${Tt(n)}.
Url: ${xr(n)}`),!0):Ef(n,r.allowUrls)?!1:(O.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${Tt(n)}.
Url: ${xr(n)}`),!0)}function wf(n,r){return n.type||!r||!r.length?!1:If(n).some(a=>T(a,r))}function _f(n,r){if(n.type!=="transaction"||!r||!r.length)return!1;let a=n.transaction;return a?T(a,r):!1}function Sf(n,r){if(!r||!r.length)return!1;let a=xr(n);return a?T(a,r):!1}function Ef(n,r){if(!r||!r.length)return!0;let a=xr(n);return a?T(a,r):!0}function If(n){let r=[];n.message&&r.push(n.message);let a;try{a=n.exception.values[n.exception.values.length-1]}catch{}return a&&a.value&&(r.push(a.value),a.type&&r.push(`${a.type}: ${a.value}`)),r}function kf(n){try{return n.exception.values[0].type==="SentryError"}catch{}return!1}function xf(n=[]){for(let r=n.length-1;r>=0;r--){let a=n[r];if(a&&a.filename!=="<anonymous>"&&a.filename!=="[native code]")return a.filename||null}return null}function xr(n){try{let r;try{r=n.exception.values[0].stacktrace.frames}catch{}return r?xf(r):null}catch{return O.error(`Cannot extract url for event ${Tt(n)}`),null}}function Tf(n){return n.type||!n.exception||!n.exception.values||n.exception.values.length===0?!1:!n.message&&!n.exception.values.some(r=>r.stacktrace||r.type&&r.type!=="Error"||r.value)}let Cf="Dedupe",sa=(()=>{let n;return{name:Cf,processEvent(r){if(r.type)return r;try{if(Pf(r,n))return O.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return n=r}}});function Pf(n,r){return r?!!(Af(n,r)||Df(n,r)):!1}function Af(n,r){let a=n.message,u=r.message;return!(!a&&!u||a&&!u||!a&&u||a!==u||!ca(n,r)||!aa(n,r))}function Df(n,r){let a=ua(r),u=ua(n);return!(!a||!u||a.type!==u.type||a.value!==u.value||!ca(n,r)||!aa(n,r))}function aa(n,r){let a=is(n),u=is(r);if(!a&&!u)return!0;if(a&&!u||!a&&u||(a=a,u=u,u.length!==a.length))return!1;for(let f=0;f<u.length;f++){let p=u[f],v=a[f];if(p.filename!==v.filename||p.lineno!==v.lineno||p.colno!==v.colno||p.function!==v.function)return!1}return!0}function ca(n,r){let a=n.fingerprint,u=r.fingerprint;if(!a&&!u)return!0;if(a&&!u||!a&&u)return!1;a=a,u=u;try{return a.join("")===u.join("")}catch{return!1}}function ua(n){return n.exception&&n.exception.values&&n.exception.values[0]}function Rf(){return{bindClient(n){Ke().setClient(n)},withScope:Er,getClient:()=>be(),getScope:Ke,getIsolationScope:qe,captureException:(n,r)=>Ke().captureException(n,r),captureMessage:(n,r,a)=>Ke().captureMessage(n,r,a),captureEvent:Ir,addBreadcrumb:vt,setUser:Ws,setTags:Ks,setTag:Hs,setExtra:js,setExtras:Us,setContext:Ls,getIntegration(n){let r=be();return r&&r.getIntegrationByName(n.id)||null},startSession:kr,endSession:Ln,captureSession(n){if(n)return Ln();Ff()}}}let Of=Rf;function Ff(){let n=Ke(),r=be(),a=n.getSession();r&&a&&r.captureSession(a)}let Mf=n=>(Oe(()=>{console.warn("You are using browserTracingIntegration() even though this bundle does not include tracing.")}),{name:"BrowserTracing"});function Un(){Oe(()=>{console.warn("You are using metrics even though this bundle does not include tracing.")})}let Nf={increment:Un,distribution:Un,set:Un,gauge:Un,timing:(n,r)=>{if(Un(),typeof r=="function")return r()}},ce=L,$i=0;function la(){return $i>0}function $f(){$i++,setTimeout(()=>{$i--})}function pn(n,r={},a){if(typeof n!="function")return n;try{let f=n.Je;if(f)return f;if(pt(n))return n}catch{return n}let u=function(){let f=Array.prototype.slice.call(arguments);try{a&&typeof a=="function"&&a.apply(this,arguments);let p=f.map(v=>pn(v,r));return n.apply(this,p)}catch(p){throw $f(),Er(v=>{v.addEventProcessor(S=>(r.mechanism&&(xi(S,void 0,void 0),Fn(S,r.mechanism)),S.extra={...S.extra,arguments:f},S)),Bs(p)}),p}};try{for(let f in n)Object.prototype.hasOwnProperty.call(n,f)&&(u[f]=n[f])}catch{}It(u,n),Pe(n,"__sentry_wrapped__",u);try{Object.getOwnPropertyDescriptor(u,"name").configurable&&Object.defineProperty(u,"name",{get(){return n.name}})}catch{}return u}function Tr(n,r){let a=Li(n,r),u={type:r&&r.name,value:Kf(r)};return a.length&&(u.stacktrace={frames:a}),u.type===void 0&&u.value===""&&(u.value="Unrecoverable error caught"),u}function Bf(n,r,a,u){let f=be(),p=f&&f.getOptions().normalizeDepth,v=Vf(r),S={Yt:ds(r,p)};if(v)return{exception:{values:[Tr(n,v)]},extra:S};let D={exception:{values:[{type:y(r)?r.constructor.name:u?"UnhandledRejection":"Error",value:Hf(r,{isUnhandledRejection:u})}]},extra:S};if(a){let F=Li(n,a);F.length&&(D.exception.values[0].stacktrace={frames:F})}return D}function Bi(n,r){return{exception:{values:[Tr(n,r)]}}}function Li(n,r){let a=r.stacktrace||r.stack||"",u=Uf(r),f=jf(r);try{return n(a,u,f)}catch{}return[]}let Lf=/Minified React error #\d+;/i;function Uf(n){return n&&Lf.test(n.message)?1:0}function jf(n){return typeof n.framesToPop=="number"?n.framesToPop:0}function Kf(n){let r=n&&n.message;return r?r.error&&typeof r.error.message=="string"?r.error.message:r:"No error message"}function fa(n,r,a,u){let f=a&&a.syntheticException||void 0,p=Ui(n,r,f,u);return Fn(p),p.level="error",a&&a.event_id&&(p.event_id=a.event_id),zt(p)}function da(n,r,a="info",u,f){let p=u&&u.syntheticException||void 0,v=ji(n,r,p,f);return v.level=a,u&&u.event_id&&(v.event_id=u.event_id),zt(v)}function Ui(n,r,a,u,f){let p;if(s(r)&&r.error)return Bi(n,r.error);if(c(r)||l(r)){let v=r;if("stack"in r)p=Bi(n,r);else{let S=v.name||(c(v)?"DOMError":"DOMException"),D=v.message?`${S}: ${v.message}`:S;p=ji(n,D,a,u),xi(p,D)}return"code"in v&&(p.tags={...p.tags,"DOMException.code":`${v.code}`}),p}return i(r)?Bi(n,r):g(r)||y(r)?(p=Bf(n,r,a,f),Fn(p,{synthetic:!0}),p):(p=ji(n,r,a,u),xi(p,`${r}`,void 0),Fn(p,{synthetic:!0}),p)}function ji(n,r,a,u){let f={};if(u&&a){let p=Li(n,a);p.length&&(f.exception={values:[{value:r,stacktrace:{frames:p}}]})}if(h(r)){let{Ye:p,qe:v}=r;return f.logentry={message:p,params:v},f}return f.message=r,f}function Hf(n,{isUnhandledRejection:r}){let a=_i(n),u=r?"promise rejection":"exception";return s(n)?`Event \`ErrorEvent\` captured as ${u} with message \`${n.message}\``:y(n)?`Event \`${Wf(n)}\` (type=${n.type}) captured as ${u}`:`Object captured as ${u} with keys: ${a}`}function Wf(n){try{let r=Object.getPrototypeOf(n);return r?r.constructor.name:void 0}catch{}}function Vf(n){for(let r in n)if(Object.prototype.hasOwnProperty.call(n,r)){let a=n[r];if(a instanceof Error)return a}}function ha(n,{metadata:r,tunnel:a,dsn:u}){let f={event_id:n.event_id,sent_at:new Date().toISOString(),...r&&r.sdk&&{sdk:{name:r.sdk.name,version:r.sdk.version}},...!!a&&!!u&&{dsn:se(u)}},p=zf(n);return Mn(f,[p])}function zf(n){return[{type:"user_report"},n]}class pa extends af{constructor(r){let a={parentSpanIsAlwaysRootSpan:!0,...r},u=ce.SENTRY_SDK_SOURCE||wu();hf(a,"browser",["browser"],u),super(a),a.sendClientReports&&ce.document&&ce.document.addEventListener("visibilitychange",()=>{ce.document.visibilityState==="hidden"&&this._flushOutcomes()})}eventFromException(r,a){return fa(this._options.stackParser,r,a,this._options.attachStacktrace)}eventFromMessage(r,a="info",u){return da(this._options.stackParser,r,a,u,this._options.attachStacktrace)}captureUserFeedback(r){if(!this._isEnabled()){O.warn("SDK not enabled, will not capture user feedback.");return}let a=ha(r,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this.sendEnvelope(a)}_prepareEvent(r,a,u){return r.platform=r.platform||"javascript",super._prepareEvent(r,a,u)}_flushOutcomes(){let r=this._clearOutcomes();if(r.length===0){O.log("No outcomes to send");return}if(!this._dsn){O.log("No dsn provided, will not send outcomes");return}O.log("Sending outcomes:",r);let a=Wu(r,this._options.tunnel&&se(this._dsn));this.sendEnvelope(a)}}let He=L,Gf=1e3,ma,Ki,Hi;function Yf(n){Wt("dom",n),Vt("dom",qf)}function qf(){if(!He.document)return;let n=ct.bind(null,"dom"),r=ga(n,!0);He.document.addEventListener("click",r,!1),He.document.addEventListener("keypress",r,!1),["EventTarget","Node"].forEach(a=>{let u=He[a]&&He[a].prototype;!u||!u.hasOwnProperty||!u.hasOwnProperty("addEventListener")||(le(u,"addEventListener",function(f){return function(p,v,S){if(p==="click"||p=="keypress")try{let D=this,F=D.L=D.L||{},G=F[p]=F[p]||{refCount:0};if(!G.handler){let z=ga(n);G.handler=z,f.call(this,p,z,S)}G.refCount++}catch{}return f.call(this,p,v,S)}}),le(u,"removeEventListener",function(f){return function(p,v,S){if(p==="click"||p=="keypress")try{let D=this,F=D.L||{},G=F[p];G&&(G.refCount--,G.refCount<=0&&(f.call(this,p,G.handler,S),G.handler=void 0,delete F[p]),Object.keys(F).length===0&&delete D.L)}catch{}return f.call(this,p,v,S)}}))})}function Jf(n){if(n.type!==Ki)return!1;try{if(!n.target||n.target._sentryId!==Hi)return!1}catch{}return!0}function Xf(n,r){return n!=="keypress"?!1:!r||!r.tagName?!0:!(r.tagName==="INPUT"||r.tagName==="TEXTAREA"||r.isContentEditable)}function ga(n,r=!1){return a=>{if(!a||a._sentryCaptured)return;let u=Qf(a);if(Xf(a.type,u))return;Pe(a,"_sentryCaptured",!0),u&&!u._sentryId&&Pe(u,"_sentryId",xe());let f=a.type==="keypress"?"input":a.type;Jf(a)||(n({event:a,name:f,global:r}),Ki=a.type,Hi=u?u._sentryId:void 0),clearTimeout(ma),ma=He.setTimeout(()=>{Hi=void 0,Ki=void 0},Gf)}}function Qf(n){try{return n.target}catch{return null}}let Cr;function ya(n){let r="history";Wt(r,n),Vt(r,Zf)}function Zf(){if(!Ju())return;let n=He.onpopstate;He.onpopstate=function(...a){let u=He.location.href,f=Cr;if(Cr=u,ct("history",{from:f,to:u}),n)try{return n.apply(this,a)}catch{}};function r(a){return function(...u){let f=u.length>2?u[2]:void 0;if(f){let p=Cr,v=String(f);Cr=v,ct("history",{from:p,to:v})}return a.apply(this,u)}}le(He.history,"pushState",r),le(He.history,"replaceState",r)}let Pr={};function ed(n){let r=Pr[n];if(r)return r;let a=He[n];if(Ii(a))return Pr[n]=a.bind(He);let u=He.document;if(u&&typeof u.createElement=="function")try{let f=u.createElement("iframe");f.hidden=!0,u.head.appendChild(f);let p=f.contentWindow;p&&p[n]&&(a=p[n]),u.head.removeChild(f)}catch(f){O.warn(`Could not create sandbox iframe for ${n} check, bailing to window.${n}: `,f)}return a&&(Pr[n]=a.bind(He))}function va(n){Pr[n]=void 0}let jn="__sentry_xhr_v3__";function td(n){Wt("xhr",n),Vt("xhr",nd)}function nd(){if(!He.XMLHttpRequest)return;let n=XMLHttpRequest.prototype;le(n,"open",function(r){return function(...a){let u=mt()*1e3,f=d(a[0])?a[0].toUpperCase():void 0,p=rd(a[1]);if(!f||!p)return r.apply(this,a);this[jn]={method:f,url:p,request_headers:{}},f==="POST"&&p.match(/sentry_key/)&&(this.qt=!0);let v=()=>{let S=this[jn];if(S&&this.readyState===4){try{S.status_code=this.status}catch{}let D={endTimestamp:mt()*1e3,startTimestamp:u,xhr:this};ct("xhr",D)}};return"onreadystatechange"in this&&typeof this.onreadystatechange=="function"?le(this,"onreadystatechange",function(S){return function(...D){return v(),S.apply(this,D)}}):this.addEventListener("readystatechange",v),le(this,"setRequestHeader",function(S){return function(...D){let[F,G]=D,z=this[jn];return z&&d(F)&&d(G)&&(z.request_headers[F.toLowerCase()]=G),S.apply(this,D)}}),r.apply(this,a)}}),le(n,"send",function(r){return function(...a){let u=this[jn];if(!u)return r.apply(this,a);a[0]!==void 0&&(u.body=a[0]);let f={startTimestamp:mt()*1e3,xhr:this};return ct("xhr",f),r.apply(this,a)}})}function rd(n){if(d(n))return n;try{return n.toString()}catch{}}function ba(n,r=ed("fetch")){let a=0,u=0;function f(p){let v=p.body.length;a+=v,u++;let S={body:p.body,method:"POST",referrerPolicy:"origin",headers:n.headers,keepalive:a<=6e4&&u<15,...n.fetchOptions};if(!r)return va("fetch"),wr("No fetch implementation available");try{return r(n.url,S).then(D=>(a-=v,u--,{statusCode:D.status,headers:{"x-sentry-rate-limits":D.headers.get("X-Sentry-Rate-Limits"),"retry-after":D.headers.get("Retry-After")}}))}catch(D){return va("fetch"),a-=v,u--,wr(D)}}return ea(n,f)}let id=10,od=20,sd=30,ad=40,cd=50;function mn(n,r,a,u){let f={filename:n,function:r==="<anonymous>"?Ye:r,in_app:!0};return a!==void 0&&(f.lineno=a),u!==void 0&&(f.colno=u),f}let ud=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,ld=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,fd=/\((\S*)(?::(\d+))(?::(\d+))\)/,wa=[sd,n=>{let r=ud.exec(n);if(r){let[,u,f,p]=r;return mn(u,Ye,+f,+p)}let a=ld.exec(n);if(a){if(a[2]&&a[2].indexOf("eval")===0){let v=fd.exec(a[2]);v&&(a[2]=v[1],a[3]=v[2],a[4]=v[3])}let[f,p]=Ia(a[1]||Ye,a[2]);return mn(p,f,a[3]?+a[3]:void 0,a[4]?+a[4]:void 0)}}],dd=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,hd=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,_a=[cd,n=>{let r=dd.exec(n);if(r){if(r[3]&&r[3].indexOf(" > eval")>-1){let p=hd.exec(r[3]);p&&(r[1]=r[1]||"eval",r[3]=p[1],r[4]=p[2],r[5]="")}let u=r[3],f=r[1]||Ye;return[f,u]=Ia(f,u),mn(u,f,r[4]?+r[4]:void 0,r[5]?+r[5]:void 0)}}],pd=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:[-a-z]+):.*?):(\d+)(?::(\d+))?\)?\s*$/i,md=[ad,n=>{let r=pd.exec(n);return r?mn(r[2],r[1]||Ye,+r[3],r[4]?+r[4]:void 0):void 0}],gd=/ line (\d+).*script (?:in )?(\S+)(?:: in function (\S+))?$/i,yd=[id,n=>{let r=gd.exec(n);return r?mn(r[2],r[3]||Ye,+r[1]):void 0}],vd=/ line (\d+), column (\d+)\s*(?:in (?:<anonymous function: ([^>]+)>|([^)]+))\(.*\))? in (.*):\s*$/i,bd=[od,n=>{let r=vd.exec(n);return r?mn(r[5],r[3]||r[4]||Ye,+r[1],+r[2]):void 0}],Sa=[wa,_a],Ea=rs(...Sa),Ia=(n,r)=>{let a=n.indexOf("safari-extension")!==-1,u=n.indexOf("safari-web-extension")!==-1;return a||u?[n.indexOf("@")!==-1?n.split("@")[0]:Ye,a?`safari-extension:${r}`:`safari-web-extension:${r}`]:[n,r]},Ar=1024,wd="Breadcrumbs",ka=((n={})=>{let r={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...n};return{name:wd,setup(a){r.console&&uu(Ed(a)),r.dom&&Yf(Sd(a,r.dom)),r.xhr&&td(Id(a)),r.fetch&&hu(kd(a)),r.history&&ya(xd(a)),r.sentry&&a.on("beforeSendEvent",_d(a))}}});function _d(n){return function(a){be()===n&&vt({category:`sentry.${a.type==="transaction"?"transaction":"event"}`,event_id:a.event_id,level:a.level,message:Tt(a)},{event:a})}}function Sd(n,r){return function(u){if(be()!==n)return;let f,p,v=typeof r=="object"?r.serializeAttribute:void 0,S=typeof r=="object"&&typeof r.maxStringLength=="number"?r.maxStringLength:void 0;S&&S>Ar&&(O.warn(`\`dom.maxStringLength\` cannot exceed ${Ar}, but a value of ${S} was configured. Sentry will use ${Ar} instead.`),S=Ar),typeof v=="string"&&(v=[v]);try{let F=u.event,G=Td(F)?F.target:F;f=me(G,{keyAttrs:v,maxStringLength:S}),p=ke(G)}catch{f="<unknown>"}if(f.length===0)return;let D={category:`ui.${u.name}`,message:f};p&&(D.data={"ui.component_name":p}),vt(D,{event:u.event,name:u.name,global:u.global})}}function Ed(n){return function(a){if(be()!==n)return;let u={category:"console",data:{arguments:a.args,logger:"console"},level:Cu(a.level),message:P(a.args," ")};if(a.level==="assert")if(a.args[0]===!1)u.message=`Assertion failed: ${P(a.args.slice(1)," ")||"console.assert"}`,u.data.arguments=a.args.slice(1);else return;vt(u,{input:a.args,level:a.level})}}function Id(n){return function(a){if(be()!==n)return;let{startTimestamp:u,endTimestamp:f}=a,p=a.xhr[jn];if(!u||!f||!p)return;let{method:v,url:S,status_code:D,body:F}=p,G={method:v,url:S,status_code:D},z={xhr:a.xhr,input:F,startTimestamp:u,endTimestamp:f};vt({category:"xhr",data:G,type:"http"},z)}}function kd(n){return function(a){if(be()!==n)return;let{startTimestamp:u,endTimestamp:f}=a;if(f&&!(a.fetchData.url.match(/sentry_key/)&&a.fetchData.method==="POST"))if(a.error){let p=a.fetchData,v={data:a.error,input:a.args,startTimestamp:u,endTimestamp:f};vt({category:"fetch",data:p,level:"error",type:"http"},v)}else{let p=a.response,v={...a.fetchData,status_code:p&&p.status},S={input:a.args,response:p,startTimestamp:u,endTimestamp:f};vt({category:"fetch",data:v,type:"http"},S)}}}function xd(n){return function(a){if(be()!==n)return;let u=a.from,f=a.to,p=Ci(ce.location.href),v=u?Ci(u):void 0,S=Ci(f);(!v||!v.path)&&(v=p),p.protocol===S.protocol&&p.host===S.host&&(f=S.relative),p.protocol===v.protocol&&p.host===v.host&&(u=v.relative),vt({category:"navigation",data:{from:u,to:f}})}}function Td(n){return!!n&&!!n.target}let Cd=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],Pd="BrowserApiErrors",xa=((n={})=>{let r={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...n};return{name:Pd,setupOnce(){r.setTimeout&&le(ce,"setTimeout",Ta),r.setInterval&&le(ce,"setInterval",Ta),r.requestAnimationFrame&&le(ce,"requestAnimationFrame",Ad),r.XMLHttpRequest&&"XMLHttpRequest"in ce&&le(XMLHttpRequest.prototype,"send",Dd);let a=r.eventTarget;a&&(Array.isArray(a)?a:Cd).forEach(Rd)}}});function Ta(n){return function(...r){let a=r[0];return r[0]=pn(a,{mechanism:{data:{function:xt(n)},handled:!1,type:"instrument"}}),n.apply(this,r)}}function Ad(n){return function(r){return n.apply(this,[pn(r,{mechanism:{data:{function:"requestAnimationFrame",handler:xt(n)},handled:!1,type:"instrument"}})])}}function Dd(n){return function(...r){let a=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(f=>{f in a&&typeof a[f]=="function"&&le(a,f,function(p){let v={mechanism:{data:{function:f,handler:xt(p)},handled:!1,type:"instrument"}},S=pt(p);return S&&(v.mechanism.data.handler=xt(S)),pn(p,v)})}),n.apply(this,r)}}function Rd(n){let r=ce,a=r[n]&&r[n].prototype;!a||!a.hasOwnProperty||!a.hasOwnProperty("addEventListener")||(le(a,"addEventListener",function(u){return function(f,p,v){try{typeof p.handleEvent=="function"&&(p.handleEvent=pn(p.handleEvent,{mechanism:{data:{function:"handleEvent",handler:xt(p),target:n},handled:!1,type:"instrument"}}))}catch{}return u.apply(this,[f,pn(p,{mechanism:{data:{function:"addEventListener",handler:xt(p),target:n},handled:!1,type:"instrument"}}),v])}}),le(a,"removeEventListener",function(u){return function(f,p,v){let S=p;try{let D=S&&S.Je;D&&u.call(this,f,D,v)}catch{}return u.call(this,f,S,v)}}))}let Od="GlobalHandlers",Ca=((n={})=>{let r={onerror:!0,onunhandledrejection:!0,...n};return{name:Od,setupOnce(){Error.stackTraceLimit=50},setup(a){r.onerror&&(Fd(a),Pa("onerror")),r.onunhandledrejection&&(Md(a),Pa("onunhandledrejection"))}}});function Fd(n){gu(r=>{let{stackParser:a,attachStacktrace:u}=Aa();if(be()!==n||la())return;let{msg:f,url:p,line:v,column:S,error:D}=r,F=Bd(Ui(a,D||f,void 0,u,!1),p,v,S);F.level="error",Ir(F,{originalException:D,mechanism:{handled:!1,type:"onerror"}})})}function Md(n){vu(r=>{let{stackParser:a,attachStacktrace:u}=Aa();if(be()!==n||la())return;let f=Nd(r),p=m(f)?$d(f):Ui(a,f,void 0,u,!0);p.level="error",Ir(p,{originalException:f,mechanism:{handled:!1,type:"onunhandledrejection"}})})}function Nd(n){if(m(n))return n;try{if("reason"in n)return n.reason;if("detail"in n&&"reason"in n.detail)return n.detail.reason}catch{}return n}function $d(n){return{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(n)}`}]}}}function Bd(n,r,a,u){let f=n.exception=n.exception||{},p=f.values=f.values||[],v=p[0]=p[0]||{},S=v.stacktrace=v.stacktrace||{},D=S.frames=S.frames||[],F=isNaN(parseInt(u,10))?void 0:u,G=isNaN(parseInt(a,10))?void 0:a,z=d(r)&&r.length>0?r:Ue();return D.length===0&&D.push({colno:F,filename:z,function:Ye,in_app:!0,lineno:G}),n}function Pa(n){O.log(`Global Handler attached: ${n}`)}function Aa(){let n=be();return n&&n.getOptions()||{stackParser:()=>[],attachStacktrace:!1}}let Da=()=>({name:"HttpContext",preprocessEvent(n){if(!ce.navigator&&!ce.location&&!ce.document)return;let r=n.request&&n.request.url||ce.location&&ce.location.href,{referrer:a}=ce.document||{},{userAgent:u}=ce.navigator||{},f={...n.request&&n.request.headers,...a&&{Referer:a},...u&&{"User-Agent":u}},p={...n.request,...r&&{url:r},headers:f};n.request=p}}),Ld="cause",Ud=5,jd="LinkedErrors",Ra=((n={})=>{let r=n.limit||Ud,a=n.key||Ld;return{name:jd,preprocessEvent(u,f,p){let v=p.getOptions();N(Tr,v.stackParser,v.maxValueLength,a,r,u,f)}}});function Oa(n){return[oa(),ia(),xa(),ka(),Ca(),Ra(),sa(),Da()]}function Kd(n={}){return{...{defaultIntegrations:Oa(),release:typeof __SENTRY_RELEASE__=="string"?__SENTRY_RELEASE__:ce.SENTRY_RELEASE&&ce.SENTRY_RELEASE.id?ce.SENTRY_RELEASE.id:void 0,autoSessionTracking:!0,sendClientReports:!0},...n}}function Hd(){let n=ce,r=n.chrome?"chrome":"browser",a=n[r],u=a&&a.runtime&&a.runtime.id,f=ce.location&&ce.location.href||"",p=["chrome-extension:","moz-extension:","ms-browser-extension:"],v=!!u&&ce===ce.top&&p.some(D=>f.startsWith(`${D}//`)),S=typeof n.nw<"u";return!!u&&!v&&!S}function Wd(n={}){let r=Kd(n);if(Hd()){Oe(()=>{console.error("[Sentry] You cannot run Sentry this way in a browser extension, check: https://docs.sentry.io/platforms/javascript/best-practices/browser-extensions/")});return}ss()||O.warn("No Fetch API detected. The Sentry SDK requires a Fetch API compatible environment to send events. Please add a Fetch API polyfill.");let a={...r,stackParser:au(r.stackParser||Ea),integrations:rf(r),transport:r.transport||ba},u=lf(pa,a);return r.autoSessionTracking&&Yd(),u}function Vd(n={}){if(!ce.document){O.error("Global document not defined in showReportDialog call");return}let r=Ke(),a=r.getClient(),u=a&&a.getDsn();if(!u){O.error("DSN not configured for showReportDialog call");return}if(r&&(n.user={...r.getUser(),...n.user}),!n.eventId){let S=Vs();S&&(n.eventId=S)}let f=ce.document.createElement("script");f.async=!0,f.crossOrigin="anonymous",f.src=tf(u,n),n.onLoad&&(f.onload=n.onLoad);let{onClose:p}=n;if(p){let S=D=>{if(D.data==="__sentry_reportdialog_closed__")try{p()}finally{ce.removeEventListener("message",S)}};ce.addEventListener("message",S)}let v=ce.document.head||ce.document.body;v?v.appendChild(f):O.error("Not injecting report dialog. No injection point found in HTML")}function zd(){}function Gd(n){n()}function Yd(){if(typeof ce.document>"u"){O.warn("Session tracking in non-browser environment with @sentry/browser is not supported.");return}kr({ignoreDuration:!0}),Mi(),ya(({from:n,to:r})=>{n!==void 0&&n!==r&&(kr({ignoreDuration:!0}),Mi())})}function qd(n){let r=be();r&&r.captureUserFeedback(n)}let gm={replayIntegration:"replay",replayCanvasIntegration:"replay-canvas",feedbackIntegration:"feedback",feedbackModalIntegration:"feedback-modal",feedbackScreenshotIntegration:"feedback-screenshot",captureConsoleIntegration:"captureconsole",contextLinesIntegration:"contextlines",linkedErrorsIntegration:"linkederrors",debugIntegration:"debug",dedupeIntegration:"dedupe",extraErrorDataIntegration:"extraerrordata",httpClientIntegration:"httpclient",reportingObserverIntegration:"reportingobserver",rewriteFramesIntegration:"rewriteframes",sessionTimingIntegration:"sessiontiming",browserProfilingIntegration:"browserprofiling"},ym=ce;async function Jd(n){throw new Error("Disabled due to CWS Policy requirement.")}function vm(n){}return e.BrowserClient=pa,e.SDK_VERSION=j,e.SEMANTIC_ATTRIBUTE_SENTRY_OP=Cs,e.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN=Ps,e.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE=Ts,e.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE=xs,e.Scope=yt,e.WINDOW=ce,e.addBreadcrumb=vt,e.addEventProcessor=Jl,e.addIntegration=sf,e.breadcrumbsIntegration=ka,e.browserApiErrorsIntegration=xa,e.browserTracingIntegration=Mf,e.captureEvent=Ir,e.captureException=Bs,e.captureMessage=zl,e.captureSession=Mi,e.captureUserFeedback=qd,e.chromeStackLineParser=wa,e.close=Yl,e.continueTrace=Cl,e.createTransport=ea,e.createUserFeedbackEnvelope=ha,e.dedupeIntegration=sa,e.defaultStackLineParsers=Sa,e.defaultStackParser=Ea,e.endSession=Ln,e.eventFromException=fa,e.eventFromMessage=da,e.exceptionFromError=Tr,e.feedbackAsyncIntegration=_s,e.feedbackIntegration=_s,e.flush=Gl,e.forceLoad=zd,e.functionToStringIntegration=ia,e.geckoStackLineParser=_a,e.getClient=be,e.getCurrentHub=Of,e.getCurrentScope=Ke,e.getDefaultIntegrations=Oa,e.getGlobalScope=ks,e.getIsolationScope=qe,e.globalHandlersIntegration=Ca,e.httpContextIntegration=Da,e.inboundFiltersIntegration=oa,e.init=Wd,e.isInitialized=ql,e.lastEventId=Vs,e.lazyLoadIntegration=Jd,e.linkedErrorsIntegration=Ra,e.makeFetchTransport=ba,e.metrics=Nf,e.onLoad=Gd,e.opera10StackLineParser=yd,e.opera11StackLineParser=bd,e.parameterize=df,e.replayIntegration=Zu,e.setContext=Ls,e.setCurrentClient=Zs,e.setExtra=js,e.setExtras=Us,e.setTag=Hs,e.setTags=Ks,e.setUser=Ws,e.showReportDialog=Vd,e.spanToBaggageHeader=El,e.spanToJSON=$n,e.spanToTraceHeader=yl,e.startSession=kr,e.winjsStackLineParser=md,e.withIsolationScope=ll,e.withScope=Er,e})({});var Wi,Hn,Ma,Na,$a,Qd,Wn,Me,Ne,$e,Be,Vi,zi,Or,Gi,Ba,La,bt,Fr;bt=function(e,t){var i,o;return i=(e&65535)+(t&65535),o=(e>>16)+(t>>16)+(i>>16),o<<16|i&65535};Ma=function(e,t){return e<<t|e>>>32-t};Wn=function(e,t,i,o,s,c){return bt(Ma(bt(bt(t,e),bt(o,c)),s),i)};Me=function(e,t,i,o,s,c,l){return Wn(t&i|~t&o,e,t,s,c,l)};Ne=function(e,t,i,o,s,c,l){return Wn(t&o|i&~o,e,t,s,c,l)};$e=function(e,t,i,o,s,c,l){return Wn(t^i^o,e,t,s,c,l)};Be=function(e,t,i,o,s,c,l){return Wn(i^(t|~o),e,t,s,c,l)};Hn=function(e,t){var i,o,s,c,l,d,h,m,g;for(e[t>>5]|=128<<t%32,e[(t+64>>>9<<4)+14]=t,l=void 0,d=void 0,h=void 0,m=void 0,g=void 0,i=1732584193,o=-271733879,s=-1732584194,c=271733878,l=0;l<e.length;)d=i,h=o,m=s,g=c,i=Me(i,o,s,c,e[l],7,-680876936),c=Me(c,i,o,s,e[l+1],12,-389564586),s=Me(s,c,i,o,e[l+2],17,606105819),o=Me(o,s,c,i,e[l+3],22,-1044525330),i=Me(i,o,s,c,e[l+4],7,-176418897),c=Me(c,i,o,s,e[l+5],12,1200080426),s=Me(s,c,i,o,e[l+6],17,-1473231341),o=Me(o,s,c,i,e[l+7],22,-45705983),i=Me(i,o,s,c,e[l+8],7,1770035416),c=Me(c,i,o,s,e[l+9],12,-1958414417),s=Me(s,c,i,o,e[l+10],17,-42063),o=Me(o,s,c,i,e[l+11],22,-1990404162),i=Me(i,o,s,c,e[l+12],7,1804603682),c=Me(c,i,o,s,e[l+13],12,-40341101),s=Me(s,c,i,o,e[l+14],17,-1502002290),o=Me(o,s,c,i,e[l+15],22,1236535329),i=Ne(i,o,s,c,e[l+1],5,-165796510),c=Ne(c,i,o,s,e[l+6],9,-1069501632),s=Ne(s,c,i,o,e[l+11],14,643717713),o=Ne(o,s,c,i,e[l],20,-373897302),i=Ne(i,o,s,c,e[l+5],5,-701558691),c=Ne(c,i,o,s,e[l+10],9,38016083),s=Ne(s,c,i,o,e[l+15],14,-660478335),o=Ne(o,s,c,i,e[l+4],20,-405537848),i=Ne(i,o,s,c,e[l+9],5,568446438),c=Ne(c,i,o,s,e[l+14],9,-1019803690),s=Ne(s,c,i,o,e[l+3],14,-187363961),o=Ne(o,s,c,i,e[l+8],20,1163531501),i=Ne(i,o,s,c,e[l+13],5,-1444681467),c=Ne(c,i,o,s,e[l+2],9,-51403784),s=Ne(s,c,i,o,e[l+7],14,1735328473),o=Ne(o,s,c,i,e[l+12],20,-1926607734),i=$e(i,o,s,c,e[l+5],4,-378558),c=$e(c,i,o,s,e[l+8],11,-2022574463),s=$e(s,c,i,o,e[l+11],16,1839030562),o=$e(o,s,c,i,e[l+14],23,-35309556),i=$e(i,o,s,c,e[l+1],4,-1530992060),c=$e(c,i,o,s,e[l+4],11,1272893353),s=$e(s,c,i,o,e[l+7],16,-155497632),o=$e(o,s,c,i,e[l+10],23,-1094730640),i=$e(i,o,s,c,e[l+13],4,681279174),c=$e(c,i,o,s,e[l],11,-358537222),s=$e(s,c,i,o,e[l+3],16,-722521979),o=$e(o,s,c,i,e[l+6],23,76029189),i=$e(i,o,s,c,e[l+9],4,-640364487),c=$e(c,i,o,s,e[l+12],11,-421815835),s=$e(s,c,i,o,e[l+15],16,530742520),o=$e(o,s,c,i,e[l+2],23,-995338651),i=Be(i,o,s,c,e[l],6,-198630844),c=Be(c,i,o,s,e[l+7],10,1126891415),s=Be(s,c,i,o,e[l+14],15,-1416354905),o=Be(o,s,c,i,e[l+5],21,-57434055),i=Be(i,o,s,c,e[l+12],6,1700485571),c=Be(c,i,o,s,e[l+3],10,-1894986606),s=Be(s,c,i,o,e[l+10],15,-1051523),o=Be(o,s,c,i,e[l+1],21,-2054922799),i=Be(i,o,s,c,e[l+8],6,1873313359),c=Be(c,i,o,s,e[l+15],10,-30611744),s=Be(s,c,i,o,e[l+6],15,-1560198380),o=Be(o,s,c,i,e[l+13],21,1309151649),i=Be(i,o,s,c,e[l+4],6,-145523070),c=Be(c,i,o,s,e[l+11],10,-1120210379),s=Be(s,c,i,o,e[l+2],15,718787259),o=Be(o,s,c,i,e[l+9],21,-343485551),i=bt(i,d),o=bt(o,h),s=bt(s,m),c=bt(c,g),l+=16;return[i,o,s,c]};Wi=function(e){var t,i,o;for(t=void 0,o="",i=e.length*32,t=0;t<i;)o+=String.fromCharCode(e[t>>5]>>>t%32&255),t+=8;return o};Or=function(e){var t,i,o;for(t=void 0,o=[],o[(e.length>>2)-1]=void 0,t=0;t<o.length;)o[t]=0,t+=1;for(i=e.length*8,t=0;t<i;)o[t>>5]|=(e.charCodeAt(t/8)&255)<<t%32,t+=8;return o};La=function(e){return Wi(Hn(Or(e),e.length*8))};Ba=function(e,t){var i,o,s,c,l;for(s=void 0,i=Or(e),c=[],l=[],o=void 0,c[15]=l[15]=void 0,i.length>16&&(i=Hn(i,e.length*8)),s=0;s<16;)c[s]=i[s]^909522486,l[s]=i[s]^1549556828,s+=1;return o=Hn(c.concat(Or(t)),512+t.length*8),Wi(Hn(l.concat(o),640))};Gi=function(e){var t,i,o,s;for(t="0123456789abcdef",o="",s=void 0,i=void 0,i=0;i<e.length;)s=e.charCodeAt(i),o+=t.charAt(s>>>4&15)+t.charAt(s&15),i+=1;return o};Fr=function(e){return unescape(encodeURIComponent(e))};zi=function(e){return La(Fr(e))};$a=function(e){return Gi(zi(e))};Vi=function(e,t){return Ba(Fr(e),Fr(t))};Na=function(e,t){return Gi(Vi(e,t))};var Zd=Qd=function(e,t,i){return t?i?Vi(t,e):Na(t,e):i?zi(e):$a(e)},Mr=Zd;var Gt=Kn,Yi=!1;var gn=(e,t)=>async(...i)=>{try{return await e(...i)}catch(o){Gt.captureException(o),console.error(o),t&&t(o)}};async function Vn(e){return(await chrome.storage.local.get(e)||{})[e]}async function eh(){let e=await Vn(R.ne);try{if(!e||(e?.lastUpdated||0)+(e?.validity||0)<Date.now()){V("Fetching sentry filter...")();let t=We().extVersionFull,i=await fetch(R.Be.replace("%VERSION%",t),{cache:"reload"});if(i.status===200){e=await i.json(),e.lastUpdated=Date.now();let o={};o[R.ne]=e,await chrome.storage.local.set(o)}}}catch{}return e||{}}function th(e,t,i){if(e.action==="deny all")return V("Error reporting is 'deny all'")(),!0;if(e.action==="filter"&&e.patterns){oe&&(i&&console.log(i),t&&console.log(t));let o=!1;for(let s of e.patterns){if(s.hash&&s.hash===t)V("Sentry filter matched hash: "+t)(),o=!0;else if(s.regex&&i){let[,c,l]=s.regex.match(/^\/(.+)\/(.*)$/)||[];o=c&&i.match(new RegExp(c,l))!==null,o&&V("Sentry filter matched regex: "+s.regex)()}if(o){let c=s.rate||1;if(Math.random()>c)return V("Sentry filter matched a rate-limited pattern with rate: "+c)(),`[x${Math.round(1/(1-c)*10)/10}]`;break}}return o}else return!1}async function nh(e){let t=await Vn(R.g),i=await Vn(R.o),o=await Vn(R.t)=="true";return e.tags={...e.tags||{}},t&&(e.tags.UUID=t),i&&(e.tags.Serial=i),e.tags.Pro=o,e}function rh(){let e=chrome.runtime.id;return!["mcbpblocgmgfnpjjppndjkmgjaogfceg","kmmldmlijnljnnhagfldmihaimmholga","pbjmgmedeliohhbaefhlplndokcbmjio","fcbmiimfkmkkkffjlopcpdlgclncnkn","fireshot-beta@getfireshot.com","{0b457cAA-602d-484a-8fe7-c1d894a011ba}","{5e11ab1e-083c-11e5-a6c0-1697f925ec7b}","com.getfireshot.fireshot.extension (83PVANDQL9)"].includes(e)}async function ih(){return chrome.runtime.id==="fireshot-beta@getfireshot.com"||chrome.runtime.id==="{0b457cAA-602d-484a-8fe7-c1d894a011ba}"?(await browser.permissions.getAll())?.data_collection?.includes("technicalAndInteraction")?"true":"false":Vn(R.Ae)}function Ua(){(self||window).nw={},Yi=!0;function e(t){function i(o){V("Reporting error...")();let s={body:o.body,method:"POST",referrerPolicy:"origin",headers:t.headers,...t.fetchOptions};return fetch(t.url,s).then(c=>({statusCode:c.status,headers:{"x-sentry-rate-limits":c.headers.get("X-Sentry-Rate-Limits"),"retry-after":c.headers.get("Retry-After")}}))}return Gt.createTransport(t,i)}Gt.init({dsn:"https://a45606e8915fe486ea11781be7653734@o4507590541901824.ingest.us.sentry.io/4507590546096128",release:"head@"+We().extVersionFull,debug:oe,autoSessionTracking:!1,transport:e,integrations:[],beforeSend:t=>ih().then(i=>i==="false"?(oe&&(V(t)(),V("Sentry is disabled")()),null):rh()?(V("Extension not recognized, skipping error report")(),null):new Promise(o=>{let s=(c,l)=>{t.breadcrumbs=[{level:c,timestamp:Date.now()/1e3,message:l},...t.breadcrumbs||[]]};try{let c,l,d=t?.exception?.values?.slice(-1).pop();if(d){let m=d.stacktrace?.frames;if(m?.length>0){let g=m.map(w=>({filename:w.filename,lineno:w.lineno,colno:w.colno,function:w.function})),y=JSON.stringify(g);c=Mr(y),s("debug",y),s("info",`FSHASH: ${c}`)}l=d.type.trim()+": "+d.value.trim()}!c&&!l&&o(t);let h=eh().then(m=>{let g=th(m,c,l);if(typeof g=="string"){let y=g;t.message&&(t.message=`${y} ${t.message}`),t.exception&&t.exception.values&&t.exception.values.forEach(w=>{w.value&&(w.value=`${y} ${w.value}`)}),g=!1}return g?null:nh(t)}).catch(m=>(s("debug",m.message+" "+m.stack),t));o(h)}catch(c){s("debug",c.message+" "+c.stack),o(t)}}))})}function Yt(e){Yi&&Gt.addBreadcrumb({message:e})}function ja(e,t){Yi&&Gt.captureMessage(e,t)}function lt(){return/^win/i.test(navigator.platform)}function Nr(){return/opr\/\d+\./i.test(navigator.appVersion)||chrome.runtime.id==="pbjmgmedeliohhbaefhlplndokcbmjio"}function $r(){return/edg\/\d+\./i.test(navigator.appVersion)||chrome.runtime.id==="fcbmiimfkmkkkffjlopcpdlgclncnknm"}function Ve(){return typeof browser<"u"&&typeof browser.runtime<"u"&&typeof browser.runtime.getBrowserInfo>"u"}function ze(){return typeof browser<"u"&&typeof browser.runtime?.getBrowserInfo=="function"}function Pt(){return Nr()?"op":$r()?"edge":Ve()?"safari":ze()?"fx":"ch"}function oh(){var e=chrome.runtime.id;if(e==="legfpnnmhhnhjgekmmbkilmijnjoehne")return Nr()?"opera":$r()?"edge":"chrome";let t=["pbjmgmedeliohhbaefhlplndokcbmjio"],i=["fireshot@getfireshot.com","fireshot-pro@getfireshot.com","fireshot-beta@getfireshot.com","{0b457cAA-602d-484a-8fe7-c1d894a011ba}","{5e11ab1e-083c-11e5-a6c0-1697f925ec7b}"],o=["fcbmiimfkmkkkffjlopcpdlgclncnknm"];return t.indexOf(e)>-1?"opera":i.indexOf(e)>-1?"firefox":o.indexOf(e)>-1?"edge":"chrome"}var sh=oh(),yn={contractId:{chrome:"com.getfireshot.api",opera:"com.getfireshot.api",edge:"com.getfireshot.api",firefox:"com.getfireshot.api.firefox"},nativeFilePath:{chrome:"fireshot-chrome-plugin.dat",opera:"fireshot-chrome-plugin.dat",edge:"fireshot-chrome-plugin.dat",firefox:"fireshot-chrome-plugin.dat"}};for(qi in yn)yn[qi]=yn[qi][sh];var qi;function ah(){chrome.scripting||(chrome.scripting={}),chrome.scripting.executeScript||(chrome.scripting.executeScript=function(e){return new Promise((t,i)=>{let o=e.target?.tabId,s=(e.target?.frameIds||[void 0])[0],c=e.target?.allFrames,l={};if(s!==void 0&&(l.frameId=s),c!==void 0&&(l.allFrames=c),!o){i(new Error("chrome.scripting.executeScript polyfill: Missing target.tabId"));return}if(e.files&&e.files.length>0){let d=[],h=m=>{if(m>=e.files.length){t(d);return}chrome.tabs.executeScript(o,{file:e.files[m],runAt:"document_start",...l},g=>{d.push(g),h(m+1)})};h(0);return}if(e.func){let d;e.args&&e.args.length>0?d=`(${e.func})(${e.args.map(h=>JSON.stringify(h)).join(",")});`:d=`(${e.func})();`,chrome.tabs.executeScript(o,{code:d}).then(t).catch(i);return}i(new Error("chrome.scripting.executeScript polyfill: No files or func provided"))})}),chrome.scripting.insertCSS||(chrome.scripting.insertCSS=function({target:e,files:t,css:i}){return new Promise((o,s)=>{if(!e||!e.tabId){s(new Error("chrome.scripting.insertCSS: target.tabId is required"));return}if(t&&t.length){let c=t.length;t.forEach(l=>{chrome.tabs.insertCSS(e.tabId,{file:l},()=>{chrome.runtime.lastError&&console.warn(chrome.runtime.lastError),--c===0&&o()})})}else i?chrome.tabs.insertCSS(e.tabId,{code:i},()=>{chrome.runtime.lastError&&console.warn(chrome.runtime.lastError),o()}):s(new Error("chrome.scripting.insertCSS: either files[] or css is required"))})})}function ch(){if(!chrome.alarms){let i=function(s){if(t.length){let c={name:s,scheduledTime:Date.now()};t.forEach(l=>l(c))}},e={},t=[],o={create(s,c={}){this.clear(s);let l=Date.now(),d,h;c.when?d=c.when-l:c.delayInMinutes&&(d=c.delayInMinutes*60*1e3),c.periodInMinutes&&(h=c.periodInMinutes*60*1e3),d<0&&(d=0);function m(){i(s),h&&(e[s].id=setTimeout(m,h))}let g=d>0?d:h;g>0?e[s]={id:setTimeout(m,g),period:h}:console.error("Error in setting alarm, none of delay or period specified")},clear(s,c=l=>{}){e[s]?(clearTimeout(e[s].id),delete e[s],c(!0)):c(!1)},clearAll(s=c=>{}){Object.keys(e).forEach(c=>clearTimeout(e[c].id));for(let c in e)delete e[c];s(!0)},get(s,c=l=>{}){e[s]?c({name:s,scheduledTime:Date.now()}):c(void 0)},getAll(s=c=>{}){let c=Object.keys(e).map(l=>({name:l,scheduledTime:Date.now()}));s(c)},onAlarm:{addListener(s){t.push(s)},removeListener(s){let c=t.indexOf(s);c>=0&&t.splice(c,1)}}};chrome.alarms=o}}function uh(){if(!chrome.action){let e={setBadgeBackgroundColor:t=>{browser.browserAction.setBadgeBackgroundColor(t)},setBadgeTextColor:(t,i)=>{Ve()?i&&i():browser.browserAction.setBadgeTextColor(t).then(i)},setBadgeText:(t,i)=>{chrome.browserAction.setBadgeText(t,i)},setIcon:(t,i)=>{chrome.browserAction.setIcon(t,i)}};chrome.action=e}}ze()&&(window.chrome=window.browser);ah();ch();uh();var Ji="alarmUpdateToken",Ur=360,Qi=30,Ka="b2s=",Te=Object.freeze({success:0,networkError:1,rejectedByServer:2,invalidResponse:3,noValidExistingToken:4,tokenInactive:5});function Ha(e){for(let t in Te)if(Te[t]===e)return t;return"unknown status"}function Wa(){return Lr(JSON.stringify({UA:navigator.userAgent,rid:new Date().getTime(),hwid:ut.getOption(R.He,""),extver:chrome.runtime.getManifest().version}))}var Xi=class{async Jt(){V("Checking token activation")();let t=Z(R.D),i=Z(R.o);t&&i&&await this.Xe(to(t,i),i)}async he(t,i,o){await this.U();let s=await this.Qe(t,i,Kn);if(s.result)return Br("setToken",{data:await qt()}),zn(),s;if(s?.code==="104"&&!o)try{let[,c]=s.message.match(/\[\d+\]\s*(.+)$/);return ie(R.ue,c),ie(R.le,i),await this.he(c,i,!0)}catch(c){return{result:!1,message:c.message}}else return{result:!1,message:s.message}}async Xe(t,i){return await this.Ze(t,i)?await this.he(t,i):(V("Activation is not required")(),{result:!0})}#i=!1;async et(t){if(this.#i){V("Token update already in progress.")();return}this.#i=!0,await gn(async()=>{await this.tt(Kn),Br("setToken",{data:await qt()}),zn(),t&&t(!0)})(),this.#i=!1}async j(){await chrome.alarms.create(Ji,{periodInMinutes:Qi})}async Xt(){await qt()?await chrome.alarms.get(Ji)||(V("Scheduling token update alarm")(),await this.j()):(V("No token found, not scheduling update timer")(),this.O())}async O(){V("Disabling token update timer")(),await chrome.alarms.clear(Ji)}async U(){V("Removing token from the storage")(),await chrome.storage.local.set({[R.u]:""}),await this.O()}async pe(t,i,o){let s=h=>h.user&&h.serial?`${Lr(h.user)}/${Lr(h.serial)}`:h.sid?h.sid:null,c=async h=>{let m;try{m=await fetch(h,{signal:AbortSignal.timeout(1e4),credentials:"include",method:"get",headers:{"X-FS-DATA":Wa()}})}catch(y){return y.message||"Network error occurred while fetching the response"}if(!m.ok)return`Network error: ${m.status} ${m.statusText}`;let g;try{g=await m.json(),V("Received response: "+JSON.stringify(g))()}catch{return"Invalid response from server"}return g},d=await(async()=>{oe||(i=void 0),oe||(o=void 0);let h=i||await eo(),m=o||chrome.runtime.id,g=s(t);if(!g)return"Invalid credentials";let y=`${Zi}/activate/${g}/${h}/${btoa(m)}`,w=await c(y);if(typeof w!="object"||!w.status)return JSON.stringify(w);if(btoa(w.status)===Ka){let b=await new Jt(w.payload).me();return b===null&&(await chrome.storage.local.set({[R.u]:w.payload}),await this.j()),b}return w.message||"Unknown error"})();return d?{result:!1,code:(/\[(\d+)\]/.exec(d)||[])[1],message:d}:{result:!0}}async nt(){let t=async c=>{let l=!1;switch(c){case Te.noValidExistingToken:await this.U();break;case Te.networkError:l=!0;break;case Te.invalidResponse:l=!0;break;case Te.success:l=!0;break;case Te.tokenInactive:await this.O();break;case Te.rejectedByServer:await this.U();break}l&&await this.j()},i=async c=>{let l;try{if(l=await fetch(c,{signal:AbortSignal.timeout(1e4),method:"get",headers:{"X-FS-DATA":Wa()}}),!l.ok)return Te.networkError;let d=await l.json();return V("Received response from server: "+JSON.stringify(d))(),d}catch(d){return V("Network error while fetching update: "+d)(),Te.networkError}},s=await(async()=>{let c=await qt();if(!c)return Te.noValidExistingToken;let l,d=!1;try{l=await wt(c),d=l.f()}catch(g){return V("Error while parsing old token: "+g)(),Te.noValidExistingToken}if(!oe&&!d)return Te.tokenInactive;let h=await i(await l.rt());if(typeof h=="number")return h;if(typeof h!="object"||!h.status)return Te.invalidResponse;if(btoa(h.status)===Ka){V("Received token")();let y=await(await new Jt(h.payload)).me();return y!==null?(V("Error while parsing new token: "+y)(),Te.invalidResponse):(await chrome.storage.local.set({[R.u]:h.payload}),Te.success)}else return Te.rejectedByServer})();return V("update status: "+Ha(s))(),await t(s),s}async it(t){try{let o=(await wt(t)).ge();await fetch(`https://auth.getfireshot.com/deactivate/${o.sid}/${o.guid}/${btoa(o.eid)}`),await this.O(),V("Token successfully deactivated")()}catch{}}async Ze(t,i){if(!t||!i)return!0;let o=await wt();if(o){let s,c;try{s=o.ge(),c=o.f()}catch{return!0}if(c){if(s&&s.user===t&&s.serial===i)return!1}else return!0}return!0}async Qe(t,i,o){let s=await this.pe({user:t,serial:i});if(s.result)return s;{let c=s.code,l=s.message;return V(`Failed to activate token with user '${t}' and serial '${i}'. Code: ${c}, Message: ${l}`)(),s}}async tt(t){let i=await this.nt();return i!==Te.success?(i!==Te.networkError&&t?.captureException(`Failed to update token [${Ha(i)}]`),!1):!0}async Qt(){let t=await wt();t&&(t.ot()?(V(`Time since last token update: ${Math.round((new Date-new Date(t.E().c+"Z"))/1e3/6)/10} minutes.`)(),await this.et()):V(`Token (${t.st()} old) does not need update at this time (update period is ${Ur} minutes).`)())}async Zt(t){let i;try{i=await new Jt(t).F(!0)}catch{return}if(i&&i.f()&&i.K()&&i.ye()&&!i.M()){V("Found previous token, restoring...")();let o=i.ve();(await this.pe({sid:o})).result&&(Br("setToken",{data:await qt()}),V("... successfully restored."))}}};var Bm=new Xi;var Va=Object.freeze({active:"YWN0aXZl",past_due:"cGFzdF9kdWU=",canceled:"canceY2FuY2VsZWQled"}),Zi="https://auth.getfireshot.com",Jt=class{#i="";#e=null;constructor(t){this.#i=t}async#a(t){async function i(w){let k="object",b=typeof x,_=await crypto.subtle.digest("SHA-256",new TextEncoder().encode(k)),E=await crypto.subtle.digest("SHA-256",new TextEncoder().encode(b)),I=await crypto.subtle.importKey("raw",_,"AES-CBC",!1,["decrypt"]),C=await crypto.subtle.decrypt({name:"AES-CBC",iv:new Uint8Array(E).subarray(0,16)},I,w);return I=null,new TextDecoder("utf-8").decode(C)}function o(w){return Uint8Array.from(atob(w),k=>k.charCodeAt(0))}function s(w){return Uint8Array.from(w,k=>k.charCodeAt(0))}async function c(w,k){let _=o(`
                MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAv7UA7s/pYDrVCY4kunni                DnmdnwgAxBpfqCOEFQZMGHh6G+/FsDbuyyQntq21W5Qi42P3UrPBJqnZ7wfhVsvj                TT9Kuty1r2mn3BD7zz2owamqtGX0s7JiQ4sdjDcVYwxTXbeq5rvX2Fh4PRQfGCIU                HWK8A4/rJDOwy0PseSnB+MsRh+XorlgMNm6VYpMkW6I2fERH96N97K9rS8HkEdLO                Y6mKYy5m41y1xttGhFxHRJkfbMlK0dqvkOI7RT0dRltnnb1x96HSabUok+A7+2fu                G3Pzb0lbVKKDuRsBIk2VExvMAW49JLy9Qi3y3iOgQQ/fmeLcv5JWe6YQQ3kyZP2O                iY01PF3V3UxH0yI5c6+13VENabHmfE1GAGSRikdZc7w5P3iuTJ+KxPLnrOFm1swl                ga23qG4rnZ1+b768dAUhWA1JRcpEaW4NKigb6x0vveaI09eTdNXHgnYtmMUx7Ubg                xeIdVtWXoJdrJ6tKMTrbaSUmJAur5lFhhdHd2RmJuT8SIIzWyGNroP5KxB+uOaPz                cltBajATKRSzwgSB6HP1rKADTRrNgVZQhIQJqJg2GoQQ0R5ijKdIOm95eraKnEeC                OvTlhVV+NHwo/QsoSBlMmpnFAS+S9AwiqH46xM0We1w9nlpEdb3ZcCVqm1NIK0Ta                3SbTHMwiWFh52R0DpU+AxiECAwEAAQ==`.replace(/\s/g,"")),E={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}},I=await crypto.subtle.importKey("spki",_,E,!0,["verify"]);return await crypto.subtle.verify("RSASSA-PKCS1-v1_5",I,k,w)}let l=o(this.#i),d;try{d=await i(l)}catch(w){throw"Invalid token format: "+w}let h=JSON.parse(d);if(!h||!h.data||!h.signature)throw"Token misses data or signature";let m;try{m=await c(s(h.data),o(h.signature))}catch(w){throw"Error while checking signature: "+w}if(!m)throw"Signature is wrong";let g=JSON.parse(h.data),y=await eo();if(!t&&g.guid!==y)throw"This token belongs to another extension guid.";if(!t&&g.eid!==chrome.runtime.id)throw"This token belongs to another extension.";return g}async F(t){try{return this.#e=await this.#a(t),this}catch{return null}}rt(){return`${Zi}/update/${this.#e.sid}/${this.#e.guid}/${btoa(this.#e.eid)}`}at(){return this.#e.status}en(){return this.#e.owner}tn(){return this.#e.plan}K(){return typeof this.#e.enabled<"u"?this.#e.enabled:!0}st(){let t=(new Date-new Date(this.E().c+"Z"))/1e3/60/60;return`${Math.floor(t)}h:${Math.floor((t-Math.floor(t))*60)}m`}ot(){return this.M()?!0:new Date-new Date(this.E().c+"Z")>Ur*60*1e3}be(){let t=new Date-new Date(this.E().c+"Z");return t>(Ur+Qi*4)*60*1e3?(V(`Token update expired: ${Math.round(t/1e3/60/6)/10} hours ago`)(),!0):!1}M(){let t=new Date-new Date(this.E().e+"Z");return t>0?(V(`Subscription expired: ${Math.round(t/1e3/60/6)/10} hours ago`)(),!0):!1}we(){return this.K()&&(!this.f()||this.M()&&this.be())}nn(){return this.#e.cap||1}ye(){return this.ve().substring(0,4)==="sub_"}ve(){return this.#e.sid}f(){let t=this.at();if(!t)return!1;let i=btoa(t);return i===Va.active||i===Va.past_due}ge(){return this.#e}E(){return{c:this.#e.c,s:this.#e.s,e:this.#e.e}}async me(){try{return await this.#a(),null}catch(t){return t}}};async function eo(){return(await chrome.storage.local.get(R.g))[R.g]||""}async function qt(){return(await chrome.storage.local.get(R.u))[R.u]}async function wt(e){try{return await new Jt(e||await qt()).F()}catch{return null}}var Gn=chrome.runtime.id,oe=chrome.runtime.getManifest()?.version_name==="debug"||["legfpnnmhhnhjgekmmbkilmijnjoehne","fireshot-beta@getfireshot.com","kmmldmlijnljnnhagfldmihaimmholga"].indexOf(Gn)>-1;chrome.storage.local.get([R.X]).then(e=>oe=oe||e[R.X]);var lh=console.log.bind(console);V("Extension ID: "+Gn)();function fh(e){oe&&console.log(`${e} not implemented yet.`)}function dh(){return Z(R.re)==="true"||Z(R.re)==="1"}function hh(){return self.constructor.name==="ServiceWorkerGlobalScope"}function ph(){let e=Z(R._,"false")==="true";return hh()&&e&&!Yn.port?(ie(R._,"false"),!1):e}function jr(){return dh()?!1:ph()}function We(){let e=chrome.runtime.getManifest();return{extVersion:e.version.split(".",3).join("."),extVersionFull:e.version.split(".",4).join("."),fSilentMode:Gn=="legfpnnmhhnhjgekmmbkilmijnjoehne"}}function za(e){V("openURLV2")();let i=(o,s=0)=>{s>0&&V(`trial ${s}`)();let c=()=>{++s<10?setTimeout(()=>i(o,s),150):chrome.windows.create({url:e}).catch(l=>reportError(l))};try{chrome.tabs.create(o).catch(()=>c())}catch{c()}};i({url:e})}function bn(e,t){if(V("openURL")(),!t)return chrome.tabs.create({url:e});chrome.tabs.create({url:e},i=>{let o=(s,c)=>{if(s===i.id)switch(c.status){case"complete":chrome.tabs.onUpdated.removeListener(o),t(i);break}};chrome.tabs.onUpdated.addListener(o),setTimeout(()=>chrome.tabs.onUpdated.removeListener(o),1e4)})}function Ae(){return(...e)=>{if(e.length!==0)if(oe&&console.log.bind(console,...e)(),e.length>1)Yt(JSON.stringify(e).substring(0,512));else{let t=typeof e[0]=="string"?e[0]:JSON.stringify(e);Yt(t.substring(0,512))}}}function V(...e){let t=()=>{};if(e.length===0)return t;if(e.length>1)Yt(JSON.stringify(e).substring(0,512));else{let i=typeof e[0]=="string"?e[0]:JSON.stringify(e);Yt(i.substring(0,512))}return oe?lh.bind(console,...e):t}function ot(e){oe&&console.time(e)}function st(e){oe&&console.timeEnd(e)}function Xt(e){console.error("FireShot: "+e)}function Ga(){let e=document.createNodeIterator(document.documentElement,NodeFilter.SHOW_ELEMENT,null),t;for(;t=e.nextNode();)[{i18Attr:"data-i18n",originalAttr:"innerText"},{i18Attr:"data-title-i18n",originalAttr:"title"}].forEach(o=>{let s;if(s=t.getAttribute(o.i18Attr)){let c=chrome.i18n.getMessage(s);c?t[o.originalAttr]=c:t[o.originalAttr]=(oe?"#":"")+t[o.originalAttr],oe||t.removeAttribute(o.i18Attr)}})}function At(e,t,i,o,s){fh("gaTrack")}function vn(e,t,i){for(e=e.toString();e.length<i;)e=t+e;return e}function Ya(e,t,i=Z(R.m,2)-1){let o=Z(R.P,100),s=0,c;do{c=Z(R.b,R.fe);let l=new Date,d=e,h=t,m="not available";try{m=new URL(d).hostname}catch{}c=c.replace(/%n/g,Z(R.T,"true")==="true"?vn(i,0,Z(R.C,3)):i),c=c.replace(/%y/g,l.getFullYear()),c=c.replace(/%m/g,vn(l.getMonth()+1,0,2)),c=c.replace(/%d/g,vn(l.getDate(),0,2)),c=c.replace(/%H/g,vn(l.getHours(),0,2)),c=c.replace(/%M/g,vn(l.getMinutes(),0,2)),c=c.replace(/%S/g,vn(l.getSeconds(),0,2)),c=c.replace(/%U/g,l.toLocaleString("en-US",{hour:"numeric",minute:"numeric",second:"numeric",hour12:!0})),c=c.replace(/%A/g,l.toLocaleDateString(navigator.language,{weekday:"long"})),c=c.replace(/%B/g,l.toLocaleDateString(navigator.language,{month:"long"})),s==1?d=d.substr(0,Math.max(14,o-c.length+1)):s==2?(d=d.replace(/(.*)\?.*/gi,"$1"),c=c.replace(/%u/g,d),h=h.substr(0,Math.max(14,o-c.length+1))+"_"):s==3&&(d=d.substr(0,(o-c.length)/2-1),c=c.replace(/%u/g,d),h=h.substr(0,o-c.length-1)+"_"),c=c.replace(/%u/g,d),c=c.replace(/%t/g,h),c=c.replace(/%e/g,m),c=c.replace(/[:/\\*?<>|"]/g,function(g){switch(g){case"<":return"{";case">":return"}";case"|":return"-"}return"_"})}while(++s<4&&c.length>o);return c===""&&(c="Untitled"),c}function ft(){return jr()?Z(R.t)=="true":(!lt()||Z(R.S)==="true")&&Z(R.t)=="true"}async function zn(){let e=()=>{if(new Date>new Date(2026,1,15)&&!jr()){let t,i=Z(R.D,""),o=Z(R.o,"");i!==""&&o!==""&&(i=to(i,o),t=mh(i,o)),ie(R.t,t?"true":""),ie(R.i,t?"true":"")}};try{let t=await wt();if(t.K())if(ie(R.S,"true"),t.ye()){let i=t.f(),o=t.M(),s=t.be();V(`Token is active: ${i}, expired: ${o}, update expired: ${s}, blocked: ${o&&s}`)();let l=!t.we();ie(R.t,l.toString()),ie(R.i,l.toString())}else ie(R.t,t.f().toString()),ie(R.i,t.f().toString());else e()}catch{Z(R.S)==="true"?(ie(R.S,""),ie(R.t,""),ie(R.i,""),ie(R.D,""),ie(R.o,"")):e()}}function no(){return Z(R.i)==="true"}function qa(e,t,i){Ve()||ze()?t():chrome.permissions.contains(e,o=>{o?t():chrome.permissions.request(e,s=>{!chrome.runtime.lastError||console.log(chrome.runtime.lastError),s?t():(V("The user rejected to grant permissions.")(),i&&i())})})}function Ja(e,t){qa({permissions:["downloads"]},e,t)}function Xa(){return new Promise(e=>qa({origins:["https://mail.google.com/*"]},()=>e(!0),()=>e(!1)))}function Qa(e){let t=e.match(/,(.{100})/);if(t&&t.length>0){let i=Uint8Array.from(atob(t[1]),o=>o.charCodeAt(0));return{w:i[18]<<8|i[19],h:i[22]<<8|i[23]}}else return{w:0,h:0}}function ro(e){let t;return(...i)=>{t&&cancelAnimationFrame(t),t=requestAnimationFrame(()=>{e(...i)})}}function Za(e=0){return new Promise(t=>{setTimeout(t,e)})}function to(e,t){let i=Z(R.le,""),o=Z(R.ue,"");return i&&o&&i===t&&(e=o),e}function Lr(e){return btoa(String.fromCharCode(...new TextEncoder().encode(e)))}function mh(e,t){let i=h=>{for(var m="",g=0;g<h.length;g++){var y=h[g].toString(16);y.length<2&&(y="0"+y),m+=y}return m},o=h=>{if(!h||h.length<1)return new Uint8Array(0);let m=[],g=h.length,y="0123456789abcdefghijklmnopqrstuvwxyz";h[0]!=="2"&&(y="23456789abcdefghjklmnpqrstuvwxyz");let w=[];for(let P=0;P<g;P++){let A=h[P].toLowerCase();for(let T=0;T<y.length;T++)if(y[T]===A){w[P]=T;break}}let k=0,b,_,E=0,I=0;for(;E<g;){b=0;let P=0;for(;b<8&&E<g;){let A=w[E];_=Math.min(5-k,8-b),k<=b?A=A<<b:A=A>>k,P=P|A,b+=_,k+=_,k>=5&&(E++,k=0)}m[I++]=P}let C=Math.floor(g*5/8);return new Uint8Array(m.slice(0,C))},s=(h,m,g,y)=>{let w=m.length;if(y===1)for(let k=0;k<g;k++){let b=k%w;h[k]=h[k]^m.charCodeAt(b)}else if(y===2){let k=0,b=0;for(let _=0;_<Math.max(g,w);_++)h[k]=h[k]^m.charCodeAt(b),k++,b++,k===g&&(k=0),b===w&&(b=0)}return h};t=t.replace(/-/g,"");let c=o(t),l=c[0]&15,d=!1;if(l===2){if((c[0]&240)>>5===1){let m=s(c.slice(1),e,c.length-1,2),g=i(m.slice(0,5));d=g===i([0,26,26,51,84])||g===i([5,27,26,57,74])}}else if(l===4&&(c[0]&240)>>5===1){let m="FS";for(let b=13;b>=10;--b)m+=i(c.slice(b,b+1));m=m.toUpperCase();let g=Mr(m),y=s(c.slice(1),g,c.length-1,2),w=s(y,e,y.length,2);d=i(w.slice(0,5))===i([0,26,26,51,84])}return d}var gh=0,yh=1,Yn={port:void 0,ready:!1,autoReconnect:!1,updating:!1,updated:!1,ignoreResponse:!1,portBusy:!1,callback:void 0,callbackDisconnected:void 0,prevVersion:void 0,updateTrials:0,pendingData:"",firstPacket:!0,onNativeHostUpdated:null,onPluginEvent:null,init:function(e,t,i,o){this.onNativeHostUpdated=t,this.onPluginEvent=e;let s=c=>{if(this.ignoreResponse){V("Ignored response: "+JSON.stringify(c))(),c.topic==="status"&&c.code==yh&&(this.updating=!1,this.autoReconnect=!1,e&&e(c));return}this.autoReconnect=!1,!this.processInternally(c)&&e&&e(c)};this.callback=i,this.callbackDisconnected=o,this.ignoreResponse=!1,this.portBusy=!0;try{this.port=chrome.runtime.connectNative(yn.contractId+"")}catch(c){Xt(c.message),this.portBusy=!1}this.port.onMessage.addListener(c=>{if(c.data!=="")this.pendingData+=c.data;else try{let l=JSON.parse(this.pendingData);oe&&V("Original Packet: "+this.pendingData.substring(0,1024))(),this.pendingData="",s(l)}catch(l){V("Raw packet data triggered error:",this.pendingData.substring(0,1024))(),Gt.captureException(l),this.pendingData="",Xt(l.message)}}),this.port.onDisconnect.addListener(()=>{chrome.runtime.lastError&&console.log("ERROR: "+chrome.runtime.lastError.message),this.ready=!1,this.portBusy=!1,ie(R._,"false"),!this.updating&&this.callbackDisconnected&&this.callbackDisconnected(),V("Native port disconnected.")(),this.firstPacket=!0,this.pendingData="",this.autoReconnect&&this.doReconnect()}),V("Native port created successfully. Starting test...")(),this.launchJSON({JSONCommand:"ping",version:We().extVersionFull,id:Gn})},processInternally:function(e){if(e.topic=="hostVersion"){if(this.hostVersion=e.data,We().extVersion!=this.hostVersion)return++this.updateTrials>3?(V("Too much of unsuccessful update trials. No updates anymore.")(),this.updating=!1,!1):(this.prevVersion=this.hostVersion,this.doUpdate(),!0)}else if(e.topic=="status")if(e.code==gh){var t=e.data;return this.updateTrials=0,this.ready=!0,ie(R._,"true"),this.callback&&(this.callback(),this.callback=void 0),this.updating&&(this.updated=!0,this.updating=!1,this.prevVersion!="0"&&this.onNativeHostUpdated(t)),!1}else return this.updating&&(this.updating=!1),!1;else if(e.topic=="getDLL")return this.sendDLL(e.x64),!0;return!1},launchJSON:function(e){this.port.postMessage(e)},getFile:function(e,t){let i=()=>{let o=!0;if(e.search(/sss-x64\.dat|sss\.dat|fireshot-chrome-plugin\.dat/)!==-1){let s=We().extVersionFull,c=R.$e+s,l=parseInt(ut.getOption(c,"0"));l<3?(V("Opening helper installer page.")(),o=!1,ut.setOption(c,l+1),za("https://getfireshot.com/helper-install.php?ver="+s)):V("Helper installer page cannot be shown more than 3 times, aborting.")()}return o};V("Fetching: "+e)(),fetch(chrome.runtime.getURL(e)).then(o=>{V(`Fetching status = [${o.status}]`)(),o.ok?o.blob().then(s=>{V(`Blob size is ${s.size} bytes`)();let c=new FileReader;c.onload=l=>{V("Fetching complete")();let d="base64,";t(l.target.result.substr(l.target.result.indexOf(d)+d.length,l.target.result.length))},c.onerror=()=>{V("Error in FileReader")()},c.readAsDataURL(s)}).catch(s=>{i()&&reportError(s)}):(V("NativeError-Error retrieving file")(),ja(`Error retrieving file: ${o.status}`))}).catch(o=>{i()&&reportError(o)})},sendDLL:function(e){this.getFile(`native/${e?"sss-x64.dat":"sss.dat"}`,t=>{t&&this.launchJSON({JSONCommand:"updateDLL",version:We().extVersionFull,data:t})})},doUpdate:function(){let e=We().extVersionFull;V("Updating native to the version: "+e)(),this.ignoreResponse=!0,this.getFile("native/"+yn.nativeFilePath,t=>{this.updating=!0,this.autoReconnect=!0,this.launchJSON({JSONCommand:"updateNative",version:e,data:t})})},doReconnect:function(){setTimeout(()=>{V("Trying to reconnect...")(),this.init(this.onPluginEvent,this.onNativeHostUpdated,this.callback,this.callbackDisconnected)},1e3)},forceDisconnect:function(){this.autoReconnect=!1,this.port&&this.port.disconnect(),this.ready=!1,ie(R._,"false")}};async function qn(e,t){V(`Sending ${e.topic}`)();let i=150*1024*1024;if(e.topic!=="saveFile"||e.data.length<i)browser.runtime.sendNativeMessage("application.id",e,o=>{V("Response from native App:")(),V(o)(),t&&t(o)});else{let o={};for(let s in e)s!="data"&&(o[s]=e[s]);V("Sending saveFile in async mode...")(),browser.runtime.sendNativeMessage("application.id",o,async s=>{V("Response from native App:")(),V(s)();let c=l=>new Promise(d=>browser.runtime.sendNativeMessage("application.id",l,d));if(s.success==="true"){let l=s.fileId,d=e.data,h=0,m;for(;h<d.length;){let g=d.substring(h,h+i);if(h+=i,m=await c({topic:"writeBlock",fileId:l,data:g}),V(`Written ${g.length} bytes, result:`)(),V(m)(),m.success!=="true")break}m.success==="true"&&(m=await c({topic:"writeBlock",fileId:l,openFolder:e.openFolder})),V("Signaling to finish. result:")(),V(m)(),t&&t(m)}else t&&t(s)})}}var po=function(e,t){return po=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(i[s]=o[s])},po(e,t)};function vh(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");po(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}var te=function(){return te=Object.assign||function(t){for(var i,o=1,s=arguments.length;o<s;o++){i=arguments[o];for(var c in i)Object.prototype.hasOwnProperty.call(i,c)&&(t[c]=i[c])}return t},te.apply(this,arguments)};function ti(e,t,i){if(i||arguments.length===2)for(var o=0,s=t.length,c;o<s;o++)(c||!(o in t))&&(c||(c=Array.prototype.slice.call(t,0,o)),c[o]=t[o]);return e.concat(c||Array.prototype.slice.call(t))}var Le=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Re=Object.keys,_e=Array.isArray;typeof Promise<"u"&&!Le.Promise&&(Le.Promise=Promise);function nt(e,t){return typeof t!="object"||Re(t).forEach(function(i){e[i]=t[i]}),e}var kn=Object.getPrototypeOf,bh={}.hasOwnProperty;function Ze(e,t){return bh.call(e,t)}function xn(e,t){typeof t=="function"&&(t=t(kn(e))),(typeof Reflect>"u"?Re:Reflect.ownKeys)(t).forEach(function(i){Mt(e,i,t[i])})}var yc=Object.defineProperty;function Mt(e,t,i,o){yc(e,t,nt(i&&Ze(i,"get")&&typeof i.get=="function"?{get:i.get,set:i.set,configurable:!0}:{value:i,configurable:!0,writable:!0},o))}function Cn(e){return{from:function(t){return e.prototype=Object.create(t.prototype),Mt(e.prototype,"constructor",e),{extend:xn.bind(null,e.prototype)}}}}var wh=Object.getOwnPropertyDescriptor;function vc(e,t){var i=wh(e,t),o;return i||(o=kn(e))&&vc(o,t)}var _h=[].slice;function hi(e,t,i){return _h.call(e,t,i)}function bc(e,t){return t(e)}function Jn(e){if(!e)throw new Error("Assertion Failed")}function wc(e){Le.setImmediate?setImmediate(e):setTimeout(e,0)}function Sh(e,t){return e.reduce(function(i,o,s){var c=t(o,s);return c&&(i[c[0]]=c[1]),i},{})}function Et(e,t){if(typeof t=="string"&&Ze(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var i=[],o=0,s=t.length;o<s;++o){var c=Et(e,t[o]);i.push(c)}return i}var l=t.indexOf(".");if(l!==-1){var d=e[t.substr(0,l)];return d==null?void 0:Et(d,t.substr(l+1))}}function Qe(e,t,i){if(!(!e||t===void 0)&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){Jn(typeof i!="string"&&"length"in i);for(var o=0,s=t.length;o<s;++o)Qe(e,t[o],i[o])}else{var c=t.indexOf(".");if(c!==-1){var l=t.substr(0,c),d=t.substr(c+1);if(d==="")i===void 0?_e(e)&&!isNaN(parseInt(l))?e.splice(l,1):delete e[l]:e[l]=i;else{var h=e[l];(!h||!Ze(e,l))&&(h=e[l]={}),Qe(h,d,i)}}else i===void 0?_e(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=i}}function Eh(e,t){typeof t=="string"?Qe(e,t,void 0):"length"in t&&[].map.call(t,function(i){Qe(e,i,void 0)})}function _c(e){var t={};for(var i in e)Ze(e,i)&&(t[i]=e[i]);return t}var Ih=[].concat;function Sc(e){return Ih.apply([],e)}var kh="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Sc([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return Le[e]}),Ec=new Set(kh.map(function(e){return Le[e]}));function Ic(e){var t={};for(var i in e)if(Ze(e,i)){var o=e[i];t[i]=!o||typeof o!="object"||Ec.has(o.constructor)?o:Ic(o)}return t}function xh(e){for(var t in e)if(Ze(e,t))return!1;return!0}var Qn=null;function sn(e){Qn=new WeakMap;var t=mo(e);return Qn=null,t}function mo(e){if(!e||typeof e!="object")return e;var t=Qn.get(e);if(t)return t;if(_e(e)){t=[],Qn.set(e,t);for(var i=0,o=e.length;i<o;++i)t.push(mo(e[i]))}else if(Ec.has(e.constructor))t=e;else{var s=kn(e);t=s===Object.prototype?{}:Object.create(s),Qn.set(e,t);for(var c in e)Ze(e,c)&&(t[c]=mo(e[c]))}return t}var Th={}.toString;function go(e){return Th.call(e).slice(8,-1)}var yo=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Ch=typeof yo=="symbol"?function(e){var t;return e!=null&&(t=e[yo])&&t.apply(e)}:function(){return null};function Qt(e,t){var i=e.indexOf(t);return i>=0&&e.splice(i,1),i>=0}var Sn={};function St(e){var t,i,o,s;if(arguments.length===1){if(_e(e))return e.slice();if(this===Sn&&typeof e=="string")return[e];if(s=Ch(e)){for(i=[];o=s.next(),!o.done;)i.push(o.value);return i}if(e==null)return[e];if(t=e.length,typeof t=="number"){for(i=new Array(t);t--;)i[t]=e[t];return i}return[e]}for(t=arguments.length,i=new Array(t);t--;)i[t]=arguments[t];return i}var Do=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Ph=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],kc=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Ro=Ph.concat(kc),Ah={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Pn(e,t){this.name=e,this.message=t}Cn(Pn).from(Error).extend({toString:function(){return this.name+": "+this.message}});function xc(e,t){return e+". Errors: "+Object.keys(t).map(function(i){return t[i].toString()}).filter(function(i,o,s){return s.indexOf(i)===o}).join(`
`)}function ni(e,t,i,o){this.failures=t,this.failedKeys=o,this.successCount=i,this.message=xc(e,t)}Cn(ni).from(Pn);function En(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(i){return t[i]}),this.failuresByPos=t,this.message=xc(e,this.failures)}Cn(En).from(Pn);var Oo=Ro.reduce(function(e,t){return e[t]=t+"Error",e},{}),Dh=Pn,Q=Ro.reduce(function(e,t){var i=t+"Error";function o(s,c){this.name=i,s?typeof s=="string"?(this.message="".concat(s).concat(c?`
 `+c:""),this.inner=c||null):typeof s=="object"&&(this.message="".concat(s.name," ").concat(s.message),this.inner=s):(this.message=Ah[t]||i,this.inner=null)}return Cn(o).from(Dh),e[t]=o,e},{});Q.Syntax=SyntaxError;Q.Type=TypeError;Q.Range=RangeError;var ec=kc.reduce(function(e,t){return e[t+"Error"]=Q[t],e},{});function Rh(e,t){if(!e||e instanceof Pn||e instanceof TypeError||e instanceof SyntaxError||!e.name||!ec[e.name])return e;var i=new ec[e.name](t||e.message,e);return"stack"in e&&Mt(i,"stack",{get:function(){return this.inner.stack}}),i}var pi=Ro.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=Q[t]),e},{});pi.ModifyError=ni;pi.DexieError=Pn;pi.BulkError=En;function ye(){}function or(e){return e}function Oh(e,t){return e==null||e===or?t:function(i){return t(e(i))}}function an(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function Fh(e,t){return e===ye?t:function(){var i=e.apply(this,arguments);i!==void 0&&(arguments[0]=i);var o=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var c=t.apply(this,arguments);return o&&(this.onsuccess=this.onsuccess?an(o,this.onsuccess):o),s&&(this.onerror=this.onerror?an(s,this.onerror):s),c!==void 0?c:i}}function Mh(e,t){return e===ye?t:function(){e.apply(this,arguments);var i=this.onsuccess,o=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),i&&(this.onsuccess=this.onsuccess?an(i,this.onsuccess):i),o&&(this.onerror=this.onerror?an(o,this.onerror):o)}}function Nh(e,t){return e===ye?t:function(i){var o=e.apply(this,arguments);nt(i,o);var s=this.onsuccess,c=this.onerror;this.onsuccess=null,this.onerror=null;var l=t.apply(this,arguments);return s&&(this.onsuccess=this.onsuccess?an(s,this.onsuccess):s),c&&(this.onerror=this.onerror?an(c,this.onerror):c),o===void 0?l===void 0?void 0:l:nt(o,l)}}function $h(e,t){return e===ye?t:function(){return t.apply(this,arguments)===!1?!1:e.apply(this,arguments)}}function Fo(e,t){return e===ye?t:function(){var i=e.apply(this,arguments);if(i&&typeof i.then=="function"){for(var o=this,s=arguments.length,c=new Array(s);s--;)c[s]=arguments[s];return i.then(function(){return t.apply(o,c)})}return t.apply(this,arguments)}}var ht=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Tc(e,t){ht=e}var er={},Cc=100,Mo=typeof Promise>"u"?[]:(function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,kn(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,kn(t),e]})(),tc=Mo[0],nc=Mo[1],Bh=Mo[2],Lh=nc&&nc.then,Zt=tc&&tc.constructor,No=!!Bh;function Uh(){queueMicrotask(Kh)}var tr=function(e,t){Xn.push([e,t]),ri&&(Uh(),ri=!1)},vo=!0,ri=!0,nn=[],Yr=[],bo=or,Ft={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ye,pgp:!1,env:{},finalize:ye},X=Ft,Xn=[],rn=0,qr=[];function W(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=X;if(typeof e!="function"){if(e!==er)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&_o(this,this._value);return}this._state=null,this._value=null,++t.ref,Ac(this,e)}var wo={get:function(){var e=X,t=ii;function i(o,s){var c=this,l=!e.global&&(e!==X||t!==ii),d=l&&!$t(),h=new W(function(m,g){$o(c,new Pc(rc(o,e,l,d),rc(s,e,l,d),m,g,e))});return this._consoleTask&&(h._consoleTask=this._consoleTask),h}return i.prototype=er,i},set:function(e){Mt(this,"then",e&&e.prototype===er?wo:{get:function(){return e},set:wo.set})}};xn(W.prototype,{then:wo,_then:function(e,t){$o(this,new Pc(null,null,e,t,X))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=arguments[0],i=arguments[1];return typeof t=="function"?this.then(null,function(o){return o instanceof t?i(o):Jr(o)}):this.then(null,function(o){return o&&o.name===t?i(o):Jr(o)})},finally:function(e){return this.then(function(t){return W.resolve(e()).then(function(){return t})},function(t){return W.resolve(e()).then(function(){return Jr(t)})})},timeout:function(e,t){var i=this;return e<1/0?new W(function(o,s){var c=setTimeout(function(){return s(new Q.Timeout(t))},e);i.then(o,s).finally(clearTimeout.bind(null,c))}):this}});typeof Symbol<"u"&&Symbol.toStringTag&&Mt(W.prototype,Symbol.toStringTag,"Dexie.Promise");Ft.env=Rc();function Pc(e,t,i,o,s){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=i,this.reject=o,this.psd=s}xn(W,{all:function(){var e=St.apply(null,arguments).map(oi);return new W(function(t,i){e.length===0&&t([]);var o=e.length;e.forEach(function(s,c){return W.resolve(s).then(function(l){e[c]=l,--o||t(e)},i)})})},resolve:function(e){if(e instanceof W)return e;if(e&&typeof e.then=="function")return new W(function(i,o){e.then(i,o)});var t=new W(er,!0,e);return t},reject:Jr,race:function(){var e=St.apply(null,arguments).map(oi);return new W(function(t,i){e.map(function(o){return W.resolve(o).then(t,i)})})},PSD:{get:function(){return X},set:function(e){return X=e}},totalEchoes:{get:function(){return ii}},newPSD:Nt,usePSD:cn,scheduler:{get:function(){return tr},set:function(e){tr=e}},rejectionMapper:{get:function(){return bo},set:function(e){bo=e}},follow:function(e,t){return new W(function(i,o){return Nt(function(s,c){var l=X;l.unhandleds=[],l.onunhandled=c,l.finalize=an(function(){var d=this;Hh(function(){d.unhandleds.length===0?s():c(d.unhandleds[0])})},l.finalize),e()},t,i,o)})}});Zt&&(Zt.allSettled&&Mt(W,"allSettled",function(){var e=St.apply(null,arguments).map(oi);return new W(function(t){e.length===0&&t([]);var i=e.length,o=new Array(i);e.forEach(function(s,c){return W.resolve(s).then(function(l){return o[c]={status:"fulfilled",value:l}},function(l){return o[c]={status:"rejected",reason:l}}).then(function(){return--i||t(o)})})})}),Zt.any&&typeof AggregateError<"u"&&Mt(W,"any",function(){var e=St.apply(null,arguments).map(oi);return new W(function(t,i){e.length===0&&i(new AggregateError([]));var o=e.length,s=new Array(o);e.forEach(function(c,l){return W.resolve(c).then(function(d){return t(d)},function(d){s[l]=d,--o||i(new AggregateError(s))})})})}),Zt.withResolvers&&(W.withResolvers=Zt.withResolvers));function Ac(e,t){try{t(function(i){if(e._state===null){if(i===e)throw new TypeError("A promise cannot be resolved with itself.");var o=e._lib&&An();i&&typeof i.then=="function"?Ac(e,function(s,c){i instanceof W?i._then(s,c):i.then(s,c)}):(e._state=!0,e._value=i,Dc(e)),o&&Dn()}},_o.bind(null,e))}catch(i){_o(e,i)}}function _o(e,t){if(Yr.push(t),e._state===null){var i=e._lib&&An();t=bo(t),e._state=!1,e._value=t,Wh(e),Dc(e),i&&Dn()}}function Dc(e){var t=e._listeners;e._listeners=[];for(var i=0,o=t.length;i<o;++i)$o(e,t[i]);var s=e._PSD;--s.ref||s.finalize(),rn===0&&(++rn,tr(function(){--rn===0&&Bo()},[]))}function $o(e,t){if(e._state===null){e._listeners.push(t);return}var i=e._state?t.onFulfilled:t.onRejected;if(i===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++rn,tr(jh,[i,e,t])}function jh(e,t,i){try{var o,s=t._value;!t._state&&Yr.length&&(Yr=[]),o=ht&&t._consoleTask?t._consoleTask.run(function(){return e(s)}):e(s),!t._state&&Yr.indexOf(s)===-1&&Vh(t),i.resolve(o)}catch(c){i.reject(c)}finally{--rn===0&&Bo(),--i.psd.ref||i.psd.finalize()}}function Kh(){cn(Ft,function(){An()&&Dn()})}function An(){var e=vo;return vo=!1,ri=!1,e}function Dn(){var e,t,i;do for(;Xn.length>0;)for(e=Xn,Xn=[],i=e.length,t=0;t<i;++t){var o=e[t];o[0].apply(null,o[1])}while(Xn.length>0);vo=!0,ri=!0}function Bo(){var e=nn;nn=[],e.forEach(function(o){o._PSD.onunhandled.call(null,o._value,o)});for(var t=qr.slice(0),i=t.length;i;)t[--i]()}function Hh(e){function t(){e(),qr.splice(qr.indexOf(t),1)}qr.push(t),++rn,tr(function(){--rn===0&&Bo()},[])}function Wh(e){nn.some(function(t){return t._value===e._value})||nn.push(e)}function Vh(e){for(var t=nn.length;t;)if(nn[--t]._value===e._value){nn.splice(t,1);return}}function Jr(e){return new W(er,!1,e)}function we(e,t){var i=X;return function(){var o=An(),s=X;try{return Bt(i,!0),e.apply(this,arguments)}catch(c){t&&t(c)}finally{Bt(s,!1),o&&Dn()}}}var De={awaits:0,echoes:0,id:0},zh=0,Xr=[],Qr=0,ii=0,Gh=0;function Nt(e,t,i,o){var s=X,c=Object.create(s);c.parent=s,c.ref=0,c.global=!1,c.id=++Gh,Ft.env,c.env=No?{Promise:W,PromiseProp:{value:W,configurable:!0,writable:!0},all:W.all,race:W.race,allSettled:W.allSettled,any:W.any,resolve:W.resolve,reject:W.reject}:{},t&&nt(c,t),++s.ref,c.finalize=function(){--this.parent.ref||this.parent.finalize()};var l=cn(c,e,i,o);return c.ref===0&&c.finalize(),l}function Rn(){return De.id||(De.id=++zh),++De.awaits,De.echoes+=Cc,De.id}function $t(){return De.awaits?(--De.awaits===0&&(De.id=0),De.echoes=De.awaits*Cc,!0):!1}(""+Lh).indexOf("[native code]")===-1&&(Rn=$t=ye);function oi(e){return De.echoes&&e&&e.constructor===Zt?(Rn(),e.then(function(t){return $t(),t},function(t){return $t(),Ie(t)})):e}function Yh(e){++ii,(!De.echoes||--De.echoes===0)&&(De.echoes=De.awaits=De.id=0),Xr.push(X),Bt(e,!0)}function qh(){var e=Xr[Xr.length-1];Xr.pop(),Bt(e,!1)}function Bt(e,t){var i=X;if((t?De.echoes&&(!Qr++||e!==X):Qr&&(!--Qr||e!==X))&&queueMicrotask(t?Yh.bind(null,e):qh),e!==X&&(X=e,i===Ft&&(Ft.env=Rc()),No)){var o=Ft.env.Promise,s=e.env;(i.global||e.global)&&(Object.defineProperty(Le,"Promise",s.PromiseProp),o.all=s.all,o.race=s.race,o.resolve=s.resolve,o.reject=s.reject,s.allSettled&&(o.allSettled=s.allSettled),s.any&&(o.any=s.any))}}function Rc(){var e=Le.Promise;return No?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(Le,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function cn(e,t,i,o,s){var c=X;try{return Bt(e,!0),t(i,o,s)}finally{Bt(c,!1)}}function rc(e,t,i,o){return typeof e!="function"?e:function(){var s=X;i&&Rn(),Bt(t,!0);try{return e.apply(this,arguments)}finally{Bt(s,!1),o&&queueMicrotask($t)}}}function io(e){Promise===Zt&&De.echoes===0?Qr===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}var Ie=W.reject;function So(e,t,i,o){if(!e.idbdb||!e._state.openComplete&&!X.letThrough&&!e._vip){if(e._state.openComplete)return Ie(new Q.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._state.autoOpen)return Ie(new Q.DatabaseClosed);e.open().catch(ye)}return e._state.dbReadyPromise.then(function(){return So(e,t,i,o)})}else{var s=e._createTransaction(t,i,e._dbSchema);try{s.create(),e._state.PR1398_maxLoop=3}catch(c){return c.name===Oo.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then(function(){return So(e,t,i,o)})):Ie(c)}return s._promise(t,function(c,l){return Nt(function(){return X.trans=s,o(c,l,s)})}).then(function(c){if(t==="readwrite")try{s.idbtrans.commit()}catch{}return t==="readonly"?c:s._completion.then(function(){return c})})}}var ic="4.2.1",tn="\uFFFF",Eo=-1/0,_t="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Oc="String expected.",In=[],mi="__dbnames",oo="readonly",so="readwrite";function un(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var Fc={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Kr(e){return typeof e=="string"&&!/\./.test(e)?function(t){return t[e]===void 0&&e in t&&(t=sn(t),delete t[e]),t}:function(t){return t}}function Jh(){throw Q.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function ue(e,t){try{var i=oc(e),o=oc(t);if(i!==o)return i==="Array"?1:o==="Array"?-1:i==="binary"?1:o==="binary"?-1:i==="string"?1:o==="string"?-1:i==="Date"?1:o!=="Date"?NaN:-1;switch(i){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return Qh(sc(e),sc(t));case"Array":return Xh(e,t)}}catch{}return NaN}function Xh(e,t){for(var i=e.length,o=t.length,s=i<o?i:o,c=0;c<s;++c){var l=ue(e[c],t[c]);if(l!==0)return l}return i===o?0:i<o?-1:1}function Qh(e,t){for(var i=e.length,o=t.length,s=i<o?i:o,c=0;c<s;++c)if(e[c]!==t[c])return e[c]<t[c]?-1:1;return i===o?0:i<o?-1:1}function oc(e){var t=typeof e;if(t!=="object")return t;if(ArrayBuffer.isView(e))return"binary";var i=go(e);return i==="ArrayBuffer"?"binary":i}function sc(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}function Zr(e,t,i){var o=e.schema.yProps;return o?(t&&i.numFailures>0&&(t=t.filter(function(s,c){return!i.failures[c]})),Promise.all(o.map(function(s){var c=s.updatesTable;return t?e.db.table(c).where("k").anyOf(t).delete():e.db.table(c).clear()})).then(function(){return i})):i}var Zh=(function(){function e(t){this["@@propmod"]=t}return e.prototype.execute=function(t){var i,o=this["@@propmod"];if(o.add!==void 0){var s=o.add;if(_e(s))return ti(ti([],_e(t)?t:[],!0),s,!0).sort();if(typeof s=="number")return(Number(t)||0)+s;if(typeof s=="bigint")try{return BigInt(t)+s}catch{return BigInt(0)+s}throw new TypeError("Invalid term ".concat(s))}if(o.remove!==void 0){var c=o.remove;if(_e(c))return _e(t)?t.filter(function(d){return!c.includes(d)}).sort():[];if(typeof c=="number")return Number(t)-c;if(typeof c=="bigint")try{return BigInt(t)-c}catch{return BigInt(0)-c}throw new TypeError("Invalid subtrahend ".concat(c))}var l=(i=o.replacePrefix)===null||i===void 0?void 0:i[0];return l&&typeof t=="string"&&t.startsWith(l)?o.replacePrefix[1]+t.substring(l.length):t},e})();function Mc(e,t){for(var i=Re(t),o=i.length,s=!1,c=0;c<o;++c){var l=i[c],d=t[l],h=Et(e,l);d instanceof Zh?(Qe(e,l,d.execute(h)),s=!0):h!==d&&(Qe(e,l,d),s=!0)}return s}var Nc=(function(){function e(){}return e.prototype._trans=function(t,i,o){var s=this._tx||X.trans,c=this.name,l=ht&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(t==="readonly"?"read":"write"," ").concat(this.name));function d(g,y,w){if(!w.schema[c])throw new Q.NotFound("Table "+c+" not part of transaction");return i(w.idbtrans,w)}var h=An();try{var m=s&&s.db._novip===this.db._novip?s===X.trans?s._promise(t,d,o):Nt(function(){return s._promise(t,d,o)},{trans:s,transless:X.transless||X}):So(this.db,t,[this.name],d);return l&&(m._consoleTask=l,m=m.catch(function(g){return console.trace(g),Ie(g)})),m}finally{h&&Dn()}},e.prototype.get=function(t,i){var o=this;return t&&t.constructor===Object?this.where(t).first(i):t==null?Ie(new Q.Type("Invalid argument to Table.get()")):this._trans("readonly",function(s){return o.core.get({trans:s,key:t}).then(function(c){return o.hook.reading.fire(c)})}).then(i)},e.prototype.where=function(t){if(typeof t=="string")return new this.db.WhereClause(this,t);if(_e(t))return new this.db.WhereClause(this,"[".concat(t.join("+"),"]"));var i=Re(t);if(i.length===1)return this.where(i[0]).equals(t[i[0]]);var o=this.schema.indexes.concat(this.schema.primKey).filter(function(g){if(g.compound&&i.every(function(w){return g.keyPath.indexOf(w)>=0})){for(var y=0;y<i.length;++y)if(i.indexOf(g.keyPath[y])===-1)return!1;return!0}return!1}).sort(function(g,y){return g.keyPath.length-y.keyPath.length})[0];if(o&&this.db._maxKey!==tn){var s=o.keyPath.slice(0,i.length);return this.where(s).equals(s.map(function(g){return t[g]}))}!o&&ht&&console.warn("The query ".concat(JSON.stringify(t)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(i.join("+"),"]"));var c=this.schema.idxByName;function l(g,y){return ue(g,y)===0}var d=i.reduce(function(g,y){var w=g[0],k=g[1],b=c[y],_=t[y];return[w||b,w||!b?un(k,b&&b.multi?function(E){var I=Et(E,y);return _e(I)&&I.some(function(C){return l(_,C)})}:function(E){return l(_,Et(E,y))}):k]},[null,null]),h=d[0],m=d[1];return h?this.where(h.name).equals(t[h.keyPath]).filter(m):o?this.filter(m):this.where(i).equals("")},e.prototype.filter=function(t){return this.toCollection().and(t)},e.prototype.count=function(t){return this.toCollection().count(t)},e.prototype.offset=function(t){return this.toCollection().offset(t)},e.prototype.limit=function(t){return this.toCollection().limit(t)},e.prototype.each=function(t){return this.toCollection().each(t)},e.prototype.toArray=function(t){return this.toCollection().toArray(t)},e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},e.prototype.orderBy=function(t){return new this.db.Collection(new this.db.WhereClause(this,_e(t)?"[".concat(t.join("+"),"]"):t))},e.prototype.reverse=function(){return this.toCollection().reverse()},e.prototype.mapToClass=function(t){var i=this,o=i.db,s=i.name;this.schema.mappedClass=t,t.prototype instanceof Jh&&(t=(function(h){vh(m,h);function m(){return h!==null&&h.apply(this,arguments)||this}return Object.defineProperty(m.prototype,"db",{get:function(){return o},enumerable:!1,configurable:!0}),m.prototype.table=function(){return s},m})(t));for(var c=new Set,l=t.prototype;l;l=kn(l))Object.getOwnPropertyNames(l).forEach(function(h){return c.add(h)});var d=function(h){if(!h)return h;var m=Object.create(t.prototype);for(var g in h)if(!c.has(g))try{m[g]=h[g]}catch{}return m};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=d,this.hook("reading",d),t},e.prototype.defineClass=function(){function t(i){nt(this,i)}return this.mapToClass(t)},e.prototype.add=function(t,i){var o=this,s=this.schema.primKey,c=s.auto,l=s.keyPath,d=t;return l&&c&&(d=Kr(l)(t)),this._trans("readwrite",function(h){return o.core.mutate({trans:h,type:"add",keys:i!=null?[i]:null,values:[d]})}).then(function(h){return h.numFailures?W.reject(h.failures[0]):h.lastResult}).then(function(h){if(l)try{Qe(t,l,h)}catch{}return h})},e.prototype.upsert=function(t,i){var o=this,s=this.schema.primKey.keyPath;return this._trans("readwrite",function(c){return o.core.get({trans:c,key:t}).then(function(l){var d=l??{};return Mc(d,i),s&&Qe(d,s,t),o.core.mutate({trans:c,type:"put",values:[d],keys:[t],upsert:!0,updates:{keys:[t],changeSpecs:[i]}}).then(function(h){return h.numFailures?W.reject(h.failures[0]):!!l})})})},e.prototype.update=function(t,i){if(typeof t=="object"&&!_e(t)){var o=Et(t,this.schema.primKey.keyPath);return o===void 0?Ie(new Q.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(o).modify(i)}else return this.where(":id").equals(t).modify(i)},e.prototype.put=function(t,i){var o=this,s=this.schema.primKey,c=s.auto,l=s.keyPath,d=t;return l&&c&&(d=Kr(l)(t)),this._trans("readwrite",function(h){return o.core.mutate({trans:h,type:"put",values:[d],keys:i!=null?[i]:null})}).then(function(h){return h.numFailures?W.reject(h.failures[0]):h.lastResult}).then(function(h){if(l)try{Qe(t,l,h)}catch{}return h})},e.prototype.delete=function(t){var i=this;return this._trans("readwrite",function(o){return i.core.mutate({trans:o,type:"delete",keys:[t]}).then(function(s){return Zr(i,[t],s)}).then(function(s){return s.numFailures?W.reject(s.failures[0]):void 0})})},e.prototype.clear=function(){var t=this;return this._trans("readwrite",function(i){return t.core.mutate({trans:i,type:"deleteRange",range:Fc}).then(function(o){return Zr(t,null,o)})}).then(function(i){return i.numFailures?W.reject(i.failures[0]):void 0})},e.prototype.bulkGet=function(t){var i=this;return this._trans("readonly",function(o){return i.core.getMany({keys:t,trans:o}).then(function(s){return s.map(function(c){return i.hook.reading.fire(c)})})})},e.prototype.bulkAdd=function(t,i,o){var s=this,c=Array.isArray(i)?i:void 0;o=o||(c?void 0:i);var l=o?o.allKeys:void 0;return this._trans("readwrite",function(d){var h=s.schema.primKey,m=h.auto,g=h.keyPath;if(g&&c)throw new Q.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(c&&c.length!==t.length)throw new Q.InvalidArgument("Arguments objects and keys must have the same length");var y=t.length,w=g&&m?t.map(Kr(g)):t;return s.core.mutate({trans:d,type:"add",keys:c,values:w,wantResults:l}).then(function(k){var b=k.numFailures,_=k.results,E=k.lastResult,I=k.failures,C=l?_:E;if(b===0)return C;throw new En("".concat(s.name,".bulkAdd(): ").concat(b," of ").concat(y," operations failed"),I)})})},e.prototype.bulkPut=function(t,i,o){var s=this,c=Array.isArray(i)?i:void 0;o=o||(c?void 0:i);var l=o?o.allKeys:void 0;return this._trans("readwrite",function(d){var h=s.schema.primKey,m=h.auto,g=h.keyPath;if(g&&c)throw new Q.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(c&&c.length!==t.length)throw new Q.InvalidArgument("Arguments objects and keys must have the same length");var y=t.length,w=g&&m?t.map(Kr(g)):t;return s.core.mutate({trans:d,type:"put",keys:c,values:w,wantResults:l}).then(function(k){var b=k.numFailures,_=k.results,E=k.lastResult,I=k.failures,C=l?_:E;if(b===0)return C;throw new En("".concat(s.name,".bulkPut(): ").concat(b," of ").concat(y," operations failed"),I)})})},e.prototype.bulkUpdate=function(t){var i=this,o=this.core,s=t.map(function(d){return d.key}),c=t.map(function(d){return d.changes}),l=[];return this._trans("readwrite",function(d){return o.getMany({trans:d,keys:s,cache:"clone"}).then(function(h){var m=[],g=[];t.forEach(function(w,k){var b=w.key,_=w.changes,E=h[k];if(E){for(var I=0,C=Object.keys(_);I<C.length;I++){var P=C[I],A=_[P];if(P===i.schema.primKey.keyPath){if(ue(A,b)!==0)throw new Q.Constraint("Cannot update primary key in bulkUpdate()")}else Qe(E,P,A)}l.push(k),m.push(b),g.push(E)}});var y=m.length;return o.mutate({trans:d,type:"put",keys:m,values:g,updates:{keys:s,changeSpecs:c}}).then(function(w){var k=w.numFailures,b=w.failures;if(k===0)return y;for(var _=0,E=Object.keys(b);_<E.length;_++){var I=E[_],C=l[Number(I)];if(C!=null){var P=b[I];delete b[I],b[C]=P}}throw new En("".concat(i.name,".bulkUpdate(): ").concat(k," of ").concat(y," operations failed"),b)})})})},e.prototype.bulkDelete=function(t){var i=this,o=t.length;return this._trans("readwrite",function(s){return i.core.mutate({trans:s,type:"delete",keys:t}).then(function(c){return Zr(i,t,c)})}).then(function(s){var c=s.numFailures,l=s.lastResult,d=s.failures;if(c===0)return l;throw new En("".concat(i.name,".bulkDelete(): ").concat(c," of ").concat(o," operations failed"),d)})},e})();function sr(e){var t={},i=function(d,h){if(h){for(var m=arguments.length,g=new Array(m-1);--m;)g[m-1]=arguments[m];return t[d].subscribe.apply(null,g),e}else if(typeof d=="string")return t[d]};i.addEventType=c;for(var o=1,s=arguments.length;o<s;++o)c(arguments[o]);return i;function c(d,h,m){if(typeof d=="object")return l(d);h||(h=$h),m||(m=ye);var g={subscribers:[],fire:m,subscribe:function(y){g.subscribers.indexOf(y)===-1&&(g.subscribers.push(y),g.fire=h(g.fire,y))},unsubscribe:function(y){g.subscribers=g.subscribers.filter(function(w){return w!==y}),g.fire=g.subscribers.reduce(h,m)}};return t[d]=i[d]=g,g}function l(d){Re(d).forEach(function(h){var m=d[h];if(_e(m))c(h,d[h][0],d[h][1]);else if(m==="asap")var g=c(h,or,function(){for(var w=arguments.length,k=new Array(w);w--;)k[w]=arguments[w];g.subscribers.forEach(function(b){wc(function(){b.apply(null,k)})})});else throw new Q.InvalidArgument("Invalid event config")})}}function ar(e,t){return Cn(t).from({prototype:e}),t}function ep(e){return ar(Nc.prototype,function(i,o,s){this.db=e,this._tx=s,this.name=i,this.schema=o,this.hook=e._allTables[i]?e._allTables[i].hook:sr(null,{creating:[Fh,ye],reading:[Oh,or],updating:[Nh,ye],deleting:[Mh,ye]})})}function wn(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function ao(e,t){e.filter=un(e.filter,t)}function co(e,t,i){var o=e.replayFilter;e.replayFilter=o?function(){return un(o(),t())}:t,e.justLimit=i&&!o}function tp(e,t){e.isMatch=un(e.isMatch,t)}function ei(e,t){if(e.isPrimKey)return t.primaryKey;var i=t.getIndexByKeyPath(e.index);if(!i)throw new Q.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return i}function ac(e,t,i){var o=ei(e,t.schema);return t.openCursor({trans:i,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:o,range:e.range}})}function Hr(e,t,i,o){var s=e.replayFilter?un(e.filter,e.replayFilter()):e.filter;if(e.or){var c={},l=function(d,h,m){if(!s||s(h,m,function(w){return h.stop(w)},function(w){return h.fail(w)})){var g=h.primaryKey,y=""+g;y==="[object ArrayBuffer]"&&(y=""+new Uint8Array(g)),Ze(c,y)||(c[y]=!0,t(d,h,m))}};return Promise.all([e.or._iterate(l,i),cc(ac(e,o,i),e.algorithm,l,!e.keysOnly&&e.valueMapper)])}else return cc(ac(e,o,i),un(e.algorithm,s),t,!e.keysOnly&&e.valueMapper)}function cc(e,t,i,o){var s=o?function(l,d,h){return i(o(l),d,h)}:i,c=we(s);return e.then(function(l){if(l)return l.start(function(){var d=function(){return l.continue()};(!t||t(l,function(h){return d=h},function(h){l.stop(h),d=ye},function(h){l.fail(h),d=ye}))&&c(l.value,l,function(h){return d=h}),d()})})}var np=(function(){function e(){}return e.prototype._read=function(t,i){var o=this._ctx;return o.error?o.table._trans(null,Ie.bind(null,o.error)):o.table._trans("readonly",t).then(i)},e.prototype._write=function(t){var i=this._ctx;return i.error?i.table._trans(null,Ie.bind(null,i.error)):i.table._trans("readwrite",t,"locked")},e.prototype._addAlgorithm=function(t){var i=this._ctx;i.algorithm=un(i.algorithm,t)},e.prototype._iterate=function(t,i){return Hr(this._ctx,t,i,this._ctx.table.core)},e.prototype.clone=function(t){var i=Object.create(this.constructor.prototype),o=Object.create(this._ctx);return t&&nt(o,t),i._ctx=o,i},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(t){var i=this._ctx;return this._read(function(o){return Hr(i,t,o,i.table.core)})},e.prototype.count=function(t){var i=this;return this._read(function(o){var s=i._ctx,c=s.table.core;if(wn(s,!0))return c.count({trans:o,query:{index:ei(s,c.schema),range:s.range}}).then(function(d){return Math.min(d,s.limit)});var l=0;return Hr(s,function(){return++l,!1},o,c).then(function(){return l})}).then(t)},e.prototype.sortBy=function(t,i){var o=t.split(".").reverse(),s=o[0],c=o.length-1;function l(m,g){return g?l(m[o[g]],g-1):m[s]}var d=this._ctx.dir==="next"?1:-1;function h(m,g){var y=l(m,c),w=l(g,c);return ue(y,w)*d}return this.toArray(function(m){return m.sort(h)}).then(i)},e.prototype.toArray=function(t){var i=this;return this._read(function(o){var s=i._ctx;if(s.dir==="next"&&wn(s,!0)&&s.limit>0){var c=s.valueMapper,l=ei(s,s.table.core.schema);return s.table.core.query({trans:o,limit:s.limit,values:!0,query:{index:l,range:s.range}}).then(function(h){var m=h.result;return c?m.map(c):m})}else{var d=[];return Hr(s,function(h){return d.push(h)},o,s.table.core).then(function(){return d})}},t)},e.prototype.offset=function(t){var i=this._ctx;return t<=0?this:(i.offset+=t,wn(i)?co(i,function(){var o=t;return function(s,c){return o===0?!0:o===1?(--o,!1):(c(function(){s.advance(o),o=0}),!1)}}):co(i,function(){var o=t;return function(){return--o<0}}),this)},e.prototype.limit=function(t){return this._ctx.limit=Math.min(this._ctx.limit,t),co(this._ctx,function(){var i=t;return function(o,s,c){return--i<=0&&s(c),i>=0}},!0),this},e.prototype.until=function(t,i){return ao(this._ctx,function(o,s,c){return t(o.value)?(s(c),i):!0}),this},e.prototype.first=function(t){return this.limit(1).toArray(function(i){return i[0]}).then(t)},e.prototype.last=function(t){return this.reverse().first(t)},e.prototype.filter=function(t){return ao(this._ctx,function(i){return t(i.value)}),tp(this._ctx,t),this},e.prototype.and=function(t){return this.filter(t)},e.prototype.or=function(t){return new this.db.WhereClause(this._ctx.table,t,this)},e.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(t){var i=this._ctx;return i.keysOnly=!i.isMatch,this.each(function(o,s){t(s.key,s)})},e.prototype.eachUniqueKey=function(t){return this._ctx.unique="unique",this.eachKey(t)},e.prototype.eachPrimaryKey=function(t){var i=this._ctx;return i.keysOnly=!i.isMatch,this.each(function(o,s){t(s.primaryKey,s)})},e.prototype.keys=function(t){var i=this._ctx;i.keysOnly=!i.isMatch;var o=[];return this.each(function(s,c){o.push(c.key)}).then(function(){return o}).then(t)},e.prototype.primaryKeys=function(t){var i=this._ctx;if(i.dir==="next"&&wn(i,!0)&&i.limit>0)return this._read(function(s){var c=ei(i,i.table.core.schema);return i.table.core.query({trans:s,values:!1,limit:i.limit,query:{index:c,range:i.range}})}).then(function(s){var c=s.result;return c}).then(t);i.keysOnly=!i.isMatch;var o=[];return this.each(function(s,c){o.push(c.primaryKey)}).then(function(){return o}).then(t)},e.prototype.uniqueKeys=function(t){return this._ctx.unique="unique",this.keys(t)},e.prototype.firstKey=function(t){return this.limit(1).keys(function(i){return i[0]}).then(t)},e.prototype.lastKey=function(t){return this.reverse().firstKey(t)},e.prototype.distinct=function(){var t=this._ctx,i=t.index&&t.table.schema.idxByName[t.index];if(!i||!i.multi)return this;var o={};return ao(this._ctx,function(s){var c=s.primaryKey.toString(),l=Ze(o,c);return o[c]=!0,!l}),this},e.prototype.modify=function(t){var i=this,o=this._ctx;return this._write(function(s){var c;typeof t=="function"?c=t:c=function(I){return Mc(I,t)};var l=o.table.core,d=l.schema.primaryKey,h=d.outbound,m=d.extractKey,g=200,y=i.db._options.modifyChunkSize;y&&(typeof y=="object"?g=y[l.name]||y["*"]||200:g=y);var w=[],k=0,b=[],_=function(I,C){var P=C.failures,A=C.numFailures;k+=I-A;for(var T=0,N=Re(P);T<N.length;T++){var K=N[T];w.push(P[K])}},E=t===uc;return i.clone().primaryKeys().then(function(I){var C=wn(o)&&o.limit===1/0&&(typeof t!="function"||E)&&{index:o.index,range:o.range},P=function(A){var T=Math.min(g,I.length-A),N=I.slice(A,A+T);return(E?Promise.resolve([]):l.getMany({trans:s,keys:N,cache:"immutable"})).then(function(K){var M=[],q=[],ee=h?[]:null,j=E?N:[];if(!E)for(var L=0;L<T;++L){var Y=K[L],ne={value:sn(Y),primKey:I[A+L]};c.call(ne,ne.value,ne)!==!1&&(ne.value==null?j.push(I[A+L]):!h&&ue(m(Y),m(ne.value))!==0?(j.push(I[A+L]),M.push(ne.value)):(q.push(ne.value),h&&ee.push(I[A+L])))}return Promise.resolve(M.length>0&&l.mutate({trans:s,type:"add",values:M}).then(function(J){for(var me in J.failures)j.splice(parseInt(me),1);_(M.length,J)})).then(function(){return(q.length>0||C&&typeof t=="object")&&l.mutate({trans:s,type:"put",keys:ee,values:q,criteria:C,changeSpec:typeof t!="function"&&t,isAdditionalChunk:A>0}).then(function(J){return _(q.length,J)})}).then(function(){return(j.length>0||C&&E)&&l.mutate({trans:s,type:"delete",keys:j,criteria:C,isAdditionalChunk:A>0}).then(function(J){return Zr(o.table,j,J)}).then(function(J){return _(j.length,J)})}).then(function(){return I.length>A+T&&P(A+g)})})};return P(0).then(function(){if(w.length>0)throw new ni("Error modifying one or more objects",w,k,b);return I.length})})})},e.prototype.delete=function(){var t=this._ctx,i=t.range;return wn(t)&&!t.table.schema.yProps&&(t.isPrimKey||i.type===3)?this._write(function(o){var s=t.table.core.schema.primaryKey,c=i;return t.table.core.count({trans:o,query:{index:s,range:c}}).then(function(l){return t.table.core.mutate({trans:o,type:"deleteRange",range:c}).then(function(d){var h=d.failures,m=d.numFailures;if(m)throw new ni("Could not delete some values",Object.keys(h).map(function(g){return h[g]}),l-m);return l-m})})}):this.modify(uc)},e})(),uc=function(e,t){return t.value=null};function rp(e){return ar(np.prototype,function(i,o){this.db=e;var s=Fc,c=null;if(o)try{s=o()}catch(m){c=m}var l=i._ctx,d=l.table,h=d.hook.reading.fire;this._ctx={table:d,index:l.index,isPrimKey:!l.index||d.schema.primKey.keyPath&&l.index===d.schema.primKey.name,range:s,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:c,or:l.or,valueMapper:h!==or?h:null}})}function ip(e,t){return e<t?-1:e===t?0:1}function op(e,t){return e>t?-1:e===t?0:1}function tt(e,t,i){var o=e instanceof Bc?new e.Collection(e):e;return o._ctx.error=i?new i(t):new TypeError(t),o}function _n(e){return new e.Collection(e,function(){return $c("")}).limit(0)}function sp(e){return e==="next"?function(t){return t.toUpperCase()}:function(t){return t.toLowerCase()}}function ap(e){return e==="next"?function(t){return t.toLowerCase()}:function(t){return t.toUpperCase()}}function cp(e,t,i,o,s,c){for(var l=Math.min(e.length,o.length),d=-1,h=0;h<l;++h){var m=t[h];if(m!==o[h])return s(e[h],i[h])<0?e.substr(0,h)+i[h]+i.substr(h+1):s(e[h],o[h])<0?e.substr(0,h)+o[h]+i.substr(h+1):d>=0?e.substr(0,d)+t[d]+i.substr(d+1):null;s(e[h],m)<0&&(d=h)}return l<o.length&&c==="next"?e+i.substr(e.length):l<e.length&&c==="prev"?e.substr(0,i.length):d<0?null:e.substr(0,d)+o[d]+i.substr(d+1)}function Wr(e,t,i,o){var s,c,l,d,h,m,g,y=i.length;if(!i.every(function(_){return typeof _=="string"}))return tt(e,Oc);function w(_){s=sp(_),c=ap(_),l=_==="next"?ip:op;var E=i.map(function(I){return{lower:c(I),upper:s(I)}}).sort(function(I,C){return l(I.lower,C.lower)});d=E.map(function(I){return I.upper}),h=E.map(function(I){return I.lower}),m=_,g=_==="next"?"":o}w("next");var k=new e.Collection(e,function(){return Dt(d[0],h[y-1]+o)});k._ondirectionchange=function(_){w(_)};var b=0;return k._addAlgorithm(function(_,E,I){var C=_.key;if(typeof C!="string")return!1;var P=c(C);if(t(P,h,b))return!0;for(var A=null,T=b;T<y;++T){var N=cp(C,P,d[T],h[T],l,m);N===null&&A===null?b=T+1:(A===null||l(A,N)>0)&&(A=N)}return E(A!==null?function(){_.continue(A+g)}:I),!1}),k}function Dt(e,t,i,o){return{type:2,lower:e,upper:t,lowerOpen:i,upperOpen:o}}function $c(e){return{type:1,lower:e,upper:e}}var Bc=(function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),e.prototype.between=function(t,i,o,s){o=o!==!1,s=s===!0;try{return this._cmp(t,i)>0||this._cmp(t,i)===0&&(o||s)&&!(o&&s)?_n(this):new this.Collection(this,function(){return Dt(t,i,!o,!s)})}catch{return tt(this,_t)}},e.prototype.equals=function(t){return t==null?tt(this,_t):new this.Collection(this,function(){return $c(t)})},e.prototype.above=function(t){return t==null?tt(this,_t):new this.Collection(this,function(){return Dt(t,void 0,!0)})},e.prototype.aboveOrEqual=function(t){return t==null?tt(this,_t):new this.Collection(this,function(){return Dt(t,void 0,!1)})},e.prototype.below=function(t){return t==null?tt(this,_t):new this.Collection(this,function(){return Dt(void 0,t,!1,!0)})},e.prototype.belowOrEqual=function(t){return t==null?tt(this,_t):new this.Collection(this,function(){return Dt(void 0,t)})},e.prototype.startsWith=function(t){return typeof t!="string"?tt(this,Oc):this.between(t,t+tn,!0,!0)},e.prototype.startsWithIgnoreCase=function(t){return t===""?this.startsWith(t):Wr(this,function(i,o){return i.indexOf(o[0])===0},[t],tn)},e.prototype.equalsIgnoreCase=function(t){return Wr(this,function(i,o){return i===o[0]},[t],"")},e.prototype.anyOfIgnoreCase=function(){var t=St.apply(Sn,arguments);return t.length===0?_n(this):Wr(this,function(i,o){return o.indexOf(i)!==-1},t,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var t=St.apply(Sn,arguments);return t.length===0?_n(this):Wr(this,function(i,o){return o.some(function(s){return i.indexOf(s)===0})},t,tn)},e.prototype.anyOf=function(){var t=this,i=St.apply(Sn,arguments),o=this._cmp;try{i.sort(o)}catch{return tt(this,_t)}if(i.length===0)return _n(this);var s=new this.Collection(this,function(){return Dt(i[0],i[i.length-1])});s._ondirectionchange=function(l){o=l==="next"?t._ascending:t._descending,i.sort(o)};var c=0;return s._addAlgorithm(function(l,d,h){for(var m=l.key;o(m,i[c])>0;)if(++c,c===i.length)return d(h),!1;return o(m,i[c])===0?!0:(d(function(){l.continue(i[c])}),!1)}),s},e.prototype.notEqual=function(t){return this.inAnyRange([[Eo,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var t=St.apply(Sn,arguments);if(t.length===0)return new this.Collection(this);try{t.sort(this._ascending)}catch{return tt(this,_t)}var i=t.reduce(function(o,s){return o?o.concat([[o[o.length-1][1],s]]):[[Eo,s]]},null);return i.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(i,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(t,i){var o=this,s=this._cmp,c=this._ascending,l=this._descending,d=this._min,h=this._max;if(t.length===0)return _n(this);if(!t.every(function(T){return T[0]!==void 0&&T[1]!==void 0&&c(T[0],T[1])<=0}))return tt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Q.InvalidArgument);var m=!i||i.includeLowers!==!1,g=i&&i.includeUppers===!0;function y(T,N){for(var K=0,M=T.length;K<M;++K){var q=T[K];if(s(N[0],q[1])<0&&s(N[1],q[0])>0){q[0]=d(q[0],N[0]),q[1]=h(q[1],N[1]);break}}return K===M&&T.push(N),T}var w=c;function k(T,N){return w(T[0],N[0])}var b;try{b=t.reduce(y,[]),b.sort(k)}catch{return tt(this,_t)}var _=0,E=g?function(T){return c(T,b[_][1])>0}:function(T){return c(T,b[_][1])>=0},I=m?function(T){return l(T,b[_][0])>0}:function(T){return l(T,b[_][0])>=0};function C(T){return!E(T)&&!I(T)}var P=E,A=new this.Collection(this,function(){return Dt(b[0][0],b[b.length-1][1],!m,!g)});return A._ondirectionchange=function(T){T==="next"?(P=E,w=c):(P=I,w=l),b.sort(k)},A._addAlgorithm(function(T,N,K){for(var M=T.key;P(M);)if(++_,_===b.length)return N(K),!1;return C(M)?!0:(o._cmp(M,b[_][1])===0||o._cmp(M,b[_][0])===0||N(function(){w===c?T.continue(b[_][0]):T.continue(b[_][1])}),!1)}),A},e.prototype.startsWithAnyOf=function(){var t=St.apply(Sn,arguments);return t.every(function(i){return typeof i=="string"})?t.length===0?_n(this):this.inAnyRange(t.map(function(i){return[i,i+tn]})):tt(this,"startsWithAnyOf() only works with strings")},e})();function up(e){return ar(Bc.prototype,function(i,o,s){if(this.db=e,this._ctx={table:i,index:o===":id"?null:o,or:s},this._cmp=this._ascending=ue,this._descending=function(c,l){return ue(l,c)},this._max=function(c,l){return ue(c,l)>0?c:l},this._min=function(c,l){return ue(c,l)<0?c:l},this._IDBKeyRange=e._deps.IDBKeyRange,!this._IDBKeyRange)throw new Q.MissingAPI})}function dt(e){return we(function(t){return nr(t),e(t.target.error),!1})}function nr(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var cr="storagemutated",Io="x-storagemutated-1",Lt=sr(null,cr),lp=(function(){function e(){}return e.prototype._lock=function(){return Jn(!X.global),++this._reculock,this._reculock===1&&!X.global&&(X.lockOwnerFor=this),this},e.prototype._unlock=function(){if(Jn(!X.global),--this._reculock===0)for(X.global||(X.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{cn(t[1],t[0])}catch{}}return this},e.prototype._locked=function(){return this._reculock&&X.lockOwnerFor!==this},e.prototype.create=function(t){var i=this;if(!this.mode)return this;var o=this.db.idbdb,s=this.db._state.dbOpenError;if(Jn(!this.idbtrans),!t&&!o)switch(s&&s.name){case"DatabaseClosedError":throw new Q.DatabaseClosed(s);case"MissingAPIError":throw new Q.MissingAPI(s.message,s);default:throw new Q.OpenFailed(s)}if(!this.active)throw new Q.TransactionInactive;return Jn(this._completion._state===null),t=this.idbtrans=t||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):o.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),t.onerror=we(function(c){nr(c),i._reject(t.error)}),t.onabort=we(function(c){nr(c),i.active&&i._reject(new Q.Abort(t.error)),i.active=!1,i.on("abort").fire(c)}),t.oncomplete=we(function(){i.active=!1,i._resolve(),"mutatedParts"in t&&Lt.storagemutated.fire(t.mutatedParts)}),this},e.prototype._promise=function(t,i,o){var s=this;if(t==="readwrite"&&this.mode!=="readwrite")return Ie(new Q.ReadOnly("Transaction is readonly"));if(!this.active)return Ie(new Q.TransactionInactive);if(this._locked())return new W(function(l,d){s._blockedFuncs.push([function(){s._promise(t,i,o).then(l,d)},X])});if(o)return Nt(function(){var l=new W(function(d,h){s._lock();var m=i(d,h,s);m&&m.then&&m.then(d,h)});return l.finally(function(){return s._unlock()}),l._lib=!0,l});var c=new W(function(l,d){var h=i(l,d,s);h&&h.then&&h.then(l,d)});return c._lib=!0,c},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(t){var i=this._root(),o=W.resolve(t);if(i._waitingFor)i._waitingFor=i._waitingFor.then(function(){return o});else{i._waitingFor=o,i._waitingQueue=[];var s=i.idbtrans.objectStore(i.storeNames[0]);(function l(){for(++i._spinCount;i._waitingQueue.length;)i._waitingQueue.shift()();i._waitingFor&&(s.get(-1/0).onsuccess=l)})()}var c=i._waitingFor;return new W(function(l,d){o.then(function(h){return i._waitingQueue.push(we(l.bind(null,h)))},function(h){return i._waitingQueue.push(we(d.bind(null,h)))}).finally(function(){i._waitingFor===c&&(i._waitingFor=null)})})},e.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Q.Abort))},e.prototype.table=function(t){var i=this._memoizedTables||(this._memoizedTables={});if(Ze(i,t))return i[t];var o=this.schema[t];if(!o)throw new Q.NotFound("Table "+t+" not part of transaction");var s=new this.db.Table(t,o,this);return s.core=this.db.core.table(t),i[t]=s,s},e})();function fp(e){return ar(lp.prototype,function(i,o,s,c,l){var d=this;i!=="readonly"&&o.forEach(function(h){var m,g=(m=s[h])===null||m===void 0?void 0:m.yProps;g&&(o=o.concat(g.map(function(y){return y.updatesTable})))}),this.db=e,this.mode=i,this.storeNames=o,this.schema=s,this.chromeTransactionDurability=c,this.idbtrans=null,this.on=sr(this,"complete","error","abort"),this.parent=l||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new W(function(h,m){d._resolve=h,d._reject=m}),this._completion.then(function(){d.active=!1,d.on.complete.fire()},function(h){var m=d.active;return d.active=!1,d.on.error.fire(h),d.parent?d.parent._reject(h):m&&d.idbtrans&&d.idbtrans.abort(),Ie(h)})})}function ko(e,t,i,o,s,c,l,d){return{name:e,keyPath:t,unique:i,multi:o,auto:s,compound:c,src:(i&&!l?"&":"")+(o?"*":"")+(s?"++":"")+Lc(t),type:d}}function Lc(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function Lo(e,t,i){return{name:e,primKey:t,indexes:i,mappedClass:null,idxByName:Sh(i,function(o){return[o.name,o]})}}function dp(e){return e.length===1?e[0]:e}var rr=function(e){try{return e.only([[]]),rr=function(){return[[]]},[[]]}catch{return rr=function(){return tn},tn}};function xo(e){return e==null?function(){}:typeof e=="string"?hp(e):function(t){return Et(t,e)}}function hp(e){var t=e.split(".");return t.length===1?function(i){return i[e]}:function(i){return Et(i,e)}}function lc(e){return[].slice.call(e)}var pp=0;function Zn(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function mp(e,t,i){function o(y,w){var k=lc(y.objectStoreNames);return{schema:{name:y.name,tables:k.map(function(b){return w.objectStore(b)}).map(function(b){var _=b.keyPath,E=b.autoIncrement,I=_e(_),C=_==null,P={},A={name:b.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:C,compound:I,keyPath:_,autoIncrement:E,unique:!0,extractKey:xo(_)},indexes:lc(b.indexNames).map(function(T){return b.index(T)}).map(function(T){var N=T.name,K=T.unique,M=T.multiEntry,q=T.keyPath,ee=_e(q),j={name:N,compound:ee,keyPath:q,unique:K,multiEntry:M,extractKey:xo(q)};return P[Zn(q)]=j,j}),getIndexByKeyPath:function(T){return P[Zn(T)]}};return P[":id"]=A.primaryKey,_!=null&&(P[Zn(_)]=A.primaryKey),A})},hasGetAll:k.length>0&&"getAll"in w.objectStore(k[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function s(y){if(y.type===3)return null;if(y.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var w=y.lower,k=y.upper,b=y.lowerOpen,_=y.upperOpen,E=w===void 0?k===void 0?null:t.upperBound(k,!!_):k===void 0?t.lowerBound(w,!!b):t.bound(w,k,!!b,!!_);return E}function c(y){var w=y.name;function k(E){var I=E.trans,C=E.type,P=E.keys,A=E.values,T=E.range;return new Promise(function(N,K){N=we(N);var M=I.objectStore(w),q=M.keyPath==null,ee=C==="put"||C==="add";if(!ee&&C!=="delete"&&C!=="deleteRange")throw new Error("Invalid operation type: "+C);var j=(P||A||{length:1}).length;if(P&&A&&P.length!==A.length)throw new Error("Given keys array must have same length as given values array.");if(j===0)return N({numFailures:0,failures:{},results:[],lastResult:void 0});var L,Y=[],ne=[],J=0,me=function(Ee){++J,nr(Ee)};if(C==="deleteRange"){if(T.type===4)return N({numFailures:J,failures:ne,results:[],lastResult:void 0});T.type===3?Y.push(L=M.clear()):Y.push(L=M.delete(s(T)))}else{var Se=ee?q?[A,P]:[A,null]:[P,null],Ue=Se[0],ke=Se[1];if(ee)for(var Ce=0;Ce<j;++Ce)Y.push(L=ke&&ke[Ce]!==void 0?M[C](Ue[Ce],ke[Ce]):M[C](Ue[Ce])),L.onerror=me;else for(var Ce=0;Ce<j;++Ce)Y.push(L=M[C](Ue[Ce])),L.onerror=me}var Ge=function(Ee){var Oe=Ee.target.result;Y.forEach(function(B,O){return B.error!=null&&(ne[O]=B.error)}),N({numFailures:J,failures:ne,results:C==="delete"?P:Y.map(function(B){return B.result}),lastResult:Oe})};L.onerror=function(Ee){me(Ee),Ge(Ee)},L.onsuccess=Ge})}function b(E){var I=E.trans,C=E.values,P=E.query,A=E.reverse,T=E.unique;return new Promise(function(N,K){N=we(N);var M=P.index,q=P.range,ee=I.objectStore(w),j=M.isPrimaryKey?ee:ee.index(M.name),L=A?T?"prevunique":"prev":T?"nextunique":"next",Y=C||!("openKeyCursor"in j)?j.openCursor(s(q),L):j.openKeyCursor(s(q),L);Y.onerror=dt(K),Y.onsuccess=we(function(ne){var J=Y.result;if(!J){N(null);return}J.___id=++pp,J.done=!1;var me=J.continue.bind(J),Se=J.continuePrimaryKey;Se&&(Se=Se.bind(J));var Ue=J.advance.bind(J),ke=function(){throw new Error("Cursor not started")},Ce=function(){throw new Error("Cursor not stopped")};J.trans=I,J.stop=J.continue=J.continuePrimaryKey=J.advance=ke,J.fail=we(K),J.next=function(){var Ge=this,Ee=1;return this.start(function(){return Ee--?Ge.continue():Ge.stop()}).then(function(){return Ge})},J.start=function(Ge){var Ee=new Promise(function(B,O){B=we(B),Y.onerror=dt(O),J.fail=O,J.stop=function(re){J.stop=J.continue=J.continuePrimaryKey=J.advance=Ce,B(re)}}),Oe=function(){if(Y.result)try{Ge()}catch(B){J.fail(B)}else J.done=!0,J.start=function(){throw new Error("Cursor behind last entry")},J.stop()};return Y.onsuccess=we(function(B){Y.onsuccess=Oe,Oe()}),J.continue=me,J.continuePrimaryKey=Se,J.advance=Ue,Oe(),Ee},N(J)},K)})}function _(E){return function(I){return new Promise(function(C,P){C=we(C);var A=I.trans,T=I.values,N=I.limit,K=I.query,M=N===1/0?void 0:N,q=K.index,ee=K.range,j=A.objectStore(w),L=q.isPrimaryKey?j:j.index(q.name),Y=s(ee);if(N===0)return C({result:[]});if(E){var ne=T?L.getAll(Y,M):L.getAllKeys(Y,M);ne.onsuccess=function(Ue){return C({result:Ue.target.result})},ne.onerror=dt(P)}else{var J=0,me=T||!("openKeyCursor"in L)?L.openCursor(Y):L.openKeyCursor(Y),Se=[];me.onsuccess=function(Ue){var ke=me.result;if(!ke)return C({result:Se});if(Se.push(T?ke.value:ke.primaryKey),++J===N)return C({result:Se});ke.continue()},me.onerror=dt(P)}})}}return{name:w,schema:y,mutate:k,getMany:function(E){var I=E.trans,C=E.keys;return new Promise(function(P,A){P=we(P);for(var T=I.objectStore(w),N=C.length,K=new Array(N),M=0,q=0,ee,j=function(J){var me=J.target;(K[me._pos]=me.result)!=null,++q===M&&P(K)},L=dt(A),Y=0;Y<N;++Y){var ne=C[Y];ne!=null&&(ee=T.get(C[Y]),ee._pos=Y,ee.onsuccess=j,ee.onerror=L,++M)}M===0&&P(K)})},get:function(E){var I=E.trans,C=E.key;return new Promise(function(P,A){P=we(P);var T=I.objectStore(w),N=T.get(C);N.onsuccess=function(K){return P(K.target.result)},N.onerror=dt(A)})},query:_(h),openCursor:b,count:function(E){var I=E.query,C=E.trans,P=I.index,A=I.range;return new Promise(function(T,N){var K=C.objectStore(w),M=P.isPrimaryKey?K:K.index(P.name),q=s(A),ee=q?M.count(q):M.count();ee.onsuccess=we(function(j){return T(j.target.result)}),ee.onerror=dt(N)})}}}var l=o(e,i),d=l.schema,h=l.hasGetAll,m=d.tables.map(function(y){return c(y)}),g={};return m.forEach(function(y){return g[y.name]=y}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(y){var w=g[y];if(!w)throw new Error("Table '".concat(y,"' not found"));return g[y]},MIN_KEY:-1/0,MAX_KEY:rr(t),schema:d}}function gp(e,t){return t.reduce(function(i,o){var s=o.create;return te(te({},i),s(i))},e)}function yp(e,t,i,o){var s=i.IDBKeyRange;i.indexedDB;var c=gp(mp(t,s,o),e.dbcore);return{dbcore:c}}function si(e,t){var i=t.db,o=yp(e._middlewares,i,e._deps,t);e.core=o.dbcore,e.tables.forEach(function(s){var c=s.name;e.core.schema.tables.some(function(l){return l.name===c})&&(s.core=e.core.table(c),e[c]instanceof e.Table&&(e[c].core=s.core))})}function ai(e,t,i,o){i.forEach(function(s){var c=o[s];t.forEach(function(l){var d=vc(l,s);(!d||"value"in d&&d.value===void 0)&&(l===e.Transaction.prototype||l instanceof e.Transaction?Mt(l,s,{get:function(){return this.table(s)},set:function(h){yc(this,s,{value:h,writable:!0,configurable:!0,enumerable:!0})}}):l[s]=new e.Table(s,c))})})}function To(e,t){t.forEach(function(i){for(var o in i)i[o]instanceof e.Table&&delete i[o]})}function vp(e,t){return e._cfg.version-t._cfg.version}function bp(e,t,i,o){var s=e._dbSchema;i.objectStoreNames.contains("$meta")&&!s.$meta&&(s.$meta=Lo("$meta",jc("")[0],[]),e._storeNames.push("$meta"));var c=e._createTransaction("readwrite",e._storeNames,s);c.create(i),c._completion.catch(o);var l=c._reject.bind(c),d=X.transless||X;Nt(function(){if(X.trans=c,X.transless=d,t===0)Re(s).forEach(function(h){jo(i,h,s[h].primKey,s[h].indexes)}),si(e,i),W.follow(function(){return e.on.populate.fire(c)}).catch(l);else return si(e,i),_p(e,c,t).then(function(h){return Sp(e,h,c,i)}).catch(l)})}function wp(e,t){Uc(e._dbSchema,t),t.db.version%10===0&&!t.objectStoreNames.contains("$meta")&&t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var i=gi(e,e.idbdb,t);ui(e,e._dbSchema,t);for(var o=Uo(i,e._dbSchema),s=function(m){if(m.change.length||m.recreate)return console.warn("Unable to patch indexes of table ".concat(m.name," because it has changes on the type of index or primary key.")),{value:void 0};var g=t.objectStore(m.name);m.add.forEach(function(y){ht&&console.debug("Dexie upgrade patch: Creating missing index ".concat(m.name,".").concat(y.src)),ci(g,y)})},c=0,l=o.change;c<l.length;c++){var d=l[c],h=s(d);if(typeof h=="object")return h.value}}function _p(e,t,i){return t.storeNames.includes("$meta")?t.table("$meta").get("version").then(function(o){return o??i}):W.resolve(i)}function Sp(e,t,i,o){var s=[],c=e._versions,l=e._dbSchema=gi(e,e.idbdb,o),d=c.filter(function(m){return m._cfg.version>=t});if(d.length===0)return W.resolve();d.forEach(function(m){s.push(function(){var g=l,y=m._cfg.dbschema;ui(e,g,o),ui(e,y,o),l=e._dbSchema=y;var w=Uo(g,y);w.add.forEach(function(C){jo(o,C[0],C[1].primKey,C[1].indexes)}),w.change.forEach(function(C){if(C.recreate)throw new Q.Upgrade("Not yet support for changing primary key");var P=o.objectStore(C.name);C.add.forEach(function(A){return ci(P,A)}),C.change.forEach(function(A){P.deleteIndex(A.name),ci(P,A)}),C.del.forEach(function(A){return P.deleteIndex(A)})});var k=m._cfg.contentUpgrade;if(k&&m._cfg.version>t){si(e,o),i._memoizedTables={};var b=_c(y);w.del.forEach(function(C){b[C]=g[C]}),To(e,[e.Transaction.prototype]),ai(e,[e.Transaction.prototype],Re(b),b),i.schema=b;var _=Do(k);_&&Rn();var E,I=W.follow(function(){if(E=k(i),E&&_){var C=$t.bind(null,null);E.then(C,C)}});return E&&typeof E.then=="function"?W.resolve(E):I.then(function(){return E})}}),s.push(function(g){var y=m._cfg.dbschema;Ep(y,g),To(e,[e.Transaction.prototype]),ai(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),i.schema=e._dbSchema}),s.push(function(g){e.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(e.idbdb.version/10)===m._cfg.version?(e.idbdb.deleteObjectStore("$meta"),delete e._dbSchema.$meta,e._storeNames=e._storeNames.filter(function(y){return y!=="$meta"})):g.objectStore("$meta").put(m._cfg.version,"version"))})});function h(){return s.length?W.resolve(s.shift()(i.idbtrans)).then(h):W.resolve()}return h().then(function(){Uc(l,o)})}function Uo(e,t){var i={del:[],add:[],change:[]},o;for(o in e)t[o]||i.del.push(o);for(o in t){var s=e[o],c=t[o];if(!s)i.add.push([o,c]);else{var l={name:o,def:c,recreate:!1,del:[],add:[],change:[]};if(""+(s.primKey.keyPath||"")!=""+(c.primKey.keyPath||"")||s.primKey.auto!==c.primKey.auto)l.recreate=!0,i.change.push(l);else{var d=s.idxByName,h=c.idxByName,m=void 0;for(m in d)h[m]||l.del.push(m);for(m in h){var g=d[m],y=h[m];g?g.src!==y.src&&l.change.push(y):l.add.push(y)}(l.del.length>0||l.add.length>0||l.change.length>0)&&i.change.push(l)}}}return i}function jo(e,t,i,o){var s=e.db.createObjectStore(t,i.keyPath?{keyPath:i.keyPath,autoIncrement:i.auto}:{autoIncrement:i.auto});return o.forEach(function(c){return ci(s,c)}),s}function Uc(e,t){Re(e).forEach(function(i){t.db.objectStoreNames.contains(i)||(ht&&console.debug("Dexie: Creating missing table",i),jo(t,i,e[i].primKey,e[i].indexes))})}function Ep(e,t){[].slice.call(t.db.objectStoreNames).forEach(function(i){return e[i]==null&&t.db.deleteObjectStore(i)})}function ci(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function gi(e,t,i){var o={},s=hi(t.objectStoreNames,0);return s.forEach(function(c){for(var l=i.objectStore(c),d=l.keyPath,h=ko(Lc(d),d||"",!0,!1,!!l.autoIncrement,d&&typeof d!="string",!0),m=[],g=0;g<l.indexNames.length;++g){var y=l.index(l.indexNames[g]);d=y.keyPath;var w=ko(y.name,d,!!y.unique,!!y.multiEntry,!1,d&&typeof d!="string",!1);m.push(w)}o[c]=Lo(c,h,m)}),o}function Ip(e,t,i){e.verno=t.version/10;var o=e._dbSchema=gi(e,t,i);e._storeNames=hi(t.objectStoreNames,0),ai(e,[e._allTables],Re(o),o)}function kp(e,t){var i=gi(e,e.idbdb,t),o=Uo(i,e._dbSchema);return!(o.add.length||o.change.some(function(s){return s.add.length||s.change.length}))}function ui(e,t,i){for(var o=i.db.objectStoreNames,s=0;s<o.length;++s){var c=o[s],l=i.objectStore(c);e._hasGetAll="getAll"in l;for(var d=0;d<l.indexNames.length;++d){var h=l.indexNames[d],m=l.index(h).keyPath,g=typeof m=="string"?m:"["+hi(m).join("+")+"]";if(t[c]){var y=t[c].idxByName[g];y&&(y.name=h,delete t[c].idxByName[g],t[c].idxByName[h]=y)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&Le.WorkerGlobalScope&&Le instanceof Le.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function jc(e){return e.split(",").map(function(t,i){var o,s=t.split(":"),c=(o=s[1])===null||o===void 0?void 0:o.trim();t=s[0].trim();var l=t.replace(/([&*]|\+\+)/g,""),d=/^\[/.test(l)?l.match(/^\[(.*)\]$/)[1].split("+"):l;return ko(l,d||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),_e(d),i===0,c)})}var xp=(function(){function e(){}return e.prototype._createTableSchema=function(t,i,o){return Lo(t,i,o)},e.prototype._parseIndexSyntax=function(t){return jc(t)},e.prototype._parseStoresSpec=function(t,i){var o=this;Re(t).forEach(function(s){if(t[s]!==null){var c=o._parseIndexSyntax(t[s]),l=c.shift();if(!l)throw new Q.Schema("Invalid schema for table "+s+": "+t[s]);if(l.unique=!0,l.multi)throw new Q.Schema("Primary key cannot be multiEntry*");c.forEach(function(h){if(h.auto)throw new Q.Schema("Only primary key can be marked as autoIncrement (++)");if(!h.keyPath)throw new Q.Schema("Index must have a name and cannot be an empty string")});var d=o._createTableSchema(s,l,c);i[s]=d}})},e.prototype.stores=function(t){var i=this.db;this._cfg.storesSource=this._cfg.storesSource?nt(this._cfg.storesSource,t):t;var o=i._versions,s={},c={};return o.forEach(function(l){nt(s,l._cfg.storesSource),c=l._cfg.dbschema={},l._parseStoresSpec(s,c)}),i._dbSchema=c,To(i,[i._allTables,i,i.Transaction.prototype]),ai(i,[i._allTables,i,i.Transaction.prototype,this._cfg.tables],Re(c),c),i._storeNames=Re(c),this},e.prototype.upgrade=function(t){return this._cfg.contentUpgrade=Fo(this._cfg.contentUpgrade||ye,t),this},e})();function Tp(e){return ar(xp.prototype,function(i){this.db=e,this._cfg={version:i,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function Ko(e,t){var i=e._dbNamesDB;return i||(i=e._dbNamesDB=new Tn(mi,{addons:[],indexedDB:e,IDBKeyRange:t}),i.version(1).stores({dbnames:"name"})),i.table("dbnames")}function Ho(e){return e&&typeof e.databases=="function"}function Cp(e){var t=e.indexedDB,i=e.IDBKeyRange;return Ho(t)?Promise.resolve(t.databases()).then(function(o){return o.map(function(s){return s.name}).filter(function(s){return s!==mi})}):Ko(t,i).toCollection().primaryKeys()}function Pp(e,t){var i=e.indexedDB,o=e.IDBKeyRange;!Ho(i)&&t!==mi&&Ko(i,o).put({name:t}).catch(ye)}function Ap(e,t){var i=e.indexedDB,o=e.IDBKeyRange;!Ho(i)&&t!==mi&&Ko(i,o).delete(t).catch(ye)}function Co(e){return Nt(function(){return X.letThrough=!0,e()})}function Dp(){var e=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!e||!indexedDB.databases)return Promise.resolve();var t;return new Promise(function(i){var o=function(){return indexedDB.databases().finally(i)};t=setInterval(o,100),o()}).finally(function(){return clearInterval(t)})}var uo;function Wo(e){return!("from"in e)}var Xe=function(e,t){if(this)nt(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0});else{var i=new Xe;return e&&"d"in e&&nt(i,e),i}};xn(Xe.prototype,(uo={add:function(e){return li(this,e),this},addKey:function(e){return ir(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(i){return ir(t,i,i)}),this},hasKey:function(e){var t=fi(this).next(e).value;return t&&ue(t.from,e)<=0&&ue(t.to,e)>=0}},uo[yo]=function(){return fi(this)},uo));function ir(e,t,i){var o=ue(t,i);if(!isNaN(o)){if(o>0)throw RangeError();if(Wo(e))return nt(e,{from:t,to:i,d:1});var s=e.l,c=e.r;if(ue(i,e.from)<0)return s?ir(s,t,i):e.l={from:t,to:i,d:1,l:null,r:null},fc(e);if(ue(t,e.to)>0)return c?ir(c,t,i):e.r={from:t,to:i,d:1,l:null,r:null},fc(e);ue(t,e.from)<0&&(e.from=t,e.l=null,e.d=c?c.d+1:1),ue(i,e.to)>0&&(e.to=i,e.r=null,e.d=e.l?e.l.d+1:1);var l=!e.r;s&&!e.l&&li(e,s),c&&l&&li(e,c)}}function li(e,t){function i(o,s){var c=s.from,l=s.to,d=s.l,h=s.r;ir(o,c,l),d&&i(o,d),h&&i(o,h)}Wo(t)||i(e,t)}function Rp(e,t){var i=fi(t),o=i.next();if(o.done)return!1;for(var s=o.value,c=fi(e),l=c.next(s.from),d=l.value;!o.done&&!l.done;){if(ue(d.from,s.to)<=0&&ue(d.to,s.from)>=0)return!0;ue(s.from,d.from)<0?s=(o=i.next(d.from)).value:d=(l=c.next(s.from)).value}return!1}function fi(e){var t=Wo(e)?null:{s:0,n:e};return{next:function(i){for(var o=arguments.length>0;t;)switch(t.s){case 0:if(t.s=1,o)for(;t.n.l&&ue(i,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!o||ue(i,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function fc(e){var t,i,o=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((i=e.l)===null||i===void 0?void 0:i.d)||0),s=o>1?"r":o<-1?"l":"";if(s){var c=s==="r"?"l":"r",l=te({},e),d=e[s];e.from=d.from,e.to=d.to,e[s]=d[s],l[s]=d[c],e[c]=l,l.d=dc(l)}e.d=dc(e)}function dc(e){var t=e.r,i=e.l;return(t?i?Math.max(t.d,i.d):t.d:i?i.d:0)+1}function yi(e,t){return Re(t).forEach(function(i){e[i]?li(e[i],t[i]):e[i]=Ic(t[i])}),e}function Vo(e,t){return e.all||t.all||Object.keys(e).some(function(i){return t[i]&&Rp(t[i],e[i])})}var on={},lo={},fo=!1;function Vr(e,t){yi(lo,e),fo||(fo=!0,setTimeout(function(){fo=!1;var i=lo;lo={},zo(i,!1)},0))}function zo(e,t){t===void 0&&(t=!1);var i=new Set;if(e.all)for(var o=0,s=Object.values(on);o<s.length;o++){var c=s[o];hc(c,e,i,t)}else for(var l in e){var d=/^idb\:\/\/(.*)\/(.*)\//.exec(l);if(d){var h=d[1],m=d[2],c=on["idb://".concat(h,"/").concat(m)];c&&hc(c,e,i,t)}}i.forEach(function(g){return g()})}function hc(e,t,i,o){for(var s=[],c=0,l=Object.entries(e.queries.query);c<l.length;c++){for(var d=l[c],h=d[0],m=d[1],g=[],y=0,w=m;y<w.length;y++){var k=w[y];Vo(t,k.obsSet)?k.subscribers.forEach(function(I){return i.add(I)}):o&&g.push(k)}o&&s.push([h,g])}if(o)for(var b=0,_=s;b<_.length;b++){var E=_[b],h=E[0],g=E[1];e.queries.query[h]=g}}function Op(e){var t=e._state,i=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?Ie(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var o=t.openCanceller,s=Math.round(e.verno*10),c=!1;function l(){if(t.openCanceller!==o)throw new Q.DatabaseClosed("db.open() was cancelled")}var d=t.dbReadyResolve,h=null,m=!1,g=function(){return new W(function(y,w){if(l(),!i)throw new Q.MissingAPI;var k=e.name,b=t.autoSchema||!s?i.open(k):i.open(k,s);if(!b)throw new Q.MissingAPI;b.onerror=dt(w),b.onblocked=we(e._fireOnBlocked),b.onupgradeneeded=we(function(_){if(h=b.transaction,t.autoSchema&&!e._options.allowEmptyDB){b.onerror=nr,h.abort(),b.result.close();var E=i.deleteDatabase(k);E.onsuccess=E.onerror=we(function(){w(new Q.NoSuchDatabase("Database ".concat(k," doesnt exist")))})}else{h.onerror=dt(w);var I=_.oldVersion>Math.pow(2,62)?0:_.oldVersion;m=I<1,e.idbdb=b.result,c&&wp(e,h),bp(e,I/10,h,w)}},w),b.onsuccess=we(function(){h=null;var _=e.idbdb=b.result,E=hi(_.objectStoreNames);if(E.length>0)try{var I=_.transaction(dp(E),"readonly");if(t.autoSchema)Ip(e,_,I);else if(ui(e,e._dbSchema,I),!kp(e,I)&&!c)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),_.close(),s=_.version+1,c=!0,y(g());si(e,I)}catch{}In.push(e),_.onversionchange=we(function(C){t.vcFired=!0,e.on("versionchange").fire(C)}),_.onclose=we(function(){e.close({disableAutoOpen:!1})}),m&&Pp(e._deps,k),y()},w)}).catch(function(y){switch(y?.name){case"UnknownError":if(t.PR1398_maxLoop>0)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),g();break;case"VersionError":if(s>0)return s=0,g();break}return W.reject(y)})};return W.race([o,(typeof navigator>"u"?W.resolve():Dp()).then(g)]).then(function(){return l(),t.onReadyBeingFired=[],W.resolve(Co(function(){return e.on.ready.fire(e.vip)})).then(function y(){if(t.onReadyBeingFired.length>0){var w=t.onReadyBeingFired.reduce(Fo,ye);return t.onReadyBeingFired=[],W.resolve(Co(function(){return w(e.vip)})).then(y)}})}).finally(function(){t.openCanceller===o&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(y){t.dbOpenError=y;try{h&&h.abort()}catch{}return o===t.openCanceller&&e._close(),Ie(y)}).finally(function(){t.openComplete=!0,d()}).then(function(){if(m){var y={};e.tables.forEach(function(w){w.schema.indexes.forEach(function(k){k.name&&(y["idb://".concat(e.name,"/").concat(w.name,"/").concat(k.name)]=new Xe(-1/0,[[[]]]))}),y["idb://".concat(e.name,"/").concat(w.name,"/")]=y["idb://".concat(e.name,"/").concat(w.name,"/:dels")]=new Xe(-1/0,[[[]]])}),Lt(cr).fire(y),zo(y,!0)}return e})}function Po(e){var t=function(l){return e.next(l)},i=function(l){return e.throw(l)},o=c(t),s=c(i);function c(l){return function(d){var h=l(d),m=h.value;return h.done?m:!m||typeof m.then!="function"?_e(m)?Promise.all(m).then(o,s):o(m):m.then(o,s)}}return c(t)()}function Fp(e,t,i){var o=arguments.length;if(o<2)throw new Q.InvalidArgument("Too few arguments");for(var s=new Array(o-1);--o;)s[o-1]=arguments[o];i=s.pop();var c=Sc(s);return[e,c,i]}function Kc(e,t,i,o,s){return W.resolve().then(function(){var c=X.transless||X,l=e._createTransaction(t,i,e._dbSchema,o);l.explicit=!0;var d={trans:l,transless:c};if(o)l.idbtrans=o.idbtrans;else try{l.create(),l.idbtrans._explicit=!0,e._state.PR1398_maxLoop=3}catch(y){return y.name===Oo.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then(function(){return Kc(e,t,i,null,s)})):Ie(y)}var h=Do(s);h&&Rn();var m,g=W.follow(function(){if(m=s.call(l,l),m)if(h){var y=$t.bind(null,null);m.then(y,y)}else typeof m.next=="function"&&typeof m.throw=="function"&&(m=Po(m))},d);return(m&&typeof m.then=="function"?W.resolve(m).then(function(y){return l.active?y:Ie(new Q.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):g.then(function(){return m})).then(function(y){return o&&l._resolve(),l._completion.then(function(){return y})}).catch(function(y){return l._reject(y),Ie(y)})})}function zr(e,t,i){for(var o=_e(e)?e.slice():[e],s=0;s<i;++s)o.push(t);return o}function Mp(e){return te(te({},e),{table:function(t){var i=e.table(t),o=i.schema,s={},c=[];function l(_,E,I){var C=Zn(_),P=s[C]=s[C]||[],A=_==null?0:typeof _=="string"?1:_.length,T=E>0,N=te(te({},I),{name:T?"".concat(C,"(virtual-from:").concat(I.name,")"):I.name,lowLevelIndex:I,isVirtual:T,keyTail:E,keyLength:A,extractKey:xo(_),unique:!T&&I.unique});if(P.push(N),N.isPrimaryKey||c.push(N),A>1){var K=A===2?_[0]:_.slice(0,A-1);l(K,E+1,I)}return P.sort(function(M,q){return M.keyTail-q.keyTail}),N}var d=l(o.primaryKey.keyPath,0,o.primaryKey);s[":id"]=[d];for(var h=0,m=o.indexes;h<m.length;h++){var g=m[h];l(g.keyPath,0,g)}function y(_){var E=s[Zn(_)];return E&&E[0]}function w(_,E){return{type:_.type===1?2:_.type,lower:zr(_.lower,_.lowerOpen?e.MAX_KEY:e.MIN_KEY,E),lowerOpen:!0,upper:zr(_.upper,_.upperOpen?e.MIN_KEY:e.MAX_KEY,E),upperOpen:!0}}function k(_){var E=_.query.index;return E.isVirtual?te(te({},_),{query:{index:E.lowLevelIndex,range:w(_.query.range,E.keyTail)}}):_}var b=te(te({},i),{schema:te(te({},o),{primaryKey:d,indexes:c,getIndexByKeyPath:y}),count:function(_){return i.count(k(_))},query:function(_){return i.query(k(_))},openCursor:function(_){var E=_.query.index,I=E.keyTail,C=E.isVirtual,P=E.keyLength;if(!C)return i.openCursor(_);function A(T){function N(M){M!=null?T.continue(zr(M,_.reverse?e.MAX_KEY:e.MIN_KEY,I)):_.unique?T.continue(T.key.slice(0,P).concat(_.reverse?e.MIN_KEY:e.MAX_KEY,I)):T.continue()}var K=Object.create(T,{continue:{value:N},continuePrimaryKey:{value:function(M,q){T.continuePrimaryKey(zr(M,e.MAX_KEY,I),q)}},primaryKey:{get:function(){return T.primaryKey}},key:{get:function(){var M=T.key;return P===1?M[0]:M.slice(0,P)}},value:{get:function(){return T.value}}});return K}return i.openCursor(k(_)).then(function(T){return T&&A(T)})}});return b}})}var Np={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:Mp};function Go(e,t,i,o){return i=i||{},o=o||"",Re(e).forEach(function(s){if(!Ze(t,s))i[o+s]=void 0;else{var c=e[s],l=t[s];if(typeof c=="object"&&typeof l=="object"&&c&&l){var d=go(c),h=go(l);d!==h?i[o+s]=t[s]:d==="Object"?Go(c,l,i,o+s+"."):c!==l&&(i[o+s]=t[s])}else c!==l&&(i[o+s]=t[s])}}),Re(t).forEach(function(s){Ze(e,s)||(i[o+s]=t[s])}),i}function Yo(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var $p={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return te(te({},e),{table:function(t){var i=e.table(t),o=i.schema.primaryKey,s=te(te({},i),{mutate:function(c){var l=X.trans,d=l.table(t).hook,h=d.deleting,m=d.creating,g=d.updating;switch(c.type){case"add":if(m.fire===ye)break;return l._promise("readwrite",function(){return y(c)},!0);case"put":if(m.fire===ye&&g.fire===ye)break;return l._promise("readwrite",function(){return y(c)},!0);case"delete":if(h.fire===ye)break;return l._promise("readwrite",function(){return y(c)},!0);case"deleteRange":if(h.fire===ye)break;return l._promise("readwrite",function(){return w(c)},!0)}return i.mutate(c);function y(b){var _=X.trans,E=b.keys||Yo(o,b);if(!E)throw new Error("Keys missing");return b=b.type==="add"||b.type==="put"?te(te({},b),{keys:E}):te({},b),b.type!=="delete"&&(b.values=ti([],b.values,!0)),b.keys&&(b.keys=ti([],b.keys,!0)),Bp(i,b,E).then(function(I){var C=E.map(function(P,A){var T=I[A],N={onerror:null,onsuccess:null};if(b.type==="delete")h.fire.call(N,P,T,_);else if(b.type==="add"||T===void 0){var K=m.fire.call(N,P,b.values[A],_);P==null&&K!=null&&(P=K,b.keys[A]=P,o.outbound||Qe(b.values[A],o.keyPath,P))}else{var M=Go(T,b.values[A]),q=g.fire.call(N,M,P,T,_);if(q){var ee=b.values[A];Object.keys(q).forEach(function(j){Ze(ee,j)?ee[j]=q[j]:Qe(ee,j,q[j])})}}return N});return i.mutate(b).then(function(P){for(var A=P.failures,T=P.results,N=P.numFailures,K=P.lastResult,M=0;M<E.length;++M){var q=T?T[M]:E[M],ee=C[M];q==null?ee.onerror&&ee.onerror(A[M]):ee.onsuccess&&ee.onsuccess(b.type==="put"&&I[M]?b.values[M]:q)}return{failures:A,results:T,numFailures:N,lastResult:K}}).catch(function(P){return C.forEach(function(A){return A.onerror&&A.onerror(P)}),Promise.reject(P)})})}function w(b){return k(b.trans,b.range,1e4)}function k(b,_,E){return i.query({trans:b,values:!1,query:{index:o,range:_},limit:E}).then(function(I){var C=I.result;return y({type:"delete",keys:C,trans:b}).then(function(P){return P.numFailures>0?Promise.reject(P.failures[0]):C.length<E?{failures:[],numFailures:0,lastResult:void 0}:k(b,te(te({},_),{lower:C[C.length-1],lowerOpen:!0}),E)})})}}});return s}})}};function Bp(e,t,i){return t.type==="add"?Promise.resolve([]):e.getMany({trans:t.trans,keys:i,cache:"immutable"})}function Hc(e,t,i){try{if(!t||t.keys.length<e.length)return null;for(var o=[],s=0,c=0;s<t.keys.length&&c<e.length;++s)ue(t.keys[s],e[c])===0&&(o.push(i?sn(t.values[s]):t.values[s]),++c);return o.length===e.length?o:null}catch{return null}}var Lp={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var i=e.table(t);return te(te({},i),{getMany:function(o){if(!o.cache)return i.getMany(o);var s=Hc(o.keys,o.trans._cache,o.cache==="clone");return s?W.resolve(s):i.getMany(o).then(function(c){return o.trans._cache={keys:o.keys,values:o.cache==="clone"?sn(c):c},c})},mutate:function(o){return o.type!=="add"&&(o.trans._cache=null),i.mutate(o)}})}}}};function Wc(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function Vc(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":return!1;case"getMany":return!1;case"count":return!1;case"openCursor":return!1}}var Up={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,i=new Xe(e.MIN_KEY,e.MAX_KEY);return te(te({},e),{transaction:function(o,s,c){if(X.subscr&&s!=="readonly")throw new Q.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(X.querier));return e.transaction(o,s,c)},table:function(o){var s=e.table(o),c=s.schema,l=c.primaryKey,d=c.indexes,h=l.extractKey,m=l.outbound,g=l.autoIncrement&&d.filter(function(b){return b.compound&&b.keyPath.includes(l.keyPath)}),y=te(te({},s),{mutate:function(b){var _,E,I=b.trans,C=b.mutatedParts||(b.mutatedParts={}),P=function(Y){var ne="idb://".concat(t,"/").concat(o,"/").concat(Y);return C[ne]||(C[ne]=new Xe)},A=P(""),T=P(":dels"),N=b.type,K=b.type==="deleteRange"?[b.range]:b.type==="delete"?[b.keys]:b.values.length<50?[Yo(l,b).filter(function(Y){return Y}),b.values]:[],M=K[0],q=K[1],ee=b.trans._cache;if(_e(M)){A.addKeys(M);var j=N==="delete"||M.length===q.length?Hc(M,ee):null;j||T.addKeys(M),(j||q)&&jp(P,c,j,q)}else if(M){var L={from:(_=M.lower)!==null&&_!==void 0?_:e.MIN_KEY,to:(E=M.upper)!==null&&E!==void 0?E:e.MAX_KEY};T.add(L),A.add(L)}else A.add(i),T.add(i),c.indexes.forEach(function(Y){return P(Y.name).add(i)});return s.mutate(b).then(function(Y){return M&&(b.type==="add"||b.type==="put")&&(A.addKeys(Y.results),g&&g.forEach(function(ne){for(var J=b.values.map(function(ke){return ne.extractKey(ke)}),me=ne.keyPath.findIndex(function(ke){return ke===l.keyPath}),Se=0,Ue=Y.results.length;Se<Ue;++Se)J[Se][me]=Y.results[Se];P(ne.name).addKeys(J)})),I.mutatedParts=yi(I.mutatedParts||{},C),Y})}}),w=function(b){var _,E,I=b.query,C=I.index,P=I.range;return[C,new Xe((_=P.lower)!==null&&_!==void 0?_:e.MIN_KEY,(E=P.upper)!==null&&E!==void 0?E:e.MAX_KEY)]},k={get:function(b){return[l,new Xe(b.key)]},getMany:function(b){return[l,new Xe().addKeys(b.keys)]},count:w,query:w,openCursor:w};return Re(k).forEach(function(b){y[b]=function(_){var E=X.subscr,I=!!E,C=Wc(X,s)&&Vc(b,_),P=C?_.obsSet={}:E;if(I){var A=function(j){var L="idb://".concat(t,"/").concat(o,"/").concat(j);return P[L]||(P[L]=new Xe)},T=A(""),N=A(":dels"),K=k[b](_),M=K[0],q=K[1];if(b==="query"&&M.isPrimaryKey&&!_.values?N.add(q):A(M.name||"").add(q),!M.isPrimaryKey)if(b==="count")N.add(i);else{var ee=b==="query"&&m&&_.values&&s.query(te(te({},_),{values:!1}));return s[b].apply(this,arguments).then(function(j){if(b==="query"){if(m&&_.values)return ee.then(function(J){var me=J.result;return T.addKeys(me),j});var L=_.values?j.result.map(h):j.result;_.values?T.addKeys(L):N.addKeys(L)}else if(b==="openCursor"){var Y=j,ne=_.values;return Y&&Object.create(Y,{key:{get:function(){return N.addKey(Y.primaryKey),Y.key}},primaryKey:{get:function(){var J=Y.primaryKey;return N.addKey(J),J}},value:{get:function(){return ne&&T.addKey(Y.primaryKey),Y.value}}})}return j})}}return s[b].apply(this,arguments)}}),y}})}};function jp(e,t,i,o){function s(c){var l=e(c.name||"");function d(m){return m!=null?c.extractKey(m):null}var h=function(m){return c.multiEntry&&_e(m)?m.forEach(function(g){return l.addKey(g)}):l.addKey(m)};(i||o).forEach(function(m,g){var y=i&&d(i[g]),w=o&&d(o[g]);ue(y,w)!==0&&(y!=null&&h(y),w!=null&&h(w))})}t.indexes.forEach(s)}function pc(e,t,i){if(i.numFailures===0)return t;if(t.type==="deleteRange")return null;var o=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;if(i.numFailures===o)return null;var s=te({},t);return _e(s.keys)&&(s.keys=s.keys.filter(function(c,l){return!(l in i.failures)})),"values"in s&&_e(s.values)&&(s.values=s.values.filter(function(c,l){return!(l in i.failures)})),s}function Kp(e,t){return t.lower===void 0?!0:t.lowerOpen?ue(e,t.lower)>0:ue(e,t.lower)>=0}function Hp(e,t){return t.upper===void 0?!0:t.upperOpen?ue(e,t.upper)<0:ue(e,t.upper)<=0}function ho(e,t){return Kp(e,t)&&Hp(e,t)}function mc(e,t,i,o,s,c){if(!i||i.length===0)return e;var l=t.query.index,d=l.multiEntry,h=t.query.range,m=o.schema.primaryKey,g=m.extractKey,y=l.extractKey,w=(l.lowLevelIndex||l).extractKey,k=i.reduce(function(b,_){var E=b,I=[];if(_.type==="add"||_.type==="put")for(var C=new Xe,P=_.values.length-1;P>=0;--P){var A=_.values[P],T=g(A);if(!C.hasKey(T)){var N=y(A);(d&&_e(N)?N.some(function(j){return ho(j,h)}):ho(N,h))&&(C.addKey(T),I.push(A))}}switch(_.type){case"add":{var K=new Xe().addKeys(t.values?b.map(function(j){return g(j)}):b);E=b.concat(t.values?I.filter(function(j){var L=g(j);return K.hasKey(L)?!1:(K.addKey(L),!0)}):I.map(function(j){return g(j)}).filter(function(j){return K.hasKey(j)?!1:(K.addKey(j),!0)}));break}case"put":{var M=new Xe().addKeys(_.values.map(function(j){return g(j)}));E=b.filter(function(j){return!M.hasKey(t.values?g(j):j)}).concat(t.values?I:I.map(function(j){return g(j)}));break}case"delete":var q=new Xe().addKeys(_.keys);E=b.filter(function(j){return!q.hasKey(t.values?g(j):j)});break;case"deleteRange":var ee=_.range;E=b.filter(function(j){return!ho(g(j),ee)});break}return E},e);return k===e?e:(k.sort(function(b,_){return ue(w(b),w(_))||ue(g(b),g(_))}),t.limit&&t.limit<1/0&&(k.length>t.limit?k.length=t.limit:e.length===t.limit&&k.length<t.limit&&(s.dirty=!0)),c?Object.freeze(k):k)}function gc(e,t){return ue(e.lower,t.lower)===0&&ue(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function Wp(e,t,i,o){if(e===void 0)return t!==void 0?-1:0;if(t===void 0)return 1;var s=ue(e,t);if(s===0){if(i&&o)return 0;if(i)return 1;if(o)return-1}return s}function Vp(e,t,i,o){if(e===void 0)return t!==void 0?1:0;if(t===void 0)return-1;var s=ue(e,t);if(s===0){if(i&&o)return 0;if(i)return-1;if(o)return 1}return s}function zp(e,t){return Wp(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&Vp(e.upper,t.upper,e.upperOpen,t.upperOpen)>=0}function Gp(e,t,i,o){var s=on["idb://".concat(e,"/").concat(t)];if(!s)return[];var c=s.queries[i];if(!c)return[null,!1,s,null];var l=o.query?o.query.index.name:null,d=c[l||""];if(!d)return[null,!1,s,null];switch(i){case"query":var h=d.find(function(y){return y.req.limit===o.limit&&y.req.values===o.values&&gc(y.req.query.range,o.query.range)});if(h)return[h,!0,s,d];var m=d.find(function(y){var w="limit"in y.req?y.req.limit:1/0;return w>=o.limit&&(o.values?y.req.values:!0)&&zp(y.req.query.range,o.query.range)});return[m,!1,s,d];case"count":var g=d.find(function(y){return gc(y.req.query.range,o.query.range)});return[g,!!g,s,d]}}function Yp(e,t,i,o){e.subscribers.add(i),o.addEventListener("abort",function(){e.subscribers.delete(i),e.subscribers.size===0&&qp(e,t)})}function qp(e,t){setTimeout(function(){e.subscribers.size===0&&Qt(t,e)},3e3)}var Jp={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name,i=te(te({},e),{transaction:function(o,s,c){var l=e.transaction(o,s,c);if(s==="readwrite"){var d=new AbortController,h=d.signal,m=function(g){return function(){if(d.abort(),s==="readwrite"){for(var y=new Set,w=0,k=o;w<k.length;w++){var b=k[w],_=on["idb://".concat(t,"/").concat(b)];if(_){var E=e.table(b),I=_.optimisticOps.filter(function(ne){return ne.trans===l});if(l._explicit&&g&&l.mutatedParts)for(var C=0,P=Object.values(_.queries.query);C<P.length;C++)for(var A=P[C],T=0,N=A.slice();T<N.length;T++){var K=N[T];Vo(K.obsSet,l.mutatedParts)&&(Qt(A,K),K.subscribers.forEach(function(ne){return y.add(ne)}))}else if(I.length>0){_.optimisticOps=_.optimisticOps.filter(function(ne){return ne.trans!==l});for(var M=0,q=Object.values(_.queries.query);M<q.length;M++)for(var A=q[M],ee=0,j=A.slice();ee<j.length;ee++){var K=j[ee];if(K.res!=null&&l.mutatedParts)if(g&&!K.dirty){var L=Object.isFrozen(K.res),Y=mc(K.res,K.req,I,E,K,L);K.dirty?(Qt(A,K),K.subscribers.forEach(function(me){return y.add(me)})):Y!==K.res&&(K.res=Y,K.promise=W.resolve({result:Y}))}else K.dirty&&Qt(A,K),K.subscribers.forEach(function(me){return y.add(me)})}}}}y.forEach(function(ne){return ne()})}}};l.addEventListener("abort",m(!1),{signal:h}),l.addEventListener("error",m(!1),{signal:h}),l.addEventListener("complete",m(!0),{signal:h})}return l},table:function(o){var s=e.table(o),c=s.schema.primaryKey,l=te(te({},s),{mutate:function(d){var h=X.trans;if(c.outbound||h.db._options.cache==="disabled"||h.explicit||h.idbtrans.mode!=="readwrite")return s.mutate(d);var m=on["idb://".concat(t,"/").concat(o)];if(!m)return s.mutate(d);var g=s.mutate(d);return(d.type==="add"||d.type==="put")&&(d.values.length>=50||Yo(c,d).some(function(y){return y==null}))?g.then(function(y){var w=te(te({},d),{values:d.values.map(function(b,_){var E;if(y.failures[_])return b;var I=!((E=c.keyPath)===null||E===void 0)&&E.includes(".")?sn(b):te({},b);return Qe(I,c.keyPath,y.results[_]),I})}),k=pc(m,w,y);m.optimisticOps.push(k),queueMicrotask(function(){return d.mutatedParts&&Vr(d.mutatedParts)})}):(m.optimisticOps.push(d),d.mutatedParts&&Vr(d.mutatedParts),g.then(function(y){if(y.numFailures>0){Qt(m.optimisticOps,d);var w=pc(m,d,y);w&&m.optimisticOps.push(w),d.mutatedParts&&Vr(d.mutatedParts)}}),g.catch(function(){Qt(m.optimisticOps,d),d.mutatedParts&&Vr(d.mutatedParts)})),g},query:function(d){var h;if(!Wc(X,s)||!Vc("query",d))return s.query(d);var m=((h=X.trans)===null||h===void 0?void 0:h.db._options.cache)==="immutable",g=X,y=g.requery,w=g.signal,k=Gp(t,o,"query",d),b=k[0],_=k[1],E=k[2],I=k[3];if(b&&_)b.obsSet=d.obsSet;else{var C=s.query(d).then(function(P){var A=P.result;if(b&&(b.res=A),m){for(var T=0,N=A.length;T<N;++T)Object.freeze(A[T]);Object.freeze(A)}else P.result=sn(A);return P}).catch(function(P){return I&&b&&Qt(I,b),Promise.reject(P)});b={obsSet:d.obsSet,promise:C,subscribers:new Set,type:"query",req:d,dirty:!1},I?I.push(b):(I=[b],E||(E=on["idb://".concat(t,"/").concat(o)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}}),E.queries.query[d.query.index.name||""]=I)}return Yp(b,I,y,w),b.promise.then(function(P){return{result:mc(P.result,d,E?.optimisticOps,s,b,m)}})}});return l}});return i}};function Gr(e,t){return new Proxy(e,{get:function(i,o,s){return o==="db"?t:Reflect.get(i,o,s)}})}var Tn=(function(){function e(t,i){var o=this;this._middlewares={},this.verno=0;var s=e.dependencies;this._options=i=te({addons:e.addons,autoOpen:!0,indexedDB:s.indexedDB,IDBKeyRange:s.IDBKeyRange,cache:"cloned"},i),this._deps={indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange};var c=i.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var l={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ye,dbReadyPromise:null,cancelOpen:ye,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:i.autoOpen};l.dbReadyPromise=new W(function(h){l.dbReadyResolve=h}),l.openCanceller=new W(function(h,m){l.cancelOpen=m}),this._state=l,this.name=t,this.on=sr(this,"populate","blocked","versionchange","close",{ready:[Fo,ye]}),this.once=function(h,m){var g=function(){for(var y=[],w=0;w<arguments.length;w++)y[w]=arguments[w];o.on(h).unsubscribe(g),m.apply(o,y)};return o.on(h,g)},this.on.ready.subscribe=bc(this.on.ready.subscribe,function(h){return function(m,g){e.vip(function(){var y=o._state;if(y.openComplete)y.dbOpenError||W.resolve().then(m),g&&h(m);else if(y.onReadyBeingFired)y.onReadyBeingFired.push(m),g&&h(m);else{h(m);var w=o;g||h(function k(){w.on.ready.unsubscribe(m),w.on.ready.unsubscribe(k)})}})}}),this.Collection=rp(this),this.Table=ep(this),this.Transaction=fp(this),this.Version=Tp(this),this.WhereClause=up(this),this.on("versionchange",function(h){h.newVersion>0?console.warn("Another connection wants to upgrade database '".concat(o.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(o.name,"'. Closing db now to resume the delete request.")),o.close({disableAutoOpen:!1})}),this.on("blocked",function(h){!h.newVersion||h.newVersion<h.oldVersion?console.warn("Dexie.delete('".concat(o.name,"') was blocked")):console.warn("Upgrade '".concat(o.name,"' blocked by other connection holding version ").concat(h.oldVersion/10))}),this._maxKey=rr(i.IDBKeyRange),this._createTransaction=function(h,m,g,y){return new o.Transaction(h,m,g,o._options.chromeTransactionDurability,y)},this._fireOnBlocked=function(h){o.on("blocked").fire(h),In.filter(function(m){return m.name===o.name&&m!==o&&!m._state.vcFired}).map(function(m){return m.on("versionchange").fire(h)})},this.use(Lp),this.use(Jp),this.use(Up),this.use(Np),this.use($p);var d=new Proxy(this,{get:function(h,m,g){if(m==="_vip")return!0;if(m==="table")return function(w){return Gr(o.table(w),d)};var y=Reflect.get(h,m,g);return y instanceof Nc?Gr(y,d):m==="tables"?y.map(function(w){return Gr(w,d)}):m==="_createTransaction"?function(){var w=y.apply(this,arguments);return Gr(w,d)}:y}});this.vip=d,c.forEach(function(h){return h(o)})}return e.prototype.version=function(t){if(isNaN(t)||t<.1)throw new Q.Type("Given version is not a positive number");if(t=Math.round(t*10)/10,this.idbdb||this._state.isBeingOpened)throw new Q.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);var i=this._versions,o=i.filter(function(s){return s._cfg.version===t})[0];return o||(o=new this.Version(t),i.push(o),i.sort(vp),o.stores({}),this._state.autoSchema=!1,o)},e.prototype._whenReady=function(t){var i=this;return this.idbdb&&(this._state.openComplete||X.letThrough||this._vip)?t():new W(function(o,s){if(i._state.openComplete)return s(new Q.DatabaseClosed(i._state.dbOpenError));if(!i._state.isBeingOpened){if(!i._state.autoOpen){s(new Q.DatabaseClosed);return}i.open().catch(ye)}i._state.dbReadyPromise.then(o,s)}).then(t)},e.prototype.use=function(t){var i=t.stack,o=t.create,s=t.level,c=t.name;c&&this.unuse({stack:i,name:c});var l=this._middlewares[i]||(this._middlewares[i]=[]);return l.push({stack:i,create:o,level:s??10,name:c}),l.sort(function(d,h){return d.level-h.level}),this},e.prototype.unuse=function(t){var i=t.stack,o=t.name,s=t.create;return i&&this._middlewares[i]&&(this._middlewares[i]=this._middlewares[i].filter(function(c){return s?c.create!==s:o?c.name!==o:!1})),this},e.prototype.open=function(){var t=this;return cn(Ft,function(){return Op(t)})},e.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var t=this._state,i=In.indexOf(this);if(i>=0&&In.splice(i,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}t.isBeingOpened||(t.dbReadyPromise=new W(function(o){t.dbReadyResolve=o}),t.openCanceller=new W(function(o,s){t.cancelOpen=s}))},e.prototype.close=function(t){var i=t===void 0?{disableAutoOpen:!0}:t,o=i.disableAutoOpen,s=this._state;o?(s.isBeingOpened&&s.cancelOpen(new Q.DatabaseClosed),this._close(),s.autoOpen=!1,s.dbOpenError=new Q.DatabaseClosed):(this._close(),s.autoOpen=this._options.autoOpen||s.isBeingOpened,s.openComplete=!1,s.dbOpenError=null)},e.prototype.delete=function(t){var i=this;t===void 0&&(t={disableAutoOpen:!0});var o=arguments.length>0&&typeof arguments[0]!="object",s=this._state;return new W(function(c,l){var d=function(){i.close(t);var h=i._deps.indexedDB.deleteDatabase(i.name);h.onsuccess=we(function(){Ap(i._deps,i.name),c()}),h.onerror=dt(l),h.onblocked=i._fireOnBlocked};if(o)throw new Q.InvalidArgument("Invalid closeOptions argument to db.delete()");s.isBeingOpened?s.dbReadyPromise.then(d):d()})},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return this.idbdb!==null},e.prototype.hasBeenClosed=function(){var t=this._state.dbOpenError;return t&&t.name==="DatabaseClosed"},e.prototype.hasFailed=function(){return this._state.dbOpenError!==null},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,"tables",{get:function(){var t=this;return Re(this._allTables).map(function(i){return t._allTables[i]})},enumerable:!1,configurable:!0}),e.prototype.transaction=function(){var t=Fp.apply(this,arguments);return this._transaction.apply(this,t)},e.prototype._transaction=function(t,i,o){var s=this,c=X.trans;(!c||c.db!==this||t.indexOf("!")!==-1)&&(c=null);var l=t.indexOf("?")!==-1;t=t.replace("!","").replace("?","");var d,h;try{if(h=i.map(function(g){var y=g instanceof s.Table?g.name:g;if(typeof y!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return y}),t=="r"||t===oo)d=oo;else if(t=="rw"||t==so)d=so;else throw new Q.InvalidArgument("Invalid transaction mode: "+t);if(c){if(c.mode===oo&&d===so)if(l)c=null;else throw new Q.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");c&&h.forEach(function(g){if(c&&c.storeNames.indexOf(g)===-1)if(l)c=null;else throw new Q.SubTransaction("Table "+g+" not included in parent transaction.")}),l&&c&&!c.active&&(c=null)}}catch(g){return c?c._promise(null,function(y,w){w(g)}):Ie(g)}var m=Kc.bind(null,this,d,h,c,o);return c?c._promise(d,m,"lock"):X.trans?cn(X.transless,function(){return s._whenReady(m)}):this._whenReady(m)},e.prototype.table=function(t){if(!Ze(this._allTables,t))throw new Q.InvalidTable("Table ".concat(t," does not exist"));return this._allTables[t]},e})(),Xp=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Qp=(function(){function e(t){this._subscribe=t}return e.prototype.subscribe=function(t,i,o){return this._subscribe(!t||typeof t=="function"?{next:t,error:i,complete:o}:t)},e.prototype[Xp]=function(){return this},e})(),di;try{di={indexedDB:Le.indexedDB||Le.mozIndexedDB||Le.webkitIndexedDB||Le.msIndexedDB,IDBKeyRange:Le.IDBKeyRange||Le.webkitIDBKeyRange}}catch{di={indexedDB:null,IDBKeyRange:null}}function Zp(e){var t=!1,i,o=new Qp(function(s){var c=Do(e);function l(I){var C=An();try{c&&Rn();var P=Nt(e,I);return c&&(P=P.finally($t)),P}finally{C&&Dn()}}var d=!1,h,m={},g={},y={get closed(){return d},unsubscribe:function(){d||(d=!0,h&&h.abort(),w&&Lt.storagemutated.unsubscribe(_))}};s.start&&s.start(y);var w=!1,k=function(){return io(E)};function b(){return Vo(g,m)}var _=function(I){yi(m,I),b()&&k()},E=function(){if(!(d||!di.indexedDB)){m={};var I={};h&&h.abort(),h=new AbortController;var C={subscr:I,signal:h.signal,requery:k,querier:e,trans:null},P=l(C);Promise.resolve(P).then(function(A){t=!0,i=A,!(d||C.signal.aborted)&&(m={},g=I,!xh(g)&&!w&&(Lt(cr,_),w=!0),io(function(){return!d&&s.next&&s.next(A)}))},function(A){t=!1,["DatabaseClosedError","AbortError"].includes(A?.name)||d||io(function(){d||s.error&&s.error(A)})})}};return setTimeout(k,0),y});return o.hasValue=function(){return t},o.getValue=function(){return i},o}var en=Tn;xn(en,te(te({},pi),{delete:function(e){var t=new en(e,{addons:[]});return t.delete()},exists:function(e){return new en(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return Cp(en.dependencies).then(e)}catch{return Ie(new Q.MissingAPI)}},defineClass:function(){function e(t){nt(this,t)}return e},ignoreTransaction:function(e){return X.trans?cn(X.transless,e):e()},vip:Co,async:function(e){return function(){try{var t=Po(e.apply(this,arguments));return!t||typeof t.then!="function"?W.resolve(t):t}catch(i){return Ie(i)}}},spawn:function(e,t,i){try{var o=Po(e.apply(i,t||[]));return!o||typeof o.then!="function"?W.resolve(o):o}catch(s){return Ie(s)}},currentTransaction:{get:function(){return X.trans||null}},waitFor:function(e,t){var i=W.resolve(typeof e=="function"?en.ignoreTransaction(e):e).timeout(t||6e4);return X.trans?X.trans.waitFor(i):i},Promise:W,debug:{get:function(){return ht},set:function(e){Tc(e)}},derive:Cn,extend:nt,props:xn,override:bc,Events:sr,on:Lt,liveQuery:Zp,extendObservabilitySet:yi,getByKeyPath:Et,setByKeyPath:Qe,delByKeyPath:Eh,shallowClone:_c,deepClone:sn,getObjectDiff:Go,cmp:ue,asap:wc,minKey:Eo,addons:[],connections:In,errnames:Oo,dependencies:di,cache:on,semVer:ic,version:ic.split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,i){return e+t/Math.pow(10,i*2)})}));en.maxKey=rr(en.dependencies.IDBKeyRange);typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Lt(cr,function(e){if(!Ot){var t;t=new CustomEvent(Io,{detail:e}),Ot=!0,dispatchEvent(t),Ot=!1}}),addEventListener(Io,function(e){var t=e.detail;Ot||qo(t)}));function qo(e){var t=Ot;try{Ot=!0,Lt.storagemutated.fire(e),zo(e,!0)}finally{Ot=t}}var Ot=!1,Rt,Ao=function(){};typeof BroadcastChannel<"u"&&(Ao=function(){Rt=new BroadcastChannel(Io),Rt.onmessage=function(e){return e.data&&qo(e.data)}},Ao(),typeof Rt.unref=="function"&&Rt.unref(),Lt(cr,function(e){Ot||Rt.postMessage(e)}));typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!Tn.disableBfCache&&e.persisted){ht&&console.debug("Dexie: handling persisted pagehide"),Rt?.close();for(var t=0,i=In;t<i.length;t++){var o=i[t];o.close({disableAutoOpen:!1})}}}),addEventListener("pageshow",function(e){!Tn.disableBfCache&&e.persisted&&(ht&&console.debug("Dexie: handling persisted pageshow"),Ao(),qo({all:new Xe(-1/0,[[]])}))}));W.rejectionMapper=Rh;Tc(ht);var Jo=class{getDB(){let t=new Tn("FireShotDB");return t.version(1).stores({captures:`
              ++id,
              time,
              url,
              title`,tiles:"++id, parentId"}),t}async createNewEntry(){return await this.getDB().captures.add({time:0})}async addTile(t,i){await this.getDB().tiles.add({parentId:t,blob:i})}async commitEntry(t,i,o,s,c){await this.getDB().captures.update(t,{time:i,url:o,title:s,metadata:c})}async cleanup(){Ae()("DB cleanup...");let i=await this.getDB().captures.where("time").equals(0).primaryKeys();await this.deleteCaptures(i)}async deleteCaptures(t){let i=this.getDB();await i.tiles.where("parentId").anyOf(t).delete(),await i.captures.bulkDelete(t)}async deleteOlderThanGivenDays(t){Ae()("Performing database cleanup...");let i=this.getDB(),o=new Date;o.setDate(o.getDate()-t);let s=await i.captures.where("time").below(o).primaryKeys();s.length>0?(console.log(`Removing ${s.length} items`),await this.deleteCaptures(s)):Ae()("Nothing to do.")}async getCapture(t){try{let i=this.getDB();return{...await i.captures.get(t),tiles:(await i.tiles.where("parentId").equals(t).sortBy("id")).map(o=>o.blob)}}catch(i){return console.error(i),null}}async getAllCaptures(){return await this.getDB().captures.toArray()}},ln=new Jo;var zc="image/png",vi=class{#i=0;#e=0;#a=Number.MAX_SAFE_INTEGER;#y=Number.MAX_SAFE_INTEGER;#v=0;#h=0;#p;#u=0;#m=0;#b=0;#l=-1;#n=0;#r=0;#d=[];#t=null;#s=null;#f=null;#o;#c=null;#g=0;dbError=!1;constructor(){}async F(){await gn(async()=>{await ln.cleanup()})()}#E(){this.#t=new OffscreenCanvas(this.#n,R.Y),this.#t.aTag=1,this.#s=new OffscreenCanvas(this.#n,R.Y),this.#s.aTag=2,this.#f=this.#t.getContext("2d",{alpha:!1,willReadFrequently:!1}),this.#f.aTag=1,this.#c=this.#s.getContext("2d",{alpha:!1,willReadFrequently:!1}),this.#c.aTag=2}async#w(t){await gn(async()=>{this.#l<0&&(this.#l=await ln.createNewEntry()),this.#m+=t.size,Ve()&&(t=await t.arrayBuffer()),await ln.addTile(this.#l,t),++this.#b},()=>this.dbError=!0)()}async#_(){ot("swapActiveContext"),this.#g=0,this.#o+=this.#t.height,await this.#w(await this.#t.convertToBlob({type:zc})),[this.#t,this.#s]=[this.#s,this.#t],[this.#f,this.#c]=[this.#c,this.#f],st("swapActiveContext")}async#I(t){let i=t.x,o=t.y,s=this.#h===t.y||this.#u===0,c=t.metrics.div,l=t.metrics.left,d=t.metrics.top,h=t.metrics.crop,m=t.metrics.cropLeft||0,g=t.metrics.cropTop||0,y=t.metrics.cropRight||0,w=t.metrics.cropBottom||0,k=t.metrics.stickyHdrHeight,{w:b,h:_}=Qa(t.dataurl),[E,I]=c?[t.metrics.cw,t.metrics.ch]:[b,_];this.#u===0&&(this.#v=t.x,this.#h=t.y),this.#u=this.#u+1,this.#y=Math.min(this.#y,t.y),this.#e=Math.max(this.#e,t.y),this.#n===0&&(this.#n=this.#i+E-this.#a-(h?m:0),h&&(this.#n=Math.min(this.#n,y-m)),this.#E(),this.#o=0);let C=s?0:k,P=i-this.#v-m,A=o-this.#h-g+C,T=c?I-C:I-C-d,N=A+T;this.#r=Math.max(this.#r,N),h&&(this.#r=Math.min(this.#r,Math.floor(w-g))),ot("fetch dataurl");let K=await fetch(t.dataurl);if(!K.ok)throw new Error("failed to preload image chunk");st("fetch dataurl"),ot("createImageBitmap");let M=await createImageBitmap(await K.blob());st("createImageBitmap"),A-this.#o>=this.#t.height&&await this.#_();let q=Math.max(E,b)-l,ee=Math.max(I,_)-(d+C);this.#f.drawImage(M,l,d+C,q,ee,P,A-this.#o,q,ee),this.#r-this.#o>=this.#t.height&&(this.#g=this.#r-this.#o-this.#t.height,this.#c.drawImage(M,l,d+C,q,ee,P,A-this.#o-this.#t.height,q,ee))}async#k(t){ot("commitDBRecord");let i=Z(R.m,2)-1;await gn(async()=>{let o={calculatedHeight:Math.floor(this.#r),calculatedWidth:this.#n,blobsSize:this.#m,totalTiles:this.#b,pageUrl:t.url,...t.savedCapParamsForDebugging};await ln.commitEntry(this.#l,new Date(t.created),t.url,t.title,{n:i,size:this.#m,width:this.#n,height:Math.floor(this.#r),cbb:t.canBeBetter,debug:o,links:t.links,words:t.words})},()=>this.dbError=!0)(),st("commitDBRecord")}async#S(){this.#n===0&&this.#d.forEach(t=>{this.#a=Math.min(this.#a,t.x),this.#i=Math.max(this.#i,t.x)});for(let t of this.#d)await this.#I(t);this.#d.length=0}async _e(t){this.#d.push(t),typeof this.#p>"u"&&(this.#p=t.y),this.#p!==t.y&&await this.#S()}async ct(t){return ot("Finalize"),this.#u===0&&await this.#S(),this.#g>0&&await this.#_(),this.#s.height=this.#r-this.#o,this.#c.drawImage(this.#t,0,0,this.#n,this.#r-this.#o,0,0,this.#n,this.#r-this.#o),await this.#w(await this.#s.convertToBlob({type:zc})),this.#t.width=1,this.#t.height=1,this.#s.width=1,this.#s.height=1,await this.#k(t),V("tiles created")(),st("Finalize"),this.#l}};function em(){let e=null,t=null,i=null;function o(){ie(R.i,!0),ie(R.t,!0)}async function s(){t=new vi,await t.F(),i=null}async function c(d){i?i=i.then(()=>t._e(d)):i=t._e(d)}async function l(d){try{if(d.rows===0)return;await i;let h=await t.ct(d);if(t.dbError){Yc(!0);return}t=null,i=null,oe&&ot("captureDone");let m=[R.I,R.p].indexOf(d.action)!==-1,g;if(m){let w=btoa(JSON.stringify({action:d.action,folder:d.overrideFolder||"",context:d.contextId}));g={url:`fsCaptured.html?id=${h}&params=${w}`,active:!0}}else g={url:`fsCaptured.html?id=${h}`,windowId:d.tab.windowId,index:d.tab.incognito?void 0:d.tab.index+1,openerTabId:d.tab.incognito?void 0:d.tab.id},Z(R.Fe)!=="true"&&(delete g.index,ze()&&delete g.openerTabId);if(ze()&&d.tab.incognito&&!d.justStore){let w=(await browser.windows.getAll({windowTypes:["normal"]})).filter(b=>!b.incognito),k;if(w.length>0)k=w[0],await browser.windows.update(k.id,{focused:!0});else{k=await browser.windows.create({incognito:!1,focused:!0,allowScriptsToClose:!0});let b=await browser.tabs.query({windowId:k.id});if(b?.length>0){let _=b[0];setTimeout(()=>browser.tabs.remove(_.id),1e3)}}g.windowId=k.id}let y=w=>new Promise(k=>{chrome.tabs.create(w,b=>{chrome.runtime.lastError?(delete w.index,delete w.openerTabId,chrome.tabs.create(w,k)):k(b)})});d.justStore||await y(g),oe&&st("captureDone")}finally{e({topic:"processingFinished"})}}return{init:function(d){e=d},launchJSON:function(d){switch(d.JSONCommand){case"captureInit":return s();case"captureTabPNG":c(d);break;case"captureDone":return l(d);case"activateFireShot":o();break}}}}var Gc=new em;function tm(){return jr()?Yn:Gc}function Br(e,t,i){if(typeof Yn>"u"){console.error("This method should be called only from the Service worker.");return}let o;typeof e=="object"?(o=e,e=t,t=i):o=tm();try{let s=t||{},c=e;if(s.JSONCommand=c,oe)if(s.dataurl){let l=s.dataurl;s.dataurl="<cut>",V("plugin command: "+c+" : "+JSON.stringify(s))(),s.dataurl=l}else V("plugin command: "+c+" : "+JSON.stringify(s).substring(0,2e3))();return o.launchJSON(s)}catch(s){return Xt(s.message),!1}}function Yc(e){chrome.tabs.create({url:`fsHistory.html${e?"?cleanup=1":""}`})}function qc(e){chrome.tabs.create({url:"fsOptions.html"+(e?"?extras=1":"")})}function Xo(e){bn(`https://getfireshot.com/buy.php?browser=${Pt()}${e?"&SRC="+e:""}&ver=${We().extVersionFull}`)}function Jc(){lt()?(ze()?chrome.windows:chrome.tabs).create({url:"fsNativeInstall.html"}):bi()}function bi(){new Date>new Date(2026,1,15)?alert("This beta preview period has ended. Please visit the purchase page to get the full version of FireShot Pro."):(ie(R.t,"true"),oe||Qo())}function Qo(){bn("https://getfireshot.com/beta-pro.php?browser="+Pt())}function Xc(){qn({topic:"highlightLastCreatedFile"})}function Qc(){qn({topic:"openLastCreatedFile"})}var Zc=function(e,t,i){let c=.8/devicePixelRatio;var l=0,d=e,h=t,m=[],g=[],y=[],w=[],k=0,b=1,_,E,I,C,P=d.width,A=d.height,T=Math.min(8.27*72/P,c);function N(H){g.push(H),k+=H.length+1}function K(H){H?y.unshift(k):y.push(k)}function M(H){N(arguments.length===1?H:Array.prototype.join.call(arguments," "))}function q(H){let U="";for(let ae=0;ae<H.length;++ae){let ve=H.charCodeAt(ae).toString(16);ve=("000"+ve).slice(-4),U+=ve}return U}function ee(){let H="",U=new Date;return H=new Date(U.valueOf()+(U.getTimezoneOffset()+480)*6e4).toISOString().replace(/[-:T]/g,"").slice(0,-4)+"Z",H}function j(){M(`%PDF-1.5\r
%\xFFCaptured and generated by FireShot [https://getfireshot.com]\xFF`)}function L(H,U,ae){K(ae);var ve=ae?1:++b,he;U&&(he="/Length "+U.length);var le=ve+` 0 obj\r
<<`+H+(he||"")+">>";return M(le),U&&(M("stream"),M(U),M("endstream")),M("endobj"),ve}function Y(H){return H.toFixed(2)}function ne(H){for(var U=H.toString();U.length<10;)U="0"+U;return U}function J(H){try{return(Ve()?"https://getfireshot.com/pdfs_":"https://getfireshot.com/pdf_")+btoa(H)}catch{return""}}function me(){E=L("/Type/Catalog/Pages 1 0 R"),L("/Type/Pages /Kids ["+_+" 0 R] /Count 1",null,!0)}function Se(){I=L(`/CreationDate (D:${ee()})/Creator (FireShot Webpage Screenshots (https://getfireshot.com))/Author (FireShot (https://getfireshot.com))/Title <FEFF${q(i)}>`)}function Ue(){}function ke(){C=k,M(`\r
xref\r
0 `+(y.length+1)+`\r
0000000000 65535 f`);for(var H=0;H<y.length;++H)M(ne(y[H])+" 00000 n")}function Ce(){M(`trailer\r
<</Root `+E+" 0 R /Size "+(y.length+1)+"/Info "+I+` 0 R>>\r
`)}function Ge(){M(`startxref\r
`+C+`\r
%%EOF\r
`)}function Ee(H,U){var ae=Math.max(0,U[0]),ve=A-Math.max(0,U[1]),he=Math.min(d.width,U[0]+U[2]),le=A-Math.min(d.height,U[1]+U[3]),Pe=[Y(ae*T),Y(le*T),Y(he*T),Y(ve*T)].join(" ");m.push(L("/Type/Annot/BS<</W "+l+" /S /S>>/C[0 1 0]/Subtype/Link/Rect["+Pe+"]/A "+H+" 0 R"))}function Oe(H){var U;return w[H]?U=w[H]:(U=L("/Type/Action/S/URI/URI("+H+")"),w[H]=U),U}function B(){for(var H in h)h[H].nActionId=Oe(J(h[H].a))}function O(){if(h.length){B();for(var H in h){var U=h[H];for(var ae in U.r)Ee(U.nActionId,U.r[ae])}}}function re(H){var U="/Type /XObject /Subtype /Image /Width "+H.width+" /Height "+H.height+" /ColorSpace /DeviceRGB /BitsPerComponent 8 /Filter /DCTDecode ",ae=atob(H.toDataURL("image/jpeg").replace("data:image/jpeg;base64,",""));return L(U,ae)}function de(){var U=[],ae="",ve=0,he=0,le=document.createElement("canvas"),Pe=le.getContext("2d");for(le.width=d.width;ve<d.height;)le.height=Math.min(2048,d.height-ve),Pe.drawImage(d,0,-ve),ve+=le.height,ae+="/I"+he+" "+re(le)+` 0 R\r
`,U.push(`q\r
1 0 0 1 0 `+Y((d.height-ve)*T)+` cm\r
`+Y(le.width*T)+" 0 0 "+Y(le.height*T)+` 0 0 cm\r
/I`+he+++` Do\r
Q`);var It=m.length?"/Annots["+m.join(" 0 R ")+" 0 R]":"",pt=L("/ProcSet[/PDF/ImageC]/XObject<<"+ae+">>"),Kt=L("",U.join(`\r
`));_=L("/Type/Page/Parent 1 0 R/MediaBox[0 0 "+Y(P*T)+" "+Y(A*T)+"]/Contents "+Kt+" 0 R/Resources "+pt+" 0 R"+It)}function se(){return j(),O(),de(),me(),Se(),ke(),Ce(),Ge(),g.join(`
`)}return{getBytes:function(){return oe?se():void 0},toDataURL:function(){return"data:application/pdf;base64,"+btoa(se())},toBlob:function(){var H=se();let U=new Array(H.length);for(var ae=0;ae<H.length;ae++)U[ae]=H.charCodeAt(ae);return new Blob([new Uint8Array(U)],{type:"application/pdf"})}}};async function eu(e){let t=-1;async function i(){async function m(g,y){function w(P,A){return new Promise(T=>{fetch(A.data).then(N=>N.blob()).then(N=>{N.name=decodeURIComponent(A.name),P.push(N),T()})})}let k=await chrome.runtime.sendMessage({type:"getAttachments",email:g.User.getEmailAddress()}),b=JSON.parse(k),_=[],E=[],I=[];y.setToRecipients(decodeURIComponent(b.to).split(",")),y.setSubject(decodeURIComponent(b.subject));for(var C=0;C<b.files.length;++C)_.push(w(b.files[C].inline==="yes"?E:I,b.files[C]));await Promise.all(_).then(()=>{E.length>0&&y.attachInlineFiles(E),I.length>0&&(setTimeout(function(){y.attachFiles(I)},1e3),y.getBodyElement().focus())})}InboxSDK.load(2,"sdk_FireShot_c30c6a0127").then(g=>{let y=g.Compose.registerComposeViewHandler(w=>{y(),m(g,w)});g.Compose.openNewComposeView()})}let o=!1;chrome.runtime.onMessage.addListener(function m(g,y,w){y?.tab?.id===t&&(g.type==="inboxsdk__injectPageWorld"&&!o?(o=!0,chrome.scripting.executeScript({target:{tabId:y.tab.id},world:"MAIN",files:["scripts/3p/pageWorld.js"]}),w(!0)):g.type==="getAttachments"&&(chrome.runtime.onMessage.removeListener(m),w(e)))});let s=!1,c=async(m,g,y)=>{!s&&t===m&&g?.status==="complete"&&/^https?:\/\/mail.google.com\/mail.*$/.test(y.url)&&(chrome.tabs.onUpdated.removeListener(c),s=!0,await chrome.scripting.executeScript({target:{tabId:t},files:["scripts/3p/inboxsdk.js"]}),await chrome.scripting.executeScript({target:{tabId:t},func:i}))},l=null,d=async()=>{chrome.tabs.onUpdated.addListener(c),{id:t}=await chrome.tabs.create({url:"https://gmail.com/"})};if(setTimeout(()=>{chrome.tabs.onUpdated.removeListener(c),chrome.tabs.onRemoved.removeListener(l)},300*60*1e3),await Xa())d();else{let{id:m}=await chrome.tabs.create({url:"fsGmailPermissions.html"});l=async g=>{g===m&&(Ae()("Permissions tab closed"),chrome.tabs.onRemoved.removeListener(l),await chrome.permissions.contains({origins:["https://mail.google.com/*"]})?(Ae()("Gmail permissions granted starting GMail."),d()):Ae()("Gmail permissions not granted, aborting attachment"))},chrome.tabs.onRemoved.addListener(l)}}var tu=function(e,t){return new Promise((i,o)=>{try{let s={},c,l,d=m=>{console.error("a worker error occured."),c?c.terminate():document.head.removeChild(l),reportError(m),o(m)},h=async m=>{m.data.message==="loaded"?(d&&((c||l).removeEventListener("error",d),d=void 0),i(s)):m.data.message==="abort"?(reportError(m.data.data),t({data:{message:"completed",result:null}})):t(m)};if(Z(R.Re,"false")!=="true"&&typeof OffscreenCanvas<"u")s.postMessage=(m,g)=>{m.message==="terminate"?c.terminate():c.postMessage(m,g)},c=new Worker(e),c.addEventListener("error",d,!1),c.addEventListener("message",h,!1);else{let m={msgs:[],host:h};window.fsWorkerConnection=m,l=document.createElement("script"),l.addEventListener("error",d,!1),s.postMessage=g=>{m.worker?setTimeout(()=>m.worker({data:g},10)):m.msgs.push(g)},l.async=!0,l.src=e,document.head.appendChild(l)}}catch(s){reportError(s),o(s)}})};Ua();var nu=!1,dr=!1,iu,ts,ou,lr,fr,wi,ur,su,et,Ut,fn,jt={},ru,rt,Zo,es=-1;window.addEventListener("load",async()=>{var e=!1;let t="showAlert1",i="#";function o(){lt()?(ft()||$("#upgradeLink,#noflashgoadvanced,#noflashgoadvanced2,#noflashgoadvanced3,#divPDFFeatures").removeClass("hiddenInitially"),$("#divWinPromo").show(),$("#divNonWinPromo").hide()):($("#divWinPromo").hide(),$("#divNonWinPromo").show()),Nr()?$("#lnkOperaStore").hide():$r()?$("#lnkEdgeNew").hide():Ve()?$("#lnkSafariStore").hide():ze()?($("#lnkAmo").hide(),$("#divEmail").hide()):$("#lnkChromeStore").hide(),$("a[href*='APPID']").each(function(){this.href=this.href.replace("APPID",Pt()),this.href=this.href.replace("VERID",We().extVersionFull)}),jt.UUID=Z(R.g),jt.Serial=Z(R.o),$("#lnkProblem, #lnkProblemBetaPreview, #lnkProblemPDF").attr("href","https://getfireshot.com/report-problem.php?u="+btoa(lr)+"&browser="+Pt()+"&ver="+We().extVersionFull+"&d="+btoa(JSON.stringify(jt))),w();let B=ft();$("#btnPDFOptionsForGmail").toggle(B),$("#pdfCaret").toggle(!B),$("#pdfSettings").toggle(B),e&&($("#spnAdvancedFeaturesSection, #lnkUpgradeFromPDF, #betaProgramPromo").hide(),$("#lnkBuyProFromPDF, #lnkBuyProFromPDF1").show())}async function s(B){let O=B==="png"?"image/png":"image/jpeg";if(et.length===1&&et[0].type===O)return et[0];let re=setTimeout(()=>$("#divProcessing").slideDown(200),200),de=Math.min(R.G/Ut,ze()||Ve()?32767:B==="png"?65535:65500,fn),H=await(await c(0,de)).convertToBlob({type:O});return clearTimeout(re),$("#divProcessing").slideUp(10),H}async function c(B,O){Ae()(`getCanvasFromBlobs(${O})`);let re=new OffscreenCanvas(Ut,O),de=re.getContext("2d",{alpha:!1,willReadFrequently:!1}),se=0,H=0;for(;se<O&&et[H];){let U=await createImageBitmap(et[H++]);de.drawImage(U,0,se),se+=U.height}return re}async function l(){let B=Math.min(R.G/Ut,ze()||Ve()?32767:65535,fn),O=setTimeout(()=>$("#divProcessing").slideDown(200),200),re=await c(0,B),de=new Zc(re,ts,fr);return clearTimeout(O),$("#divProcessing").slideUp(10),de}function d(){N(async()=>ft()?(At("UA-1025658-9","fireshot.com","PDF-Pro-Created"),b()):(await l()).toBlob(),ur+".pdf")}function h(){let B=Z(R.Le,"png");N(()=>s(B),ur+"."+B)}function m(){$("#lnkOptions, #btnOptions").click(()=>(qc(!0),!1)),$("#advancedInstructionsPreDialog").on("hidden.bs.modal",Jc),$("#lnkInstallAdvancedTop-1, #lnkInstallAdvancedTop-2, #lnkUpgradeFromPDF, #lnkInstallAdvanced, #lnkInstallAdvanced1, #lnkInstallAdvancedClipboardDlg").click(function(){return e?Xo("Captured_Suspended"):lt()?$("#advancedInstructionsPreDialog").modal():(bi(),o()),!1}),$("#btnCloseAlert1").click(function(){ie(t,0)}),$("#btnSaveImage").click(h),$("#btnSaveImagePDF").click(d),$("#btnSendEmail").find("li").click(function(){return $("#btnGmail").dropdown("toggle"),_(),P($(this).attr("value")),!1}),$("#btnClipboard").click(C),$("#btnPrint").click(function(){E(),_()}),$("#lnkPdfSettings").click(B=>(B.stopPropagation(),k(),!1)),$("#pdfCaret").click(B=>{B.stopPropagation(),$("#ddControl").dropdown("toggle")}),$("#menuPDFFeatures").find("li").click(B=>{B.stopPropagation();let O=document.getElementById("menuPDFFeatures").getBoundingClientRect();return $("#divUpgradeMsg").css({"min-width":O.width+"px",height:O.height+"px"}),$("#divUpgradeMsg").fadeIn(200),!1}),$("#menuPDFFeatures").parent().on("hide.bs.dropdown",()=>$("#divUpgradeMsg").hide()),$("#btnCloseAdvancedTopMsg").click(()=>{ie(R.te,new Date().getTime()+864e6),$("#divCanBeBetterPromo").fadeOut(300)}),$("#btnCloseAdvertising").click(()=>{$("#divAdvertising").hide()}),$("#lnkAdPromo").click(()=>(bn(i),!1)),$("#lnkTest1").click(()=>{}),$("#lnkTest2").click(()=>{}),$("#lnkTest3").click(()=>{}),$("#btnHidePreviewWarning").click(()=>(g(!1),!1)),$("#divPreviewWarning").click(()=>{g(!0)}),$("#lnkDisableBetaPreview").click(()=>(ie(R.t,"false"),o(),setTimeout(()=>$("#divBackToLiteWarning").fadeIn(300),300),setTimeout(()=>$("#divBackToLiteWarning").fadeOut(900),4e3),At("UA-1025658-9","fireshot.com","BetaPreviewCanceled"),!1)),$("#btnEnableBetaPreview, #btnEnableBetaPreview-1, #btnEnableBetaPreview-2").click(()=>{bi(),setTimeout(o,200)}),$("#btnPDFOptionsForGmail").click(B=>(B.stopPropagation(),k(),!0)),$("#lnkBetaProgramConditions, #lnkBetaProgramConditions-1").click(()=>(Qo(),!1)),$("#btnCompactBPPromo, #lnkExpandBPPromo").click(B=>{ie(R.ae,B.currentTarget.id==="btnCompactBPPromo"),o()}),$("#lnkRemoveAdv").click(()=>(Y(),!1)),Ve()&&$('a[target="_blank"]').click(function(){if($(this).attr("href")&&$(this).attr("href")!=="#")return window.open($(this).attr("href")),!1}),$("#lnkBuyPro, #lnkBuyProFromPDF, #lnkBuyProFromPDF1").click(()=>(Xo("capturedPageLnk"),!1)),$("#spnOpenInFinder").click(B=>{Xc(),B.stopPropagation()}),$("#divDownloadedInfoText").click(Qc)}function g(B){ie(R.se,B),o()}function y(){return!lt()&&ft()&&!no()}function w(){let B=Z(R.se,"true")==="true";y()?($("#divPreviewWarning").removeClass("hiddenInitially"),$("#divCanBeBetterPromo, #divLimitedSavingFunctionality").hide(),B?$("#divPreviewWarning").removeClass("warningCollapsed"):$("#divPreviewWarning").addClass("warningCollapsed")):$("#divPreviewWarning").addClass("hiddenInitially"),(lt()||ft()||e)&&$("#divBetaPromo").addClass("hiddenInitially"),Z(R.ae)==="true"?($("#divBPFull").slideUp(300),$("#divBPBrief").slideDown(300)):($("#divBPBrief").hide(),$("#divBPFull").slideDown(300))}function k(){return At("UA-1025658-9","fireshot.com","PDF-Pro-Settings"),new Promise(B=>{let O=function(re,de,se,H,U){return{title:re,URL:de,created:se,extents:{cx:H,cy:U}}};PDFDialog.templateVars=new O(fr,lr,wi,Ut,fn),PDFDialog.preferences=ut,PDFDialog.show(!1).then(re=>{re&&ie(R.ce,"true"),B(re)})})}function b(){return!rt&&Z(R.ce,"false")==="false"?k().then(B=>B?Ue(!1):"cancelled"):Ue(!1)}function _(){(rt||Z(R.ee)==="true")&&window.close()}function E(){document.querySelectorAll("div").forEach(O=>{O.classList.add("noPrint")});let B=document.getElementById("divImgResult");for(;B;)B.classList.remove("noPrint"),B=B.parentElement;if(!ft()){let O=65536;for(let re of document.getElementById("divImgResult").childNodes)O<=0?re.classList.add("noPrint"):O-=re.naturalHeight}setTimeout(()=>{print(),document.querySelectorAll(".noPrint").forEach(O=>{O.classList.remove("noPrint")})},Ve()?200:0)}function I(){$("#divErrorMessage").slideDown(200)}async function C(){if(ze())browser.permissions.request({permissions:["clipboardWrite"]}).then(()=>et[0].arrayBuffer()).then(B=>{browser.clipboard.setImageData(B,"png")}).then(()=>{$("#divClipboardMessage").slideDown(200),setTimeout(()=>$("#divClipboardMessage").slideUp(100),2e3),_()}).catch(B=>{Ae()(B),$("#modalCopyToClipboard").modal()});else try{let B=await s("png"),O=new ClipboardItem(Object.defineProperty({},B.type,{value:B,enumerable:!0}));await navigator.clipboard.write([O]),$("#divDownloadedInfo").slideUp(10),$("#divClipboardMessage").slideDown(200),setTimeout(()=>$("#divClipboardMessage").slideUp(100),2e3),Z(R.ee)==="true"&&setTimeout(_,500)}catch(B){Ae()(B),$("#modalCopyToClipboard").modal()}}async function P(B){let O=null,re=H=>new Promise(U=>{let ae=new FileReader;ae.onloadend=()=>{U(ae.result)},ae.readAsDataURL(H)});switch(B){case"png":case"jpg":O=await re(await s(B));break;default:{if(ft()){let H=await b();if(!H||H.size===0){I();return}O=await re(H)}else O=(await l()).toDataURL();B="pdf"}}let de=ur+"."+B,se={to:"",subject:"Screenshots from FireShot",files:[{inline:"no",name:encodeURIComponent(de),data:O}]};setTimeout(()=>eu(JSON.stringify(se)),200)}function A(B,O,re){function de(se){return new Promise(H=>{let U=new FileReader;U.readAsDataURL(se),U.onloadend=()=>{H(U.result.split(",")[1])}})}B().then(se=>{if(se!=="cancelled")if(!se||se.size===0)I();else return de(se)}).then(se=>{if(!se)return;let H={topic:"saveFile",data:se,dialog:String(!rt&&Z(R.Z)!=="true"),filename:re,subfolder:O,openFolder:String(!rt&&Z(R.Q)==="true"),extension:"pdf"};Ae()(`b64 encoded data size is: ${se.length} bytes`),qn(H,U=>{U.success==="true"&&(rt?Rr().onFileSavedEvent(es,1):($("#divDownloadedInfoFilename").text(decodeURI(U.file.substring(U.file.lastIndexOf("/")+1,U.file.length))),$("#divDownloadedInfo").slideUp(100).slideDown(200)),_())})})}var T;function N(B,O,re){let de=/^\/*(.*?)\/*$/g.exec(Z(R.Me,R.Ne))[1];de!==""&&(de+="/"),rt&&Zo&&(de+=decodeURI(Zo)+"/"),Ve()?A(B,de,O):Ja(()=>{var se;nu||(nu=!0,chrome.downloads.onChanged.addListener(async H=>{!T||!H.state||H.state.current!="complete"||T!=H.id||(URL.revokeObjectURL(se),rt?await Rr().onFileSavedEvent(es,T):Z(R.Q)==="true"&&chrome.downloads.show(T),_())})),B().then(async H=>{if(H==="cancelled")return;if(!H||H.size===0){I();return}await Rr().addOnDeterminingFilenameHandler(re?O:de+O),se=URL.createObjectURL(H),chrome.downloads.download({url:se,saveAs:!rt&&Z(R.Z)!=="true",filename:ze()?de+O:void 0,conflictAction:"overwrite"},ae=>{chrome.runtime.lastError?!re&&!ze()&&N(B,O,!0):T=ae})})})}function K(){bn("https://getfireshot.com/like.php?browser="+Pt()+"&ver="+We().extVersion)}function M(){$("#btnLike #btnDislike").unbind(),$("#btnLike").click(function(){ie(R.A,"true"),$("#divLikeMessage").hide(),J()}),$("#btnDislike").click(function(){ie(R.A,"false"),$("#divLikeMessage").slideUp(100)}),setTimeout(function(){$("#divLikeMessage").slideDown(300)},2e3)}function q(){return parseInt(Z(R.te,"0"))<=new Date().getTime()?(setTimeout(()=>$("#divCanBeBetterPromo").slideDown(300),oe?0:2e3),!0):!1}function ee(){return setTimeout(()=>$("#divLimitedSavingFunctionality").slideDown(300),oe?0:2e3),!0}function j(){setTimeout(()=>$("#divAdvertising").slideDown(700),2e3)}function L(){if(oe)return;new Date().getTime()>Z(R.oe,0)&&(ft()||y())&&(document.getElementById("iframeAdv").src="https://ssl.getfireshot.com/carbon/index.html",window.addEventListener("message",O=>{switch(O.data.msg){case"loaded":At("UA-1025658-9","Ads","AdLoaded"),$("#divAdv,#divAdvHelper").removeClass("hiddenInitially"),$("#pageHeader").addClass("hiddenWhenAdShown");break;case"logAction":ie(R.oe,new Date().getTime()+O.data.id);break;case"logClicked":At("UA-1025658-9","Ads","AdClicked");break}},!1))}function Y(){document.getElementById("framePromo").src="fsPromoDialog.html?context=ads",setTimeout(()=>{document.getElementById("modalPromo").showModal(),document.getElementById("modalPromo").addEventListener("click",B=>B.target.close())},100)}function ne(){document.getElementById("framePromo").src="fsPromoDialog.html?context=history&persistent=true",document.addEventListener("keydown",B=>B.preventDefault()),setTimeout(()=>{document.getElementById("modalPromo").showModal()},100)}function J(){$("#btnRate #btnRateLater").unbind(),$("#btnRate").click(function(){ie(R.ie,"true"),$("#divSendReview").slideUp(100),K()}),$("#btnRateLater").click(function(){$("#divSendReview").slideUp(100)}),setTimeout(function(){$("#divSendReview").slideDown(300)},200)}function me(){let B=Z(R.A,"")==="true",O=Z(R.A,"")!=="",re=Z(R.ie,"false")==="true",de=parseInt(Z(R.B,0));!O&&de>10?M():B&&!re&&de%50===0&&J()}function Se(){function B(){let U=document.getElementById("divImgResult"),ae=20,ve=U.getClientRects()[0],he=document.getElementById("divPanel").getClientRects()[0];ve&&(ve.y+ve.height<he.y?($("#divImgResult").css("max-height",$("#divPanel").height()+"px"),$("#divImgResult").css("overflow-y",U.clientHeight<U.scrollHeight?"scroll":"hidden"),$("#divPanel").width("auto")):($("#divImgResult").css("max-height",""),$("#divImgResult").height("auto"),$("#divPanel").width($("#divContainer").width()-$("#divImgResult").width()-40)),Ut<$(U).width()-ae?($("canvas.canvasCell").css("width","auto"),$("#divImgResult").css("overflow-y",U.clientHeight<U.scrollHeight?"scroll":"hidden"),U.style.zoom=1.0000001,setTimeout(function(){U.style.zoom=1},50)):U.clientHeight>=U.scrollHeight&&($(U).css("overflow-y","hidden"),$("canvas.canvasCell").css("width",""),U.style.zoom=1.0000001,setTimeout(function(){U.style.zoom=1},50)))}function O(){$("#divLeftCol").offset().top-15<window.scrollY&&$("#divImgResult").height()>$("#divPanel").height()&&$("#divPanel").height()<window.innerHeight?($("#divPanel").addClass("fixed"),$("#divPanel").css({top:"15px"})):$("#divPanel").removeClass("fixed")}let re=Z(R.m,1),de=!1,se=!de&&re%5===0;de?$("#lnkSiteIndex").css("opacity","1"):setTimeout(function(){$("#lnkSiteIndex").addClass("splashIn")},se?1800:1e3),ft()||(ru?ee():(!su||!q())&&(lt()?de?j():se?setTimeout(()=>$("#divPromo").slideDown(300),1e3):$("#divPromo").show():e||$("#divBetaPromo").removeClass("hiddenInitially"))),document.title=ur,window.addEventListener("resize",ro(B)),window.addEventListener("scroll",ro(O));let H=(U,ae)=>new Promise(ve=>{let he=new Image;he.className="canvasCell",document.getElementById("divImgResult").appendChild(he);let le=URL.createObjectURL(U);he.src=le,he.onload=function(){ae&&(he.onload=null,setTimeout(()=>{let Pe=new FileReader;Pe.readAsDataURL(U),Pe.onloadend=function(){let It=Pe.result;he.src=It}},100)),Ae()(`Loaded image tile [${this.width}, ${this.height}]`),ve()}});oe&&ot("pageInit"),Promise.all(et.map(U=>H(U,et[0]===U))).then(()=>{let U=document.getElementById("divImgResult");U.childNodes.length>0&&(U.childNodes[0].id="imgResult"),oe&&st("pageInit"),setTimeout(B,10),$("#divPreload").hide(),$("#divContainer").show(),$("#divPreviewWarningContainer").show();})}function Ue(B){function O(re){ProgressBar.percentage=re,rt&&(document.title=`[${Math.round(re)}%] ${chrome.i18n.getMessage("label_processing")}`)}return new Promise(re=>{let H=fn,U=Ut;H/1500>2&&(O(0),ProgressBar.visible=!0);let ae=Z("pdfSettings"+(B?"multi":"")),ve=Z("header"),he=Z("footer"),le=Z("watermark");O(5);let Pe=0,It=0,pt=null,Kt=null;async function*hr(je){je.postMessage({message:"init",width:U,height:H,URL:lr,title:fr,created:wi,pdfSettings:ae,headerSettings:ve,footerSettings:he,wmSettings:le});let Ht=0;for(let _i of et){let Fe=await createImageBitmap(_i),at=new OffscreenCanvas(Fe.width,Fe.height),pr=at.getContext("2d",{alpha:!1,willReadFrequently:!0});pr.drawImage(Fe,0,0),Fe.close();let kt=0;for(;kt<at.height;){let Ye=Math.min(1500,at.height-kt),mr=pr.getImageData(0,kt,at.width,Ye);je.postMessage({message:"blit",dstX:0,dstY:Ht+kt,dstW:at.width,dstH:Ye,imageData:mr.data,bufWidth:at.width,bufHeight:Ye,srcX:0,srcY:0}),kt+=Ye,++Pe%5===0&&(yield)}Ht+=at.height}je.postMessage({message:"addExtras",metadata:JSON.stringify({links:ts,words:ou})}),je.postMessage({message:"finalize"})}tu(`scripts/enc/fsWorker.js?ratio=${window.devicePixelRatio}`,je=>{switch(je.data.message){case"blitDone":{let Ht=je.data.totalHeight;O(Math.round(5+95*Ht/H)),++It+Math.floor(5/2)>Pe&&Kt.next();break}case"completed":{ProgressBar.visible=!1,oe&&st("pdf"),je.data.result&&!je.data.result.size&&At("UA-1025658-9","fireshot.com","PDF-Pro-Wrong-Size"),re(je.data.result),pt.postMessage({message:"terminate"});break}case"dumpBitmap":{re(je.data.result);break}}}).then(je=>{oe&&ot("pdf"),pt=je,Kt=hr(pt),Kt.next()})})}function ke(){switch(Ae()(`Performing automatic action: ${rt}`),rt){case R.p:d();break;case R.I:h();break}}function Ce(){$("#divPreload").hide(),$("#divPageError").removeClass("hiddenInitially"),$("#spnErrorMsg").text(chrome.i18n.getMessage("captured_an_error_occurred")),$("#spnProblemOnHalt").text(chrome.i18n.getMessage("captured_link_report_problem")),$("#lnkProblemOnHalt").attr("href","https://getfireshot.com/report-problem.php?u="+btoa(document.location.href)+"&browser="+Pt()+"&ver="+We().extVersionFull+"&d="+btoa(JSON.stringify(jt))),document.title="..."}function Ge(){try{Ga()}catch(re){Xt(re.message)}let O=new URLSearchParams(window.location.search).get("params");O&&({action:rt,folder:Zo,context:es}=JSON.parse(atob(O))),ie(R.B,parseInt(Z(R.B,0))+1),ur=Ya(lr,fr,iu),rt?($("#divPreload").hide(),document.title=chrome.i18n.getMessage("label_processing"),ke()):(ru=et.length>1,o(),m(),Se(),me(),L())}for(await ut.ensureLoaded(),await zn(),e=(await wt())?.we();!et&&!dr;)await Za(200);if(dr){Ae()("Page error occurred, halting..."),Ce();return}let Ee=new Date;Ee.setHours(24,0,0,0),Ee.setDate(Ee.getDate()-7)>wi&&!no()?($("#divPreload").hide(),ne()):Ge()});function nm(e){let t=new URLSearchParams(window.location.search),i=parseInt(t.get("id"));isNaN(i)?(dr=!0,e(null)):ln.getCapture(i).then(o=>{o?.tiles.length>0?(Ve()&&(o.tiles=o.tiles.map(s=>new Blob([s],{type:"image/png"}))),lr=o.url,fr=o.title,su=o.metadata.cbb,iu=o.metadata.n,Ut=o.metadata.width,fn=o.metadata.height,ts=o.metadata.links,ou=o.metadata.words,jt={tilesInDB:o.tiles.length,...o.metadata.debug||{}},wi=new Date(o.time),!Ut||!fn?(dr=!0,reportError("Preload failed due to incomplete DB record"),e(null)):e(o.tiles)):oe||window.close()}).catch(o=>{dr=!0,jt={error:o.message,...jt||{}},reportError(`Preload failed: ${o.message}`),e(null)})}ot("preload");nm(e=>{Yt("savedCapParamsForDebugging: "+JSON.stringify(jt)),et=e,st("preload"),et&&(Ae()(`capHeight: ${fn}`),Ae()(`data preloaded successfully (${et.length} blobs)`))});})();
//# sourceMappingURL=fsCaptured.js.map

//# debugId=32bc46e8-cbce-5f5e-b063-04fffe1f1859
