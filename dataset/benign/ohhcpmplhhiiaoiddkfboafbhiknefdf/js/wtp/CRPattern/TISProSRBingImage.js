var SS_Util=TrendMicro.TB.SAFESEARCHING;function foundImageCallback(e){TMExt_debug(e);var t=TMExt_$(e.FindInsertNode()).parent(),l=t.find("a").eq(0),n=l.find("img").eq(0);t.attr("link_level",e.level),SS_Util.isNeedToBlock(e.level)?(TMExt_debug("==========================BLOCK THE ABOVE ONE==================================="),SS_Util.checkImageBlockPopupExist(),t.css("display","inline-block"),t.css("height","100%"),t.css("text-decoration","none"),t.css("width","100%"),n.remove(),l.find("span").remove(),SS_Util.setBlockImage(t),SS_Util.bindMouseEnterEvent(t)):TMExt_debug("the image level is "+e.level+", no need to block (level 8 is parent control category)")}function getRealUrl(e){try{var t=TMExt_$(e).attr("m"),l=t.indexOf('purl":"')+7,n=t.indexOf('"',l);return t.substring(l,n)}catch(t){return e.href}}function TSSRParseResult_Image(e){var t,l=new CreateTSRLocatedObject(null,null,"a",null),n=new CreateTSRLocatedObject(null,l,"ul",null),a=new CreateTSRLocatedObject(e,n,"div","vm_c");if(n.multiMatches=!0,n.appendAttribute("class","dgControl_list "),l.multiMatches=!0,l.appendAttribute("class","iusc"),t=a.findElement())for(var r=GetAllTSRLocatedNodes(t),i=0;i<r.length;i++){var c=getRealUrl(r[i]);c&&CreateTSRResultObject(r[i],c,null,null,null,null,foundImageCallback)}}function TSRParse(){var e=g_oEnv.Parser.iResultNumber;return TSSRParseResult_Image(document),TrendMicro.TB.ReduceNewNode(e+1),g_oEnv.Parser.rgobjSearchResult}TSRTagFlowID(),TMExt_debug("URL matched, start safe searching function"),TMExt_$(window).resize(function(){SS_Util.refreshBlockImages()});